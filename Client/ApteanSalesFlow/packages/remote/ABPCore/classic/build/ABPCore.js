var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||typeof Object.defineProperties=='function'?Object.defineProperty:function(b,c,a){a=a;if(b==Array.prototype||b==Object.prototype){return}b[c]=a.value};$jscomp.getGlobal=function(a){return typeof window!='undefined'&&window===a?a:typeof global!='undefined'&&global!=null?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(i,f,j,k){if(!f){return}var a=$jscomp.global;var b=i.split('.');for(var e=0;e<b.length-1;e++){var d=b[e];if(!(d in a)){a[d]={}}a=a[d]}var g=b[b.length-1];var h=a[g];var c=f(h);if(c==h||c==null){return}$jscomp.defineProperty(a,g,{configurable:!0,writable:!0,value:c})};$jscomp.polyfill('Array.prototype.copyWithin',function(a){if(a){return a}var b=function(d,c,b){var e=this.length;d=Number(d);c=Number(c);b=Number(b!=null?b:e);if(d<c){b=Math.min(b,e);while(c<b){if(c in this){this[d++]=this[c++]}else {delete this[d++];c++}}}else {b=Math.min(b,e+c-d);d+=b-c;while(b>c){if(--b in this){this[--d]=this[b]}else {delete this[d]}}}return this};return b},'es6','es3');$jscomp.SYMBOL_PREFIX='jscomp_symbol_';$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global['Symbol']){$jscomp.global['Symbol']=$jscomp.Symbol}};$jscomp.Symbol=function(){var a=0;function Symbol(b){return $jscomp.SYMBOL_PREFIX+(b||'')+a++}return Symbol}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global['Symbol'].iterator;if(!a){a=$jscomp.global['Symbol'].iterator=$jscomp.global['Symbol']('iterator')}if(typeof Array.prototype[a]!='function'){$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}})}$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){if(b<a.length){return {done:!1,value:a[b++]}}else {return {done:!0}}})};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();var a={next:b};a[$jscomp.global['Symbol'].iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();if(a instanceof String){a=a+''}var c=0;var b={next:function(){if(c<a.length){var e=c++;return {value:d(e,a[e]),done:!1}}b.next=function(){return {done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill('Array.prototype.entries',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b,c){return [b,c]})};return b},'es6','es3');$jscomp.polyfill('Array.prototype.fill',function(a){if(a){return a}var b=function(f,c,b){var d=this.length||0;if(c<0){c=Math.max(0,d+c)}if(b==null||b>d){b=d}b=Number(b);if(b<0){b=Math.max(0,d+b)}for(var e=Number(c||0);e<b;e++){this[e]=f}return this};return b},'es6','es3');$jscomp.findInternal=function(a,d,e){if(a instanceof String){a=String(a)}var f=a.length;for(var b=0;b<f;b++){var c=a[b];if(d.call(e,c,b,a)){return {i:b,v:c}}}return {i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).v};return b},'es6','es3');$jscomp.polyfill('Array.prototype.findIndex',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).i};return b},'es6','es3');$jscomp.polyfill('Array.from',function(a){if(a){return a}var b=function(b,c,g){$jscomp.initSymbolIterator();c=c!=null?c:function(d){return d};var d=[];var f=b[Symbol.iterator];if(typeof f=='function'){b=f.call(b);var h;while(!(h=b.next()).done){d.push(c.call(g,h.value))}}else {var i=b.length;for(var e=0;e<i;e++){d.push(c.call(g,b[e]))}}return d};return b},'es6','es3');$jscomp.polyfill('Object.is',function(a){if(a){return a}var b=function(b,c){if(b===c){return b!==0||1/b===1/c}else {return b!==b&&c!==c}};return b},'es6','es3');$jscomp.polyfill('Array.prototype.includes',function(a){if(a){return a}var b=function(d,e){var b=this;if(b instanceof String){b=String(b)}var f=b.length;for(var c=e||0;c<f;c++){if(b[c]==d||Object.is(b[c],d)){return !0}}return !1};return b},'es7','es3');$jscomp.polyfill('Array.prototype.keys',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b){return b})};return b},'es6','es3');$jscomp.polyfill('Array.of',function(a){if(a){return a}var b=function(b){return Array.from(arguments)};return b},'es6','es3');$jscomp.polyfill('Array.prototype.values',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(c,b){return b})};return b},'es6','es3');$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.polyfill('Promise',function(c){if(c&&!$jscomp.FORCE_POLYFILL_PROMISE){return c}function AsyncExecutor(){this.batch_=null}AsyncExecutor.prototype.asyncExecute=function(a){if(this.batch_==null){this.batch_=[];this.asyncExecuteBatch_()}this.batch_.push(a);return this};AsyncExecutor.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global['setTimeout'];AsyncExecutor.prototype.asyncExecuteFunction=function(a){e(a,0)};AsyncExecutor.prototype.executeBatch_=function(){while(this.batch_&&this.batch_.length){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var d=b[a];delete b[a];try{d()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};AsyncExecutor.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a})};var b={PENDING:0,FULFILLED:1,REJECTED:2};var a=function(d){this.state_=b.PENDING;this.result_=undefined;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{d(a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.createResolveAndReject_=function(){var b=this;var a=!1;function firstCallWins(d){return function(e){if(!a){a=!0;d.call(b,e)}}}return {resolve:firstCallWins(this.resolveTo_),reject:firstCallWins(this.reject_)}};a.prototype.resolveTo_=function(b){if(b===this){this.reject_(new TypeError('A Promise cannot resolve to itself'))}else {if(b instanceof a){this.settleSameAsPromise_(b)}else {if(isObject(b)){this.resolveToNonPromiseObj_(b)}else {this.fulfill_(b)}}}};a.prototype.resolveToNonPromiseObj_=function(b){var a=undefined;try{a=b.then}catch(f){this.reject_(f);return}if(typeof a=='function'){this.settleSameAsThenable_(a,b)}else {this.fulfill_(b)}};function isObject(a){switch(typeof a){case 'object':return a!=null;case 'function':return !0;default:return !1;}}a.prototype.reject_=function(a){this.settle_(b.REJECTED,a)};a.prototype.fulfill_=function(a){this.settle_(b.FULFILLED,a)};a.prototype.settle_=function(d,a){if(this.state_!=b.PENDING){throw new Error('Cannot settle('+d+', '+a|'): Promise already settled in state'+this.state_)}this.state_=d;this.result_=a;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){var b=this.onSettledCallbacks_;for(var a=0;a<b.length;++a){b[a].call();b[a]=null}this.onSettledCallbacks_=null}};var d=new AsyncExecutor();a.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};a.prototype.settleSameAsThenable_=function(b,d){var a=this.createResolveAndReject_();try{b.call(d,a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.then=function(f,g){var b;var d;var e=new a(function(a,e){b=a;d=e});function createCallback(a,e){if(typeof a=='function'){return function(h){try{b(a(h))}catch(i){d(i)}}}else {return e}}this.callWhenSettled_(createCallback(f,b),createCallback(g,d));return e};a.prototype['catch']=function(a){return this.then(undefined,a)};a.prototype.callWhenSettled_=function(e,f){var a=this;function callback(){switch(a.state_){case b.FULFILLED:e(a.result_);break;case b.REJECTED:f(a.result_);break;default:throw new Error('Unexpected state: '+a.state_);}}if(this.onSettledCallbacks_==null){d.asyncExecute(callback)}else {this.onSettledCallbacks_.push(function(){d.asyncExecute(callback)})}};function resolvingPromise(b){if(b instanceof a){return b}else {return new a(function(a,d){a(b)})}}a['resolve']=resolvingPromise;a['reject']=function(b){return new a(function(d,a){a(b)})};a['race']=function(b){return new a(function(e,f){var d=$jscomp.makeIterator(b);for(var a=d.next();!a.done;a=d.next()){resolvingPromise(a.value).callWhenSettled_(e,f)}})};a['all']=function(e){var d=$jscomp.makeIterator(e);var b=d.next();if(b.done){return resolvingPromise([])}else {return new a(function(g,h){var a=[];var f=0;function onFulfilled(b){return function(d){a[b]=d;f--;if(f==0){g(a)}}}do{a.push(undefined);f++;resolvingPromise(b.value).callWhenSettled_(onFulfilled(a.length-1),h);b=d.next()}while(!b.done)})}};return a},'es6','es3');$jscomp.executeAsyncGenerator=function(a){function passValueToGenerator(b){return a.next(b)}function passErrorToGenerator(b){return a['throw'](b)}return new Promise(function(b,c){function handleGeneratorRecord(d){if(d.done){b(d.value)}else {Promise.resolve(d.value).then(passValueToGenerator,passErrorToGenerator).then(handleGeneratorRecord,c)}}handleGeneratorRecord(a.next())})};$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.polyfill('WeakMap',function(c){function isConformant(){if(!c||!Object.seal){return !1}try{var b=Object.seal({});var d=Object.seal({});var a=new c([[b,2],[d,3]]);if(a.get(b)!=2||a.get(d)!=3){return !1}a['delete'](b);a.set(d,4);return !a.has(b)&&a.get(d)==4}catch(e){return !1}}if(isConformant()){return c}var a='$jscomp_hidden_'+Math.random().toString().substring(2);function insert(b){if(!$jscomp.owns(b,a)){var d={};$jscomp.defineProperty(b,a,{value:d})}}function patch(a){var b=Object[a];if(b){Object[a]=function(d){insert(d);return b(d)}}}patch('freeze');patch('preventExtensions');patch('seal');var d=0;var b=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=$jscomp.makeIterator(a);var b;while(!(b=f.next()).done){var e=b.value;this.set(e[0],e[1])}}};b.prototype.set=function(b,d){insert(b);if(!$jscomp.owns(b,a)){throw new Error('WeakMap key fail: '+b)}b[a][this.id_]=d;return this};b.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:undefined};b.prototype.has=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};b.prototype['delete']=function(b){if(!$jscomp.owns(b,a)||!$jscomp.owns(b[a],this.id_)){return !1}return delete b[a][this.id_]};return b},'es6','es3');$jscomp.MapEntry=function(){this.previous;this.next;this.head;this.key;this.value};$jscomp.polyfill('Map',function(b){var g=!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!b||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=b;var e=Object.seal({x:4});var c=new b($jscomp.makeIterator([[e,'s']]));if(c.get(e)!='s'||c.size!=1||c.get({x:4})||c.set({x:4},'t')!=c||c.size!=2){return !1}var d=c.entries();var a=d.next();if(a.done||a.value[0]!=e||a.value[1]!='s'){return !1}a=d.next();if(a.done||a.value[0].x!=4||a.value[1]!='t'||!d.next().done){return !1}return !0}catch(j){return !1}}();if(g){return b}$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=new WeakMap();var a=function(a){this.data_={};this.head_=f();this.size=0;if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.set(d[0],d[1])}}};a.prototype.set=function(e,d){var a=c(this,e);if(!a.list){a.list=this.data_[a.id]=[]}if(!a.entry){a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:d};a.list.push(a.entry);this.head_.previous.next=a.entry;this.head_.previous=a.entry;this.size++}else {a.entry.value=d}return this};a.prototype['delete']=function(d){var a=c(this,d);if(a.entry&&a.list){a.list.splice(a.index,1);if(!a.list.length){delete this.data_[a.id]}a.entry.previous.next=a.entry.next;a.entry.next.previous=a.entry.previous;a.entry.head=null;this.size--;return !0}return !1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};a.prototype.has=function(a){return !!c(this,a).entry};a.prototype.get=function(d){var a=c(this,d).entry;return a&&a.value};a.prototype.entries=function(){return d(this,function(a){return [a.key,a.value]})};a.prototype.keys=function(){return d(this,function(a){return a.key})};a.prototype.values=function(){return d(this,function(a){return a.value})};a.prototype.forEach=function(e,d){var f=this.entries();var c;while(!(c=f.next()).done){var a=c.value;e.call(d,a[1],a[0],this)}};a.prototype[Symbol.iterator]=a.prototype.entries;var c=function(g,e){var f=i(e);var a=g.data_[f];if(a&&$jscomp.owns(g.data_,f)){for(var d=0;d<a.length;d++){var c=a[d];if(e!==e&&c.key!==c.key||e===c.key){return {id:f,list:a,index:d,entry:c}}}}return {id:f,list:a,index:-1,entry:undefined}};var d=function(c,d){var a=c.head_;return $jscomp.iteratorPrototype(function(){if(a){while(a.head!=c.head_){a=a.previous}while(a.next!=a.head){a=a.next;return {done:!1,value:d(a)}}a=null}return {done:!0,value:void 0}})};var f=function(){var a={};a.previous=a.next=a.head=a;return a};var h=0;var i=function(a){var c=a&&typeof a;if(c=='object'||c=='function'){a=a;if(!e.has(a)){var d=''+ ++h;e.set(a,d);return d}return e.get(a)}return 'p_'+a};return a},'es6','es3');$jscomp.polyfill('Math.acosh',function(a){if(a){return a}var b=function(b){b=Number(b);return Math.log(b+Math.sqrt(b*b-1))};return b},'es6','es3');$jscomp.polyfill('Math.asinh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.log(Math.abs(b)+Math.sqrt(b*b+1));return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Math.log1p',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var f=b;var g=1;var c=b;var d=0;var e=1;while(d!=c){f*=b;e*=-1;c=(d=c)+e*f/++g}return c}return Math.log(1+b)};return b},'es6','es3');$jscomp.polyfill('Math.atanh',function(b){if(b){return b}var a=Math.log1p;var c=function(c){c=Number(c);return (a(c)-a(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.cbrt',function(a){if(a){return a}var b=function(b){if(b===0){return b}b=Number(b);var c=Math.pow(Math.abs(b),1/3);return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Math.clz32',function(a){if(a){return a}var b=function(b){b=Number(b)>>>0;if(b===0){return 32}var c=0;if((b&4.29490176E9)===0){b<<=16;c+=16}if((b&4.27819008E9)===0){b<<=8;c+=8}if((b&4.02653184E9)===0){b<<=4;c+=4}if((b&3.221225472E9)===0){b<<=2;c+=2}if((b&2.147483648E9)===0){c++}return c};return b},'es6','es3');$jscomp.polyfill('Math.cosh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);return (b(c)+b(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.expm1',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var e=b;var f=1;var c=b;var d=0;while(d!=c){e*=b/++f;c=(d=c)+e}return c}return Math.exp(b)-1};return b},'es6','es3');$jscomp.polyfill('Math.hypot',function(a){if(a){return a}var b=function(c,d,h){c=Number(c);d=Number(d);var b,g,f;var e=Math.max(Math.abs(c),Math.abs(d));for(b=2;b<arguments.length;b++){e=Math.max(e,Math.abs(arguments[b]))}if(e>1.0E100||e<1.0E-100){c=c/e;d=d/e;f=c*c+d*d;for(b=2;b<arguments.length;b++){g=Number(arguments[b])/e;f+=g*g}return Math.sqrt(f)*e}else {f=c*c+d*d;for(b=2;b<arguments.length;b++){g=Number(arguments[b]);f+=g*g}return Math.sqrt(f)}};return b},'es6','es3');$jscomp.polyfill('Math.imul',function(a){if(a){return a}var b=function(b,c){b=Number(b);c=Number(c);var f=b>>>16&65535;var d=b&65535;var g=c>>>16&65535;var e=c&65535;var h=f*e+d*g<<16>>>0;return d*e+h|0};return b},'es6','es3');$jscomp.polyfill('Math.log10',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN10};return b},'es6','es3');$jscomp.polyfill('Math.log2',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN2};return b},'es6','es3');$jscomp.polyfill('Math.sign',function(a){if(a){return a}var b=function(b){b=Number(b);return b===0||isNaN(b)?b:b>0?1:-1};return b},'es6','es3');$jscomp.polyfill('Math.sinh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);if(c===0){return c}return (b(c)-b(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.tanh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.exp(-2*Math.abs(b));var d=(1-c)/(1+c);return b<0?-d:d};return b},'es6','es3');$jscomp.polyfill('Math.trunc',function(a){if(a){return a}var b=function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0){return b}var c=Math.floor(Math.abs(b));return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9.007199254740991E15},'es6','es3');$jscomp.polyfill('Number.MIN_SAFE_INTEGER',function(){return -9.007199254740991E15},'es6','es3');$jscomp.polyfill('Number.isFinite',function(a){if(a){return a}var b=function(b){if(typeof b!=='number'){return !1}return !isNaN(b)&&b!==Infinity&&b!==-Infinity};return b},'es6','es3');$jscomp.polyfill('Number.isInteger',function(a){if(a){return a}var b=function(b){if(!Number.isFinite(b)){return !1}return b===Math.floor(b)};return b},'es6','es3');$jscomp.polyfill('Number.isNaN',function(a){if(a){return a}var b=function(b){return typeof b==='number'&&isNaN(b)};return b},'es6','es3');$jscomp.polyfill('Number.isSafeInteger',function(a){if(a){return a}var b=function(b){return Number.isInteger(b)&&Math.abs(b)<=Number.MAX_SAFE_INTEGER};return b},'es6','es3');$jscomp.polyfill('Object.assign',function(a){if(a){return a}var b=function(e,f){for(var d=1;d<arguments.length;d++){var b=arguments[d];if(!b){continue}for(var c in b){if($jscomp.owns(b,c)){e[c]=b[c]}}}return e};return b},'es6','es3');$jscomp.polyfill('Object.entries',function(a){if(a){return a}var b=function(c){var d=[];for(var b in c){if($jscomp.owns(c,b)){d.push([b,c[b]])}}return d};return b},'es8','es3');$jscomp.polyfill('Object.getOwnPropertySymbols',function(a){if(a){return a}return function(){return []}},'es6','es5');$jscomp.polyfill('Reflect.ownKeys',function(b){if(b){return b}var a='jscomp_symbol_';function isSymbol(c){return c.substring(0,a.length)==a}var c=function(e){var f=[];var c=Object.getOwnPropertyNames(e);var d=Object.getOwnPropertySymbols(e);for(var a=0;a<c.length;a++){(isSymbol(c[a])?d:f).push(c[a])}return f.concat(d)};return c},'es6','es5');$jscomp.polyfill('Object.getOwnPropertyDescriptors',function(a){if(a){return a}var b=function(e){var d={};var c=Reflect.ownKeys(e);for(var b=0;b<c.length;b++){d[c[b]]=Object.getOwnPropertyDescriptor(e,c[b])}return d};return b},'es8','es5');$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0};var a={};try{a.__proto__=b;return a.a}catch(c){}return !1};$jscomp.setPrototypeOf=typeof Object.setPrototypeOf=='function'?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b){throw new TypeError(a+' is not extensible')}return a}:null;$jscomp.polyfill('Object.setPrototypeOf',function(a){return a||$jscomp.setPrototypeOf},'es6','es5');$jscomp.polyfill('Object.values',function(a){if(a){return a}var b=function(b){var c=[];for(var d in b){if($jscomp.owns(b,d)){c.push(b[d])}}return c};return b},'es8','es3');$jscomp.polyfill('Reflect.apply',function(a){if(a){return a}var c=Function.prototype.apply;var b=function(e,d,b){return c.call(e,d,b)};return b},'es6','es3');$jscomp.objectCreate=$jscomp.ASSUME_ES5||typeof Object.create=='function'?Object.create:function(b){var a=function(){};a.prototype=b;return new a()};$jscomp.construct=function(){function reflectConstructWorks(){function Base(){}function Derived(){}new Base();Reflect.construct(Base,[],Derived);return new Base() instanceof Base}if(typeof Reflect!='undefined'&&Reflect.construct){if(reflectConstructWorks()){return Reflect.construct}var b=Reflect.construct;var a=function(e,d,a){var c=b(e,d);if(a){Reflect.setPrototypeOf(c,a.prototype)}return c};return a}function construct(b,d,a){if(a===undefined){a=b}var f=a.prototype||Object.prototype;var c=$jscomp.objectCreate(f);var e=Function.prototype.apply;var g=e.call(b,c,d);return g||c}return construct}();$jscomp.polyfill('Reflect.construct',function(a){return $jscomp.construct},'es6','es3');$jscomp.polyfill('Reflect.defineProperty',function(a){if(a){return a}var b=function(e,d,c){try{Object.defineProperty(e,d,c);var b=Object.getOwnPropertyDescriptor(e,d);if(!b){return !1}return b.configurable===(c.configurable||!1)&&b.enumerable===(c.enumerable||!1)&&('value' in b?b.value===c.value&&b.writable===(c.writable||!1):b.get===c.get&&b.set===c.set)}catch(f){return !1}};return b},'es6','es5');$jscomp.polyfill('Reflect.deleteProperty',function(a){if(a){return a}var b=function(c,b){if(!$jscomp.owns(c,b)){return !0}try{return delete c[b]}catch(d){return !1}};return b},'es6','es3');$jscomp.polyfill('Reflect.getOwnPropertyDescriptor',function(a){return a||Object.getOwnPropertyDescriptor},'es6','es5');$jscomp.polyfill('Reflect.getPrototypeOf',function(a){return a||Object.getPrototypeOf},'es6','es5');$jscomp.findDescriptor=function(d,c){var a=d;while(a){var b=Reflect.getOwnPropertyDescriptor(a,c);if(b){return b}a=Reflect.getPrototypeOf(a)}return undefined};$jscomp.polyfill('Reflect.get',function(a){if(a){return a}var b=function(d,c,e){if(arguments.length<=2){return d[c]}var b=$jscomp.findDescriptor(d,c);if(b){return b.get?b.get.call(e):b.value}return undefined};return b},'es6','es5');$jscomp.polyfill('Reflect.has',function(a){if(a){return a}var b=function(c,b){return b in c};return b},'es6','es3');$jscomp.polyfill('Reflect.isExtensible',function(a){if(a){return a}if($jscomp.ASSUME_ES5||typeof Object.isExtensible=='function'){return Object.isExtensible}return function(){return !0}},'es6','es3');$jscomp.polyfill('Reflect.preventExtensions',function(a){if(a){return a}if(!($jscomp.ASSUME_ES5||typeof Object.preventExtensions=='function')){return function(){return !1}}var b=function(b){Object.preventExtensions(b);return !Object.isExtensible(b)};return b},'es6','es3');$jscomp.polyfill('Reflect.set',function(a){if(a){return a}var b=function(b,d,e,f){var c=$jscomp.findDescriptor(b,d);if(!c){if(Reflect.isExtensible(b)){b[d]=e;return !0}return !1}if(c.set){c.set.call(arguments.length>3?f:b,e);return !0}else {if(c.writable&&!Object.isFrozen(b)){b[d]=e;return !0}}return !1};return b},'es6','es5');$jscomp.polyfill('Reflect.setPrototypeOf',function(a){if(a){return a}else {if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;var c=function(c,d){try{b(c,d);return !0}catch(e){return !1}};return c}else {return null}}},'es6','es5');$jscomp.polyfill('Set',function(b){var c=!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!b||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=b;var d=Object.seal({x:4});var c=new b($jscomp.makeIterator([d]));if(!c.has(d)||c.size!=1||c.add(d)!=c||c.size!=1||c.add({x:4})!=c||c.size!=2){return !1}var e=c.entries();var a=e.next();if(a.done||a.value[0]!=d||a.value[1]!=d){return !1}a=e.next();if(a.done||a.value[0]==d||a.value[0].x!=4||a.value[1]!=a.value[0]){return !1}return e.next().done}catch(f){return !1}}();if(c){return b}$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map();if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}this.size=this.map_.size};a.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype['delete']=function(c){var a=this.map_['delete'](c);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};a.prototype.keys=a.prototype.values;a.prototype[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(c,a){var d=this;this.map_.forEach(function(e){return c.call(a,e,e,d)})};return a},'es6','es3');$jscomp.checkStringArgs=function(a,c,b){if(a==null){throw new TypeError("The 'this' value for String.prototype."+b+' must not be null or undefined')}if(c instanceof RegExp){throw new TypeError('First argument to String.prototype.'+b+' must not be a regular expression')}return a+''};$jscomp.polyfill('String.prototype.codePointAt',function(a){if(a){return a}var b=function(b){var e=$jscomp.checkStringArgs(this,null,'codePointAt');var f=e.length;b=Number(b)||0;if(!(b>=0&&b<f)){return void 0}b=b|0;var c=e.charCodeAt(b);if(c<55296||c>56319||b+1===f){return c}var d=e.charCodeAt(b+1);if(d<56320||d>57343){return c}return (c-55296)*1024+d+9216};return b},'es6','es3');$jscomp.polyfill('String.prototype.endsWith',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'endsWith');b=b+'';if(c===void 0){c=d.length}var f=Math.max(0,Math.min(c|0,d.length));var e=b.length;while(e>0&&f>0){if(d[--f]!=b[--e]){return !1}}return e<=0};return b},'es6','es3');$jscomp.polyfill('String.fromCodePoint',function(a){if(a){return a}var b=function(e){var c='';for(var d=0;d<arguments.length;d++){var b=Number(arguments[d]);if(b<0||b>1114111||b!==Math.floor(b)){throw new RangeError('invalid_code_point '+b)}if(b<=65535){c+=String.fromCharCode(b)}else {b-=65536;c+=String.fromCharCode(b>>>10&1023|55296);c+=String.fromCharCode(b&1023|56320)}}return c};return b},'es6','es3');$jscomp.polyfill('String.prototype.includes',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'includes');return d.indexOf(b,c||0)!==-1};return b},'es6','es3');$jscomp.polyfill('String.prototype.repeat',function(a){if(a){return a}var b=function(b){var c=$jscomp.checkStringArgs(this,null,'repeat');if(b<0||b>1342177279){throw new RangeError('Invalid count value')}b=b|0;var d='';while(b){if(b&1){d+=c}if(b>>>=1){c+=c}}return d};return b},'es6','es3');$jscomp.stringPadding=function(c,a){var b=c!==undefined?String(c):' ';if(!(a>0)||!b){return ''}var d=Math.ceil(a/b.length);return b.repeat(d).substring(0,a)};$jscomp.polyfill('String.prototype.padEnd',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return b+$jscomp.stringPadding(c,e)};return b},'es8','es3');$jscomp.polyfill('String.prototype.padStart',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return $jscomp.stringPadding(c,e)+b};return b},'es8','es3');$jscomp.polyfill('String.prototype.startsWith',function(a){if(a){return a}var b=function(b,g){var c=$jscomp.checkStringArgs(this,b,'startsWith');b=b+'';var h=c.length;var e=b.length;var f=Math.max(0,Math.min(g|0,c.length));var d=0;while(d<e&&f<h){if(c[f++]!=b[d++]){return !1}}return d>=e};return b},'es6','es3');$jscomp.arrayFromIterator=function(c){var b;var a=[];while(!(b=c.next()).done){a.push(b.value)}return a};$jscomp.arrayFromIterable=function(a){if(a instanceof Array){return a}else {return $jscomp.arrayFromIterator($jscomp.makeIterator(a))}};$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var e=$jscomp.setPrototypeOf;e(a,b)}else {for(var c in b){if(c=='prototype'){continue}if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);if(d){Object.defineProperty(a,c,d)}}else {a[c]=b[c]}}}a.superClass_=b.prototype};$jscomp.polyfill('WeakSet',function(b){function isConformant(){if(!b||!Object.seal){return !1}try{var c=Object.seal({});var d=Object.seal({});var a=new b([c]);if(!a.has(c)||a.has(d)){return !1}a['delete'](c);a.add(d);return !a.has(c)&&a.has(d)}catch(e){return !1}}if(isConformant()){return b}var a=function(a){this.map_=new WeakMap();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}};a.prototype.add=function(a){this.map_.set(a,!0);return this};a.prototype.has=function(a){return this.map_.has(a)};a.prototype['delete']=function(a){return this.map_['delete'](a)};return a},'es6','es3');try{if(Array.prototype.values.toString().indexOf('[native code]')==-1){delete Array.prototype.values}}catch(a){}Ext.define('ABP.Widget',{override:'Ext.Widget',constructor:function(){var b=this;var a=['onClick','onChange'];this.callParent(arguments);if(Ext.isFunction(this.toggleCls)&&a.some(function(a){return this[a]}.bind(b))||Boolean(this.automationCls)){this.toggleCls(ABP.util.Common.getAutomationClass(this),!0)}}});Ext.define('ABP.Component',{override:'Ext.Component',constructor:function(){var b=this;var a=['onClick','onChange'];this.callParent(arguments);if(Ext.isFunction(this.toggleCls)&&a.some(function(a){return this[a]||Boolean(this.handler)}.bind(b))||Boolean(this.automationCls)){this.toggleCls(ABP.util.Common.getAutomationClass(this),!0)}},setAriaLabel:function(b){var a=this;if(a.rendered){var c=a.el.dom;if(b){c.setAttribute('aria-label',b)}else {c.removeAttribute('aria-label')}if(a.hideLabel&&a.inputEl){a.inputEl.dom.setAttribute('aria-label',b)}}}});Ext.define('ABP.SenchaTextOverrides.data.validator.Bound',{override:'Ext.data.validator.Bound',getEmptyMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_bound_emptyMessage')},getMinOnlyMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_bound_minOnlyMessage')},getMaxOnlyMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_bound_maxOnlyMessage')},getBothMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_bound_bothMessage')}});Ext.define('ABP.SenchaTextOverrides.data.validator.Email',{override:'Ext.data.validator.Email',getMessage:function(a){return ABP.util.Common.geti18nString('s_dataValidator_email_message')}});Ext.define('ABP.SenchaTextOverrides.data.validator.Exclusion',{override:'Ext.data.validator.Exclusion',getMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_exclusion_message')}});Ext.define('ABP.SenchaTextOverrides.data.validator.IPAddress',{override:'Ext.data.validator.IPAddress',getMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_ipaddress_message')}});Ext.define('ABP.SenchaTextOverrides.data.validator.Format',{override:'Ext.data.validator.Format',getMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_format_message')}});Ext.define('ABP.SenchaTextOverrides.data.validator.Number',{override:'Ext.data.validator.Number',getMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_number_message')}});Ext.define('ABP.SenchaTextOverrides.data.validator.Inclusion',{override:'Ext.data.validator.Inclusion',getMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_inclusion_message')}});Ext.define('ABP.SenchaTextOverrides.data.validator.Length',{override:'Ext.data.validator.Length',getMinOnlyMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_length_minOnlyMessage')},getMaxOnlyMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_length_maxOnlyMessage')},getBothMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_length_bothMessage')}});Ext.define('ABP.SenchaTextOverrides.data.validator.Presence',{override:'Ext.data.validator.Presence',getMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_presence_message')}});Ext.define('ABP.SenchaTextOverrides.data.validator.Range',{override:'Ext.data.validator.Range',getMinOnlyMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_range_minOnlyMessage')},getMaxOnlyMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_range_maxOnlyMessage')},getBothMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_range_bothMessage')},getNanMessage:function(){return ABP.util.Common.geti18nString('s_dataValidator_range_nanMessage')}});Ext.define('ABP.SenchaTextOverrides.grid.plugin.DragDrop',{override:'Ext.grid.plugin.DragDrop',bind:{dragText:'{i18n.s_grid_plugin_dragText}'},setDragText:function(a){this.dragText=a}});Ext.define('ABP.SenchaTextOverrides.view.AbstractView',{override:'Ext.view.AbstractView',bind:{loadingText:'{i18n.s_abstractView_loading}'},setLoadingText:function(a){this.loadingText=a}});Ext.define('ABP.SenchaTextOverrides.picker.Date',{override:'Ext.picker.Date',beforeRender:function(){var a=this,b=Ext.String.htmlEncode,d=new Array(a.numDays),c=Ext.Date.format(new Date(),a.format);if(a.padding&&!a.width){a.cacheWidth()}a.todayText=a.isDateTimePicker?ABP.util.Common.geti18nString('s_picker_date_nowText'):ABP.util.Common.geti18nString('s_picker_date_todayText');a.minText=ABP.util.Common.geti18nString('s_picker_date_minText');a.maxText=ABP.util.Common.geti18nString('s_picker_date_maxText');a.disabledDaysText=ABP.util.Common.geti18nString('s_picker_date_disabledDaysText');a.disabledDatesText=ABP.util.Common.geti18nString('s_picker_date_disabledDatesText');a.nextText=ABP.util.Common.geti18nString('s_picker_date_nextText');a.prevText=ABP.util.Common.geti18nString('s_picker_date_prevText');a.monthYearText=ABP.util.Common.geti18nString('s_picker_date_monthYearText');a.todayTip=ABP.util.Common.geti18nString('s_picker_date_todayTip');a.monthBtn=new Ext.button.Split({ownerCt:a,ownerLayout:a.getComponentLayout(),text:'',tooltip:a.monthYearText,tabIndex:-1,ariaRole:'presentation',listeners:{click:a.doShowMonthPicker,arrowclick:a.doShowMonthPicker,scope:a}});if(a.showToday){a.todayBtn=new Ext.button.Button({ui:a.footerButtonUI,ownerCt:a,ownerLayout:a.getComponentLayout(),text:Ext.String.format(a.todayText,c),tooltip:Ext.String.format(a.todayTip,c),tooltipType:'title',tabIndex:-1,ariaRole:'presentation',handler:a.selectToday,scope:a})}a.callParent();Ext.applyIf(a,{renderData:{}});Ext.apply(a.renderData,{dayNames:a.dayNames,showToday:a.showToday,prevText:b(a.prevText),nextText:b(a.nextText),todayText:b(a.todayText),ariaMinText:b(a.ariaMinText),ariaMaxText:b(a.ariaMaxText),ariaDisabledDaysText:b(a.ariaDisabledDaysText),ariaDisabledDatesText:b(a.ariaDisabledDatesText),days:d});a.protoEl.unselectable()}});Ext.define('ABP.SenchaTextOverrides.picker.Month',{override:'Ext.picker.Month',beforeRender:function(){var a=this,b=0,f=[],c=Ext.Date.getShortMonthName,d=a.monthOffset,e=a.monthMargin,g='';a.okBtn.text=ABP.util.Common.geti18nString('s_picker_month_okText');a.cancelBtn.text=ABP.util.Common.geti18nString('s_picker_month_cancelText');if(a.padding&&!a.width){a.cacheWidth()}a.callParent();for(;b<d;++b){f.push(c(b),c(b+d))}if(Ext.isDefined(e)){g='margin: 0 '+e+'px;'}Ext.apply(a.renderData,{months:f,years:a.getYears(),showButtons:a.showButtons,monthStyle:g})}});Ext.define('ABP.SenchaTextOverrides.toolbar.Paging',{override:'Ext.PagingToolbar',bind:{afterPageText:'{i18n.s_toolbar_paging_afterPageText}',displayMsg:'{i18n.s_toolbar_paging_displayMsg}',emptyMsg:'{i18n.s_toolbar_paging_emptyMsg}'},setAfterPageText:function(a){this.afterPageText=a},setDisplayMsg:function(a){this.displayMsg=a},setEmptyMsg:function(a){this.emptyMsg=a},getPagingItems:function(){var a=this,b={scope:a,blur:a.onPagingBlur};b[Ext.supports.SpecialKeyDownRepeat?'keydown':'keypress']=a.onPagingKeyDown;return [{itemId:'first',tooltip:ABP.util.Common.geti18nString('s_toolbar_paging_firstText'),overflowText:ABP.util.Common.geti18nString('s_toolbar_paging_firstText'),iconCls:Ext.baseCSSPrefix+'tbar-page-first',disabled:!0,handler:a.moveFirst,scope:a},{itemId:'prev',tooltip:ABP.util.Common.geti18nString('s_toolbar_paging_prevText'),overflowText:ABP.util.Common.geti18nString('s_toolbar_paging_prevText'),iconCls:Ext.baseCSSPrefix+'tbar-page-prev',disabled:!0,handler:a.movePrevious,scope:a},'-',ABP.util.Common.geti18nString('s_toolbar_paging_beforePageText'),{xtype:'numberfield',itemId:'inputItem',name:'inputItem',cls:Ext.baseCSSPrefix+'tbar-page-number',allowDecimals:!1,minValue:1,hideTrigger:!0,enableKeyEvents:!0,keyNavEnabled:!1,selectOnFocus:!0,submitValue:!1,isFormField:!1,width:a.inputItemWidth,margin:'-1 2 3 2',listeners:b},{xtype:'tbtext',itemId:'afterTextItem',html:Ext.String.format(a.afterPageText,1)},'-',{itemId:'next',tooltip:ABP.util.Common.geti18nString('s_toolbar_paging_nextText'),overflowText:ABP.util.Common.geti18nString('s_toolbar_paging_nextText'),iconCls:Ext.baseCSSPrefix+'tbar-page-next',disabled:!0,handler:a.moveNext,scope:a},{itemId:'last',tooltip:ABP.util.Common.geti18nString('s_toolbar_paging_lastText'),overflowText:ABP.util.Common.geti18nString('s_toolbar_paging_lastText'),iconCls:Ext.baseCSSPrefix+'tbar-page-last',disabled:!0,handler:a.moveLast,scope:a},'-',{itemId:'refresh',tooltip:ABP.util.Common.geti18nString('s_toolbar_paging_refreshText'),overflowText:ABP.util.Common.geti18nString('s_toolbar_paging_refreshText'),iconCls:Ext.baseCSSPrefix+'tbar-loading',disabled:a.store.isLoading(),handler:a.doRefresh,scope:a}]}});Ext.define('ABP.SenchaTextOverrides.form.Basic',{override:'Ext.form.Basic',bind:{waitTitle:'{i18n.s_form_basic_waitTitle}'},setWaitTitle:function(a){this.waitTitle=a}});Ext.define('ABP.SenchaTextOverrides.form.field.Base',{override:'Ext.form.field.Base',bind:{invalidText:'{i18n.s_form_field_base_invalidText}'},setInvalidText:function(a){this.invalidText=a}});Ext.define('ABP.SenchaTextOverrides.form.field.Text',{override:'Ext.form.field.Text',bind:{minLengthText:'{i18n.s_field_text_minLengthText}',maxLengthText:'{i18n.s_field_text_maxLengthText}',blankText:'{i18n.s_field_text_blankText}',regexText:'{i18n.s_field_text_regexText}'},setMinLengthText:function(a){this.minLengthText=a},setMaxLengthText:function(a){this.maxLengthText=a},setBlankText:function(a){this.blankText=a},setRegexText:function(a){this.regexText=a}});Ext.define('ABP.SenchaTextOverrides.form.field.Number',{override:'Ext.form.field.Number',bind:{minText:'{i18n.s_field_number_minText}',maxText:'{i18n.s_field_number_maxText}',nanText:'{i18n.s_field_number_nanText}'},setMinText:function(a){this.minText=a},setMaxText:function(a){this.maxText=a},setNanText:function(a){this.nanText=a}});Ext.define('ABP.SenchaTextOverrides.form.field.Date',{override:'Ext.form.field.Date',bind:{disabledDaysText:'{i18n.s_field_date_disabledDaysText}',disabledDatesText:'{i18n.s_field_date_disabledDatesText}',minText:'{i18n.s_field_date_minText}',maxText:'{i18n.s_field_date_maxText}',invalidText:'{i18n.s_field_date_invalidText}'},setDisabledDaysText:function(a){this.disabledDaysText=a},setDisabledDatesText:function(a){this.disabledDatesText=a},setMinText:function(a){this.minText=a},setMaxText:function(a){this.maxText=a},setInvalidText:function(a){this.invalidText=a}});Ext.define('ABP.SenchaTextOverrides.grid.header.Container',{override:'Ext.grid.header.Container',bind:{sortAscText:'{i18n.s_grid_header_sortAscText}',sortDescText:'{i18n.s_grid_header_sortDescText}',lockText:'{i18n.s_grid_header_lockText}',unlockText:'{i18n.s_grid_header_unlockText}',columnsText:'{i18n.s_grid_header_columnsText}'},setSortAscText:function(a){this.sortAscText=a},setSortDescText:function(a){this.sortDescText=a},setLockText:function(a){this.lockText=a},setUnlockText:function(a){this.unlockText=a},setColumnsText:function(a){this.columnsText=a}});Ext.define('ABP.SenchaTextOverrides.grid.locking.Lockable',{override:'Ext.grid.locking.Lockable',getMenuItems:function(d,b){var a=this,f=ABP.util.Common.geti18nString('s_grid_header_unlockText'),h=ABP.util.Common.geti18nString('s_grid_header_lockText'),g=Ext.baseCSSPrefix+'hmenu-unlock',i=Ext.baseCSSPrefix+'hmenu-lock',c=a.onUnlockMenuClick.bind(a),e=a.onLockMenuClick.bind(a);return function(){var a=d.call(this);a.push('-',{itemId:'unlockItem',iconCls:g,text:f,handler:c,disabled:!b});a.push({itemId:'lockItem',iconCls:i,text:h,handler:e,disabled:b});return a}}});Ext.define('ABP.SenchaTextOverrides.grid.GroupingFeature',{override:'Ext.grid.feature.Grouping',getMenuItems:function(){var a=this,e=ABP.util.Common.geti18nString('s_grid_groupingFeature_groupByText'),f=a.disabled||!a.getGroupField(),c=ABP.util.Common.geti18nString('s_grid_groupingFeature_showGroupsText'),b=a.enableNoGroups,d=a.view.headerCt.getMenuItems;return function(){var g=d.call(this);g.push('-',{iconCls:Ext.baseCSSPrefix+'group-by-icon',itemId:'groupMenuItem',text:e,handler:a.onGroupMenuItemClick,scope:a});if(b){g.push({itemId:'groupToggleMenuItem',text:c,checked:!f,checkHandler:a.onGroupToggleMenuItemClick,scope:a})}return g}}});Ext.define('ABP.SenchaTextOverrides.grid.PropertyColumnModel',{override:'Ext.grid.PropertyColumnModel',bind:{nameText:'{i18n.s_grid_propertyColumnModel_nameText}',valueText:'{i18n.s_grid_propertyColumnModel_valueText}',trueText:'{i18n.s_grid_propertyColumnModel_trueText}',falseText:'{i18n.s_grid_propertyColumnModel_falseText}'},setNameText:function(a){this.nameText=a},setValueText:function(a){this.valueText=a},setTrueText:function(a){this.trueText=a},setFalseText:function(a){this.falseText=a}});Ext.define('ABP.SenchaTextOverrides.grid.BooleanColumn',{override:'Ext.grid.BooleanColumn',bind:{trueText:'{i18n.s_grid_booleanColumn_trueText}',falseText:'{i18n.s_grid_booleanColumn_falseText}',undefinedText:'{i18n.s_grid_booleanColumn_undefinedText}'},setTrueText:function(a){this.trueText=a},setFalseText:function(a){this.falseText=a},setUndefinedText:function(a){this.undefinedText=a}});Ext.define('ABP.SenchaTextOverrides.form.field.Time',{override:'Ext.form.field.Time',bind:{minText:'{i18n.s_field_time_minText}',maxText:'{i18n.s_field_time_maxText}',invalidText:'{i18n.s_field_time_invalidText}'},setMinText:function(a){this.minText=a},setMaxText:function(a){this.maxText=a},setInvalidText:function(a){this.invalidText=a}});Ext.define('ABP.SenchaTextOverrides.form.CheckboxGroup',{override:'Ext.form.CheckboxGroup',bind:{blankText:'{i18n.s_field_checkboxGroup_blankText}'},setBlankText:function(a){this.blankText=a}});Ext.define('ABP.SenchaTextOverrides.form.RadioGroup',{override:'Ext.form.RadioGroup',bind:{blankText:'{i18n.s_field_radioGroup_blankText}'},setBlankText:function(a){this.blankText=a}});Ext.define('ABP.SenchaTextOverrides.grid.filters.Filters',{override:'Ext.grid.filters.Filters',createMenuItem:function(b,d){var a=this,c;if(b.items.length){a.sep=b.add('-')}c=b.add({checked:!1,itemId:'filters',text:ABP.util.Common.geti18nString('s_grid_filters_menuFilterText'),listeners:{scope:a,checkchange:a.onCheckChange}});return a.filterMenuItem[d]=c}});Ext.define('ABP.SenchaTextOverrides.grid.filters.filter.Boolean',{override:'Ext.grid.filters.filter.Boolean',createMenu:function(e){var a=this,d=Ext.id(),c={scope:a,click:a.onClick},b=a.getItemDefaults();a.callSuper(arguments);a.menu.add([Ext.apply({text:ABP.util.Common.geti18nString('s_grid_filters_boolean_yesText'),filterKey:1,group:d,checked:!!a.defaultValue,hideOnClick:!1,listeners:c},b),Ext.apply({text:ABP.util.Common.geti18nString('s_grid_filters_boolean_noText'),filterKey:0,group:d,checked:!a.defaultValue&&a.defaultValue!==null,hideOnClick:!1,listeners:c},b)])}});Ext.define('ABP.SenchaTextOverrides.grid.filters.filter.List',{override:'Ext.grid.filters.filter.List',bind:{loadingText:'{i18n.s_grid_filters_list_loadingText}'},setLoadingText:function(a){this.loadingText=a}});Ext.define('ABP.SenchaTextOverrides.grid.filters.filter.Number',{override:'Ext.grid.filters.filter.Number',createMenu:function(){var a=this,j={scope:a,keyup:a.onValueChange,spin:{fn:a.onInputSpin,buffer:200},el:{click:a.stopFn}},g=a.getItemDefaults(),h=a.menuItems,k=a.getFields(),f,e,i,c,d,b;a.callSuper();a.fields={};for(e=0,i=h.length;e<i;e++){c=h[e];if(c!=='-'){f=k[c];b={labelClsExtra:Ext.baseCSSPrefix+'grid-filters-icon '+f.iconCls};if(g){Ext.merge(b,g)}Ext.merge(b,f);b.emptyText=b.emptyText||ABP.util.Common.geti18nString('s_grid_filters_number_emptyText');delete b.iconCls;a.fields[c]=d=a.menu.add(b);d.filter=a.filter[c];d.filterKey=c;d.on(j)}else {a.menu.add(c)}}}});Ext.define('ABP.SenchaTextOverrides.grid.filters.filter.String',{override:'Ext.grid.filters.filter.String',createMenu:function(){var b=this,a;b.callSuper();a=Ext.apply({},b.getItemDefaults());if(a.iconCls&&!('labelClsExtra' in a)){a.labelClsExtra=Ext.baseCSSPrefix+'grid-filters-icon '+a.iconCls}delete a.iconCls;a.emptyText=a.emptyText||ABP.util.Common.geti18nString('s_grid_filters_string_emptyText');b.inputItem=b.menu.add(a);b.inputItem.on({scope:b,keyup:b.onValueChange,el:{click:function(a){a.stopPropagation()}}})}});Ext.define('ABP.SenchaTextOverrides.view.MultiSelectorSearch',{override:'Ext.view.MultiSelectorSearch',bind:{searchText:'{i18n.s_multiSelectorSearch_searchText}'},setSearchText:function(a){this.searchText=a}});Ext.define('ABP.SenchaTextOverrides.view.MultiSelector',{override:'Ext.view.MultiSelector',bind:{emptyText:'{i18n.s_multiSelector_emptyText}',removeRowTip:'{i18n.s_multiSelector_removeRowTip}',addToolText:'{i18n.s_multiSelector_addToolText}'},setEmptyText:function(a){this.emptyText=a},setRemoveRowTip:function(a){this.removeRowTip=a},setAddToolText:function(a){this.addToolText=a}});Ext.define('ABP.SenchaTextOverrides.tab.Tab',{override:'Ext.tab.Tab',bind:{closeText:'{i18n.s_tab_closeText}'},setCloseText:function(a){this.closeText=a}});Ext.define('ABP.Container',{override:'Ext.Container'});Ext.define('ABP.overrides.loadMask.LoadMask',{override:'Ext.LoadMask',type:3,msg:'',renderTpl:['<div id="{id}-msgWrapEl" data-ref="msgWrapEl" class="{[values.$comp.msgWrapCls]}" role="presentation">','<div id="{id}-msgEl" data-ref="msgEl" class="{[values.$comp.msgCls]} ',Ext.baseCSSPrefix,'mask-msg-inner {childElCls}" role="presentation">','<tpl if="[values.$comp.extraMask]">','<div id="{id}-extraEl" data-ref="extraEl" class="'+Ext.baseCSSPrefix+'mask-extra" role="presentation">','{[values.$comp.extraMask]}','</div>','</tpl>','<tpl if="[values.$comp.msg]">','<div id="{id}-msgTextEl" data-ref="msgTextEl" class="'+Ext.baseCSSPrefix+'mask-msg-text {childElCls}" role="presentation">','{msg}','</div>','</tpl>','</div>','</div>'],constructor:function(a){a=a||{};var b='';a.type=a.type||this.type;a.cls=a.cls||'';a.cls+=' x-mask abp-loadmask';if(this.lookupViewModel()){b=this.lookupViewModel().data.i18n.loading_mask_message}this.msg=Ext.String.htmlEncode(a.msg)||Ext.String.htmlEncode(b);switch(a.type){case 1:a.cls+=' abp-spinner';a.extraMask='<div class="abp-spinner-el"></div>';break;case 2:a.cls+=' loading-circles';a.extraMask='<div class="circle"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>';break;case 3:a.cls+=' loading-bars';a.extraMask='<div class="bars"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div> </div>';break;default:break;}a.listeners=a.listeners||{};this.callParent([a])}});Ext.define('ABP.form.field.Base',{override:'Ext.form.field.Base',getSubTplData:function(d){var b=this,a=b.callParent(arguments),c=ABP.util.Common.getAutomationClass(b);Ext.apply(a,{anchorName:c});return a}});Ext.define('ABP.form.field.Text',{override:'Ext.form.field.Text',setVtypeText:function(a){if(a!==undefined){this.vtypeText=a}}});Ext.define('ABP.form.field.Checkbox',{override:'Ext.form.field.Checkbox',overCls:Ext.baseCSSPrefix+'check-over',getSubTplData:function(d){var b=this,a=b.callParent(arguments),c=a.type==='checkbox'?ABP.util.Common.getAutomationClass(b)+'-check':ABP.util.Common.getAutomationClass(b)+'-'+b.inputValue;a['checkboxCls']=a['checkboxCls']+' '+c;return a}});Ext.define('ABP.form.field.Radio',{override:'Ext.form.field.Radio',overCls:Ext.baseCSSPrefix+'radio-over'});Ext.define('ABP.overrides.form.trigger.Spinner',{override:'Ext.form.trigger.Spinner',bodyTpl:'<tpl if="vertical">'+'<div class="{spinnerCls} {spinnerCls}-{ui} {spinnerUpCls} {spinnerUpCls}-{ui}'+' {childElCls} {upDisabledCls} {spinnerUpAutoCls}"></div>'+'</tpl>'+'<div class="{spinnerCls} {spinnerCls}-{ui} {spinnerDownCls} {spinnerDownCls}-{ui}'+' {childElCls} {downDisabledCls} {spinnerDownAutoCls}"></div>'+'<tpl if="!vertical">'+'<div class="{spinnerCls} {spinnerCls}-{ui} {spinnerUpCls} {spinnerUpCls}-{ui}'+' {childElCls} {upDisabledCls}"></div>'+'</tpl>',getBodyRenderData:function(){var a=this;return {vertical:a.vertical,upDisabledCls:a.upEnabled?'':a.spinnerUpCls+'-disabled',downDisabledCls:a.downEnabled?'':a.spinnerDownCls+'-disabled',spinnerCls:a.spinnerCls,spinnerUpCls:a.spinnerUpCls,spinnerDownCls:a.spinnerDownCls,spinnerUpAutoCls:ABP.util.Common.getAutomationClass(a)+'-spinner-up',spinnerDownAutoCls:ABP.util.Common.getAutomationClass(a)+'-spinner-down'}}});Ext.define('ABP.view.BoundList',{override:'Ext.view.BoundList',generateTpl:function(){var a=this,b=a.displayField,d=a.pickerField?a.pickerField.valueField:b,c=ABP.util.Common.getAutomationClass(a.pickerField||a)+'-picker';a.toggleCls(c,!0);a.tpl=new Ext.XTemplate('<tpl for=".">','<li role="option" unselectable="on" class="'+a.itemCls+' ',c+'-item-'+'{'+d+':htmlEncode}','">'+a.getInnerTpl(b),'&nbsp;','</li>','</tpl>')},getInnerTpl:function(a){return '{'+a+':htmlEncode}'}});Ext.define('ABP.view.Table',{override:'Ext.view.Table',renderRow:function(h,f,g){var a=this,b=a.grid,c=a.itemCls;var d=b.automationCls||(b.automationCls=ABP.util.Common.getAutomationClass(b));a.itemCls=c+' '+d+'-row-'+f;var e=this.callParent(arguments);a.itemCls=c;if(g){return e}}});Ext.define('ABP.grid.column.Column',{override:'Ext.grid.column.Column',constructor:function(a){a=a||{};a.name=a.name||a.dataIndex;this.callParent([a]);this.tdCls=this.tdCls+' '+ABP.util.Common.getAutomationClass(this)}});Ext.define('ABP.view.overrides.PackageEntryOverride',{override:'Ext.package.Entry',count:0,loaded:!1,constructor:function(a){var b=this;b.packageName=a;if(ABP.util.Config.getPackageURL()!==null){b.jsUrl=ABP.util.Config.getPackageURL()+'/classic/'+a+'/'+a+'.js';b.cssUrl=ABP.util.Config.getPackageURL()+'/classic/'+a+'/'+a+'.css'}else {b.jsUrl=Ext.getResourcePath(a+'.js',null,a);b.cssUrl=Ext.getResourcePath(a+'.css',null,a)}b.promise=new Ext.Promise(function(c,d){b.resolveFn=c;b.rejectFn=d})},getRequires:function(){var c=this,f=c.metadata,a=c._requires,b,d;if(!a){a=[];if(f&&(b=f.requires)&&b.length){for(var e=0;e<b.length;e++){d=b[e];if(d!=c.packageName){a.push(d)}}}c._requires=a}return a},beginLoad:function(){var a=this;if(!a.loaded){a.block();a.loadStyle();a.loadScript();a.unblock()}},loadStyle:function(){var a=this.metadata,b=a&&a.required,c=a&&a.css;if(c!==!1&&b!==!0){this.load(this.cssUrl)}},loadScript:function(){var a=this.metadata,c=a&&a.files,e=Ext.manifest,d=e&&e.loadOrder,f=[],b;if(c&&d){for(b=0;b<c.length;b++){f.push(d[c[b]].path)}this.load(f)}else {if(a&&!a.included){this.load(this.jsUrl)}}},load:function(b){var a=this;a.block();Ext.Boot.load({url:b,success:function(){a.unblock()},failure:function(){if(Ext.String.endsWith(b,'.css')){a.unblock()}else {if(!a.error){a.error=new Error('Failed to load "'+b+'"');a.error.url=b;a.unblock()}}}})},block:function(){this.count++},_wait:function(b){var a=this;a.block();Ext.require(b,function(){a.unblock()})},_getPendingClasses:function(){var b=Ext.ClassManager,c=b&&b.classState,d,a;if(b.getPendingClasses){return b.getPendingClasses()}else {if(c){d=[];for(a in c){if(a&&a!=='null'){if(c[a]<30){d.push(a)}}}return d}}},unblock:function(){var a=this;if(!a.error&&a.count>1){a.count--}else {a.count=0;var b=a._getPendingClasses();if(b&&b.length){a._wait(b)}else {a.notify()}}},notify:function(){var a=this;if(a.resolveFn){a.count=0;if(a.error){ABP.util.Logger.logError(a.error);a.rejectFn(a.error)}else {a.loaded=!0;ABP.util.Logger.logInfo('Loaded package "'+a.packageName+'"');a.resolveFn(a)}a.resolveFn=a.rejectFn=null}}});Ext.isiOS=Ext.isiOS||/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==='MacIntel'&&navigator.maxTouchPoints>1;if(Ext.isiOS){Ext.isMac=!1;Ext.platformTags.desktop=!1}Ext.define('ABP.controllers.base.rightPane.RightPanePanelController',{extend:'Ext.app.ViewController',listen:{controller:{'*':{rightPane_toggleTab:'handleToggleTab'}}},onToggle:function(){},createButtonMenu:function(b,a){a=this.configureButtonMenuLayout(a);return Ext.create('Ext.menu.Menu',{xtype:'menu',floated:!1,floating:!1,cls:'settings-container-button-menu',layout:a,ui:'lightblue',hidden:!0,height:0,animCollapse:!0,items:b})},addMenuButton:function(b,a){if(!b||Ext.isEmpty(b)){return null}Ext.applyIf(a,{cls:'settings-container-button',automationCls:'toolusermenu-unsafe-'+a.titleKey||a.title,handler:'toggleMenuButton'});var e=this,d=e.getView(),c=e.createButtonMenu(b,a.layout);d.add({text:a.title,ariaLabel:a.title,bind:a.titleKey?{text:'{i18n.'+a.titleKey+':htmlEncode}',ariaLabel:'{i18n.'+a.titleKey+':ariaEncode}'}:{},buttonMenu:c,cls:a.cls,ui:'menuitem',uiCls:'light',textAlign:'left',automationCls:a.automationCls,handler:a.handler,listeners:a.listeners,keyMap:a.keyMap||null,iconCls:'icon-navigate-close',iconAlign:'right'});d.add(c);return c},privates:{handleToggleTab:function(b){var a=this,c=a.getView();if(b.xtype===c.xtype){a.onToggle()}},baseRightPanePanel_toggleRightPane:function(){this.fireEvent('session_toggleRightPane')},configureButtonMenuLayout:function(a){if(a==='table'){return {type:'table',columns:6}}if(a==='hbox'){return {type:'hbox',pack:'start',align:'center',wrap:!0}}return {type:'vbox',pack:'start',align:'start'}},toggleMenuButton:function(b){var e=this;var d=e.getView();var c=d.activeMenuButton;var a;if(!c&&!b){return}if(c){c.removeCls('x-btn-menu-active');a=c.buttonMenu;a.setHeight(0);a.hide();d.activeMenuButton=null;if(!b||b&&b.id===c.id){return}}a=b.buttonMenu;if(!a){return}b.addCls('x-btn-menu-active');a.show();a.setHeight('auto');d.activeMenuButton=b}}});Ext.define('ABP.data.TreeData',{xtype:'abptreedata',isData:!0,data:null,parentDataArray:null,index:null,level:null,parentId:null,constructor:function(a){this.initConfig(a);return this},getData:function(){return this.data},isLeaf:function(){return this.data?this.data.isLeaf:!1},hasChildNodes:function(){return this.data?this.data.children?!0:!1:!1},set:function(b,a){if(this.data){this.data[b]=a}},remove:function(){if(this.parentDataArray){Ext.Array.removeAt(this.parentDataArray,this.index)}}});Ext.define('ABP.events.ABPEvents',{extend:'Ext.mixin.Observable',alternateClassName:'Ext.ABPEvents',requires:['Ext.dom.Element'],observableType:'abp',singleton:!0,resizeBuffer:100,constructor:function(){var a=this;a.callParent()},fireEvent:function(a){if(typeof appInsights=='object'){appInsights.trackEvent(a,arguments)}return this.callParent(arguments)}},function(a){ABP.on=function(){return a.addListener.apply(a,arguments)};ABP.un=function(){return a.removeListener.apply(a,arguments)};ABP.fireEvent=function(){return a.fireEvent.apply(a,arguments)}});Ext.define('ABP.events.ABPEventDomain',{extend:'Ext.app.EventDomain',requires:['Ext.ABPEvents'],singleton:!0,type:'abp',constructor:function(){var a=this;a.callParent();a.monitor(Ext.ABPEvents)},listen:function(b,a){this.callParent([{global:b},a])},match:Ext.returnTrue});Ext.define('ABP.internal.util.MainMenu',{singleton:!0,copyFavorites:function(){var c=this,a=c.getFavoritesNode();if(!a){return null}var b=a.copy(undefined,undefined,!0);return b.childNodes},jsonSerializeFavorites:function(){var d=this,b=Ext.getStore('navSearch'),a=d.getFavoritesNode();if(!a){return null}if(b.lazyFill){var c=this.serializeNodeWithData(a,b);return Ext.JSON.encode(c.children)}else {return Ext.JSON.encode(a.serialize().children)}},getFavoritesNode:function(){var a=Ext.getStore('navSearch');if(!a){return null}return a.getNodeById('container_nav-favorites')},serializeNodeWithData:function(g,f,j){var e=j||new Ext.data.writer.Json({writeAllFields:!0});var i=e.getRecordData(g);var b=[];var d=g.childNodes;var h=Ext.isArray(d)?d.length:0;for(var a=0;a<h;a++){b.push(this.serializeNodeWithData(d[a],f,e))}var c=g.data.children;var h=Ext.isArray(c)?c.length:0;for(var a=0;a<h;a++){var l=Ext.Array.every(b,function(b){return !(b.id===c[a].id)});if(l){var k=f.getModel().loadData(c[a]);b.push(this.serializeNodeWithData(k,f,e))}}if(!Ext.isEmpty(b)){i.children=b}return i}});Ext.define('ABP.model.ABPLoggingModel',{extend:'Ext.data.Model',fields:['level','time','message','detail']});Ext.define('ABP.model.ApplicationServicesModel',{extend:'Ext.data.Model',fields:[{name:'services',type:'auto'}]});Ext.define('ABP.model.EnvironmentModel',{extend:'Ext.data.Model',fields:['name','id','languages']});Ext.define('ABP.model.HelpLinkModel',{extend:'Ext.data.Model',fields:['product','type','link']});Ext.define('ABP.model.HelpLinkTypeModel',{extend:'Ext.data.Model',fields:['type','text']});Ext.define('ABP.model.PreBootstrapConfigModel',{extend:'Ext.data.Model',fields:[{name:'serverUrl',type:'string'},{name:'overrideExistingServerUrl',type:'boolean'},{name:'usesRedirectForToken',type:'boolean'}]});Ext.define('ABP.model.RecentModel',{extend:'Ext.data.Model',fields:[{name:'appId',type:'string'},{name:'searchId',type:'string'},{name:'timestamp',type:'int'},{name:'count',type:'int'},{name:'text',type:'string'},{name:'hierarchy',type:'string'},{name:'instanceId',type:'string'}]});Ext.define('ABP.model.SearchModel',{extend:'Ext.data.Model',fields:[{name:'appId',type:'string'},{name:'event',type:'string'},{name:'id',type:'string'},{name:'icon',type:'string'},{name:'minLength',type:'int'},{name:'minLengthError',type:'string'},{name:'name',type:'string'},{name:'recents',type:'int',defaultValue:5},{name:'suggestionThreshold',type:'int',defaultValue:3},{name:'suggestionEvent',type:'string'}]});Ext.define('ABP.model.SearchTreeResultsModel',{extend:'Ext.data.Model',fields:['appId','event','eventArgs','text','activateApp','hierarchy','shorthand','href']});Ext.define('ABP.model.ServerUrlModel',{extend:'Ext.data.Model',fields:['url']});Ext.define('ABP.model.SettingsLanguageModel',{extend:'Ext.data.Model',fields:['Key','Value']});Ext.define('ABP.model.Suggestion',{extend:'Ext.data.Model',fields:[{name:'timestamp',type:'int'},{name:'count',type:'int'},{name:'text',type:'string'},{name:'hierarchy',type:'string'},{name:'instanceId',type:'string'},{name:'isRecent',type:'boolean'}]});Ext.define('ABP.model.WCAGRegion',{extend:'Ext.data.Model',alias:'model.wcagregion',fields:[{name:'domId',type:'string'},{name:'text',type:'string'},{name:'textKey',type:'string'},{name:'event',type:'string'},{name:'context',type:'string'}]});Ext.define('ABPCore.plugins.LoadingLine',{extend:'Ext.plugin.Abstract',alias:'plugin.loadingline',isBusy:!1,init:function(b){var a=this;a.setCmp(b);a.isBusy=a.cmp.isBusy;a.cmp.on('afterrender',a.onAfterRender,a);a.cmp.on('painted',a.onAfterRender,a);a.cmp.on('isBusy',a.onUpdateIsBusy,a);a.cmp.on('toggleIsBusy',a.onToggleIsBusy,a);a.cmp.setBusy=a.cmpSetBusy;a.cmp.hasLoadingLine=!0},destroy:function(){if(this.cmp){delete this.cmp.setBusy;delete this.cmp.hasLoadingLine;this.cmp.un('afterrender',this.onAfterRender,this);this.cmp.un('painted',this.onAfterRender,this);this.cmp.un('isBusy',this.onUpdateIsBusy,this);this.cmp.un('toggleIsBusy',this.onUpdateIsBusy,this)}},setBusy:function(a){var b=this;if(b.isBusy!=a){b.updateIsBusy(a)}},privates:{cmpSetBusy:function(a){this.fireEvent('isBusy',a)},onToggleIsBusy:function(){this.setBusy(!this.isBusy)},onUpdateIsBusy:function(a){this.setBusy(a)},onAfterRender:function(){var a=this;var b=a.getCmp();b.add(a.loadingLine=Ext.widget({xtype:'abploadingline',itemId:'loadingLine',reference:'loadingLine',floating:!0,height:2,padding:0,hidden:!a.isBusy,width:b.getWidth()}));return},updateIsBusy:function(d){var c=this,a=c.getCmp(),b=c.loadingLine;if(a.header){a=a.getHeader()}if(d){b.setWidth(a.getWidth());b.showBy(a,'bl-bl',[0,0])}else {b.setHidden(!0)}c.isBusy=d}}});Ext.define('ABP.store.ABPEnvironmentStore',{extend:'Ext.data.Store',requires:['ABP.model.EnvironmentModel'],model:'ABP.model.EnvironmentModel',storeId:'ABPEnvironmentStore'});Ext.define('ABP.store.ABPLoggingStore',{extend:'Ext.data.Store',requires:['ABP.model.ABPLoggingModel'],model:'ABP.model.ABPLoggingModel',storeId:'ABPLoggingStore',proxy:{type:'memory',reader:{type:'json'}}});Ext.define('ABP.store.ABPPreBootstrapConfigStore',{extend:'Ext.data.Store',requires:['ABP.model.PreBootstrapConfigModel','Ext.data.proxy.Rest'],model:'ABP.model.PreBootstrapConfigModel',storeId:'ABPPreBootstrapConfigStore',proxy:{type:'rest',url:Ext.getResourcePath('abp-prebootstrap-config.json','shared'),reader:{type:'json'}},autoload:!1});Ext.define('ABP.store.ABPRecentSearchStore',{extend:'Ext.data.Store',requires:['ABP.model.RecentModel'],model:'ABP.model.RecentModel',storeId:'ABPRecentSearchStore',autoLoad:!1,proxy:{type:'localstorage',id:'ABP_RecentSearches'},sorters:[{property:'timestamp',direction:'DESC'}],append:function(b,c,g,e){if(!c||c.length===0){return}var f=b.get('recents');if(f===0){return}var d=this;var a=d.lookup(b.data.appId,b.data.id,c);if(a){a.beginEdit();a.set('timestamp',Date.now());a.set('count',a.data.count+1);a.endEdit()}else {a=Ext.create('ABP.model.RecentModel');a.set('appId',b.data.appId);a.set('searchId',b.data.id);a.set('timestamp',Date.now());a.set('count',1);a.set('text',c);a.set('hierarchy',g);a.set('instanceId',e);d.add(a)}d.truncate(b);d.sync()},privates:{lookup:function(d,c,a){var b=null;a=a.toLowerCase();this.each(function(e){if(e.data.appId===d&&e.data.searchId===c&&e.data.text.toLowerCase()===a){b=e;return !1}});return b},truncate:function(a){a.data.appId,a.data.id;var d=this;var e=a.get('recents')*10;var b=[];var c=0;d.each(function(d){if(d.data.appId===a.data.appId&&d.data.searchId===a.data.id){c++}if(c>e){b.push(d)}});d.remove(b)}}});Ext.define('ABP.store.ABPServerUrlStore',{extend:'Ext.data.Store',requires:['ABP.model.ServerUrlModel','Ext.data.proxy.LocalStorage'],storeId:'ABPServerUrlStore',model:'ABP.model.ServerUrlModel',autoLoad:!0,autoSync:!0,proxy:{type:'localstorage',id:'ABP_SavedServerUrls'}});Ext.define('ABP.store.ApplicationAuthenticationStore',{extend:'Ext.data.Store',requires:['Ext.data.proxy.Rest'],storeId:'ApplicationAuthenticationStore',proxy:{type:'rest',url:Ext.getResourcePath('application.settings.json?_dc='+Date.now(),'shared'),reader:{type:'json',rootProperty:'authentication'}}});Ext.define('ABP.store.ABPApplicationServicesStore',{extend:'Ext.data.Store',requires:['ABP.model.ApplicationServicesModel','Ext.data.proxy.Rest'],model:'ABP.model.ApplicationServicesModel',storeId:'ABPApplicationServicesStore',proxy:{type:'rest',url:Ext.getResourcePath('application.settings.json','shared'),reader:{type:'json',rootProperty:'services'}},autoload:!1});Ext.define('ABP.events.ThemeEvents',{extend:'Ext.mixin.Observable',alternateClassName:'Ext.ABPThemeEvents',requires:['Ext.dom.Element'],observableType:'theme',singleton:!0,resizeBuffer:100,constructor:function(){var a=this;a.callParent()}},function(a){ABPTheme=typeof ABPTheme=='undefined'?{}:ABPTheme;ABPTheme.on=function(){return a.addListener.apply(a,arguments)};ABPTheme.un=function(){return a.removeListener.apply(a,arguments)};ABPTheme.fireEvent=function(){return a.fireEvent.apply(a,arguments)}});Ext.define('ABP.events.ThemeEventDomain',{extend:'Ext.app.EventDomain',requires:['Ext.ABPThemeEvents'],singleton:!0,type:'theme',constructor:function(){var a=this;a.callParent();a.monitor(Ext.ABPThemeEvents)},listen:function(b,a){this.callParent([{global:b},a])},match:Ext.returnTrue});Ext.define('ABP.ThemeManager',{singleton:!0,requires:['ABP.events.ThemeEventDomain'],config:{selectedTheme:Ext.theme.subThemeList[0]},applySelectedTheme:function(a){if(a&&a.themes){return a.themes}return a},updateSelectedTheme:function(a,b){ABPTheme.fireEvent('changed',a)}},function(a){ABPTheme=typeof ABPTheme=='undefined'?{}:ABPTheme;ABPTheme.setTheme=function(b){return ABP.ThemeManager.setSelectedTheme(b)}});Ext.define('ABP.util.RequestQueue',{alternateClassName:'ABPRequestQueue',singleton:!0,requestQueue:[],push:function(a){var b=this;if(a&&a.url){b.requestQueue.push(a);ABPLogger.logDebug('Queued request: '+a.url)}},start:function(){var b=this;while(!Ext.isEmpty(b.requestQueue)){var a=b.pop();if(a){ABPLogger.logDebug('Retry request from queue: '+a.url);ABP.util.Ajax.request(a)}}},isEmpty:function(){return Ext.isEmpty(this.requestQueue)},privates:{pop:function(){var b=this;if(!Ext.isEmpty(b.requestQueue)&&b.requestQueue.length>0){var a=b.requestQueue[0];if(a.headers&&a.headers.Authorization){delete a.headers.Authorization}Ext.Array.removeAt(b.requestQueue,0);return a}}}});Ext.define('ABP.util.Ajax',{requires:['ABP.util.RequestQueue'],singleton:!0,mixins:{observable:'Ext.mixin.Observable'},config:{timeout:null},interceptor:null,constructor:function(a){this.mixins.observable.constructor.call(this,a)},availableRequests:{configuration:'configuration',login:'login',bootstrap:'bootstrap',refreshToken:'refreshtoken',logout:'logout',saveFavorites:'favorites',offlinePassword:'offlinePassword',actionCenterConfig:'controlcenter'},request:function(a){var g=this,f={success:!1,responseText:'',status:200};a.headers=a.headers||{};a.headers=Ext.applyIf(a.headers,g.getRequestHeaders(a));if(g.fireEvent('intercept',g,a,f)!==!1){if(f.success){if(f.status===2001){return}if(f.status===200){Ext.callback(a.success,a.scope,[f,a])}else {Ext.callback(a.failure,a.scope,[f,a])}return}}else {return}if(!a.timeout&&g.getTimeout()){a.timeout=g.getTimeout()}var l=this.getUrlInfo(a.url).abpEndPoint;if(l){var h=ABP.util.AjaxInteractionManager.getAjaxInteractions(l);if(h){var d=h.communications;var e=h.substitute;var c=h.urlQueryStringParameters;if(d&&Ext.isArray(d)){var k=[];var j=[];for(var b=0;b<d.length;b++){if(d[b].handlerObj){if(d[b].handlerObj.success){k.push(d[b].handlerObj.success)}if(d[b].handlerObj.failure){j.push(d[b].handlerObj.failure)}}}if(!Ext.isEmpty(k)){a.initialSuccess=a.success;a.configSuccess=k;a.success=function(d,b){for(var c=0;c<b.configSuccess.length;c++){if(Ext.isFunction(b.configSuccess[c])){b.configSuccess[c](d)}else {if(Ext.isString(b.configSuccess[c])){var e=ABP.util.Common.getSingletonFunctionFromString(b.configSuccess[c]);if(e){e(d)}}}}b.initialSuccess(d,b)}}if(!Ext.isEmpty(j)){a.initialFailure=a.failure;a.configFailure=j;a.failure=function(d,b){for(var c=0;c<b.configFailure.length;c++){if(Ext.isFunction(b.configFailure[c])){b.configFailure[c](d)}else {if(Ext.isString(b.configFailure[c])){var e=ABP.util.Common.getSingletonFunctionFromString(b.configFailure[c]);if(e){e(d)}}}}b.initialFailure(d,b)}}}if(e&&e.substituteFunc){if(Ext.isFunction(e.substituteFunc)){e.substituteFunc(a);return}else {if(Ext.isString(e.substituteFunc)){var m=ABP.util.Common.getSingletonFunctionFromString(e.substituteFunc);if(m){m(a);return}}}}if(c&&Ext.isArray(c)&&!Ext.isEmpty(c)){var i=a.url.indexOf('?')===-1?'?':'&';var n=c.length;for(var b=0;b<n;++b){if(b!==0){i+='&'+c[b].name+'='+c[b].value}else {i+=c[b].name+'='+c[b].value}}a.url+=i}}}if(ABPAuthManager.getToken()){a.initialFailure=a.failure;a.failure=g.handleAjaxFailure}Ext.Ajax.request(a)},getRequestHeaders:function(e){var d=e.url;var b={};var c=ABPServiceManager.matchEndpointToService(d);if(!Ext.isEmpty(c)){var a=ABPServiceManager.getTokenForService(c);if(Ext.isEmpty(a)){if(d.indexOf(ABP.util.Ajax.getServerUrl())>-1){a=ABPAuthManager.getToken()}}if(!Ext.isEmpty(a)){b['Authorization']='Bearer '+a}}else {var a=ABPAuthManager.getToken();if(!Ext.isEmpty(a)){b['Authorization']='Bearer '+a}else {if(ABP.util.Config.getAuthType()==='oauth'&&ABP.util.Config.getSessionId()!==null){b['Authorization']='Bearer '+ABP.util.Config.getSessionId()}}}b['SystemId']=ABP.util.LocalStorage.get('SavedEnvironment');b['UserId']=ABP.util.LocalStorage.get('SavedUsername');return b},getServerUrl:function(){var a=ABP.util.LocalStorage.get('ServerUrl');if(a&&this.isValidServerUrl(a)){if(a.indexOf('#')>0){a=a.substring(0,a.indexOf('#'))}return a}else {return ''}},getBootstrapServerUrl:function(){var b=ABP.util.LocalStorage.get('ServerUrl');var a='';if(b&&this.isValidServerUrl(b)){if(b.indexOf('#')>0){b=b.substring(0,b.indexOf('#'))}a=b}else {if(document.URL.indexOf('http')!==-1){if(this.attemptDiscoveryServerUrl){a=this.attemptDiscoveryServerUrl;if(a===document.location.origin){this.attemptDiscoveryServerUrl='';return ''}}else {a=document.URL}if(a.indexOf('#')>0){a=a.substring(0,a.indexOf('#'))}a=a.substring(0,a.lastIndexOf('/'));this.attemptDiscoveryServerUrl=a;var c=ABP.util.Config.getApiUrlPrefix();if(c!==null){a=a+c}}}return a},getAttemptDiscoveryServerUrl:function(){return this.attemptDiscoveryServerUrl},isValidServerUrl:function(a){if(!a){return !1}return /^(?:(?:https?):\/\/)(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*|(?:(?:[a-z\u00a1-\uffff0-9]+_?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*)(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(a)},getUrlInfo:function(d){var a=ABP.util.LocalStorage.get('ServerUrl');if(!a){a=window.location.origin}a=a.toLowerCase();d=d.replace(a+'/','');var c=d.split('?');var g=null;if(c.length===2){g=c[1].split('&')}var b=c[0].split('/');var f='';var e=b.lastIndexOf('abp');if(e>-1&&e<=b.length-2){f=b[e+1]}return {baseUrl:a,routes:b,abpEndPoint:f,options:g}},uploadFile:function(b,a){ABP.util.Ajax.request({url:a,rawData:b,headers:{'Content-Type':null},success:function(c){if(c.status!==200){ABP.view.base.popUp.PopUp.showInfo('error '+c.status)}},failure:function(c){var e=ABP.util.Common.geti18nString('error_upload_failed');var d=Ext.JSON.decode(c.responseText);ABP.util.Logger.logError(e+' ('+c.stausText+')',d.exceptionMessage);ABP.view.base.popUp.PopUp.showInfo(e,d.exceptionMessage)}})},downloadFile:function(a){ABP.util.Ajax.request({url:a,success:function(b,c){try{Ext.destroy(Ext.get('downloadIframe'))}catch(d){}Ext.DomHelper.append(document.body,{tag:'iframe',id:'downloadIframe',frameBorder:0,width:0,height:0,css:'display:none;visibility:hidden;height:0px;',src:a})},failure:function(b,f){var c=ABP.util.Common.geti18nString('error_download_failed');if(b.status===410){var d=ABP.util.Common.geti18nString('error_download_failed_fileNotFound');ABP.util.Logger.logError(c+' (410)',d);ABP.view.base.popUp.PopUp.showInfo(c,d)}else {if(b.responseText){var e=Ext.JSON.decode(b.responseText);ABP.util.Logger.logError(c+' ('+b.status+')',e.errorMessage);ABP.view.base.popUp.PopUp.showInfo(c,e.errorMessage)}}}})},handleAjaxFailure:function(b,a){var c=ABP.util.Msal.enabled;var d=1;a.failureAttempts=Ext.isNumber(a.failureAttempts)?a.failureAttempts:0;a.failureAttempts+=1;if(a.failureAttempts>d){a.failure=a.initialFailure;delete a.initialFailure;Ext.callback(a.initialFailure,a.scope,[b,a])}if(b.status===401&&!a.refreshedToken){ABPRequestQueue.push(a);if(ABPAuthManager.isRequestingToken()){return}try{var e=ABPServiceManager.matchEndpointToService(a.url);c=ABPAuthManager.serviceUsesB2cToken(e)}catch(f){ABPLogger.logWarn(f)}ABPAuthManager.requestToken(c).then(function(){a.refreshedToken=!0;a.failure=a.initialFailure;delete a.initialFailure;ABP.util.Ajax.request(a);if(!ABPRequestQueue.isEmpty()){ABPRequestQueue.start()}},function(c){Ext.callback(a.initialFailure,a.scope,[c,a])})}else {Ext.callback(a.initialFailure,a.scope,[b,a])}}});Ext.define('ABP.util.Logger',{singleton:!0,alternateClassName:'ABPLogger',requires:['ABP.store.ABPLoggingStore'],initialized:!1,_store:undefined,_enabled:!1,MAX_RECORDS:500,constructor:function(){this._store=Ext.create('ABP.store.ABPLoggingStore')},getCurrentTime:function(){var a=new Date();return a.toISOString()},store:function(a){if(this._enabled){if(!this._initialized){this.initialize()}this._store.add(a);if(this._store.getCount()>this.MAX_RECORDS){this._store.removeAt(0)}}},initialize:function(){this._initialized=!0;this.logInfo('Logger',navigator.userAgent)},enable:function(){this._enabled=!0},disable:function(){this._enabled=!1},log:function(b,c,a,e){this.store({level:a,time:this.getCurrentTime(),message:b,detail:c});var d=Ext.isEmpty(c)?b:b+'\n'+c;if(a==='FATAL'||a==='ERROR'){a='error'}else {if(a==='WARNING'||a==='ARIA'){a='warn'}else {if(a==='INFO'){a='info'}else {if(a==='DEBUG'||a==='TRACE'){a='log'}}}}Ext.log({msg:d,level:a,stack:!!e})},logFatal:function(a,b){this.log(a,b,'FATAL')},logError:function(a,b){this.log(a,b,'ERROR')},logWarn:function(a,b){this.log(a,b,'WARNING')},logInfo:function(a,b){this.log(a,b,'INFO')},logDebug:function(a,b){this.log(a,b,'DEBUG')},logTrace:function(a,b){this.log(a,b,'TRACE')},logException:function(a,e,b){var c='';var d='';if(Ext.isObject(a)||a.stack){c=a.message||a.description;d=a.stack!==null?a.stack:'No stack trace available.'}else {c=a}b=b===!1?b:!0;this.log(c,d,e,!0);if(Ext.AbstractComponent.layoutSuspendCount!==0){Ext.resumeLayouts()}return !1},logAria:function(c,b,a){this.log('ARIA'+b+': '+c,a,'ARIA')},handleException:function(f,c,e,d,a){var b;try{a=a||{};b=(a.fileName||c)+':'+(a.lineNumber||e)+':'+(a.columnNumber||d);a.message=(a.message||f)+'\n  at '+b;if(!a.stack&&(a.fileName||c)){a.stack='Error: '+a.message+'\n  at '+b}Ext.bind(ABP.view.util.Logger.logException,ABP.view.util.Logger,[a,'ERROR',!1]).call()}catch(g){}return !0},handleError:function(a){if(a){try{var b=Ext.JSON.encode(a);Ext.bind(ABP.view.util.Logger.logException,ABP.view.util.Logger,['Error raised.',b,'ERROR']).call()}catch(c){}}return !1},getLogs:function(b){if(!b){b=','}var a='';var d;var c,e;for(d=0;d<this._store.getCount();d++){c=this._store.getAt(d);a=a+c.get('time')+b+c.get('level')+b+c.get('message');e=c.get('detail');if(e){a=a+b+e}a=a+'\r\n'}return a},clearLogs:function(){this._store.removeAll()}},function(a){a.aria=function(){a.logAria.apply(a,arguments)}});Ext.define('ABP.util.AjaxInteractionManager',{singleton:!0,requires:['ABP.util.Logger'],config:{registeredAjaxCommunications:{},registeredAjaxSubstitutions:{},registeredAjaxUrlQueryStringParameters:{}},constructor:function(a){this.initConfig(a)},getAjaxInteractions:function(a){var c=this.getRegisteredAjaxCommunications()[a];var d=this.getRegisteredAjaxSubstitutions()[a];var b=this.getRegisteredAjaxUrlQueryStringParameters()[a];var e=null;if(c||d||b){e={'communications':c,'substitute':d,'urlQueryStringParameters':b}}return e},registerAjaxCommunication:function(a,b,c){ABP.util.Logger.logTrace('Registering Ajax Communication: '+a+' for '+b);if(this.getRegisteredAjaxCommunications()[a]){this.getRegisteredAjaxCommunications()[a].push({'appId':b,'handlerObj':c})}else {this.getRegisteredAjaxCommunications()[a]=[{'appId':b,'handlerObj':c}]}},registerAjaxSubstitute:function(a,b,c){ABP.util.Logger.logTrace('Registering Ajax Override: '+a+' for '+b);this.getRegisteredAjaxSubstitutions()[a]={'appId':b,'substituteFunc':c}},registerAjaxUrlQueryStringParameter:function(a,c,b){var d=this;ABP.util.Logger.logTrace('Registering Ajax Query String Parameter: '+a+' of '+c+':'+b);if(a!=='all'){d.__setUrlQueryStringParameter(a,c,b)}else {var e=ABP.util.Ajax.availableRequests;for(prop in e){d.__setUrlQueryStringParameter(prop,c,b)}}},privates:{__setUrlQueryStringParameter:function(a,d,c){var b=this;if(b.getRegisteredAjaxUrlQueryStringParameters()[a]){b.getRegisteredAjaxUrlQueryStringParameters()[a].push({'name':d,'value':c})}else {b.getRegisteredAjaxUrlQueryStringParameters()[a]=[{'name':d,'value':c}]}}}});Ext.define('ABP.util.Aria',{singleton:!0,setExpanded:function(a,b){if(!a){return}if(a.inputEl){a.inputEl.dom.setAttribute('aria-expanded',b)}},setActiveDecendant:function(a,b){if(!a){return}if(a.inputEl){a.inputEl.dom.setAttribute('aria-activedescendant',b)}},encodeAttribute:function(a){if(!a){return a}a=String(a).replace(/&/g,'').replace(/"/g,'').replace(/'/g,'').replace(/</g,'').replace(/>/g,'');return Ext.String.htmlEncode(a)}});Ext.apply(Ext.util.Format,{ariaEncode:function(a){return ABP.util.Aria.encodeAttribute(a)}});Ext.define('ABP.util.AuthenticationManager',{alternateClassName:'ABPAuthManager',singleton:!0,tokenKey:'servicetoken',tokenAudience:[],tokenRefreshTask:null,tokenAudienceLoaded:!1,requestingToken:!1,tokens:new Ext.util.HashMap(),serviceToken:null,token:null,requestToken:function(a){var d=this;var b=[];var c=d.getTokenAudience();a=Ext.isBoolean(a)?a:!0;if(a){b.push(ABP.util.Msal.getToken())}else {for(i=0;i<c.length;i++){b.push(d.requestTokenForService(c[i]))}}return Ext.Deferred.all(b)},serviceUsesB2cToken:function(a){var b=this;a=Ext.isString(a)?ABPServiceManager.getService(a):a;return Ext.isEmpty(a.usesB2cToken)?!0:a.usesB2cToken},requestTokenForService:function(b){var a=this;var f=ABPServiceManager.getService(b);if(f&&f.usesB2cToken){var g=Ext.String.format('Service {0} is configured to use B2C tokens.',b);ABPLogger.logDebug(g);return}if(a.requestingToken){return}url=ABP.util.Ajax.getServerUrl();var c=new Ext.Deferred();a.requestingToken=!0;var e={method:'GET',withCredentials:!0,url:url+'/abp/token?audience='+b,success:function(e){a.requestingToken=!1;var d=Ext.JSON.decode(e.responseText);a.authenticationSuccessService(d.authorizationToken);c.resolve(d)},failure:function(d){a.requestingToken=!1;a.authenticationFailure(d);c.reject(d)}};var d=a.getToken(b);if(d){e.headers={'Authorization':'Bearer '+d}}ABP.util.Ajax.request(e);return c.promise},isRequestingToken:function(){return this.requestingToken},isTokenValid:function(){var b=this;var c=Math.floor(Date.now()/1000);var a=b.currentTokenExpires;if(!Ext.isNumber(a)){a=b.getTokenExpiration()}return a>c+2},getToken:function(){var a=this;return ABP.util.SessionStorage.get(a.tokenKey)},setToken:function(a,c){var b=this;if(!Ext.isEmpty(a)){b.token=a;ABP.util.SessionStorage.set(b.tokenKey,a)}},getServiceToken:function(){var a=this;if(a.serviceToken){return a.serviceToken}else {return ABP.util.SessionStorage.get('abpservicetoken')}},setServiceToken:function(a){var b=this;if(!Ext.isEmpty(a)){b.serviceToken=a;ABP.util.SessionStorage.set('abpservicetoken',a)}},getTokenForAudience:function(a){return this.getServiceToken()},privates:{addTokenAudience:function(a){var b=this;if(b.tokenAudience.indexOf(a)>-1){return}else {b.tokenAudience.push(a)}},removeTokenAudience:function(c){var b=this;var a=b.tokenAudience.indexOf(c);if(a>-1){b.tokenAudience.splice(a,1)}},getTokenAudience:function(){return ABPServiceManager.getRegisteredServices()},authenticationSuccessService:function(a){var c=this;if(ABP.util.Jwt.isJwt(a)){var b=ABP.util.Jwt.getPayload(a);c.setServiceToken(a,b);c.setServiceTokenRefreshTask(a,b)}if(!ABPRequestQueue.isEmpty()){ABPRequestQueue.start()}},authenticationSuccess:function(a){var c=this;if(ABP.util.Jwt.isJwt(a)){var b=ABP.util.Jwt.getPayload(a);ABPLogger.logDebug('Token Generation Success: '+b.aud);c.setToken(a,b);c.setTokenRefreshTask(a,b)}if(!ABPRequestQueue.isEmpty()){ABPRequestQueue.start()}},authenticationFailure:function(a){ABPLogger.logError('Token Generation Failed.');ABPLogger.logDebug(a.responseText)},getTokenExpiration:function(b,c){var d=this;var b=b||d.getToken();if(ABP.util.Jwt.isJwt(b)){var a=Ext.isEmpty(c)?ABP.util.Jwt.getPayload(b):c;if(Ext.isNumber(a.exp)&&!Ext.isEmpty(a.iat)){return a.exp-a.iat}}},setTokenRefreshTask:function(g,f){var b=this;if(Ext.isEmpty(b.tokenRefreshTask)){b.tokenRefreshTask=new Ext.util.DelayedTask(b.requestToken,b)}var c=b.getTokenExpiration(g,f);if(ABP.Config.getDebugMode()&&f){var d='Token: {0}\n\nExpires at UTC: {1}.\n\nCurrent UTC: {2}';var e=new Date();var h=new Date(e.getTime()+c*1000);d=Ext.String.format(d,g,h.toUTCString(),e.toUTCString());ABPLogger.logDebug(d)}var a=c;if(Ext.isNumber(c)){a=a*1000*0.7;a=Math.floor(a);b.tokenRefreshTask.delay(a);ABPLogger.logDebug('Services token is set to refresh in about '+Math.round(a/1000/60)+' minutes.')}},setServiceTokenRefreshTask:function(g,f){var b=this;if(Ext.isEmpty(b.tokenRefreshTask)){b.tokenRefreshTask=new Ext.util.DelayedTask(b.requestTokenForService,b)}var c=b.getTokenExpiration(g,f);if(ABP.Config.getDebugMode()&&f){var d='Token: {0}\n\nExpires at UTC: {1}.\n\nCurrent UTC: {2}';var e=new Date();var h=new Date(e.getTime()+c*1000);d=Ext.String.format(d,g,h.toUTCString(),e.toUTCString());ABPLogger.logDebug(d)}var a=c;if(Ext.isNumber(c)){a=a*1000*0.7;a=Math.floor(a);b.tokenRefreshTask.delay(a);ABPLogger.logDebug('Services token is set to refresh in about '+Math.round(a/1000/60)+' minutes.')}}}});Ext.define('ABP.util.BroadcastChannel',{singleton:!0,broadcastAvailable:!0,broadcastChannels:[],create:function(b,c,d){try{var a=new BroadcastChannel(b);a.onmessage=c.bind(d);this.broadcastChannels.push(a)}catch(e){this._broadcastAvailable=!1;console.error('Unable to create broadcast channel')}},remove:function(b){var a=Ext.Array.findBy(this.broadcastChannels,function(a){return b===a.name});if(a){a.close();Ext.Array.remove(a)}},send:function(b,c){var a=Ext.Array.findBy(this.broadcastChannels,function(a){return b===a.name});if(a){a.postMessage(c)}}});Ext.define('ABP.util.CSS.Colors',{singleton:!0,themePrefixCls:'.abp-theme-colors ',defaultMismatchColor:'darkred',selectors:{'base':'.abp-theme .base '},getThemeColor:function(d){var c;var a=this;var e='.'+ABP.ThemeManager.getSelectedTheme();var b=a.selectors[d];if(Ext.isEmpty(b)){b='.abp-theme .'+d;c=this.getProperty(a.themePrefixCls+b,'color',a.defaultMismatchColor)}else {c=this.getProperty(a.themePrefixCls+b+e,'color',a.defaultMismatchColor)}if(c===a.defaultMismatchColor){ABP.util.Logger.logWarn('The ABP theme color requested is not in the ABP theme: "'+d+'". Using the mismatch color "'+a.defaultMismatchColor+'" to highlight the problem control.')}return c},getAnyColor:function(a){var b=this;var c='.'+ABP.ThemeManager.getSelectedTheme();var d=this.getProperty(b.themePrefixCls+b.selectors[a]+c,'color',a)},getProperty:function(e,b,d){var a=Ext.util.CSS.getRule(e);if(a){var c=a.styleMap?a.styleMap.get(b):a.style.getPropertyValue(b);if(c){return c.toString()}}else {return d}}});Ext.define('ABP.util.Color',{singleton:!0,getRGBValues:function(a){if(a.substr(0,3)=='rgb'){return this.getFromRGBFunction(a)}if(a.substr(0,1)=='#'){return this.getFromHex(a)}},getWCAGContrast:function(g){var d=window.getComputedStyle(g,null);var b=d.getPropertyValue('background-color');if(this.isTransparent(b)){b=this.getParentBackground(g)}var e=d.getPropertyValue('color');var f=parseInt(d.getPropertyValue('font-size').replace('px',''));var i=d.getPropertyValue('font-weight');var c='';var h=f>=24||f>18&&i>=700;var a=ABP.util.Color.getContrast(e,b);if(h){if(a>=3){if(a>=4.5){c='AAA'}else {c='AA'}}else {console.log('WCAG Fail - '+b+' / '+e+' > '+a)}}else {if(a>=4.5){if(a>=7){c='AAA'}else {c='AA'}}else {console.log('WCAG Fail - '+b+' / '+e+' > '+a)}}return c},getContrast:function(f,g){var c=this;var a=f;if(typeof f=='string'){a=c.getRGBValues(f)}var b=g;if(typeof g=='string'){b=c.getRGBValues(g)}var d=c.getLuminanace(a[0],a[1],a[2])+0.05;var e=c.getLuminanace(b[0],b[1],b[2])+0.05;return d>e?d/e:e/d},getContrastingBWColor:function(a){var b=this;var c=b.getContrast('#000000',a);var d=b.getContrast('#FFFFFF',a);return c>d?'#000000':'#FFFFFF'},privates:{getFromHex:function(a){var b=[0,0,0];a=a.replace('#','');b[0]=parseInt(a.substr(0,2),16);b[1]=parseInt(a.substr(2,2),16);b[2]=parseInt(a.substr(4,2),16);return b},getFromRGBFunction:function(c){c=c.toUpperCase();var b=c.replace('(','');b=b.replace(')','');b=b.replace('RGBA','');b=b.replace('RGB','');var a=b.split(',');a[0]=Number(a[0]);a[1]=Number(a[1]);a[2]=Number(a[2]);if(c.indexOf('RGBA')>-1){a[3]=Number(a[3])}return a},getLuminanace:function(d,c,b){var a=[d,c,b].map(function(a){a/=255;return a<=0.03928?a/12.92:Math.pow((a+0.055)/1.055,2.4)});return a[0]*0.2126+a[1]*0.7152+a[2]*0.0722},isTransparent:function(b){var a=this.getFromRGBFunction(b);if(a.length<=3){return !1}return a[3]===0},getParentBackground:function(d){var a=d.parentElement;if(!a){return 'rgb(255,255,255)'}var c=window.getComputedStyle(a,null);var b=c.getPropertyValue('background-color');if(this.isTransparent(b)){return this.getParentBackground(a)}return b}}});Ext.define('ABP.util.Common',{singleton:!0,__cssClassNameInvalidChars:/[ !\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,__lastLoginAsUserDeferId:null,__keyNavigation:!1,__uuidGenerator:null,geti18nString:function(e,c){var f=Ext.getApplication();var d=f.getMainView();var b=d.getViewModel();var a=null;if(b){a=b.checkI18n(e,c)}return a},getClassic:function(){return Ext.toolkit==='classic'},getModern:function(){return Ext.toolkit==='modern'},getWindowHeight:function(){var a;if(this.getClassic()){a=Ext.getBody().getHeight()}else {a=Ext.Viewport.getWindowHeight()}return a},getWindowWidth:function(){var a;if(this.getClassic()){a=Ext.getBody().getWidth()}else {a=Ext.Viewport.getWindowWidth()}return a},getPortrait:function(){var a=null;if(this.getModern()){a=Ext.Viewport.determineOrientation()==='portrait'}return a},getLandscape:function(){var a=null;if(this.getModern()){a=Ext.Viewport.determineOrientation()==='landscape'}return a},inspectString:function(c){var a=(((a||'')+'').toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join('');var d=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,b=/\x3c!--[\s\S]*?--\x3e|<\?(?:php)?[\s\S]*?\?>/gi;return c.replace(b,'').replace(d,function(b,d){return a.indexOf('<'+d.toLowerCase()+'>')>-1?b:''}).replace('/>','').trim()},getSmallScreen:function(){var c=this.getWindowWidth();var b=this.getWindowHeight();var a=!1;if(c<700||b<700){a=!0}return a},getToolBarButton:function(d){var e=Ext.getApplication();var c=e.getMainView();var a=c.down('toolbartop');var b=null;if(a){b=a.getController().getButton(d)}return b},getMenuItem:function(d,c,e){var b=this.getMainMenu();var a=null;if(b){a=b.getController().findMenuItem(d,c,e)}return a},getFavorites:function(){var a=ABP.internal.util.MainMenu.jsonSerializeFavorites();return a},getCurrentTheme:function(){var b=Ext.getApplication();var a=b.getMainView();vm=a.getViewModel();return vm.get('currentTheme')},isFavorite:function(f,a){var c;var d=Ext.getStore('navSearch');var b=d.getNodeById('container_nav-favorites');if(b){if(d.lazyFill){var e=this.getMainMenu();if(typeof a==='function'){c=e.getController().findTreeStoreItemInChildren(b,null,null,a)}else {if(Ext.isString(a)){c=e.getController().findTreeStoreItemInChildren(b,'uniqueId','fav_'+a)}}}else {if(typeof a==='function'){c=b.findChildBy(a,null,!0)}else {if(Ext.isString(a)){c=b.findChild('uniqueId','fav_'+a,!0)}}}}return Ext.isEmpty(c)?!1:!0},getRecents:function(){var d=this.getMainMenu();var e=[];if(d){var f=d.getViewModel();var a=f.get('recentPages');if(a&&!Ext.isEmpty(a)){var c=[];for(var b=0;b<a.length;++b){if(a[b].serialData){c.push(a[b].serialData)}}if(!Ext.isEmpty(c)){e=Ext.JSON.encode(c)}}}return e},getAutomationClass:function(a){var c;var b;var e;var d;var f;if(a.initialConfig){if(a.initialConfig.node){if(a.initialConfig.node.data){e=a.initialConfig.node.data.automationCls;d=a.initialConfig.node.data.labelKey;f=a.initialConfig.node.data.label}}}if(this.hasAutomationClass(a)){return ''}if(a.automationCls){return this.getAutomationAnchorName(a.automationCls)}else {if(e){return this.getAutomationAnchorName(e)}else {if(Ext.isString(a.xtype)){c=a.xtype}else {if(Ext.isString(a.defaultType)){c=a.defaultType}else {c='unknown-xtype'}}if(Ext.isString(a.name)){b=a.name}else {if(Ext.isString(d)){b=d}else {if(Ext.isString(f)){b=f}else {if(Ext.isString(a.itemId)){b=a.itemId}else {b='custom-unsafe'}}}}return this.getAutomationAnchorName(c+'-'+b)}}},getAutomationAnchorName:function(a){return 'a-'+a.replace(this.__cssClassNameInvalidChars,'-')},isJsonString:function(a){try{JSON.parse(a)}catch(b){return !1}return !0},setKeyboardFocus:function(b){var a=Ext.query(b,!1);if(a&&a.length>0){var c=Ext.getCmp(a[0].id);Ext.getCmp(c.id).focus(50)}},openBrowserTab:function(f,a,g,h){var e=ABP.util.Config.getEnvironment();var d=ABP.util.Config.getUsername();var i=ABP.util.Config.getOAuthInfo();var k=ABP.util.Config.getLanguage();var b=ABP.util.LocalStorage.getForLoggedInUser('SavedPassword');if(!b){if(ABP.util.LocalStorage.get('SavedUsername')==d&&ABP.util.LocalStorage.get('SavedEnvironment')==e){b=ABP.util.LocalStorage.get('SavedPassword')}}var c=this.getLoginAsUserObj(e,d,i,k,b,!h);ABP.util.LocalStorage.set('LoginAsUser',ABP.util.Common.jsonEncode(c));if(ABP.util.Common.__lastLoginAsUserDeferId){Ext.undefer(ABP.util.Common.__lastLoginAsUserDeferId);ABP.util.Common.__lastLoginAsUserDeferId=null}ABP.util.Common.__lastLoginAsUserDeferId=Ext.defer(function(c){try{var b=ABP.util.Common.jsonDecode(ABP.util.LocalStorage.get('LoginAsUser'));if(c.created==b.created){ABP.util.LocalStorage.remove('LoginAsUser')}}catch(l){}},ABP.util.Constants.login.loginAsUserLifetime*1000,this,[c]);a=a||'_blank';var j=window.open(f,a);if(Ext.isEmpty(j)){ABP.view.base.popUp.PopUp.showHyperlink('help_blocked_Text',f,a,g,'help_blocked_Title',null,null,null)}},jsonDecode:function(b){var a=null;try{a=Ext.JSON.decode(b)}catch(c){ABP.util.Logger.logError('Cannot JSON.decode this:'+b+'. Exception:'+c)}return a},jsonEncode:function(b){var a=null;try{a=Ext.JSON.encode(b)}catch(c){ABP.util.Logger.logError('Cannot JSON.encode this:'+b+'. Exception:'+c)}return a},setViewModelProperty:function(a,e){var f=Ext.getApplication(),d=f.getMainView(),b=d.getViewModel(),c=['switchToOnline'];if(c.indexOf(a)===-1){return}if(b){b.set(a,e)}},getViewModelProperty:function(b){var c=Ext.getApplication(),a=c.getMainView(),d=a.getViewModel();return d.get(b)},hasAutomationClass:function(a){var c;var b=a.getCls?a.getCls():a.cls;if(!b&&typeof a.getNode==='function'){var d=a.getNode();if(d&&d.data){a=d.data;b=a.cls}}if(!b&&a.componentCls){b=a.componentCls}c=this.testForAutomationClass(b);if(c===!1&&(b&&a.componentCls)){if(b!==a.componentCls){c=this.testForAutomationClass(a.componentCls)}}return c},testForAutomationClass:function(a){var b;var c;if(Ext.isArray(a)){a.forEach(function(b,e,d){if(!c){c=/\b(a-[a-zA-Z0-9-]+)\b/m.test(b)}});return c}else {if(Ext.isString(a)){b=a.match(ABP.util.Constants.AUTOMATION_CLASS_REGEX);if(b===null){return !1}else {return b.length>0}}}},getLoginAsUserObj:function(g,f,c,d,e,b){var a={environment:g,logonId:f,sessionToken:c,locale:d,password:e,created:Date.now(),clearSession:b};return a},flushAllBindings:function(d,c){var a,b;if(c){a=d.up('[xtype='+c+']')}else {a=d}if(a){var b=a.getViewModel();if(b){b.notify()}}},measureCache:{},measureDiv:null,actualMeasureText:function(g,e){var f=this,a=f.measureDiv,b=100000,c;if(!a){var d=Ext.Element.create({style:{'overflow':'hidden','position':'relative','float':'left','width':0,'height':0}});f.measureDiv=a=Ext.Element.create({style:{'position':'absolute','x':b,'y':b,'z-index':-b,'white-space':'nowrap','display':'block','padding':0,'margin':0}});Ext.getBody().appendChild(d);d.appendChild(a)}if(e){a.setStyle({font:e,lineHeight:'normal'})}a.setText('('+g+')');c=a.getSize();a.setText('()');c.width-=a.getSize().width;return c},measureTextSingleLine:function(b,e){b=b.toString();var l=this,a=l.measureCache,h=b.split(''),i=0,g=0,c,d,f,k,j;if(!a[e]){a[e]={}}a=a[e];if(a[b]){return a[b]}for(f=0,k=h.length;f<k;f++){d=h[f];if(!(c=a[d])){j=l.actualMeasureText(d,e);c=a[d]=j}i+=c.width;g=Math.max(g,c.height)}return a[b]={width:i,height:g}},getABPAboutData:function(){return {icon:'aptean2018',name:'Aptean Business Platform',version:'3.1.0.0',copyright:'Aptean &copy; '+(new Date()).getFullYear(),detail:'Copyright (C) 2004-'+(new Date()).getFullYear()+' Aptean. All rights reserved.<p>'+'Aptean, all other product names, service names, slogans, and related logos are registered trademarks or trademarks of Aptean, Inc in the United States and other countries.  All other company, product or service names referenced herein are used for identification purposes only and may be trademarks of their respective owners.<p>'+'This program is protected by copyright law and international treaties. Unauthorized reproduction and distribution is strictly prohibited.'}},getSingletonFunctionFromString:function(d){var a;var b=d.split('.');var e=b.pop();a=window;for(var c=0;c<b.length;++c){a=a[b[c]];if(a===undefined){return null}}return a[e]},getBrowserLanguage:function(){var a=window.navigator.language.toLowerCase();this.setPageLanguage(a,!0);return a},setPageLanguage:function(a,c){if(!a){return}if(c){var b=document.documentElement.getAttribute('lang');if(b){return}}document.documentElement.setAttribute('lang',a)},isEmptyObject:function(a){if(a==null){return !0}if(a.length>0){return !1}if(a.length===0){return !0}if(typeof a!=='object'){return !0}for(var b in a){if(hasOwnProperty.call(a,b)){return !1}}return !0},getObjectProperty:function(a,c){if(!Ext.isString(c)||!Ext.isObject(a)){return}var f=c.split('.'),d=f.length,b=-1;while(++b<d){var e=Ext.isObject(a)?a[f[b]]:undefined;if(e!==undefined){a=e}else {return}}if(b===d){return a}return},removeCaseInsensitiveDuplicates:function(a,c){var g=this;if(!a||!c){return a}var e=a.getCount();for(var b=e-1;b>0;b--){var f=a.getAt(b).getData()[c];var d=g.containsCaseInsensitive(a,c,f);if(d!==b&&d>-1){a.removeAt(b)}}},getKeyboardNavigation:function(){return this.__keyNavigation},getMouseNavigation:function(){return !this.__keyNavigation},setKeyboardNavigation:function(a){this.__keyNavigation=a},getUuid:function(){if(!this.__uuidGenerator){this.__uuidGenerator=Ext.create('Ext.data.identifier.Uuid',{})}return this.__uuidGenerator.generate()},isIOSChrome:function(){return !Ext.isEmpty(Ext.browser.userAgent.match('CriOS'))},privates:{getMainMenu:function(){var b=Ext.getApplication();var a=b.getMainView();var c=a.down('mainmenu');return c},compareCaseInsensitive:function(b,c){var a=new RegExp('^'+c+'$','i');return function(d){return a.test(d.get(b))}},containsCaseInsensitive:function(b,a,c){return b.findBy(this.compareCaseInsensitive(a,c))}}});Ext.define('ABP.util.Config',{singleton:!0,alternateClassName:'ABP.Config',requires:['ABP.util.Logger'],config:{i18n:[],language:'en',bootstrapConfig:null,sessionConfig:null,username:null,environment:null,sessionId:null,authType:null,application:null,loggedIn:!1,apiUrlPrefix:null,prebootSettingsExtraFields:[],rightPaneTabs:[],packageURL:null,hardcodedConfig:null,debugMode:!1,b2cShowLogin:!1,subscriptions:[],disabledProductSubscriptions:[]},setSubscriptions:function(b){var f=this;var g=b.length;var d=[];for(var c=0;c<g;++c){var e=b[c];var a=e.product.toLowerCase();if(!e.enabled){d.push(a)}else {if(a==='abpinsight'||a==='insight'){ABPInsight.util.WebserviceManager.setApiUrl(a.endpoint)}}}f.subscriptions=b;f.disabledProductSubscriptions=d},DEFAULT_BOOTSTRAP_CONFIG:{settings:{canRecoverPassword:!1,canKeepMeSignedIn:!1,canKeepMultipleUsersSignedIn:!1,canForcePasswordChange:!1,allowServiceChange:!0,rememberEnvironment:!0,rememberLanguage:!0,rememberPassword:!1,rememberUsername:!0,rememberPreviousServerUrls:!0,authenticationType:null,extraLoginFields:[],usernameCaseSensitive:!1,showSimpleLogin:!0},languageResources:[],branding:{companyName:''},availableEnvironments:[],defaultEnvironment:'',authenticatedUserName:null},DEFAULT_SESSION_CONFIG:{settings:{userConfig:{displayName:null,photo:null,enableEditProfile:!1},appToolbarTitle:null,autoHideMenu:!0,enableMenuFavorites:!1,enableMenuPeelOff:!1,enableMenuRecent:!1,enableMenuSuggested:!1,enableNavSearch:!1,enableSearch:!1,notifications:{enabled:!1,maxHistory:100,clearBadgeOnActivate:!0,sources:[]},enableWideMenu:!1,favorites:[],disableNavMenu:!1,startMenuHidden:!1,inactiveTimeout:0,inactiveWarningTime:0,rightPane:[],rememberMenuState:!0,hideTreeNavigation:!0,searchInfo:[],defaultSearch:'',loadPage:{appId:'',event:'',eventArgs:''},toolbarTitleShowBranding:!0,layoutPersistance:'local',mainMenuModernFocusFirstOption:!1,mainMenuNavSearchDisableSoundex:!1,mainMenuNavSearchDisableRelevance:!1,mainMenuNavSearchDuplicateFields:'',mainMenuNavSearchResultsMax:20,mainMenuRecentMaxShown:5,mainMenuRecentServerSideSaving:!1,mainMenuSingleExpand:!1,mainMenuSuggestedAutoExpand:!0,mainMenuStartFavoritesOpen:!1,mainMenuLazyFill:!0,navSearchShowPath:!0,persistSelectedTheme:!0,settingsPage:{enableAbout:!0,enableHeadlinesManager:!1,enableHelp:!0,enableLanguages:!0,enableLoggerView:!0,enableSignOff:!0,enableUser:!0,showSessionTimer:!0,showEnvironment:!0}},navMenu:[],navMenuOrder:{favorites:0,recents:1,suggested:2,navigation:3},sessionMenu:[],toolbarMenu:[],toolbarTitleImageUrl:null,enabledPlugins:[],availableWidgets:[],languageResources:[],headlines:[]},setPrebootSettingsExtraFields:function(a){if(Ext.isArray(a)){if(a.length>0&&!Ext.isArray(a[0])){this.config.prebootSettingsExtraFields=this.config.prebootSettingsExtraFields.concat(a)}}else {this.config.prebootSettingsExtraFields.push(a)}},registerRightPaneTabs:function(a){if(Ext.isArray(a)){if(a.length>0&&!Ext.isArray(a[0])){this.config.rightPaneTabs=this.config.rightPaneTabs.concat(a)}}else {this.config.rightPaneTabs.push(a)}},constructor:function(a){this.initConfig(a)},checkArray:function(a,b){if(!a){ABP.util.Logger.logWarn(b+' is missing, converting to empty Array');return []}if(!(a instanceof Array)){ABP.util.Logger.logWarn(b+' is not an Array, converting');return [a]}return a},checkUrl:function(a,b){var c=new Ext.data.validator.Url();if(!a){ABP.util.Logger.logWarn(b+' is missing, nulling');return null}if(!c.validate(a)===!0){ABP.util.Logger.logWarn(b+' is not a valid URL, nulling');return null}return a},checkBoolean:function(a,c,b){if(typeof a==='string'||a instanceof String){switch(a.toLowerCase()){case 'false':case '0':ABP.util.Logger.logWarn(c+' is string value, converting to boolean.');return !1;case 'true':case '1':ABP.util.Logger.logWarn(c+' is string value, converting to boolean.');return !0;default:ABP.util.Logger.logWarn(c+' is not specified, using default value "'+b+'"');return b;}}if(typeof a==='boolean'||a instanceof Boolean){return a}return b},checkInteger:function(a,c,b){if(Number.isInteger&&Number.isInteger(a)){return a}else {if(Ext.Number.parseInt(a)){ABP.util.Logger.logWarn(c+' is not an integer value, converting to integer. Or using Internet Explorer 11 or below.');return Ext.Number.parseInt(a)}else {ABP.util.Logger.logWarn(c+' is not an integer value, using default value: '+b);return b}}},checkString:function(a,b){if(typeof a==='string'||a instanceof String){return a}return b},processBootstrapConfig:function(b){var a=this;var d=0;if(!b){ABP.util.Logger.logError('Bootstrap configuration is not valid, using default configuration.');a.setBootstrapConfig(a.DEFAULT_BOOTSTRAP_CONFIG);return}if(!b.settings){ABP.util.Logger.logError('Bootstrap configuration missing settings element, using default settings configuration.');b.settings=a.DEFAULT_BOOTSTRAP_CONFIG.settings}else {var c=b.settings;c.canRecoverPassword=a.checkBoolean(c.canRecoverPassword,'Bootstrap configuration - settings - canRecoverPassword',a.DEFAULT_BOOTSTRAP_CONFIG.settings.canRecoverPassword);c.canKeepMeSignedIn=a.checkBoolean(c.canKeepMeSignedIn,'Bootstrap configuration - settings - canKeepMeSignedIn',a.DEFAULT_BOOTSTRAP_CONFIG.settings.canKeepMeSignedIn);c.canKeepMultipleUsersSignedIn=a.checkBoolean(c.canKeepMultipleUsersSignedIn,'Bootstrap configuration - settings - canKeepMultipleUsersSignedIn',a.DEFAULT_BOOTSTRAP_CONFIG.settings.canKeepMultipleUsersSignedIn);c.canForcePasswordChange=a.checkBoolean(c.canForcePasswordChange,'Bootstrap configuration - settings - canForcePasswordChange',a.DEFAULT_BOOTSTRAP_CONFIG.settings.canForcePasswordChange);c.allowServiceChange=a.checkBoolean(c.allowServiceChange,'Bootstrap configuration - settings - allowServiceChange',a.DEFAULT_BOOTSTRAP_CONFIG.settings.allowServiceChange);c.defaultLanguage=a.checkString(c.defaultLanguage,a.DEFAULT_BOOTSTRAP_CONFIG.settings.defaultLanguage);ABP.util.Common.setPageLanguage(c.defaultLanguage);c.rememberEnvironment=a.checkBoolean(c.rememberEnvironment,'Bootstrap configuration - settings - rememberEnvironment',a.DEFAULT_BOOTSTRAP_CONFIG.settings.rememberEnvironment);c.rememberLanguage=a.checkBoolean(c.rememberLanguage,'Bootstrap configuration - settings - rememberLanguage',a.DEFAULT_BOOTSTRAP_CONFIG.settings.rememberLanguage);c.rememberPassword=a.checkBoolean(c.rememberPassword,'Bootstrap configuration - settings - rememberPassword',a.DEFAULT_BOOTSTRAP_CONFIG.settings.rememberPassword);c.rememberUsername=a.checkBoolean(c.rememberUsername,'Bootstrap configuration - settings - rememberUsername',a.DEFAULT_BOOTSTRAP_CONFIG.settings.rememberUsername);c.rememberPreviousServerUrls=a.checkBoolean(c.rememberPreviousServerUrls,'Bootstrap configuration - settings - rememberPreviousServerUrls',a.DEFAULT_BOOTSTRAP_CONFIG.settings.rememberPreviousServerUrls);c.authenticationType=a.checkString(c.authenticationType,a.DEFAULT_BOOTSTRAP_CONFIG.settings.authenticationType);c.extraLoginFields=a.checkArray(c.extraLoginFields,'extra Login field');c.showSimpleLogin=a.checkBoolean(c.showSimpleLogin,'Bootstrap configuration - settings - showSimpleLogin',a.DEFAULT_BOOTSTRAP_CONFIG.settings.showSimpleLogin)}if(!b.languageResources){ABP.util.Logger.logError('Bootstrap configuration missing languageResources element, using default languageResources configuration.');b.languageResources=a.DEFAULT_BOOTSTRAP_CONFIG.languageResources}else {b.languageResources=a.checkArray(b.languageResources,'Bootstrap configuration - languageResources')}if(!b.branding){ABP.util.Logger.logError('Bootstrap configuration missing branding element, using default branding configuration.');b.branding=a.DEFAULT_BOOTSTRAP_CONFIG.branding}if(!b.availableEnvironments){ABP.util.Logger.logError('Bootstrap configuration missing availableEnvironments element, using default availableEnvironments configuration.');b.availableEnvironments=a.DEFAULT_BOOTSTRAP_CONFIG.availableEnvironments}else {b.availableEnvironments=a.checkArray(b.availableEnvironments,'Bootstrap configuration - availableEnvironments');for(d=0;d<b.availableEnvironments.length;++d){if(b.availableEnvironments[d].languages){b.availableEnvironments[d].languages=a.checkArray(b.availableEnvironments[d].languages,'Bootstrap configuration - availableEnvironments - available languages')}}}if(!b.defaultEnvironment){ABP.util.Logger.logError('Bootstrap configuration missing defaultEnvironment element, using default defaultEnvironment configuration.');b.defaultEnvironment=a.DEFAULT_BOOTSTRAP_CONFIG.defaultEnvironment}if(!b.authenticatedUserName){b.authenticatedUserName=a.DEFAULT_BOOTSTRAP_CONFIG.authenticatedUserName}if(b.offlineBootstrap){ABP.util.LocalStorage.set('OfflineBootstrap',Ext.JSON.encode(b.offlineBootstrap));b.offlineAuthenticationType=b.offlineBootstrap.offlineAuthenticationType;b.hideOfflineModeToggle=b.offlineBootstrap.hideOfflineModeToggle;if(b.offlineBootstrap.offlineAuthenticationType===1){b.validateOfflinePassword=b.offlineBootstrap.validateOfflinePassword}}this.setBootstrapConfig(b)},processSessionConfigMenuItems:function(b,d,e){var c=this,a;for(a=0;a<b.length;a++){b[a].type=c.checkString(b[a].type,'event');b[a].uniqueId=c.checkString(b[a].uniqueId,'');b[a].label=c.checkString(b[a].label,'');b[a].labelKey=c.checkString(b[a].labelKey,'');b[a].icon=c.checkString(b[a].icon,'');if(b[a].type==='route'){b[a].hash=c.checkString(b[a].hash,'')}else {b[a].event=c.checkString(b[a].event,'');b[a].eventArgs=c.checkArray(b[a].eventArgs,'Session configuration>settings>'+d+'>eventArgs')}b[a].appId=c.checkString(b[a].appId,'');b[a].activateApp=c.checkBoolean(b[a].activateApp,'Session configuration>settings>'+d+'>activateApp',!0);b[a].enabled=c.checkBoolean(b[a].enabled,'Session configuration>settings>'+d+'>enabled',!0);b[a].tooltip=c.checkString(b[a].tooltip,'');b[a].tooltipKey=c.checkString(b[a].tooltipKey,'');b[a].shorthand=c.checkString(b[a].shorthand,'');if(e){b[a].children=c.checkArray(b[a].children,'Session configuration>'+d+'>children');if(b[a].children.length>0){b[a].children=c.processSessionConfigMenuItems(b[a].children,d,e)}}}return b},processSessionConfig:function(c){var b=this;var d;if(!c){ABP.util.Logger.logError('Session configuration is not valid, using default configuration.');b.setBootstrapConfig(b.DEFAULT_SESSION_CONFIG);return}b.loadPersonalisation();if(!c.settings){ABP.util.Logger.logError('Session configuration missing settings element, using default settings configuration.');c.settings=b.DEFAULT_SESSION_CONFIG.settings}else {var a=c.settings;a.autoHideMenu=b.checkBoolean(a.autoHideMenu,'Session configuration - settings - autoHideMenu',b.DEFAULT_SESSION_CONFIG.settings.autoHideMenu);a.enableSearch=b.checkBoolean(a.enableSearch,'Session configuration - settings - enableSearch',b.DEFAULT_SESSION_CONFIG.settings.enableSearch);a.startMenuHidden=b.checkBoolean(a.startMenuHidden,'Session configuration - settings - startMenuHidden',b.DEFAULT_SESSION_CONFIG.settings.startMenuHidden);a.rememberMenuState=b.checkBoolean(a.rememberMenuState,'Session configuration - settings - rememberMenuState',b.DEFAULT_SESSION_CONFIG.settings.rememberMenuState);a.enableWideMenu=b.checkBoolean(a.enableWideMenu,'Session configuration - settings - enableWideMenu',b.DEFAULT_SESSION_CONFIG.settings.enableWideMenu);a.disableNavMenu=b.checkBoolean(a.disableNavMenu,'Session configuration - settings - disableNavMenu',b.DEFAULT_SESSION_CONFIG.settings.disableNavMenu);a.enableMenuFavorites=b.checkBoolean(a.enableMenuFavorites,'Session configuration - settings - enableMenuFavorites',b.DEFAULT_SESSION_CONFIG.settings.enableMenuFavorites);a.enableMenuPeelOff=b.checkBoolean(a.enableMenuPeelOff,'Session configuration - settings - enableMenuPeelOff',b.DEFAULT_SESSION_CONFIG.settings.enableMenuPeelOff);a.enableMenuRecent=b.checkBoolean(a.enableMenuRecent,'Session configuration - settings - enableMenuRecent',b.DEFAULT_SESSION_CONFIG.settings.enableMenuRecent);a.enableMenuSuggested=b.checkBoolean(a.enableMenuSuggested,'Session configuration - settings - enableMenuSuggested',b.DEFAULT_SESSION_CONFIG.settings.enableMenuSuggested);a.enableNavSearch=b.checkBoolean(a.enableNavSearch,'Session configuration - settings - enableNavSearch',b.DEFAULT_SESSION_CONFIG.settings.enableNavSearch);a.hideTreeNavigation=b.checkBoolean(a.hideTreeNavigation,'Session configuration - settings - hideTreeNavigation',b.DEFAULT_SESSION_CONFIG.settings.hideTreeNavigation);a.toggleableGlobalSearchField=b.checkBoolean(a.toggleableGlobalSearchField,'Session configuration - settings - toggleableGlobalSearchField',b.DEFAULT_SESSION_CONFIG.settings.toggleableGlobalSearchField);a.mainMenuModernFocusFirstOption=b.checkBoolean(a.mainMenuModernFocusFirstOption,'Session configuration - settings - mainMenuModernFocusFirstOption',b.DEFAULT_SESSION_CONFIG.settings.mainMenuModernFocusFirstOption);a.mainMenuNavSearchDisableSoundex=b.checkBoolean(a.mainMenuNavSearchDisableSoundex,'Session configuration - settings - mainMenuNavSearchDisableSoundex',b.DEFAULT_SESSION_CONFIG.settings.mainMenuNavSearchDisableSoundex);a.mainMenuNavSearchDuplicateFields=b.checkString(a.mainMenuNavSearchDuplicateFields,b.DEFAULT_SESSION_CONFIG.settings.mainMenuNavSearchDuplicateFields);a.mainMenuNavSearchDisableRelevance=b.checkBoolean(a.mainMenuNavSearchDisableRelevance,'Session configuration - settings - mainMenuNavSearchDisableRelevance',b.DEFAULT_SESSION_CONFIG.settings.mainMenuNavSearchDisableRelevance);a.mainMenuNavSearchResultsMax=b.checkInteger(a.mainMenuNavSearchResultsMax,'Session configuration - settings - mainMenuNavSearchResultsMax',b.DEFAULT_SESSION_CONFIG.settings.mainMenuNavSearchResultsMax);a.mainMenuLazyFill=b.checkBoolean(a.mainMenuLazyFill,'Session configuration - settings - mainMenuLazyFill',b.DEFAULT_SESSION_CONFIG.settings.mainMenuLazyFill);a.mainMenuRecentMaxShown=b.checkInteger(a.mainMenuRecentMaxShown,'Session configuration - settings - mainMenuRecentMaxShown',b.DEFAULT_SESSION_CONFIG.settings.mainMenuRecentMaxShown);a.mainMenuSingleExpand=b.checkBoolean(a.mainMenuSingleExpand,'Session configuration - settings - mainMenuSingleExpand',b.DEFAULT_SESSION_CONFIG.settings.mainMenuSingleExpand);a.mainMenuSuggestedAutoExpand=b.checkBoolean(a.mainMenuSuggestedAutoExpand,'Session configuration - settings - mainMenuSuggestedAutoExpand',b.DEFAULT_SESSION_CONFIG.settings.mainMenuSuggestedAutoExpand);a.mainMenuStartFavoritesOpen=b.checkBoolean(a.mainMenuStartFavoritesOpen,'Session configuration - settings - mainMenuStartFavoritesOpen',b.DEFAULT_SESSION_CONFIG.settings.mainMenuStartFavoritesOpen);a.navSearchShowPath=b.checkBoolean(a.navSearchShowPath,'Session configuration - settings - navSearchShowPath',b.DEFAULT_SESSION_CONFIG.settings.navSearchShowPath);a.persistSelectedTheme=b.checkBoolean(a.persistSelectedTheme,'Session configuration - settings - persistSelectedTheme',b.DEFAULT_SESSION_CONFIG.settings.persistSelectedTheme);if(!a.notifications){a.notifications=b.DEFAULT_SESSION_CONFIG.settings.notifications}else {a.notifications.enabled=b.checkBoolean(a.notifications.enabled,'Session configuration - settings - notifications - enabled',b.DEFAULT_SESSION_CONFIG.settings.notifications.enabled);a.notifications.maxHistory=b.checkInteger(a.notifications.maxHistory,'Session configuration - settings - notifications - maxHistory',b.DEFAULT_SESSION_CONFIG.settings.notifications.maxHistory);a.notifications.clearBadgeOnActivate=b.checkBoolean(a.notifications.clearBadgeOnActivate,'Session configuration - settings - notifications - clearBadgeOnActivate',b.DEFAULT_SESSION_CONFIG.settings.notifications.clearBadgeOnActivate);a.notifications.sources=b.checkArray(a.notifications.sources,'Session configuration - settings - notifications - sources')}if(!a.favorites||Ext.isArray(a.favorites)||Ext.isString(a.favorites)){a.favorites={favoriteItems:a.favorites,allowItemRename:!0,depthLimit:0}}else {if(Ext.isObject(a.favorites)){if(a.favorites.depthLimit&&a.favorites.depthLimit>2){ABP.util.Logger.logWarn('favorites.depthLimit must be equal to 0, 1 or 2. Setting default value of 0 (unlimited folder depth)');a.favorites.depthLimit=0}}}if(!a.rightPane){a.rightPane=b.DEFAULT_SESSION_CONFIG.settings.rightPane}if(a.enableSearch){if(!a.searchInfo){ABP.util.Logger.logError('Session configuration missing searchInfo element, using default searchInfo configuration.');a.searchInfo=b.DEFAULT_SESSION_CONFIG.settings.searchInfo}else {a.searchInfo=b.checkArray(a.searchInfo,'Session configuration - settings - searchInfo')}a.defaultSearch=b.checkString(a.defaultSearch,b.DEFAULT_SESSION_CONFIG.settings.defaultSearch)}if(a.settingsPage){if(a.settingsPage.enableUser!==undefined){d=a.settingsPage.enableUser}else {if(a.enableUser!==undefined){d=a.enableUser}else {d=a.settingsPage.enableUser}}a.settingsPage.enableUser=b.checkBoolean(d,'Session configuration - settings - settingsPage - enableUser',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableUser);if(a.settingsPage.enableHeadlinesManager!==undefined){d=a.settingsPage.enableHeadlinesManager}else {if(a.enableHeadlinesManager!==undefined){d=a.enableHeadlinesManager}else {d=a.settingsPage.enableHeadlinesManager}}a.settingsPage.enableHeadlinesManager=b.checkBoolean(d,'Session configuration - settings - settingsPage - enableHeadlinesManager',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableHeadlinesManager);if(a.settingsPage.enableHelp!==undefined){d=a.settingsPage.enableHelp}else {if(a.enableHelp!==undefined){d=a.enableHelp}else {d=a.settingsPage.enableHelp}}a.settingsPage.enableHelp=b.checkBoolean(d,'Session configuration - settings - settingsPage - enableHelp',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableHelp);if(a.settingsPage.enableAbout!==undefined){d=a.settingsPage.enableAbout}else {if(a.enableAbout!==undefined){d=a.enableAbout}else {d=a.settingsPage.enableAbout}}a.settingsPage.enableAbout=b.checkBoolean(d,'Session configuration - settings - settingsPage - enableAbout',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableAbout);if(a.settingsPage.enableSignOff!==undefined){d=a.settingsPage.enableSignOff}else {if(a.enableSignOff!==undefined){d=a.enableSignOff}else {d=a.settingsPage.enableSignOff}}a.settingsPage.enableSignOff=b.checkBoolean(d,'Session configuration - settings - settingsPage - enableSignOff',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableSignOff);if(a.settingsPage.enableLoggerView!==undefined){d=a.settingsPage.enableLoggerView}else {if(a.enableLoggerView!==undefined){d=a.enableLoggerView}else {d=a.settingsPage.enableLoggerView}}a.settingsPage.enableLoggerView=b.checkBoolean(d,'Session configuration - settings - settingsPage - enableLoggerView',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableLoggerView);if(a.settingsPage.enableLanguages!==undefined){d=a.settingsPage.enableLanguages}else {if(a.enableLanguages!==undefined){d=a.enableLanguages}else {d=a.settingsPage.enableLanguages}}a.settingsPage.enableLanguages=b.checkBoolean(d,'Session configuration - settings - settingsPage - enableLanguages',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableLanguages);if(a.settingsPage.showSessionTimer!==undefined){d=a.settingsPage.showSessionTimer}else {if(a.showSessionTimer!==undefined){d=a.showSessionTimer}else {d=a.settingsPage.showSessionTimer}}a.settingsPage.showSessionTimer=b.checkBoolean(d,'Session configuration - settings - settingsPage - showSessionTimer',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.showSessionTimer);if(a.settingsPage.showEnvironment!==undefined){d=a.settingsPage.showEnvironment}else {if(a.showEnvironment!==undefined){d=a.showEnvironment}else {d=a.settingsPage.showEnvironment}}a.settingsPage.showEnvironment=b.checkBoolean(d,'Session configuration - settings - settingsPage - showEnvironment',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.showEnvironment)}else {a.settingsPage={};a.settingsPage.enableUser=b.checkBoolean(a.enableUser,'Session configuration - settings - settingsPage - enableUser',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableUser);a.settingsPage.enableHelp=b.checkBoolean(a.enableHelp,'Session configuration - settings - settingsPage - enableHelp',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableHelp);a.settingsPage.enableAbout=b.checkBoolean(a.enableAbout,'Session configuration - settings - settingsPage - enableAbout',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableAbout);a.settingsPage.enableSignOff=b.checkBoolean(a.enableSignOff,'Session configuration - settings - settingsPage - enableSignOff',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableSignOff);a.settingsPage.enableLoggerView=b.checkBoolean(a.enableLoggerView,'Session configuration - settings - settingsPage - enableLoggerView',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableLoggerView);a.settingsPage.enableLanguages=b.checkBoolean(a.enableLanguages,'Session configuration - settings - settingsPage - enableLanguages',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.enableLanguages);a.settingsPage.showSessionTimer=b.checkBoolean(a.showSessionTimer,'Session configuration - settings - settingsPage - showSessionTimer',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.showSessionTimer);a.settingsPage.showEnvironment=b.checkBoolean(a.showEnvironment,'Session configuration - settings - settingsPage - showEnvironment',b.DEFAULT_SESSION_CONFIG.settings.settingsPage.showEnvironment)}a.layoutPersistance=b.checkString(a.layoutPersistance,b.DEFAULT_SESSION_CONFIG.settings.layoutPersistance);if(!a.userConfig){ABP.util.Logger.logWarn('Session configuration missing settings.userConfig element, using default userConfig.');a.userConfig=b.DEFAULT_SESSION_CONFIG.settings.userConfig}else {a.userConfig.displayName=b.checkString(a.userConfig.displayName,b.DEFAULT_SESSION_CONFIG.settings.userConfig.displayName);if(a.userConfig.photo){ABP.util.LocalStorage.setForLoggedInUser('Photo',a.userConfig.photo)}}a.toolbarTitleShowBranding=a.toolbarTitleShowBranding===!1?!1:b.DEFAULT_SESSION_CONFIG.settings.toolbarTitleShowBranding}if(!c.navMenu){ABP.util.Logger.logError('Session configuration missing navMenu element, using default navMenu configuration.');c.navMenu=b.DEFAULT_SESSION_CONFIG.navMenu}else {c.navMenu=b.checkArray(c.navMenu,'Session configuration - navMenu');c.navMenu=b.processSessionConfigMenuItems(c.navMenu,'navMenu',!0)}if(!c.navMenuOrder){c.navMenuOrder=b.DEFAULT_SESSION_CONFIG.navMenuOrder}else {c.navMenuOrder=b.processNavMenuOrder(c.navMenuOrder)}if(!c.firstMenuAtTop){c.firstMenuAtTop=!1}if(!c.sessionMenu){ABP.util.Logger.logError('Session configuration missing sessionMenu element, using default sessionMenu configuration.');c.sessionMenu=b.DEFAULT_SESSION_CONFIG.sessionMenu}else {c.sessionMenu=b.checkArray(c.sessionMenu,'Session configuration - sessionMenu');c.sessionMenu=b.processSessionConfigMenuItems(c.sessionMenu,'sessionMenu',!1)}if(!c.toolbarMenu){ABP.util.Logger.logError('Session configuration missing toolbarMenu element, using default toolbarMenu configuration.');c.toolbarMenu=b.DEFAULT_SESSION_CONFIG.toolbarMenu}else {c.toolbarMenu=b.checkArray(c.toolbarMenu,'Session configuration - toolbarMenu');c.toolbarMenu=b.processSessionConfigMenuItems(c.toolbarMenu,'toolbarMenu',!1)}if(!c.toolbarTitleImageUrl){c.toolbarTitleImageUrl=b.DEFAULT_SESSION_CONFIG.toolbarTitleImageUrl}if(!c.enabledPlugins){ABP.util.Logger.logInfo('Session configuration missing enabledPlugins element, using default enabledPlugins configuration.');c.enabledPlugins=b.DEFAULT_SESSION_CONFIG.enabledPlugins}else {c.enabledPlugins=b.checkArray(c.enabledPlugins,'Session configuration - enabledPlugins')}if(!c.availableWidgets){ABP.util.Logger.logInfo('Session configuration missing availableWidgets element, using default availableWidgets configuration.');c.availableWidgets=b.DEFAULT_SESSION_CONFIG.availableWidgets}else {c.availableWidgets=b.checkArray(c.availableWidgets,'Session configuration - availableWidgets')}if(!c.languageResources){ABP.util.Logger.logInfo('Session configuration missing languageResources element, using default languageResources configuration.');c.languageResources=b.DEFAULT_SESSION_CONFIG.languageResources}else {c.languageResources=b.checkArray(c.languageResources,'Session configuration - languageResources')}if(c.offlineConfiguration){ABP.util.LocalStorage.setForLoggedInUser('OfflineConfiguration',Ext.JSON.encode(c.offlineConfiguration))}this.setSessionConfig(c)},isPreAuthenticated:function(){var a=this.getBootstrapConfig();if(a&&a.authenticatedUserName){return !0}return !1},isDesktop:function(){var a=navigator.userAgent.toLowerCase();var e=a.indexOf('mobile')>-1;var d=a.indexOf('android')>-1;var b=a.indexOf('windows nt')>-1&&a.indexOf('touch')>-1;var c=!0;if(!b){if(a.indexOf('windows nt')>-1){try{document.createEvent('TouchEvent');b=!0}catch(f){}}}if(e||d||b){c=!1}return c},getSessionId:function(){var c=this;var a=c._sessionId;var b;if(!Ext.isObject(a)){b=a}else {b=a.access_token}return b},getOAuthInfo:function(){return this._sessionId},getSessionURL:function(b){var d=this;var a=d._sessionId;var c=b||'&';if(Ext.isString(a)){return c+'sessionId='+a}else {return ''}},checkHostNameMatch:function(c){var b=window.location.hostname;var a=document.createElement('a');a.href=c;return a.hostname===b},injectConfig:function(a){a.settings.searchInfo.unshift({'id':'Global','name':'Global','appId':'Respondv6','event':'searchGlobal','minLength':0,'minLengthError':'Respond_Search_QuickSearchMinimumFilterLengthError'})},addPackageConfig:function(b,a){this._sessionConfig[b]=a},privates:{supportMultipleLanguages:function(a){if(!a){return !1}for(var b=0;b<a.length;b++){if(a[b].languages&&a[b].languages.length>1){return !0}}return !1},loadPersonalisation:function(){var a=this;a.DEFAULT_SESSION_CONFIG.settings.defaultSearch=ABP.util.LocalStorage.getForLoggedInUser('DefaultSearch')},getDisplayNameInitials:function(){var c=this,a=c.getSessionConfig().settings.userConfig.displayName,b=null;if(a){b=a.split(' ');return Ext.Array.map(b,function(a){return a[0]}).join('').substring(0,2).toUpperCase()}return null},processNavMenuOrder:function(b){var h=this;var e=!1;var c=h.DEFAULT_SESSION_CONFIG.navMenuOrder;var g=Object.keys(c).length;var d=0;var f=[];for(var a in c){if(b.hasOwnProperty(a)){if(Ext.isEmpty(b[a])){e=!0;continue}else {if(!Ext.isNumber(b[a])||b[a]>=g){ABP.util.Logger.logError('Nav menu order is incorrect, using default. '+b[a]+' is not a number or outside range');return c}else {if(f.indexOf(b[a])>-1){ABP.util.Logger.logError(Ext.String.format('Nav menu order is incorrect, using the default order. Duplicate position found for {0}:{1}',a,b[a]));return c}else {f.push(b[a]);if(b[a]>d){d=b[a]}}}}}else {b[a]=null}}if(e){for(var a in c){if(Ext.isEmpty(b[a])){d+=1;b[a]=d}}}return b},getDisplayName:function(){var a=this;if(a.getSessionConfig().settings.userConfig&&a.getSessionConfig().settings.userConfig.displayName){return a.getSessionConfig().settings.userConfig.displayName}return a.getUsername()},getProfilePicture:function(){var a=this;return a.getSessionConfig().settings.userConfig.photo},updateLanguage:function(a){ABP.util.Common.setPageLanguage(a)},canGlobalSearchToggle:function(){var a=this.getSessionConfig().settings.toggleableGlobalSearchField;if(Ext.isBoolean(a)){return a}else {return !0}}}});Ext.define('ABP.util.Constants',{statics:{BASE_FONT:'roboto, opensans, arial',RESPONSIVE_SNAPPOINT_WIDTH:510,REQUIRED_FIELD_LABEL_INCREMENT:10,GRAPH_COLORS:['#B23875','#00E5D3','#B488FA','#12AEED','#FF990A','#FF366C','#21C042','#4328B7'],CHART_COLORS:{victoria:'#4328B7',meadow:'#21C042',radicalRed:'#FF366C',california:'#FF990A',cerulean:'#12AEED',mauve:'#B488FA',neptune:'#00E5D3',viola:'#B23875',red:'#C90813'},AUTOMATION_CLASS_REGEX:/\b(a-[a-zA-Z0-9-]+)\b/gm,colors:{AlertRed:'#BD202E',WarningOrange:'#F7941E',ListHeader:'#969290',BodyBackground:'#E6E6E6',BodyColor:'#333333',Black:'#000000',White:'#FFFFFF',Blue:'#1284c7',Green:'#87B840',Text:'#33363a',Text:'#33363a',LightText:'#49575B',AxisText:'#59686C',LightGreen:'#8cc640'},badgePriority:{Alert:'#C90813',Warning:'#EC641F',Success:'#0B9B29',Info:'#30ACDE'},login:{loginAsUserLifetime:60},loadingLinesHtml:'<div class="abp-loadmask loading-bars"><div class="bars slim"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div> </div></div>'}});Ext.define('ABP.util.Currency',{singleton:!0,requires:['ABP.util.Logger'],removeCents:function(a){return Ext.util.Format.currency(a,Ext.util.Format.currencySign,0)},cents:function(b){var c=Ext.util.Format.currency(b);var a=c.split(Ext.util.Format.decimalSeparator);if(a.length>=2){return a[1]}else {return Ext.util.Format.decimalSeparator+'00'}},abvFormat:function(b){var a=Ext.util.Format.currency(b,Ext.util.Format.currencySign,0);if(a>100000){a=a.substr(0,a.length-4)+'k'}return a}});Ext.define('ABP.util.Date',{singleton:!0,requires:['ABP.util.Logger'],config:{formats:['Y-m-d H:i:s','Y-m-d','h:i:s','H:i:s','n/j/Y','l, F d, Y','l, F d, Y g:i:s A','F d','g:i A','g:i:s A','Y-m-d\\TH:i:s','Y-m-d H:i:sO','F, Y','c']},constructor:function(a){this.initConfig(a)},parse:function(a){if(Ext.isDate(a)){return a}if(Number.isInteger(a)){return new Date(a)}if(Ext.Number.parseInt(a)){return new Date(Ext.Number.parseInt(a))}var b=null;var d=this.getFormats();for(var c=0;c<d.length;c++){b=Ext.Date.parse(a,d[c]);if(b){return b}}return !1}});Ext.define('ABP.util.Discovery',{singleton:!0,discoverUrl:'https://apteancustomermanagement.azurewebsites.net/abp/discover',discover:function(b,a){var d='';if(b.indexOf('@')<0){d=b;b=''}a=a||Ext.emptyFn;var c=this;Ext.Ajax.request({url:c.discoverUrl,method:'GET',params:{org:d,email:b},success:function(f){var e=f.responseText;if(Ext.isString(e)){try{var d=Ext.decode(e);if(d){c.setServiceUrls(d);c.__redirectForCustomer(d)}}catch(g){a('Error processing returned discover response');return}}},failure:function(c){a(c.responseText)}})},discoverUserInfo:function(e,c,d,b){b=b||Ext.emptyFn;var a=this;Ext.Ajax.request({url:a.discoverUrl,method:'GET',params:{org:e,email:''},success:function(h){var f=h.responseText;if(Ext.isString(f)){try{var g=Ext.decode(f);if(g){a.__getWellKnownMetadata(g,function(f){a.__getAuthorizedUserInfo(f.userinfo_endpoint,c,d)})}}catch(i){window.location=document.location.origin+'/#error='+encodeURIComponent('Error processing returned discover response');return}}}})},privates:{setServiceUrls:function(a){Ext.Array.each(a.subscriptions,function(b){ABPServiceManager.setServiceUrl(b.product,b.endpoint)})},__getWellKnownMetadata:function(b,c){var a=b.authentication;b.serviceEndpoint='http://dga1app02comtech:8080/api/v1';ABP.util.LocalStorage.set('ServerUrl',b.serviceEndpoint);if(a){a=Ext.isArray(a)?a[0]:a;if(a.metadataUrl){Ext.Ajax.request({method:'GET',url:a.metadataUrl,success:function(e){var a=e.responseText;if(Ext.isString(a)){var d=Ext.decode(a);if(d){c(d)}}}})}}},__getAuthorizedUserInfo:function(c,b,a){var d=this;Ext.Ajax.request({method:'GET',url:c,headers:{'Authorization':'Bearer '+b},success:function(e){var d=e.responseText;if(Ext.isString(d)){var f=Ext.decode(d);if(a){a(f)}}}})},__redirectForCustomer:function(b){var c=this;var a=b.authentication;b.serviceEndpoint='http://dga1app02comtech:8080/api/v1';ABP.util.LocalStorage.set('ServerUrl',b.serviceEndpoint);if(a){a=Ext.isArray(a)?a[0]:a;if(a.metadataUrl){Ext.Ajax.request({method:'GET',url:a.metadataUrl,success:function(f){var d=f.responseText;if(Ext.isString(d)){var e=Ext.decode(d);if(e){c.__redirectForWellKnown(b,a,e)}}}})}}},__redirectForWellKnown:function(f,c,a){var e=a.scopes_supported.indexOf('openid')>=0;var d=a.scopes_supported.indexOf('profile')>=0;var b='openid';if(!a.scopes_supported.indexOf('openid')){}if(a.scopes_supported.indexOf('profile')>=0){b+=' profile'}window.location=a.authorization_endpoint+'?'+Ext.Object.toQueryString({response_type:'id_token',client_id:c.clientId,scope:b,redirect_uri:document.location.origin,nonce:ABP.util.Jwt.getNonce()})}}});Ext.define('ABP.util.Events',{singleton:!0,alternateClassName:'ABP.Events',signOut:'main_DestroySession',showSettings:'featureCanvas_showSetting',switchLanguage:'main_switchLanguage',setRoute:'container_setRoute',addDefaultLanguageStrings:'main_addDefaultLanguageStrings',updateLanguageStrings:'main_updateLanguageStrings',pendingChanges:'main_pendingChanges',menuToggle:'session_toggleMenu',menuShow:'session_openMenu',menuHide:'session_closeMenu',menuToggleNav:'mainMenu_toggleNav',menuEnableOption:'mainMenu_enableMenuOption',menuAddOption:'mainMenu_addMenuOption',menuRemoveOption:'mainMenu_removeMenuOption',menuUpdateCount:'mainMenu_updateMenuCount',menuAddRecent:'mainMenu_addRecent',menuAddFavorite:'mainMenu_addFavorite',menuRemoveFavorite:'mainMenu_removeFavorite',menuUpdateFavorites:'mainmenu_updateFavorites',favoritesUpdated:'favorites_updated',menuFocusFavorites:'mainmenu_focusFavorites',menuReplaceSuggested:'mainMenu_replaceSuggested',menuAddTreeItems:'mainMenu_addTreeOption',menuRemoveTreeItem:'mainMenu_removeTreeOption',toolbarSetTitle:'toolbar_setTitle',toolbarAddButton:'toolbar_addButton',toolbarRemoveButton:'toolbar_removeButton',toolbarOpenSearch:'toolbar_openSearch',rightPaneToggle:'rightPane_toggle',rightPaneToggleTab:'rightPane_toggleTab',rightPaneAddElement:'rightPane_addElement',rightPaneShowButton:'toolbar_setVisibilityRightPaneButton',rightPaneInitTab:'rightPane_initTab',rightPaneUpdateBadge:'toolbar_updateBadge',rightPaneIncrementBadge:'toolbar_incrementBadge',rightPaneDecrementBadge:'toolbar_decrementBadge',rightPaneClearBadge:'toolbar_clearBadge',notificationsAdd:'abp_notifications_add',notificationsRemove:'abp_notifications_remove',notificationsRead:'abp_notifications_read',notificationsUnread:'abp_notifications_unread',globalSearchSuggestions:'abp_search_suggestions',headlinesShow:'abp_headlines_show',headlinesHide:'abp_headlines_hide',thumbbarShow:'thumbbar_show',thumbbarHide:'thumbbar_hide',userProfileEdit:'user_profile_edit'});Ext.define('ABP.util.IdCreator',{singleton:!0,config:{currentId:0},constructor:function(a){this.initConfig(a)},getId:function(a){var b={appId:a.appId,type:a.type,activateApp:a.activateApp};if(a.type==='event'){b.event=a.event;b.eventArgs=a.eventArgs}else {if(a.type==='route'){b.hash=a.hash}}var c=this.serialize(b);var d=ABP.util.Sha256.sha256(c);return d},privates:{serialize:function(b){var d;var c='';for(var a in b){if(b[a]){d=typeof a;c+='['+d+':'+a+':'+b[a].toString()+']'}}return c}}});Ext.define('ABP.util.Jwt',{singleton:!0,isJwt:function(a){try{jwt_decode(a)}catch(b){return !1}return !0},getPayload:function(a){return jwt_decode(a)},getNonce:function(){var a=this.randomString(16);ABP.util.LocalStorage.set('nonce',a);return a},validateNonce:function(b){var a=!1;if(ABP.util.LocalStorage.get('nonce')===b){a=!0}ABP.util.LocalStorage.set('nonce','');return a},privates:{randomString:function(a){var b='0123456789ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvwxyz-._';result='';while(a>0){var d=new Uint8Array(16);var c=window.crypto.getRandomValues(d);c.forEach(function(c){if(a==0){return}if(c<b.length){result+=b[c];a--}})}return result}}});Ext.define('ABP.util.Keyboard',{singleton:!0,focus:function(c){var a=Ext.query(c,!1);if(a&&a.length>0){var b=Ext.getCmp(a[0].id);if(b){Ext.getCmp(b.id).focus(50);return !0}else {for(i=0;i<a.length;i++){if(!a[i].hasCls('x-tab-guard')){if(a[i].focus){a[i].focus();return !0}}}}}return !1}});Ext.define('ABP.util.LocalStorage',{singleton:!0,prefix:'ABP_',userToken:'_Env-\\[(.*)]_User-\\[(.*?)]__',userToken3:'_Env-(.*)_User-(.*?)__',usernameKey:'Username',storageVersion:'4',storageVersionKey:'LocalStorageVersion',storageVersionUserKey:'LocalStorageUserVersion',constructor:function(){this.upgradeStorage()},get:function(b){if(this.localStorageAvailable()){var a=localStorage.getItem(this.prefix+b);return a}return ''},set:function(b,a){if(this.localStorageAvailable()){localStorage.setItem(this.prefix+b,a)}},remove:function(a){if(this.localStorageAvailable()){localStorage.removeItem(this.prefix+a)}},contains:function(a){if(this.localStorageAvailable()){return localStorage.getItem(this.prefix+a)===null?!1:!0}return !1},getForLoggedInUser:function(b){if(this.localStorageAvailable()){var a=localStorage.getItem(this.getLoggedInUserStoragePrefix()+b);return a}return ''},setForLoggedInUser:function(b,a){if(this.localStorageAvailable()){localStorage.setItem(this.getLoggedInUserStoragePrefix()+b,a)}},removeForLoggedInUser:function(a){if(this.localStorageAvailable()){localStorage.removeItem(this.getLoggedInUserStoragePrefix()+a)}},containsForLoggedInUser:function(a){if(this.localStorageAvailable()){return localStorage.getItem(this.getLoggedInUserStoragePrefix()+a)===null?!1:!0}return !1},getForUser:function(c,b,d){if(this.localStorageAvailable()){var a=localStorage.getItem(this.getUserStoragePrefix(c,b)+d);return a}return ''},setForUser:function(c,b,d,a){if(this.localStorageAvailable()){localStorage.setItem(this.getUserStoragePrefix(c,b)+d,a)}},removeForUser:function(b,a,c){if(this.localStorageAvailable()){localStorage.removeItem(this.getUserStoragePrefix(b,a)+c)}},removeAllForUser:function(e,d){if(this.localStorageAvailable()){var c=this.getUserStoragePrefix(e,d);for(var a=0;a<localStorage.length;a++){var b=localStorage.key(a);if(b&&Ext.String.startsWith(b,c)){localStorage.removeItem(b);a--}}}},containsForUser:function(b,a,c){if(this.localStorageAvailable()){return localStorage.getItem(this.getUserStoragePrefix(b,a)+c)===null?!1:!0}return !1},getUserData:function(g){var a;if(this.localStorageAvailable()){var i=Ext.data.StoreManager.lookup('ABPEnvironmentStore');var n=new RegExp('^'+this.prefix+this.userToken);for(var e=0;e<localStorage.length;e++){var m=localStorage.key(e);var d=m.match(n);if(d){var f=d[1];var b=d[2];if(b){b=b.toLowerCase()}var j=d.input.replace(d[0],'');var h=localStorage.getItem(localStorage.key(e));if(!a){a=[]}var k=!1;for(var c=0;c<a.length;c++){if(a[c].env===f&&a[c].user===b){k=!0;break}}if(!k){if(i){var l=i.getById(f);if(!l&&!g){continue}}else {if(!g){continue}}a.push({env:f,user:b,username:b,data:{}})}if(j==this.usernameKey){a[c].username=h}else {a[c].data[j]=h}}}return a}return a},upgradeUserStorage:function(){try{if(this.localStorageAvailable()){var a=this.get(this.storageVersionUserKey);if(!a||a!=this.storageVersion){if(!a){var b=this.get('ABPActionCenter_Layout');if(b!==null){this.setForLoggedInUser('ABPActionCenter_Layout',b);this.remove('ABPActionCenter_Layout')}}this.set(this.storageVersionUserKey,this.storageVersion)}}}catch(c){console.log(c)}},localStorageWritable:function(){try{if(this.localStorageAvailable(!0)){localStorage.setItem(this.prefix+'WriteTest','test');localStorage.removeItem(this.prefix+'WriteTest');return !0}}catch(b){console.log(b);return !1}return !1},privates:{localStorageAvailable:function(a){try{return window.localStorage!==undefined&&window.localStorage!==null}catch(b){if(a){console.log(b)}return !1}},getLoggedInUserStoragePrefix:function(){var b=ABP.util.Config.getEnvironment()||'';var a=ABP.util.Config.getUsername()||'';return this.prefix+this.getUserToken(b,a)},getUserStoragePrefix:function(b,a){return this.prefix+this.getUserToken(b,a)},getUserToken:function(b,a){if(a){a=a.toLowerCase()}var c=this.userToken.replace(new RegExp('\\\\','g'),'').replace('\\[','[').replace('(.*)',b?b:'_Anonymous_').replace('(.*?)',a?a:'_Anonymous_');return c},upgradeStorage:function(){try{if(this.localStorageAvailable()){var d=this.get(this.storageVersionKey);if(!d||d!=this.storageVersion){if(!d){}else {if(d=='3'){var b=[];var j=new RegExp('^'+this.prefix+this.userToken3);for(var a=0;a<localStorage.length;a++){var f=localStorage.key(a);var c=f.match(j);if(c){var i=c[1];var e=c[2];if(e){e=e.toLowerCase()}var h=c.input.replace(c[0],'');var g=localStorage.getItem(localStorage.key(a));b.push({env:i,user:e,itemKey:h,itemValue:g,oldKey:f})}}for(var a=0;a<b.length;a++){this.setForUser(b[a].env,b[a].user,b[a].itemKey,b[a].itemValue);localStorage.removeItem(b[a].oldKey)}}}this.set(this.storageVersionKey,this.storageVersion)}}}catch(k){console.log(k)}}}});Ext.define('ABP.util.Msal',{singleton:!0,instance:null,config:null,enabled:!1,authStore:null,requiresLogin:!1,redirectUri:null,interactionRedirectUri:null,config:{stopAtLoginPage:!1},constructor:function(){try{if(!window['Msal']){ABPLogger.logDebug('Microsoft Authentication Library was not present.');return}}catch(b){ABPLogger.logDebug('Microsoft Authentication Library was not present.')}var a=this.getAuthStore();a.load();a.on('load',this.authStoreLoaded,this)},signIn:function(){var a=this.getLoginRequest(!0);this.instance.loginRedirect(a)},signOut:function(){if(!this.enabled){return}this.instance.logout()},getToken:function(){var b=this;var a=this.instance;if(!a.getAccount()){b.signIn();return}var c=this.getLoginRequest();if(!ABPAuthManager.getToken()){b.requiresLogin=!0}return a.acquireTokenSilent(c).then(ABP.util.Msal.handleTokenResponse)['catch'](ABP.util.Msal.handleTokenFailure)},formatUri:function(a){if(a.indexOf('index.html')>-1){a=a.split('index.html')[0]}if(a.slice(-1)!=='/'){a+='/'}return a},handleTokenResponse:function(a){var e=ABP.util.Msal;var b;if(!Ext.isEmpty(a.accessToken)){b=a.accessToken}ABPAuthManager.authenticationSuccess(b);if(e.requiresLogin){var c=Ext.getApplication();if(c){var d=c.getMainView().getViewModel();if(d.get('bootstrapped')){console.log('TA/DEBUG - MSAL - firing main_tokenAuthenticate');Ext.fireEvent('main_tokenAuthenticate')}}}},handleTokenFailure:function(a){var b=ABP.util.Msal;if(a.message&&a.message.startsWith('AADB2C90205')){ABPLogger.logWarn('Failed token acquisition',a)}else {if(b.requiresInteraction(a.errorCode)){return ABP.util.Msal.signIn()}else {b.instance.acquireTokenRedirect(b.getLoginRequest())}}},getAuthStore:function(){if(this.authStore){return this.authStore}var a=Ext.data.StoreManager.lookup('ApplicationAuthenticationStore');if(!a){a=Ext.create('ABP.store.ApplicationAuthenticationStore')}this.authStore=a;return a},authStoreLoaded:function(c){var a=ABP.util.Msal;c.un('load',this.authStoreLoaded,this);var b=a.getMsalConfig(c);if(b){a.enabled=!0;a.instance=new Msal.UserAgentApplication(b);a.instance.handleRedirectCallback(a.redirectCallback);if(!a.authenticationSuccess){a.getToken()}}},getLoginRequest:function(d){var c=ABP.util.Msal;var a=c.config;if(a){var b={scopes:a.b2cScopes,redirectUri:c.getRedirectUri(d)};if(a.extraQueryParameters){b.extraQueryParameters=a.extraQueryParameters}else {if(a.domainHint){b.extraQueryParameters={domain_hint:a.domainHint}}}return b}},getRedirectUri:function(c){var a=ABP.util.Msal;if(c){if(!Ext.isEmpty(a.interactionRedirectUri)){return a.interactionRedirectUri}}if(!Ext.isEmpty(a.redirectUri)){return a.redirectUri}var b=a.instance.getRedirectUri();a.interactionRedirectUri=b;if(b.indexOf('index.html')>-1){b=b.split('index.html')[0]}if(b.slice(-1)!=='/'){b+='/'}a.redirectUri=b+'auth.html';return c===!0?a.interactionRedirectUri:a.redirectUri},getMsalConfig:function(e){var d=this;var b;var c=e.getAt(0);if(c){var a=c.getData();d.config=a;b={auth:{clientId:a.clientId,authority:a.authority,validateAuthority:!1},cache:{cacheLocation:a.cacheLocation||'localStorage',storeAuthStateInCookie:a.storeAuthStateInCookie||!0}};if(a.postLogoutRedirectUri){if(Ext.isString(a.postLogoutRedirectUri)){b.auth.postLogoutRedirectUri=a.postLogoutRedirectUri}if(Ext.isBoolean(a.postLogoutRedirectUri)){b.auth.postLogoutRedirectUri=d.formatUri(window.location.href)+'signout.html'}}}return b},redirectCallback:function(e,d){var a=ABP.util.Msal;var c=a.getAuthStore();if(c){c.un('load',a.authStoreLoaded,a)}var b=d.accessToken;if(!b&&d.idToken){a.requiresLogin=!0;a.getToken();return}if(b){ABPLogger.logDebug('Setting token from redirectCallback '+b);ABPAuthManager.authenticationSuccess(b);a.authenticationSuccess=!0}},requiresInteraction:function(a){if(!a||!a.length){return !1}return a==='consent_required'||a==='interaction_required'||a==='login_required'},getStopAtLoginPage:function(){var a=ABP.Config.getBootstrapConfig();if(a){return ABP.util.Common.getObjectProperty(a,'settings.b2cShowLogin')}return this.getB2cShowLogin()}});Ext.define('ABP.util.PluginManager',{singleton:!0,requires:['ABP.util.Logger'],config:{registeredPlugins:{},activePlugins:{}},constructor:function(a){this.initConfig(a)},getActivePluginsImplementingFunction:function(e){var b=this.getActivePlugins(),d=[],a,c;for(a in b){if(b.hasOwnProperty(a)){c=b[a];if(c[e]){d.push({plugin:c,pluginId:a})}}}return d},getPluginClass:function(a){return this.getRegisteredPlugins()[a]},getPluginInstance:function(c){var b=this.getActivePlugins()[c];if(!b){var a=this.getPluginClass(c);if(a){try{b=Ext.create(a);this.getActivePlugins()[c]=b;ABP.util.Logger.logTrace('Initialized plugin: '+a)}catch(d){ABP.util.Logger.logError('Error initializing plugin: '+a+' : '+d.message)}}}return b},getAllPluginConfigs:function(){var c=this.getRegisteredPlugins(),e=[],a,b,d;for(a in c){if(c.hasOwnProperty(a)){b=c[a];d=Ext.ClassManager.get(b);if(!d){ABP.util.Logger.logWarn('no class found for '+b)}else {e.push({pluginName:a,config:d.prototype.config})}}}return e},getMergedPluginConfigs:function(d){var b=[],e=this.getAllPluginConfigs(),c,a;if(d==='aboutInfo'){b.push(ABP.util.Common.getABPAboutData())}Ext.each(e,function(e){a=e.config[d];if(a){if(a instanceof Array){for(c=0;c<a.length;c++){b.push(Ext.clone(a[c]))}}else {b.push(Ext.clone(a))}}});return b},initializeAllPlugins:function(){var a;ABP.util.Logger.logTrace('Initializing all plugins');var b=ABP.util.PluginManager.getRegisteredPlugins();for(a in b){if(b.hasOwnProperty(a)){this.getPluginInstance(a)}}},register:function(b,a){ABP.util.Logger.logTrace('Registering Plugin: '+b+' '+a);this.getRegisteredPlugins()[b]=a}});Ext.define('ABP.util.RelativeTime',{singleton:!0,requires:['ABP.util.Logger','ABP.util.Date'],config:{refreshInterval:60,itemSelector:'.abp-time-ago',offsets:{now:45,minuteOffset:120,xminutes:50,oneHour:80,xHours:24,oneDay:48,xDays:30,oneMonth:60,xMonths:365,oneYear:2},toolTipFormat:'l jS F, Y, H:i'},updateRunner:null,updateTask:null,constructor:function(b){var a=this;a.initConfig(b);a.updateRunner=new Ext.util.TaskRunner();a.updateTask=a.updateRunner.newTask({run:a.updateElements,interval:a.getRefreshInterval()*1000,scope:a});a.start()},start:function(){var a=this;a.updateTask.start()},stop:function(){var a=this;a.updateTask.stop()},format:function(c,f){if(Ext.isString(c)){var n=c;c=new Date(c);if(c instanceof Date&&isNaN(c)){ABP.util.Logger.logWarn('Could not create relative time, failed to parse value: '+n);return}}if(!isNaN(parseInt(c,10))){c=parseInt(c,10)}f=typeof f!=='undefined'?f:!1;var o=new Date(c);var q=this;var p=new Date();var l=Ext.Date.diff(o,p,Ext.Date.SECOND);var d=q.getOffsets();var a='abp_time_';if(f){a='abp_short_time_'}var j=ABP.util.Common.geti18nString(a+'prefix_ago');var k=ABP.util.Common.geti18nString(a+'suffix_ago');if(l<0){j=ABP.util.Common.geti18nString(a+'prefix_from_now');k=ABP.util.Common.geti18nString(a+'suffix_from_now')}var i=Math.abs(l);var g=Math.floor(i/60);var h=Math.floor(g/60);var e=Math.floor(h/24);var m=Math.floor(e/365);var b='';if(i<d.now){b=ABP.util.Common.geti18nString(a+'seconds')}else {if(i<d.minuteOffset){b=ABP.util.Common.geti18nString(a+'minute')}else {if(g<d.xminutes){b=Ext.String.format(ABP.util.Common.geti18nString(a+'minutes'),Math.round(g))}else {if(g<d.oneHour){b=ABP.util.Common.geti18nString(a+'hour')}else {if(h<d.xHours){b=Ext.String.format(ABP.util.Common.geti18nString(a+'hours'),Math.round(h))}else {if(h<d.oneDay){b=ABP.util.Common.geti18nString(a+'day')}else {if(e<d.xDays){b=Ext.String.format(ABP.util.Common.geti18nString(a+'days'),Math.floor(e))}else {if(e<d.oneMonth){b=ABP.util.Common.geti18nString(a+'month')}else {if(e<d.xMonths){b=Ext.String.format(ABP.util.Common.geti18nString(a+'months'),Math.floor(e/30))}else {if(m<d.oneYear){b=ABP.util.Common.geti18nString(a+'year')}else {b=Ext.String.format(ABP.util.Common.geti18nString(a+'years'),Math.floor(m))}}}}}}}}}}if(j.length>0){b=j+' '+b}if(k.length>0){b=b+' '+k}return Ext.String.htmlEncode(b)},formatTooltip:function(a){if(!isNaN(parseInt(a,10))){a=parseInt(a,10)}var b=new Date(a);return Ext.Date.format(b,this.getToolTipFormat())},privates:{updateElements:function(){var a=this;var b=Ext.dom.Element.query(a.getItemSelector());b.forEach(function(b){if(b.dataset&&b.dataset.time){b.innerText=a.format(b.dataset.time)}})}}});Ext.apply(Ext.util.Format,{formatRelativeTime:function(a){return ABP.util.RelativeTime.format(a)},formatRelativeShortTime:function(a){return ABP.util.RelativeTime.format(a,!0)},formatRelativeTool:function(a){return ABP.util.RelativeTime.formatTooltip(a)}});Ext.define('ABP.util.ServiceManager',{alternateClassName:'ABPServiceManager',singleton:!0,services:new Ext.util.Collection(),registerService:function(a){var b=this;if(!a){return}a.usesB2cToken=Ext.isBoolean(a.usesB2cToken)?a.usesB2cToken:!0;b.services.add({id:a.name,service:a});if(a.usesB2cToken===!1&&Ext.isEmpty(ABPAuthManager.getServiceToken())){ABPAuthManager.requestTokenForService(a.name)}},getTokenForService:function(a){var b=this;var a=b.getService(a);if(a&&a.usesB2cToken){return ABPAuthManager.getToken()}else {return ABPAuthManager.getTokenForAudience(a)}},getService:function(a){var c=this;var b=c.services.get(a);if(b){return b.service}else {ABPLogger.logDebug('Could not find service '+a);return null}},getServiceUrl:function(b){var c=this;var a=c.getService(b);if(a){return a.url}return null},setServiceUrl:function(b,c){var d=this;var a=d.getService(b);if(a){a.url=c}},isServiceCall:function(a){return Ext.isEmpty(this.matchEndpointToService(a))},matchEndpointToService:function(b){var c=this;var a;c.services.each(function(d){var c=d.service;if(b.indexOf(c.url)>-1){a=c.name}});return a},getRegisteredServices:function(){var b=this;var a=[];b.services.eachKey(function(b){a.push(b)});return a}});Ext.define('ABP.util.SessionStorage',{singleton:!0,prefix:'ABP_',get:function(b){if(this.sessionStorageAvailable()){var a=sessionStorage.getItem(this.prefix+b);return a}return ''},set:function(b,a){if(this.sessionStorageAvailable()){sessionStorage.setItem(this.prefix+b,a)}},remove:function(a){if(this.sessionStorageAvailable()){sessionStorage.removeItem(this.prefix+a)}},contains:function(a){if(this.sessionStorageAvailable()){return sessionStorage.getItem(this.prefix+a)===null?!1:!0}return !1},privates:{sessionStorageAvailable:function(a){try{return window.sessionStorage!==undefined&&window.sessionStorage!==null}catch(b){if(a){console.log(b)}return !1}}}});Ext.define('ABP.util.Sha256',{singleton:!0,sha256:function(a,b){try{if(b){a=b+a}return SHA256(a)}catch(c){ABP.util.Logger.logWarn(Ext.String.format('Failed to hash value, it will be stored in plain text. Clear browser cache to remove this value. "{0}".',c));return a}},generateSaltForUser:function(b,a){if(Ext.isEmpty(b)||Ext.isEmpty(a)){return ''}return b+a}});Ext.define('ABP.util.Stopwatch',{singleton:!0,startTime:undefined,stopTime:undefined,laps:[],isRunning:!1,trace:!0,info:'',start:function(a){if(this.isRunning){return}this.laps=[];this.startTime=new Date();this.stopTime=null;this.isRunning=!0;this.info=a?a:''},stop:function(){if(!this.isRunning){return}this.stopTime=new Date();this.isRunning=!1;if(this.trace){ABP.util.Logger.logTrace('[STOP] '+this.info+' Elapsed Time(ms): '+this.elapsed())}return this.elapsed()},reset:function(){this.laps=[];this.startTime=this.isRunning?new Date():null;this.stopTime=null},restart:function(){this.isRunning=!0;this.reset()},elapsed:function(){return (this.isRunning?new Date():this.stopTime)-this.startTime},lap:function(a){if(!a){a='Lap '+this.laps.length}this.laps.push({name:a,elapsed:this.elapsed});if(this.trace){ABP.util.Logger.logTrace('['+a+'] '+this.elapsed()+'ms')}}});Ext.define('ABP.util.String',{singleton:!0,requires:['ABP.util.Logger'],config:{seperator:','},constructor:function(a){this.initConfig(a)},toArray:function(b){var a;if(b){a=b.split(this.config.seperator)}return a||[]},makeHumanReadable:function(d,b,c){var a=d.split(b||' ');a=a.map(function capitalize(a){return a.slice(0,1).toUpperCase()+a.slice(1)});return a.join(c||' ')},capitalize:function(a){return a.slice(0,1).toUpperCase()+a.slice(1)},limitLength:function(b,c){if(!c){return b}var a=b;if(b.length>c){a=b.slice(0,c);if(a[a.length-1]===' '){a=a.slice(0,-1)}a+='...'}return a},parseInt:function(c,a){a=a?a:10;var b=parseInt(c,a);if(Ext.isNumber(b)){return b}else {return !1}},isVowel:function(a){var b=['a','A','e','E','i','I','o','O','u','U'];return b.indexOf(a)>-1}});Ext.define('ABP.util.UserActivityMonitor',{singleton:!0,ui:null,runner:null,task:null,lastActive:null,running:!1,verbose:!1,interval:1000*1,maxInactive:1000*60*0,warning:1000*30*0,init:function(a){if(!a){a={}}this.maxInactive=1000*60*ABP.util.Config.getSessionConfig().settings.inactiveTimeout;this.warning=1000*60*ABP.util.Config.getSessionConfig().settings.inactiveWarningTime;if(this.maxInactive<=0){return}Ext.apply(this,a,{runner:new Ext.util.TaskRunner(),ui:Ext.getBody(),task:{run:this.monitorUI,interval:this.interval,scope:this}});this.running=!0},isRunning:function(){return this.running},start:function(){var a=this;if(!a.isRunning()){return !1}a.ui.on('keydown',this.onUpdateActivity,this);a.ui.on('tap',this.onUpdateActivity,this);a.ui.on('swipe',this.onUpdateActivity,this);a.ui.on('pinch',this.onUpdateActivity,this);a.lastActive=new Date();a.logTrace('User activity monitor has been started.');a.runner.start(this.task)},stop:function(){var a=this;if(!a.isRunning()){return !1}a.runner.stop(this.task);a.lastActive=null;a.ui.un('keydown',this.onUpdateActivity);a.ui.un('tap',this.onUpdateActivity);a.ui.un('swipe',this.onUpdateActivity);a.ui.un('pinch',this.onUpdateActivity);a.logTrace('User activity monitor has been stopped.')},onUpdateActivity:function(){this.lastActive=new Date();this.logTrace('User activity detected ('+this.lastActive+')')},monitorUI:function(){var j=new Date(),b=j-this.lastActive;var f=this;var a=Ext.getApplication().getController('ABP.view.ApplicationController');var d=Math.round((this.maxInactive-b)/1000);var c=new Date(null);c.setSeconds(d);if(b>=this.warning&&this.warning>0){if(d>=0){var e=function(b){if(b===!0){a.fireEvent('onInactive');a.fireEvent('main_fireAppEvent','container','signout',['user init',!1])}else {a.fireEvent('retain_session');f.start()}};var g=ABP.util.Common.geti18nString('inactive_timeout');var i=ABP.util.Common.geti18nString('timeout_title');ABP.view.base.popUp.PopUp.customPopup(g+c.toISOString().substr(14,5),i,'?',[{text:'session_retain',args:!1},{text:'session_signoff',args:!0}],e)}}if(b>=this.maxInactive){this.logInfo('MAXIMUM INACTIVE TIME HAS BEEN REACHED');this.stop();a.fireEvent('onInactive');var h=ABP.util.Common.geti18nString('session_timeout');a.fireEvent('main_fireAppEvent','container','signout',[h,!1])}else {this.logTrace('CURRENTLY INACTIVE FOR '+b+' (ms)')}},privates:{logTrace:function(a){if(this.verbose){ABP.util.Logger.logTrace(a)}},logInfo:function(a){ABP.util.Logger.logInfo(a)}}});Ext.define('ABP.util.Version',{singleton:!0,config:{version:'3.0.0',build:'0001'},constructor:function(a){this.initConfig(a)}});Ext.define('ABP.util.filters.text.TextFilter',{itemId:'StringFilter',config:{searchText:'',searchTerms:[],matchAllValues:!1,minLengthThreshold:2,searchFields:[],weighting:1},defaultSearchFieldConfig:{name:'',useSoundEx:!0},matchingConfig:{isMatch:!1,isExactMatch:!1,wordPosition:!1,charPosition:!1,soundsLike:!1},constructor:function(a){if(Ext.isArray(a.searchFields)){Ext.Array.each(a.searchFields,function(c,d,b){b[d]=Ext.apply({},c||{},this.defaultSearchFieldConfig)})}a.searchText=a.searchText.toLowerCase().trim();a.weighting=1/a.searchText.split(' ').length;a.searchTerms=a.searchText.split(' ');this.initConfig(a);return this},filter:function(d){var f=this.getSearchText();if(!f){return !0}var g=this.getMinLengthThreshold();if(f.length<g){return !0}var h=this,b=[],c=null;var e=this.config.searchTerms.length;for(var a=0;a<e;a++){if(this.config.searchTerms[a].length>=g||a>0){if(this.getMatchAllValues()){c=this._itemHasMatch(d,this.config.searchTerms[a],a)}else {c=this._itemHasMatch(d,this.config.searchTerms[a],a)}if(c.isMatch){b.push(c)}}}if(this.getMatchAllValues()){if(b.length!=e){b=[]}}d.data._relevance=h._calculateAccuracy(b);return d.data._relevance>0},calculateRelevancy:function(d){var h=this;var f=this.getSearchText();if(!f){return 0}var g=this.getMinLengthThreshold();if(f.length<g){return 0}var b=[];var c=null;var e=this.config.searchTerms.length;for(var a=0;a<e;a++){if(this.config.searchTerms[a].length>=g||a>0){if(this.getMatchAllValues()){c=this._itemHasMatch(d,this.config.searchTerms[a],a)}else {c=this._itemHasMatch(d,this.config.searchTerms[a],a)}if(c.isMatch){b.push(c)}}}if(this.getMatchAllValues()){if(b.length!=e){b=[]}}d.data._relevance=h._calculateAccuracy(b);return d.data._relevance},_calculateAccuracy:function(b){if(b.length===0){return 0}var a=0;var c=0;b.forEach(function(c){if(c.isExactMatch){a+=20}if(c.wordPosition){a+=6}if(c.charPosition){a+=10}if(c.soundsLike){a+=3}});return a},_itemHasMatch:function(e,c,d){var b=this;var a=b._createMatch();Ext.Array.each(this.getSearchFields(),function(g,h){var f=e.get(g.name);match=b._contains(f,c,d);if(!match.isMatch&&g.useSoundEx){match=b.soundsLike(f,c,match)}a.isMatch|=match.isMatch;a.isExactMatch|=match.isExactMatch;a.wordPosition|=match.wordPosition;a.charPosition|=match.charPosition;a.soundsLike|=match.soundsLike});return a},_createMatch:function(a){return Ext.apply({},a||{},this.matchingConfig)},_contains:function(a,f,g){var h=this,b=h._createMatch();if(!a||Ext.isObject(a)){return b}a=a.toLowerCase();if(a===this.getSearchText()){b.isExactMatch=!0}var d=a.split(' ');for(var c=0;c<d.length;c++){var e=d[c].indexOf(f);if(e>=0){b.isMatch=!0;b.wordPosition=g===c;b.charPosition=e===0}}return b},characterFilter:function(d){var f=this.getSearchText();if(!f){return !0}var g=0;if(f.length<g){return !0}var h=this,b=[],c=null;var e=this.config.searchTerms.length;for(var a=0;a<e;a++){if(this.config.searchTerms[a].length>=g||a>0){if(this.getMatchAllValues()){c=this._itemHasMatch(d,this.config.searchTerms[a],a)}else {c=this._itemHasMatch(d,this.config.searchTerms[a],a)}if(c.isMatch){b.push(c)}}}if(this.getMatchAllValues()){if(b.length!=e){b=[]}}d.data._relevance=h._calculateAccuracy(b);return d.data._relevance>0},privates:{soundsLike:function(b,f){var g=this,a=g._createMatch();if(!b||Ext.isObject(b)){return a}var c=this.getSoundEx(f);var e=this.getProminentPart(c);parts=b.split(' ');for(i=0;i<parts.length;i++){var d=this.getSoundEx(parts[i]);if(d===c){a.isMatch=!0;a.soundsLike=!0}if(Ext.String.startsWith(d,e)){a.isMatch=!0;a.soundsLike=!0}}return a},getProminentPart:function(a){var b=a.indexOf('0');if(b<0){return a}return a.substring(0,b)},getSoundEx:function(e){var a=e.toLowerCase().split(''),b=a.shift(),c='',d={a:'',e:'',i:'',o:'',u:'',b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,d:3,t:3,l:4,m:5,n:5,r:6};c=b+a.map(function(a,c,b){return d[a]}).filter(function(c,a,f){return a===0?c!==d[b]:c!==f[a-1]}).join('');return (c+'000').slice(0,4).toUpperCase()}}});Ext.define('ABP.util.filters.Factory',{singleton:!0,requires:['ABP.util.filters.text.TextFilter'],createStringFilter:function(f,d,e,a){var c={searchText:f,searchFields:d,matchAllValues:e};if(a){c.minLengthThreshold=a}var b=Ext.create('ABP.util.filters.text.TextFilter',c);return b.filter.bind(b)},createTopNFilter:function(b){var c={maxResults:b};var a=Ext.create('ABP.util.filters.misc.TopNFilter',c);return a.filter.bind(a)},createDuplicationFilter:function(a){if(Ext.isString(a)){a=ABP.util.String.toArray(a)}var c={fields:a};var b=Ext.create('ABP.util.filters.misc.DuplicateFilter',c);return b.filter.bind(b)}});Ext.define('ABP.util.filters.misc.DuplicateFilter',{itemId:'DuplicateFilter',config:{fields:[]},keys:[],constructor:function(a){this.initConfig(a);this.keys=[];return this},filter:function(c){var b=this;var a=b.generateKey(c);if(!a){return !0}if(Ext.Array.contains(b.keys,a)){return !1}b.keys.push(a);return !0},privates:{generateKey:function(c){var d=this;var a='';var b=d.getFields();Ext.Array.forEach(b,function(d){var b=c.get(d);if(b){a+=b.toString()}});return a}}});Ext.define('ABP.util.filters.misc.TopNFilter',{itemId:'TopNFilter',config:{maxResults:10},constructor:function(a){this.initConfig(a);return this},filter:function(a){var b=this;if(a.store){var c=a.store.indexOf(a);return c<b.getMaxResults()}return !1}});Ext.define('ABP.util.keyboard.Codes',{singleton:!0,statics:{keyOptions:{forwardSlash:191}}});Ext.define('ABP.util.keyboard.Shortcuts',{requires:['ABP.util.Keyboard'],keyNav:null,routeMapping:[],config:{controller:null},constructor:function(b){var a=this;Ext.apply(a,b);a.keyNav=new Ext.util.KeyNav({target:Ext.getBody(),scope:a,defaultEventAction:'stopEvent',ignoreInputFields:!0,F:{ctrl:!0,shift:!0,fn:function(c){a.controller.fireEvent('container_showMenu',!0);a.controller.fireEvent('container_menuFocusFavorites')},defaultEventAction:'stopPropagation'},Z:{ctrl:!0,shift:!0,fn:function(a){ABP.view.base.automation.AutomationHintOverlay.toggle()},defaultEventAction:'stopPropagation'},Home:{ctrl:!0,fn:function(c){a.controller.fireEvent('container_showMenu',!0);ABP.util.Keyboard.focus('.nav-search-field')},defaultEventAction:'stopPropagation'},Alt:{ctrl:!1,fn:function(c){a.controller.fireEvent('container_toggleMenuShortcuts',!0);ABP.util.Common.setKeyboardNavigation(!0)}},191:{fn:function(c,d){if(c.altKey){a.controller.fireEvent('abp_jumpto_show')}else {a.controller.fireEvent('abp_searchBar_toggleKey')}return !0},defaultEventAction:'stopPropagation'},enter:{fn:this.KeyboardNavUpdate,defaultEventAction:!1},tab:{fn:this.KeyboardNavUpdate,defaultEventAction:!1},left:{fn:this.KeyboardNavUpdate,defaultEventAction:!1},right:{fn:this.KeyboardNavUpdate,defaultEventAction:!1},up:{fn:this.KeyboardNavUpdate,defaultEventAction:!1},down:{fn:this.KeyboardNavUpdate,defaultEventAction:!1}})},KeyboardNavUpdate:function(){ABP.util.Common.setKeyboardNavigation(!0)},enable:function(){this.keyNav.enable()},disable:function(){this.keyNav.disable()},addShortcuts:function(a){var b=[];for(i=0,len=a.length;i<len;i++){var c=this.getKey(a[i].key);binding={key:c,shift:a[i].key.indexOf('SHIFT+')>=0,ctrl:a[i].key.indexOf('CTRL+')>=0,alt:a[i].key.indexOf('ALT+')>=0,handler:this.shortcutHandler,scope:this};b[c]=binding;this.addRouteMap(binding,a[i])}this.keyNav.addBindings(b)},getKey:function(a){a=a.toUpperCase();return a.replace('SHIFT+','').replace('CTRL+','').replace('ALT+','')},addRouteMap:function(a,b){var c=this.getRouteKey(a);this.routeMapping[c]=b},shortcutHandler:function(b){var a=this.routeMapping[this.getRouteKey(b)];this.controller.fireAppEvent(a.appId,a.event,a.eventArgs,a.activateApp)},getRouteKey:function(a){var b='';if(a.ctrlKey||a.ctrl){b+='CTRL+'}if(a.shiftKey||a.shift){b+='SHIFT+'}if(a.altKey||a.alt){b+='ALT+'}if(Ext.isNumber(a.keyCode)){b+=a.keyCode}else {b+=Ext.event.Event[a.key]}return b}});Ext.define('ABP.view.Root',{extend:'Ext.app.Controller',routes:{'login':{before:'onBeforeLogin',action:'onLogin'},'logout':'onLogout','home':'onHome','nosupport':'onNoSupport'},refs:[{ref:'main',selector:'app-main',autoCreate:!1}],onLogout:function(){this.fireEvent('main_DestroySession')},onBeforeLogin:function(a){if(ABP.util.Config.getLoggedIn()){ABP.view.base.popUp.PopUp.customPopup('reload_warning','','?',[{text:'error_ok_btn',args:!0},{text:'error_cancel_btn',args:!1}],'main_routingWarningCallback')}else {a.resume()}},onLogin:function(){var a=null;var b=this.getMain();if(b){a=b.getViewModel()}if(a&&a.get('bootstrapped')||!a){this.fireEvent('main_ShowLogin')}},onNoSupport:function(){this.fireEvent('main_ShowNoSupportPage');this.setRoutes({})},onHome:function(){if(this.getApplication().getMainView().down('featurecanvas')){this.fireEvent('featureCanvas_triggerDefaultMenuItem')}else {this.redirectTo('')}}});Ext.define('ABP.view.ApplicationController',{extend:'Ext.app.Controller',alias:'controller.abpapplicationcontroller',listen:{controller:{'*':{container_signOut:'__signout',container_toggleMenu:'__menuToggle',container_showMenu:'__menuOpen',container_toggleMenuShortcuts:'__menuToggleShortcuts',container_hideMenu:'__menuClose',container_toggleNav:'__navToggle',container_giveFocus:'__givenFocus',container_enableMenuOption:'__menuOptionEnable',container_addMenuOption:'__menuOptionAdd',container_removeMenuOption:'__menuOptionRemove',container_updateMenuCount:'__menuUpdateCount',container_menuAddRecent:'__menuAddRecent',container_menuAddFavorite:'__menuAddFavorite',container_menuRemoveFavorite:'__menuRemoveFavorite',container_menuUpdateFavorites:'__menuUpdateFavorites',container_menuFocusFavorites:'__menuFocusFavorite',container_menuReplaceSuggested:'__menuReplaceSuggested',container_menuAddTreeItems:'__menuAddTreeItems',container_menuRemoveTreeItem:'__menuRemoveTreeItem',container_toolbar_showBranding:'__toolbarShowBranding',container_toolbar_setTitle:'__toolbarSetTitle',container_toolbar_addButton:'__toolbarAddButton',container_toolbar_removeButton:'__toolbarRemoveButton',container_openSearch:'__openSearch',container_showSettings:'__showSettings',container_switchLanguage:'__switchLanguage',container_switchTheme:'__switchTheme',container_clean:'__cleanUp',container_setRoute:'__setRoute',container_addDefaultLanguageStrings:'__addDefaultLanguageStrings',container_updateLanguageStrings:'__updateLanguageStrings',container_pendingChanges:'__pendingChangesToggle',container_rightPane_toggle:'__rightPaneToggle',container_rightPane_toggleTab:'__rightPaneToggleTab',container_rightPane_addElement:'__rightPaneAddElement',container_rightPane_showButton:'__rightPaneShowButton',container_rightPane_initTab:'__rightPaneInitTab',container_rightPane_updateBadge:'__rightPaneUpdateBadge',container_rightPane_incrementBadge:'__rightPaneIncrementBadge',container_rightPane_decrementBadge:'__rightPaneDecrementBadge',container_rightPane_clearBadge:'__rightPaneClearBadge',container_notifications_add:'__addNotifications',container_notifications_remove:'__removeNotifications',container_notifications_read:'__markNotificationsRead',container_notifications_unread:'__markNotificationsUnread',container_globalsearch_suggestions:'__updateGlobalSearchSuggestions',container_headlines_show:'__showHeadlines',container_headlines_hide:'__hideHeadline',container_headlines_load:'__loadHeadlines',container_thumbbar_show:'__showThumbbar',container_thumbbar_hide:'__hideThumbbar',container_updateUserProfile:'__updateUserProfile',container_bootstrap_success:'__bootstrapSuccessful',container_authentication_success:'__authenticationSuccessful',container_config_processed:'__configurationProcessed'}}},__signout:function(a,b){this.fireEvent('main_DestroySession',a,b)},__menuToggle:function(){this.fireEvent('session_toggleMenu')},__menuOpen:function(){this.fireEvent('session_openMenu')},__menuToggleShortcuts:function(){this.fireEvent('session_toggleMenuShortcuts')},__menuClose:function(){this.fireEvent('session_closeMenu')},__givenFocus:function(){this.fireEvent('toolbar_focus')},__menuOptionEnable:function(c,b,a){this.fireEvent('mainMenu_enableMenuOption',c,b,a)},__menuOptionAdd:function(c,e,a,b,d){this.fireEvent('mainMenu_addMenuOption',c,e,a,b,d)},__menuOptionRemove:function(b,a){this.fireEvent('mainMenu_removeMenuOption',b,a)},__menuUpdateCount:function(b,a,c){this.fireEvent('mainMenu_updateMenuCount',b,a,c)},__menuAddRecent:function(a){this.fireEvent('mainMenu_addRecent',a)},__menuAddFavorite:function(b,a){this.fireEvent('mainMenu_addFavorite',b,a)},__menuRemoveFavorite:function(c,b,a){this.fireEvent('mainMenu_removeFavorite',c,b,a)},__menuUpdateFavorites:function(a,b){this.fireEvent('mainmenu_updateFavorites',a,b)},__menuFocusFavorite:function(){this.fireEvent('mainmenu_focusFavorites')},__menuReplaceSuggested:function(a){this.fireEvent('mainMenu_replaceSuggested',a)},__menuAddTreeItems:function(a){this.fireEvent('mainMenu_addTreeOption',a)},__menuRemoveTreeItem:function(b,a){this.fireEvent('mainMenu_removeTreeOption',b,a)},__navToggle:function(a){this.fireEvent('mainMenu_toggleNav',a)},__toolbarSetTitle:function(a){this.fireEvent('toolbar_setTitle',a)},__toolbarShowBranding:function(a){this.fireEvent('toolbar_showBranding',a)},__toolbarAddButton:function(a,d,c,b){this.fireEvent('toolbar_addButton',a,d,c,b)},__toolbarRemoveButton:function(a){this.fireEvent('toolbar_removeButton',a)},__showSettings:function(a){this.fireEvent('featureCanvas_showSetting',a)},__addDefaultLanguageStrings:function(a){this.fireEvent('main_addDefaultLanguageStrings',a)},__updateLanguageStrings:function(a){this.fireEvent('main_updateLanguageStrings',a)},__openSearch:function(){this.fireEvent('toolbar_openSearch')},__switchLanguage:function(a){this.fireEvent('main_switchLanguage',a)},__switchTheme:function(a){ABPTheme.setTheme(a)},__pendingChangesToggle:function(a){this.fireEvent('main_pendingChanges',a)},__cleanUp:function(){},__setRoute:function(b,a){if(a===undefined){a=!0}this.redirectTo(b,Ext.coerce(a,!0))},__rightPaneToggle:function(){this.fireEvent('rightPane_toggle')},__rightPaneAddElement:function(a){this.fireEvent('rightPane_addElement',a)},__rightPaneToggleTab:function(a,c,b){this.fireEvent('rightPane_toggleTab',a,c,b)},__rightPaneShowButton:function(a,b){this.fireEvent('toolbar_setVisibilityRightPaneButton',a,b)},__rightPaneInitTab:function(a){this.fireEvent('rightPane_initTab',a)},__rightPaneUpdateBadge:function(b,a){this.fireEvent('toolbar_updateBadge',b,a)},__rightPaneIncrementBadge:function(a,b){this.fireEvent('toolbar_incrementBadge',a,b)},__rightPaneDecrementBadge:function(a,b){this.fireEvent('toolbar_decrementBadge',a,b)},__rightPaneClearBadge:function(a){this.fireEvent('toolbar_clearBadge',a)},__addNotifications:function(c,b,a){this.fireEvent('abp_notifications_add',c,b,a)},__removeNotifications:function(a){this.fireEvent('abp_notifications_remove',a)},__markNotificationsRead:function(a){this.fireEvent('abp_notifications_read',a)},__markNotificationsUnread:function(a){this.fireEvent('abp_notifications_unread',a)},__updateGlobalSearchSuggestions:function(d,c,b,a){this.fireEvent('abp_search_suggestions',d,c,b,a)},__showHeadlines:function(a){this.fireEvent('abp_headlines_show',a)},__hideHeadline:function(a){this.fireEvent('abp_headlines_hide',a)},__loadHeadlines:function(){this.fireEvent('abp_headlines_load')},__showThumbbar:function(a){this.fireEvent('thumbbar_show',a)},__hideThumbbar:function(a){this.fireEvent('thumbbar_hide',a)},__updateUserProfile:function(a){this.fireEvent('main_updateUserProfile',a)},__bootstrapSuccessful:function(){this.fireEvent('abp_milestone_bootstrap_success')},__authenticationSuccessful:function(){this.fireEvent('abp_milestone_authentication_success')},__configurationProcessed:function(){this.fireEvent('abp_milestone_config_processed')}});Ext.define('ABP.view.base.popUp.PopUpController',{extend:'Ext.app.ViewController',alias:'controller.abppopupcontroller',listen:{controller:{'*':{popup_showPopUp:'showMe',popup_hidePopUp:'hideMe'}}},showMe:function(c,b){var d=this;var a=d.getView();a.setLabel(c);a.setButtons(b);a.show()},hideMe:function(){this.getView().hide()}});Ext.define('ABP.view.base.popUp.PopUpHeader',{extend:'Ext.container.Container',alias:'widget.popupheader',cls:'abp-popup-header',ui:'popup',layout:{type:'vbox',align:'stretch'},items:[{xtype:'component',cls:'abp-popup-header-topstrip'},{xtype:'header',itemId:'abpPanelHeader',cls:'abp-popup-header-header',defaultType:'tool'}],initComponent:function(){if(this.title){this.items[1].title=this.title}this.callParent(arguments)},setPosition:function(a){this.down('#abpPanelHeader').setPosition(a)},getInnerHeader:function(){return this.down('#abpPanelHeader')},setTitle:function(a){this.down('#abpPanelHeader').setTitle(a)}});Ext.define('ABP.view.base.popUp.PopUp',{extend:'Ext.panel.Panel',singleton:!0,requires:['ABP.view.base.popUp.PopUpController','ABP.view.base.popUp.PopUpHeader','ABPControlSet.util.Markdown'],alias:'widget.abppopup',alternateClassName:'ABP.Popup',controller:'abppopupcontroller',header:{xtype:'popupheader'},layout:{type:'hbox',align:'center',pack:'start'},floating:!0,centered:!0,modal:!0,cls:'framePop',ui:'popup',sizingConstants:{minWidth:440,minHeight:185,maxWidth:760},minHeight:185,shadow:!1,config:{closeKeymap:undefined},ariaRole:'alertdialog',ariaDescribedBy:'errorPopMessage',ariaAttributes:{'aria-modal':'true'},dockedItems:[{xtype:'container',dock:'bottom',itemId:'errorPopButtonBar',cls:'errorpop-buttonbar',layout:{type:'hbox',pack:'end'},items:[{xtype:'button',frame:!1,width:100,bind:{text:'{i18n.error_ok_btn:htmlEncode}',ariaLabel:'{i18n.error_ok_btn:htmlEncode}'},handler:function(){this.up('abppopup').hidePopup()}}]}],items:[{xtype:'component',itemId:'errorPopIcon',cls:'popIcon',flex:1,html:'<i class="icon-window-warning"></i>'},{xtype:'component',id:'errorPopMessage',cls:'errorpop-message',ariaRole:'alert',ariaAttributes:{'aria-live':'polite'},flex:7,width:'100%',scrollable:'y',html:''}],__showPopup:function(f,h,e,i,j,c){var a=this;c=c||{};var b=a.down('#errorPopIcon');var d=a.down('#errorPopMessage');var g=a.down('#errorPopButtonBar');if(e){if(e==='?'){b.setHtml('<i class="icon-question"></i>');if(!b.hasCls('actionblueIcon')){b.addCls('actionblueIcon')}}else {if(e==='i'){b.setHtml('<i class="icon-information"></i>');if(!b.hasCls('actionblueIcon')){b.addCls('actionblueIcon')}}else {if(Ext.isString(e)&&e.length>1){b.setHtml('<i class="'+e+'"></i>');if(b.hasCls('actionblueIcon')){b.removeCls('actionblueIcon')}}else {b.setHtml('<i class="icon-sign-warning"></i>');if(b.hasCls('actionblueIcon')){b.removeCls('actionblueIcon')}}}}b.setHidden(!1)}else {b.setHidden(!0)}if(h&&Ext.isString(h)){a.__setTitle(a.__checkString(h))}else {a.__setTitle('')}if(f){var k=c.isMarkdown||!1;f=a.__getFormattedMessage(f,k);if(c&&c.url){var l=Ext.String.format('<br/><br/><a href="{0}" target="{1}" onclick="try { ABP.view.base.popUp.PopUp.hidePopup(); return true; } catch (e) {return true;}">{2}</a>',c.url,c&&c.urlTarget?c.urlTarget:'_blank',c&&c.urlDisplayText?a.__checkString(c.urlDisplayText):c.url);d.setHtml(f+l)}else {d.setHtml(f)}d.setHidden(!1)}else {d.setHidden(!0)}if(i){g.removeAll();g.add(a.__getCustomButtons(i))}else {g.removeAll();g.add(a.__getDefaultButtons())}a.closeCallback=j;a.setCloseKeymap(Ext.getBody().addKeyListener(Ext.event.Event.ESC,a.hidePopup,a));a.calculateSizing(d.hidden,d.html);a.show();a.center();a.__putFocusOnButton()},__getFormattedMessage:function(a,g){if(g){return ABPControlSet.util.Markdown.parseMarkdown(a)}else {var f=this;if(Ext.isString(a)){return f.__checkString(a)}else {if(Ext.isArray(a)){var c,e='',d=a.length;for(var b=0;b<d;b++){c=a[b];if(Ext.isString(c)){e+=f.__checkString(c)+(b===d-1?'':'<br/>')}}return e}}}},__setTitle:function(a){if(a){if(this.header.setTitle){this.header.setTitle(a);this.header.show()}else {this.header.title=a}}else {if(this.header.setTitle){this.header.setTitle('');this.header.hide()}else {this.header.title='';this.header.hidden=!0}}},__checkString:function(b){var c=b.slice(0);var a=ABP.util.Common.geti18nString(b,!0);if(c===a){a=ABP.util.Common.inspectString(a)}return Ext.String.htmlEncode(a)},__getDefaultButtons:function(){return [{xtype:'button',frame:!1,minWidth:100,automationCls:'popup-btn-ok',defaultFocus:!0,bind:{text:'{i18n.error_ok_btn:htmlEncode}'},handler:function(){this.up('abppopup').hidePopup()}}]},__getCustomButtons:function(a){var e=this;var c=[];var d='';var b=0;if(Ext.isArray(a)){for(b=0;b<a.length;++b){if(a[b].text){d=ABP.util.Common.geti18nString(a[b].text);c.push({xtype:'button',frame:!1,minWidth:100,defaultFocus:a[b].defaultFocus,args:a[b].args,text:Ext.String.htmlEncode(d),automationCls:'popup-btn-'+b,handler:function(){this.up('abppopup').hidePopup(this.args)}})}}}else {if(a.text){d=ABP.util.Common.geti18nString(a.text);c.push({xtype:'button',frame:!1,minWidth:100,defaultFocus:a.defaultFocus,args:a.args,text:Ext.String.htmlEncode(d),handler:function(){this.up('abppopup').hidePopup(this.args)}})}}if(Ext.isEmpty(c)){c=e.__getDefaultButtons()}return c},__putFocusOnButton:function(){var e=this;var d=e.down('#errorPopButtonBar');var a=d.items.items;var b=0;var c=!1;for(b;b<a.length;++b){if(a[b].defaultFocus){c=a[b];break}}if(c){c.focus()}else {if(a.length>0){a[0].focus()}}},calculateSizing:function(e,f){var a=this;if(e){a.setWidth(a.sizingConstants.minWidth)}else {var b=f.length*7+120;var d=10500;var c=325;if(b<d){if(b<=c){a.setWidth(a.sizingConstants.minWidth);a.setHeight(b/14>a.sizingConstants.minHeight?b/14:a.sizingConstants.minHeight)}else {a.setWidth(b<a.sizingConstants.maxWidth?b:a.sizingConstants.maxWidth);a.setHeight(b/14>a.sizingConstants.minHeight?b/14:a.sizingConstants.minHeight)}}else {a.setWidth(a.sizingConstants.maxWidth);a.setHeight(b/14>a.sizingConstants.minHeight?b/14:a.sizingConstants.minHeight)}}},hidePopup:function(a){this.hide();if(this.closeCallback){if(Ext.isFunction(this.closeCallback)){this.closeCallback(a)}else {this.getController().fireEvent(this.closeCallback,a)}}},beforeclose:function(){Ext.destroy(this.getCloseKeymap())},afterRender:function(){var a=this;var b=Ext.ComponentQuery.query('app-main')[0];b.on('resize',function(){var a=Ext.ComponentQuery.query('abppopup')[0];if(a&&!a.hidden){a.setMaxHeight(Math.floor(ABP.util.Common.getWindowHeight()-ABP.util.Common.getWindowHeight()/30));a.updateLayout();a.center()}});a.addBodyCls('framePop-body');a.callParent()},showPopup:function(c,a,b,d){this.__showPopup(c,null,'!',{text:a},b,d)},showInfo:function(a,c,b){this.__showPopup(a,c,'i',null,null,b)},showError:function(a,c,b){this.__showPopup(a,c,'!',null,null,b)},showOkCancel:function(b,d,a,c){this.__showPopup(b,d,'?',[{text:'error_ok_btn',defaultFocus:!0,args:!0},{text:'error_cancel_btn',args:!1}],a,c)},showYesNo:function(b,d,a,c){this.__showPopup(b,d,'?',[{text:'error_yes_btn',defaultFocus:!0,args:!0},{text:'error_no_btn',args:!1}],a,c)},customPopup:function(c,e,f,b,a,d){this.__showPopup(c,e,f,b,a,d)},showHyperlink:function(f,i,e,b,g,h,d,c,a){a=a||{};a.url=i;a.urlTarget=e;a.urlDisplayText=b;this.__showPopup(f,g,h,d,c,a)}});Ext.define('ABP.view.base.toast.ToastBase',{requires:['ABPControlSet.util.Markdown'],levelEnum:{'BLU':0,'GRN':1,'ORG':2,'RED':3,0:'BLU',1:'GRN',2:'ORG',3:'RED','Alert':3,'Warning':2,'Success':1,'Info':0},ariaLiveMapping:{'BLU':'polite','GRN':'polite','ORG':'polite','RED':'assertive'},defaultIconEnum:{0:'icon-information',1:'icon-check',2:'icon-sign-warning',3:'icon-about'},defaultIcons:{BLU:'icon-information',GRN:'icon-hand-thumb-up',ORG:'icon-sign-warning',RED:'icon-alert'},privates:{getParamConfig:function(b,c,h,f,g,d,e){var i=this;var a=b;if(Ext.isString(b)){a={message:b.trim()};if(c){a.level=c}if(h){a.iconCls=h}if(f){a.placement=f}if(g){a.handler=g}else {a.handler=null}if(d){a.handlerArgs=d}else {a.handlerArgs=null}if(e){a.isMarkdown=e}else {a.isMarkdown=!1}}a=Ext.applyIf(a,{message:'not set!',level:0,placement:'b',icon:!0,iconCls:'icon-information',duration:i.getDefaultDuration(a.message),isMarkdown:!1});if(!a.iconCls){a.iconCls=i.defaultIconEnum[c]}return a},getLevel:function(a){var b=this;if(Ext.isString(a)){a=b.levelEnum[a]}if(Ext.isNumeric(a)){a=b.levelEnum[a]}if(!a){return b.levelEnum[0]}return a},makeHtml:function(a){var b=a.isMarkdown?ABPControlSet.util.Markdown.parseMarkdown(a.message):Ext.htmlEncode(a.message);var c="<div style='display: flex;' class='abp-toast-inner-"+this.getLevel(a.level)+"'>"+"<div class='abp-toast-icon-block "+Ext.htmlEncode(a.iconCls)+"'></div>"+"<div class='abp-toast-message'>"+b+'</div>'+'</div>';return c},getDefaultDuration:function(a){return 3000+a.length*60},handleClick:function(){var a=Ext.getCmp(this.id);if(Ext.isFunction(a.handler)){a.handler(a.handlerArgs)}}}},function(a){ABP.toast=function(g,h,f,d,e,b,c){return ABP.view.base.toast.ABPToast.show(g,h,f,d,e,b,c)}});Ext.define('ABP.view.base.toast.ABPToast',{extend:'ABP.view.base.toast.ToastBase',singleton:!0,requires:['ABPControlSet.util.Markdown'],show:function(j,l,i,f,h,d,e){var b=this;var a=b.getParamConfig(j,l,i,f,h,d,e);var c=b.getLevel(a.level);var g=b.ariaLiveMapping[c];var k=a.handler?b.handleClick:null;var m=Ext.toast({ariaRole:'alert',ariaAttributes:{'aria-live':g},html:b.makeHtml(a),autoCloseDelay:a.duration,maxWidth:ABP.util.Common.getWindowWidth()*0.8,align:a.placement,closable:!1,shadow:!0,listeners:{click:{element:'el',fn:k}},handler:a.handler,handlerArgs:a.handlerArgs,cls:['abp-toast','abp-toast-'+c],getXposAlignedToAnchor:function(){var c=this,a=c.align,m=c.anchor,g=m&&m.el,k=c.el,b=0;if(g&&g.dom){if(!c.useXAxis){b=k.getLeft();if(a==='br'||a==='tr'||a==='r'){if(k.getRight()>ABP.util.Common.getWindowWidth()-10){b=ABP.util.Common.getWindowWidth()-k.getWidth()-10}}else {if(a==='bl'||a==='tl'||a==='l'){b=10}}}else {if(a==='br'||a==='tr'||a==='r'){b+=g.getAnchorXY('r')[0];b-=k.getWidth()+c.paddingX}else {b+=g.getAnchorXY('l')[0];b+=c.paddingX}}}return b},getXposAlignedToSibling:function(c){var k=this,a=k.align,g=k.el,b;if(!k.useXAxis){b=g.getLeft();if(a==='br'||a==='tr'||a==='r'){if(g.getRight()>ABP.util.Common.getWindowWidth()-10){b=ABP.util.Common.getWindowWidth()-g.getWidth()-10}}else {if(a==='bl'||a==='tl'||a==='l'){b=10}}}else {if(a==='tl'||a==='bl'||a==='l'){b=c.xPos+c.el.getWidth()+c.spacing}else {b=c.xPos-g.getWidth()-k.spacing}}return b}});return m},privates:{makeHtml:function(a){var b=a.isMarkdown?ABPControlSet.util.Markdown.parseMarkdown(a.message):Ext.htmlEncode(a.message);return "<div style='display: flex;' class='abp-toast-inner-"+this.getLevel(a.level)+"'>"+"<div class='abp-toast-icon-block "+Ext.htmlEncode(a.iconCls)+"'></div>"+"<div class='abp-toast-message'>"+b+'</div>'+'</div>'}}},function(a){ABP.toast=function(g,h,f,d,e,b,c){return ABP.view.base.toast.ABPToast.show(g,h,f,d,e,b,c)}});Ext.define('ABP.view.base.automation.AutomationHintOverlay',{extend:'Ext.panel.Panel',singleton:!0,alias:'widget.automationoverlay',layout:{type:'absolute'},floating:!0,centered:!0,items:[],cls:'automation-overlay',overlayTip:undefined,toggle:function(){if(this.isVisible()){this.hideOverlay()}else {this.showOverlay()}},showOverlay:function(){var a=this;var d=ABP.util.Constants.AUTOMATION_CLASS_REGEX;var b;var c=[];var e;if(!this.overlayTip){overlayTip=Ext.create('Ext.tip.ToolTip',{target:this.getEl(),delegate:'div[autolabel]',trackMouse:!0,renderTo:Ext.getBody(),listeners:{beforeshow:function updateTipBody(a){a.update(a.triggerElement.getAttribute('autolabel'))}}})}function walk(a,b){b(a);a=a.firstChild;while(a){walk(a,b);a=a.nextSibling}}function getElPos(a){var b=0,c=0;while(a){b+=a.offsetLeft-a.scrollLeft+a.clientLeft;c+=a.offsetTop-a.scrollTop+a.clientTop;a=a.offsetParent}return {left:b,top:c}}function createRegion(b,d){var c=getElPos(b);return {xtype:'component',cls:'automation-hint',x:c.left,y:c.top,width:b.offsetWidth,height:b.offsetHeight,html:d,autoEl:{tag:'div',autolabel:d},listeners:{el:{mouseover:a.highlightElement,mouseleave:a.removeElementHighlight}}}}walk(Ext.getBody().dom,function(a){if(a.nodeType===1){if(a.offsetWidth>0){b=a.className.match(d);if(b!==null){c.push(createRegion(a,b.filter(function(b,d,c){return Ext.isString(b)&&c.indexOf(b)===d}).reduce(function(d,b,e,c){if(c.length>1){return d+' '+b}else {return b}})))}if(a.hasAttribute('automationId')){c.push(createRegion(a,'automationId: '+a.getAttribute('automationId')))}}}});a.removeAll();a.setSize(Ext.getBody().getViewSize());a.add(c);a.center();a.show()},hideOverlay:function(){this.hide()},highlightElement:function(){var a=Ext.getCmp(this.id);a.addCls('automation-hint-over')},removeElementHighlight:function(){var a=Ext.getCmp(this.id);a.removeCls('automation-hint-over')}});Ext.define('ABP.view.base.PackageViewController',{extend:'Ext.app.ViewController',alternateClassName:'basepackagecontroller',alias:'controller.abppackageviewcontroller',updateTitle:function(a){this.fireEvent('container_toolbar_setTitle',a)},showBranding:function(a){this.fireEvent('container_toolbar_showBranding',a)},signOut:function(a,b){this.fireEvent(ABP.Events.signOut,a,b)},showSettings:function(a){this.fireEvent(ABP.Events.showSettings,a)},switchLanguage:function(a){this.fireEvent(ABP.Events.switchLanguage,a)},switchTheme:function(a){this.fireEvent(ABP.Events.switchTheme,a)},setRoute:function(b,a){this.fireEvent(ABP.Events.setRoute,b,a)},addDefaultLanguageStrings:function(a){this.fireEvent(ABP.Events.addDefaultLanguageStrings,a)},pendingChanges:function(a){this.fireEvent(ABP.Events.pendingChanges,a)},menuToggle:function(){this.fireEvent(ABP.Events.menuToggle)},menuShow:function(){this.fireEvent(ABP.Events.menuShow)},menuHide:function(){this.fireEvent(ABP.Events.menuHide)},menuToggleNav:function(){this.fireEvent(ABP.Events.menuToggleNav)},menuEnableOption:function(c,b,a){this.fireEvent(ABP.Events.menuEnableOption,c,b,a)},menuAddOption:function(d,a,b,c){this.fireEvent(ABP.Events.menuAddOption,d,a,b,c)},menuRemoveOption:function(b,a){this.fireEvent(ABP.Events.menuRemoveOption,b,a)},menuUpdateCount:function(c,a,b){this.fireEvent(ABP.Events.menuUpdateCount,c,a,b)},menuAddRecent:function(a){this.fireEvent(ABP.Events.menuAddRecent,a)},menuAddFavorite:function(a){this.fireEvent(ABP.Events.menuAddFavorite,a)},menuRemoveFavorite:function(b,a){this.fireEvent(ABP.Events.menuRemoveFavorite,b,a)},menuUpdateFavorites:function(a){this.fireEvent(ABP.Events.menuUpdateFavorites,a)},menuFocusFavorites:function(){this.fireEvent(ABP.Events.menuFocusFavorites)},menuReplaceSuggested:function(a){this.fireEvent(ABP.Events.menuReplaceSuggested,a)},menuAddTreeItems:function(a){this.fireEvent(ABP.Events.menuAddTreeItems,a)},menuRemoveTreeItem:function(b,a){this.fireEvent(ABP.Events.menuRemoveTreeItem,b,a)},toolbarSetTitle:function(a){this.fireEvent(ABP.Events.toolbarSetTitle,a)},toolbarAddButton:function(a){this.fireEvent(ABP.Events.toolbarAddButton,a)},toolbarRemoveButton:function(a){this.fireEvent(ABP.Events.toolbarRemoveButton,a)},toolbarOpenSearch:function(){this.fireEvent(ABP.Events.toolbarOpenSearch)},rightPaneToggle:function(){this.fireEvent(ABP.Events.rightPaneToggle)},rightPaneToggleTab:function(a,b){this.fireEvent(ABP.Events.rightPaneToggleTab,a,b)},rightPaneAddElement:function(a){this.fireEvent(ABP.Events.rightPaneAddElement,a)},rightPaneShowButton:function(a,b){this.fireEvent(ABP.Events.rightPaneShowButton,a,b)},rightPaneInitTab:function(a){this.fireEvent(ABP.Events.rightPaneInitTab,a)},rightPaneUpdateBadge:function(b,a){this.fireEvent(ABP.Events.rightPaneUpdateBadge,b,a)},rightPaneIncrementBadge:function(a,b){this.fireEvent(ABP.Events.rightPaneIncrementBadge,a,b)},rightPaneDecrementBadge:function(a,b){this.fireEvent(ABP.Events.rightPaneDecrementBadge,a,b)},rightPaneClearBadge:function(a){this.fireEvent(ABP.Events.rightPaneClearBadge,a)},notificationsAdd:function(c,b,a){this.fireEvent(ABP.Events.notificationsAdd,c,b,a)},notificationsRemove:function(a){this.fireEvent(ABP.Events.notificationsRemove,a)},notificationsRead:function(a){this.fireEvent(ABP.Events.notificationsRead,a)},notificationsUnread:function(a){this.fireEvent(ABP.Events.notificationsUnread,a)},globalSearchSuggestions:function(c,b,a){this.fireEvent(ABP.Events.globalSearchSuggestions,c,b,a)},headlinesShow:function(a){this.fireEvent(ABP.Events.headlinesShow,a)},headlinesHide:function(a){this.fireEvent(ABP.Events.headlinesHide,a)},thumbbarShow:function(a){this.fireEvent(ABP.Events.thumbbarShow,a)},thumbbarHide:function(a){this.fireEvent(ABP.Events.thumbbarHide,a)}});Ext.define('ABP.view.Application',{extend:'Ext.app.Application',name:'ABP',requires:['ABP.util.Common','ABP.util.Constants','ABP.util.Config','ABP.util.CSS.Colors','ABP.util.Events','ABP.util.Jwt','ABP.util.Logger','ABP.util.Msal','ABP.view.Root','ABP.view.ApplicationController','ABP.view.base.popUp.PopUp','ABP.view.base.toast.ABPToast','ABP.view.base.automation.AutomationHintOverlay','ABP.store.ABPEnvironmentStore','ABP.store.ABPPreBootstrapConfigStore','ABP.view.base.PackageViewController','ABP.events.ABPEventDomain','ABP.events.ABPEvents'],stores:['ABP.store.ABPApplicationServicesStore','ABP.store.ApplicationAuthenticationStore','ABP.store.ABPEnvironmentStore','ABP.store.ABPServerUrlStore','ABP.store.ABPPreBootstrapConfigStore'],controllers:['ABP.view.Root','ABP.view.ApplicationController'],listen:{controller:{'#':{unmatchedroute:'onUnmatchedRoute'}}},onUnmatchedRoute:function(a){if(!ABP.util.Config.getLoggedIn()){if(a.indexOf('/')>0){ABP.util.SessionStorage.set('AfterLoginRedirect',a)}}},launch:function(){ABP.util.Config.setApplication(this);ABP.util.Logger.enable();Ext.Ajax.setDefaultHeaders({'Accept':'application/json','Content-Type':'application/json'})}});Ext.define('ABP.view.base.components.ExpandPanelViewModel',{extend:'Ext.app.ViewModel',requires:[],alias:'viewmodel.abpexpandpanel'});Ext.define('ABP.view.base.popUp.PopUpModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.abppopupmodel'});Ext.define('ABP.view.launch.LaunchCarouselController',{extend:'Ext.app.ViewController',alias:'controller.launchcarouselcontroller',listen:{controller:{'*':{launchCarousel_Settings:'switchToSettings',launchCarousel_Login:'switchToLogin',launchCarousel_Maintenance:'switchToMaintenance',launchCarousel_SelectUser:'switchToSelectUser',launchCarousel_Discovery:'switchToDiscovery'}}},switchToSettings:function(){if(ABP.util.Common.getClassic()){this.getView().setActiveTab('settings-tab')}else {this.getView().setActiveItem('#'+'settings-tab');this.showLoginForm()}},switchToLogin:function(){if(ABP.util.Common.getClassic()){this.getView().setActiveTab('login-tab')}else {this.getView().setActiveItem('#'+'login-tab');this.showLoginForm()}if(ABP.util.Msal.enabled){this.adjustLoginPageForB2cAuth()}},switchToMaintenance:function(a,e){var d=this;var b=d.getView();if(ABP.util.Common.getClassic()){d.switchToSettings()}if(a){var c=b.down('maintenance');if(c){c.showScreen(a,e)}}if(ABP.util.Common.getClassic()){this.getView().setActiveTab('maintenance-tab');if(a){if(a==='forcepassword'){if(b.down('#newPassword')){b.down('#newPassword').focus()}}else {if(a==='recoverpassword'){if(b.down('#recUrl')){b.down('#recUrl').focus()}}}}}else {this.getView().setActiveItem('#'+'maintenance-tab');this.showLoginForm()}},switchToSelectUser:function(){if(ABP.util.Common.getClassic()){var a=this.getView();a.setActiveTab('selectuser-tab');Ext.defer(a.down('#selectuser-tab').initFocus,10,a.down('#selectuser-tab'))}else {this.getView().setActiveItem('#'+'selectuser-tab');this.showLoginForm()}},switchToDiscovery:function(e){var a='discovery-tab',f=e?e.error:null,b=this.getView();if(ABP.util.Common.getClassic()){b.setActiveTab(a);var d=b.down('#'+a),c=d.getViewModel();c.set('errorText',f)}else {b.setActiveItem('#'+a);this.showLoginForm();var d=b.down('#'+a),c=d.getViewModel();c.set('errorText',f)}},showLoginForm:function(){var b=this.getView();var a=b.up('#login-form-wrapper');if(a){a.setHidden(!1)}},adjustLoginPageForB2cAuth:function(){var b=this;var a=b.getViewModel();a.set('b2cAuth',!0);a.set('showUsernameField',!1)}});Ext.define('ABP.view.launch.LaunchCarouselModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.launchcarouselmodel',data:{env_selection:null}});Ext.define('ABP.view.launch.discovery.DiscoveryController',{extend:'Ext.app.ViewController',alias:'controller.discoverycontroller',onBoxready:function(c,d){var a=this,e=a.getViewModel(),b=a.getView();b.down('#email').focus()},handleSpecialKeys:function(b,a){if(a.getKey()==a.ENTER){this.loginButtonClick()}},loginButtonClick:function(){var c=this,e=this.getView(),a=this.getViewModel(),b=a.get('email'),d=e.down('#email');if(d.isValid()&&b){a.set('errorText',null);c.fireEvent('main_showLoading','load_discovering','fullSize');ABP.util.Discovery.discover(b,function(){this.fireEvent('main_hideLoading');this.fireEvent('main_ShowLogin')}.bind(c))}else {a.set('errorText','Fill in necessary fields')}},discoverFailure:function(a){var b=this.getViewModel();me.fireEvent('main_hideLoading');b.set('errorText',a)}});Ext.define('ABP.view.launch.discovery.DiscoveryModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.discoverymodel',data:{email:'',organization:'',errorText:''},formulas:{shouldOrgBeRequired:function(c){var b=c('email'),a=['gmail','yahoo','google'];return (new RegExp(a.join('|'))).test(b)}}});Ext.define('ABP.view.launch.login.LoginController',{extend:'Ext.app.ViewController',alias:'controller.logincontroller',listen:{controller:{'*':{login_updateViewModel:'updateViewModel'}},component:{'*':{login_UserHit:'userEnter',login_PassHit:'loginButtonClick',login_environmentChanged:'onEnvironmentChanged'}}},onBoxready:function(d,e){var a=this,c=a.getViewModel(),b=a.getView();if(c.get('username')){b.down('#password').focus()}else {b.down('#username').focus()}a.checkForSignoutReason()},checkForSignoutReason:function(){var a=ABP.util.SessionStorage.get('SignoutReason');if(a&&a!=='user init'){ABP.util.SessionStorage.remove('SignoutReason');ABP.view.base.popUp.PopUp.showError(a)}},onTabChanged:function(a){},checkLocalStorageAccess:function(){if(!ABP.util.LocalStorage.localStorageWritable()){ABP.view.base.popUp.PopUp.showError('Your browser settings are preventing the use of local storage.  Please change settings before opening this program.')}},initViewModel:function(){var a=this;a.checkLocalStorageAccess();var c=a.getViewModel();var d=ABP.util.SessionStorage.get('SignoutReason');if(d&&d!=='user init'){c.set('loginErrorLabel',d)}ABP.util.SessionStorage.remove('SignoutReason');var b=c.get('bootstrapConf.authenticatedUserName');var e=c.get('bootstrapConf.settings.authenticationType');if(e==='integrated'&&b!==undefined&&b!==null&&b!==''){c.set('username',b)}else {a.setInitialValue({toModelField:'username',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberUsername',useLocalStorageKey:'SavedUsername'});a.setInitialValue({toModelField:'password',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberPassword',useLocalStorageKey:'SavedPassword'})}a.setInitialValue({toModelField:'selected_environment',useDefaultValueFrom:'bootstrapConf.defaultEnvironment',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberEnvironment',useLocalStorageKey:'SavedEnvironment'});a.setInitialValue({toModelField:'selected_language',useDefaultValueFrom:'bootstrapConf.settings.defaultLanguage',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberLanguage',useLocalStorageKey:'SavedLanguage'})},setInitialValue:function(a){var f=this;var d=f.getViewModel();var e=a.useDefaultValueFrom?d.get(a.useDefaultValueFrom):'';var c=a.ifLocalStorageEnabledBy?d.get(a.ifLocalStorageEnabledBy):!1;if(c&&(c===!0||c==='true')){var b=ABP.util.LocalStorage.get(a.useLocalStorageKey);if(b&&b!==''&&b!==null){e=b}}d.set(a.toModelField,e)},updateViewModel:function(){var b=this;var a=b.getViewModel();a.set('username',ABP.util.LocalStorage.get('SavedUsername'));a.set('password',ABP.util.LocalStorage.get('SavedPassword'));a.set('selected_environment',ABP.util.LocalStorage.get('SavedEnvironment'));a.set('selected_language',ABP.util.LocalStorage.get('SavedLanguage'))},loginButtonClick:function(){var e=this;var n=e.getView();ABP.util.Common.flushAllBindings(n);var b=e.getViewModel();var m=e.lookupReference('usernameField');if(m){b.set('username',m.getValue())}var j=e.lookupReference('passwordField');if(j){j.blur();b.set('password',j.getValue())}var k=e.checkInputs();var p=b.get('keepMeSignedIn');var l='en';var d=n.down('#loginExtraFieldCont');var c=0;var h=[];var i=[];var f=e.getExtraSettingsFields();if(b.get('lan_selection')){l=b.get('lan_selection').data.key}else {if(b.get('bootstrapConf.settings.defaultLanguage')){l=b.get('bootstrapConf.settings.defaultLanguage')}}var o=b.get('environment');if(b.get('env_selection')){o=b.get('env_selection').id}if(ABP.util.Common.getClassic()){d=d.items.items}else {d=d.getInnerItems()}if(k===!0){var g={'environment':o,'logonId':b.get('username'),'password':b.get('password'),'locale':l,'forceLogin':!1};if(d.length>0){for(c=0;c<d.length;++c){var a=d[c];if(a.request==='authentication'){if(a.getValue&&a.getValue()!==undefined){g[a.fieldId]=a.getValue()}else {if(a.getFieldData&&a.getFieldData()!==undefined){g[a.fieldId]=a.getFieldData()}}}else {if(a.request==='configuration'){if(a.getValue&&a.getValue()!==undefined){h.push({fieldId:a.fieldId,val:a.getValue()})}else {if(a.getFieldData&&a.getFieldData()!==undefined){h.push({fieldId:a.fieldId,val:a.getFieldData()})}}}}if(a.getValue&&a.getValue()!==undefined){i.push({fieldId:a.fieldId,val:a.getValue()})}else {if(a.getFieldData&&a.getFieldData()!==undefined){i.push({fieldId:a.fieldId,val:a.getFieldData()})}}}}if(f&&f.length>0){for(c=0;c<f.length;++c){g[f[c].fieldId]=f[c].val}}ABP.util.LocalStorage.remove('loginextrafields');b.getParent().getParent().set('configurationExtraInfo',h);b.getParent().getParent().set('loginExtraFieldsFilled',i);if(d.length>0){this.fireEvent('main_saveExtraFieldInfo')}this.fireEvent('main_Authenticate',g,p)}else {if(!k){ABP.view.base.popUp.PopUp.showError('login_all_fields')}else {ABP.view.base.popUp.PopUp.showError(k)}}},onSettingsClick:function(){this.fireEvent('launchCarousel_Settings',this)},onForgotPasswordClick:function(){this.fireEvent('launchCarousel_Maintenance','recoverpassword')},onEnvironmentChanged:function(d){var a=this;var g=a.getViewModel();var c=g.data.main_environmentStore.data;if(d){if(c!==undefined&&c.length>0){var b=c.getByKey(d.id||d);if(b.data.languages){var f=g.getStore('login_settingsStore');if(!Ext.isArray(b.data.languages)){if(b.data.languages.key){f.loadData([b.data.languages]);a.showLanguages(!0)}else {a.showLanguages(!1)}}else {var h=b.data.languages.slice(0);var e=a.getOrderedLanguages(h);if(e){f.loadData(e);a.showLanguages(!0)}else {a.showLanguages(!1)}}}else {a.showLanguages(!1)}}}},getOrderedLanguages:function(c){var i=this;var j=i.getViewModel();var e=j.get('bootstrapConf.settings.defaultLanguage');var a;var f;var g;var h=ABP.util.LocalStorage.get('SavedLanguage');var b=null;var d=[];if(e!==undefined&&e!==null&&c.length>0){for(a=c.length-1;a>-1;--a){if(!c[a].key||!c[a].name){d.push(a)}}if(d.length>0){for(a=0;a<d.length;++a){c.splice(a,1)}}if(c.length>0){for(a=0;a<c.length;++a){if(e===c[a].key){f=[];f.push(c[a]);c.splice(a,1);b=f.concat(c)}}}if(c.length>0&&b===null){b=c}}else {if(!e&&c.length>0){b=c}}if(h&&b){d=[];for(a=b.length-1;a>-1;--a){if(!b[a].key||!b[a].name){d.push(a)}}if(d.length>0){for(a=0;a<d.length;++a){b.splice(a,1)}}if(b.length>0){for(a=0;a<b.length;++a){if(h===b[a].key){g=[];g.push(b[a]);b.splice(a,1);b=g.concat(b)}}}}return b},showLanguages:function(c){var b=this;var d=b.getViewModel();var a=b.getView().down('#login-language');if(c){a.focusable=!0;if(ABP.util.Common.getClassic()){a.select(a.store.data.items[0])}}else {a.focusable=!1}},checkInputs:function(){var g=this;var f=g.getView();var c=!0;if(ABP.util.Msal.enabled){return !0}var e=f.down('#username');var d=f.down('#password');var a=f.down('#loginExtraFieldCont');var b=0;if(e.getValue().length<=0){c=!1;e.addCls('login-error')}else {e.removeCls('login-error')}if(d.isVisible()&&d.getValue().length<=0){c=!1;d.addCls('login-error')}else {d.removeCls('login-error')}if(a.items&&a.items.items&&!Ext.isEmpty(a.items.items)){for(b=0;b<a.items.items.length;++b){if(a.items.items[b].required){if(a.items.items[b].getValue()!==''){a.items.items[b].removeCls('login-error')}else {c=!1;a.items.items[b].addCls('login-error')}}if(a.items.items[b].checkValue&&!a.items.items[b].checkValue()){if(a.items.items[b].getErrorString){c=a.items.items[b].getErrorString()}else {c=!1}a.items.items[b].addCls('login-error')}}}return c},keepMeSignedInClicked:function(){var c=this;var a=c.getViewModel();var b=a.get('keepMeSignedIn');a.set('keepMeSignedIn',!b)},userEnter:function(){var b=this;var a=b.lookupReference('passwordField');if(a){a.focus()}},getExtraSettingsFields:function(){var a;var b=ABP.util.LocalStorage.get('settingsextrafields');if(b){a=JSON.parse(b)}else {a=this.getViewModel().get('prebootstrapExtraSettingsFilled')}return a}});Ext.define('ABP.view.launch.login.LoginModel',{requires:['ABP.model.SettingsLanguageModel'],extend:'Ext.app.ViewModel',alias:'viewmodel.loginmodel',data:{username:'',password:'',lan_selection:null,selected_environment:'',selected_language:''},stores:{login_settingsStore:{model:'ABP.model.SettingsLanguageModel'}},formulas:{canRecoverPassword:{bind:{_canRecoverPassword:'{bootstrapConf.settings.canRecoverPassword}',_b2cAuth:'{b2cAuth}'},get:function(a){if(a._b2cAuth===!1&&(a._canRecoverPassword===!0||a._canRecoverPassword==='true')){return !0}return !1}},canKeepMeSignedIn:{bind:{_canKeepMeSignedIn:'{bootstrapConf.settings.canKeepMeSignedIn}',_isOffline:'{isOffline}',_offlineMode:'{offlineMode}'},get:function(a){if(a._isOffline||a._offlineMode){return !1}if(a._canKeepMeSignedIn===!0||a._canKeepMeSignedIn==='true'){return !0}return !1}},keepMeSignedInIcon:{bind:{_checked:'{keepMeSignedIn}'},get:function(b){var a;if(b._checked){a='icon-checked-square'}else {a='icon-unchecked-square'}return a}},allowServiceChange:{bind:{_allowServiceChange:'{bootstrapConf.settings.allowServiceChange}'},get:function(a){if(a._allowServiceChange===!0||a._allowServiceChange==='true'){return !0}return !1}},preauthenticated:{bind:{_authenticatedUserName:'{bootstrapConf.authenticatedUserName}',_authenticationType:'{bootstrapConf.settings.authenticationType}'},get:function(a){if(a._authenticationType==='integrated'&&a._authenticatedUserName!==undefined&&a._authenticatedUserName!==null&&a._authenticatedUserName!==''){this.set('username',a._authenticatedUserName);return !0}return !1}},canselectuser:{bind:{_canKeepMultipleUsersSignedIn:'{bootstrapConf.settings.canKeepMultipleUsersSignedIn}'},get:function(b){if(b._canKeepMultipleUsersSignedIn){var a=ABP.util.LocalStorage.getUserData();if(a&&a.length>0){return !0}}return !1}},environment:{bind:{_avail:'{bootstrapConf.availableEnvironments}',_selected:'{selected_environment}',_default:'{bootstrapConf.defaultEnvironment}'},get:function(c){var a=c._avail;var b;if(c._selected&&a){for(b=0;b<a.length;++b){if(a[b].id===c._selected||a[b].name===c._selected){return a[b].id}}}if(c._default&&a){for(b=0;b<a.length;++b){if(a[b].id===c._default||a[b].name===c._default){return a[b].id}}}if(a&&a.length>0){return a[0].id}return null}},hideEnvironment:{bind:{environments:'{bootstrapConf.availableEnvironments}',simplifyControls:'{bootstrapConf.settings.showSimpleLogin}'},get:function(a){if(!a.simplifyControls){return !1}if(a.environments&&a.environments.length===1){return !0}return !1}},hideLanguage:{bind:{environment:'{env_selection}',simplifyControls:'{bootstrapConf.settings.showSimpleLogin}'},get:function(a){if(!a.simplifyControls){return !1}if(!a.environment){return !1}if(a.environment.data&&a.environment.data.languages&&a.environment.data.languages.length===1){return !0}return !1}},language:{bind:{_env:'{env_selection}',_avail:'{bootstrapConf.availableEnvironments}',_def:'{selected_language}'},get:function(b){var c,a,d;if(b._def&&b._env&&b._avail){for(a=0;a<b._avail.length;++a){if(b._avail[a].id===b._env.id){c=b._avail[a];break}}if(c){if(c.languages&&c.languages.length>0){for(a=0;a<c.languages.length;++a){if(c.languages[a].key===b._def){d=c.languages[a];break}}if(d){return d.key}return c.languages[0].key}}return null}if(b._env&&b._avail){for(a=0;a<b._avail.length;++a){if(b._avail[a].id===b._env.id){c=b._avail[a];break}}if(c){if(c.languages&&c.languages.length>0){return c.languages[0].key}}}return null}},extraLoginFields:{bind:{__extraField:'{bootstrapConf.settings.extraLoginFields}'},get:function(b){var c=[];var g=ABP.util.Common.getClassic();var d;var a=0;if(b.__extraField){for(a=0;a<b.__extraField.length;++a){if(this.checkForExistingFieldId(c,b.__extraField[a].fieldId)){d=this.checkForSavedValue(b.__extraField[a].fieldId);if(g){if(b.__extraField[a].type){if(b.__extraField[a].type==='text'){c.push({xtype:'textfield',cls:'a-extraloginfield-text-'+b.__extraField[a].fieldId,width:'100%',labelAlign:'top',fieldLabel:ABP.util.Common.geti18nString(b.__extraField[a].label),itemId:'extraLoginFields_'+b.__extraField[a].fieldId,fieldId:b.__extraField[a].fieldId,required:b.__extraField[a].required||!1,request:b.__extraField[a].request,value:d||b.__extraField[a].value||''})}else {if(b.__extraField[a].type==='list'&&b.__extraField[a].options&&b.__extraField[a].options.length>0){c.push({xtype:'combo',cls:'launch-combo-box a-extraloginfield-list-'+b.__extraField[a].fieldId,width:'100%',labelAlign:'top',fieldLabel:ABP.util.Common.geti18nString(b.__extraField[a].label),itemId:'extraLoginFields_'+b.__extraField[a].fieldId,fieldId:b.__extraField[a].fieldId,store:{data:b.__extraField[a].options},displayField:'name',value:d||b.__extraField[a].options[0].key,valueField:'key',triggerAction:'all',allowBlank:!1,labelWidth:0,editable:!1,autoSelect:!0,required:b.__extraField[a].required||!1,request:b.__extraField[a].request})}else {if(b.__extraField[a].type==='toggle'){var e=Ext.isBoolean(d)?d:b.__extraField[a].active==='true'||b.__extraField[a].active===!0;c.push({xtype:'button',cls:'login-keepme',fieldId:b.__extraField[a].fieldId,itemId:'extraLoginFields_'+b.__extraField[a].fieldId,width:'100%',focusCls:'',text:ABP.util.Common.geti18nString(b.__extraField[a].text),iconCls:e?'icon-checked-square':'icon-unchecked-square',active:e,value:e,handler:function(){this.active=!this.active;if(this.active){this.setIconCls('icon-checked-square')}else {this.setIconCls('icon-unchecked-square')}this.value=this.active},required:b.__extraField[a].required||!1,request:b.__extraField[a].request,getRequired:function(){return this.required}})}else {if(b.__extraField[a].type==='number'){var f=null;if(b.__extraField[a].maxVal){f=b.__extraField[a].maxVal.length}c.push({xtype:'numberfield',cls:'a-extrasettingsfield-text-'+b.__extraField[a].fieldId,width:'100%',labelAlign:'top',fieldLabel:ABP.util.Common.geti18nString(b.__extraField[a].label),itemId:'extraSettingsFields'+b.__extraField[a].fieldId,fieldId:b.__extraField[a].fieldId,value:d||'',required:b.__extraField[a].required||!1,maxValue:b.__extraField[a].maxVal?parseFloat(b.__extraField[a].maxVal):null,minValue:b.__extraField[a].minVal?parseFloat(b.__extraField[a].minVal):null,maxLength:f,enforceMaxLength:!0,checkValue:function(){var e=!0;var f=this.getValue();var c=this.maxValue;var d=this.minValue;var a;if(d&&f<d){a=ABP.util.Common.geti18nString('login_extraValue');e=!1;ABP.view.base.popUp.PopUp.showError(this.getEmptyText()+' '+a+' ('+d+'-'+c+')')}else {if(c&&f>c){a=ABP.util.Common.geti18nString('login_extraValue');e=!1;ABP.view.base.popUp.PopUp.showError(this.getEmptyText()+' '+a+' ('+d+'-'+c+')')}}return e}})}else {if(b.__extraField[a].type==='button'){c.push(this.__makeClassicButton(b.__extraField[a]))}}}}}}}else {if(b.__extraField[a].type){if(b.__extraField[a].type==='text'){c.push({xtype:'textfield',cls:['x-unselectable','login-form','a-extraloginfield-text-'+b.__extraField[a].fieldId],width:'100%',clearable:!1,allowBlank:'false',labelAlign:'top',label:ABP.util.Common.geti18nString(b.__extraField[a].label),itemId:'extraLoginFields_'+b.__extraField[a].fieldId,fieldId:b.__extraField[a].fieldId,required:b.__extraField[a].required||!1,request:b.__extraField[a].request,value:d||''})}else {if(b.__extraField[a].type==='list'&&b.__extraField[a].options&&b.__extraField[a].options.length>0){c.push({xtype:'selectfield',cls:['login-form','a-extraloginfield-list-'+b.__extraField[a].fieldId],width:'100%',labelAlign:'top',label:ABP.util.Common.geti18nString(b.__extraField[a].label),itemId:'extraLoginFields_'+b.__extraField[a].fieldId,fieldId:b.__extraField[a].fieldId,store:{data:b.__extraField[a].options},displayField:'name',value:d||b.__extraField[a].options[0].key,valueField:'key',triggerAction:'all',allowBlank:!1,labelWidth:0,editable:!1,autoSelect:!0,required:b.__extraField[a].required||!1,request:b.__extraField[a].request})}else {if(b.__extraField[a].type==='toggle'){var e=Ext.isBoolean(d)?d:b.__extraField[a].active==='true'||b.__extraField[a].active===!0;c.push({xtype:'button',cls:['login-keepme','a-extraloginfield-button'+b.__extraField[a].fieldId],itemId:'extraLoginFields_'+b.__extraField[a].fieldId,fieldId:b.__extraField[a].fieldId,text:ABP.util.Common.geti18nString(b.__extraField[a].text),iconCls:e?'icon-checked-square':'icon-unchecked-square',active:e,value:e,handler:function(){this.active=!this.active;if(this.active){this.setIconCls('icon-checked-square')}else {this.setIconCls('icon-unchecked-square')}this.setValue(this.active)},width:'100%',request:b.__extraField[a].request,required:b.__extraField[a].required||!1,getRequired:function(){return this.required}})}else {if(b.__extraField[a].type==='number'){c.push({xtype:'abpnumberfield',cls:['x-unselectable','login-form','a-extraloginfield-text-'+b.__extraField[a].fieldId],width:'100%',clearable:!1,allowBlank:'false',labelAlign:'top',label:ABP.util.Common.geti18nString(b.__extraField[a].label),itemId:'extraSettingsFields'+b.__extraField[a].fieldId,fieldId:b.__extraField[a].fieldId,required:b.__extraField[a].required||!1,maxValue:b.__extraField[a].maxVal?parseFloat(b.__extraField[a].maxVal):null,minValue:b.__extraField[a].minVal?parseFloat(b.__extraField[a].minVal):null,value:d||''})}else {if(b.__extraField[a].type==='button'){c.push(this.__makeModernButton(b.__extraField[a]))}}}}}}}}}}return c}},loginBtnText:{bind:{_online:'{i18n.login_signin_btn}',_offline:'{i18n.login_offline_signin_btn}',_isOffline:'{isOffline}',_offlineMode:'{offlineMode}'},get:function(a){if(a._isOffline||a._offlineMode){return a._offline}else {return a._online}}},passwordText:{bind:{_online:'{i18n.login_password}',_offline:'{i18n.offline_login_password}',_isOffline:'{isOffline}',_offlineMode:'{offlineMode}'},get:function(a){if(a._isOffline||a._offlineMode){try{var b=this.get('bootstrapConf');if(b.offlineAuthenticationType&&b.offlineAuthenticationType===1){return a._offline}}catch(c){return a._online}return a._offline}else {return a._online}}},showPasswordField:{bind:{_isOffline:'{isOffline}',_offlineMode:'{offlineMode}'},get:function(a){var b=this.get('bootstrapConf.offlineAuthenticationType');var e=this.get('preauthenticated');var d=this.get('b2cAuth');var c=(a._isOffline||a._offlineMode)&&b===0;if(d||e||c){return !1}else {return !0}}}},checkForExistingFieldId:function(b,d){var a=0;var c=!0;for(a=0;a<b.length;++a){if(b[a].fieldId===d){c=!1;break}}return c},checkForSavedValue:function(e){var c=ABP.util.LocalStorage.get('loginextrafields');var b;var d=null;var a=0;if(c){b=JSON.parse(c);for(a=0;a<b.length;++a){if(b[a].fieldId===e){d=b[a].val;break}}}return d},__makeClassicButton:function(a){var d=a.action;var b;var c;switch(d){case 'popup':b=function(){c=Ext.create('ABP.view.base.popUp.PopUpFrame',{config:{buttonInfo:a}});c.show()};break;case 'redirect':b=function(){window.location.href=a.url};break;case 'newTab':b=function(){window.open(a.url)};break;}return {xtype:'button',handler:b,cls:'btn-extra a-extrasettingsfield-button-'+a.fieldId,itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,bind:{text:a.labelKey?'{i18n.'+a.labelKey+'}':a.label},width:'100%',fieldData:null,request:a.request,setFieldData:function(b){this.fieldData=b},getFieldData:function(){return this.fieldData},getRequired:function(){return !1}}},__makeModernButton:function(a){var d=a.action;var b;var c;switch(d){case 'popup':b=function(){c=Ext.create({xtype:'popupframe',config:{buttonInfo:a}});c.show()};break;case 'redirect':b=function(){window.location.href=a.url};break;case 'newTab':b=function(){window.open(a.url)};break;}return {xtype:'button',handler:b,cls:['btn-login','login-form','a-extrasettingsfield-button-'+a.fieldId],itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,margin:'6 0 4 0',bind:{text:a.labelKey?'{i18n.'+a.labelKey+'}':a.label},width:'100%',fieldData:null,request:a.request,setFieldData:function(b){this.fieldData=b},getFieldData:function(){return this.fieldData},getRequired:function(){return !1}}}});Ext.define('ABP.view.launch.selectuser.SelectUserController',{extend:'Ext.app.ViewController',alias:'controller.selectusercontroller',requires:['ABP.store.ABPEnvironmentStore'],listen:{component:{'*':{selectuser_select:'selectUser',selectuser_delete:'deleteUser',selectuser_new:'newUser'}},controller:{'*':{selectuser_load_users:'loadUsers'}},store:{'#ABPEnvironmentStore':{datachanged:'environmentStoreChanged'}}},selectUser:function(c){if(c){var b=c.get('env');var a=c.get('username');var d=ABP.util.Common.getLoginAsUserObj(b,a,ABP.util.LocalStorage.getForUser(b,a,'sessionToken'),ABP.util.LocalStorage.getForUser(b,a,'SavedLanguage'),ABP.util.LocalStorage.getForUser(b,a,'SavedPassword'));this.fireEvent('main_loginAsUser',d)}},deleteUser:function(a){if(a){ABP.util.LocalStorage.removeAllForUser(a.get('env'),a.get('user'));var c=this.getViewModel();if(c){var b=c.getStore('userStore');if(b){b.reload()}}}},loadUsers:function(){var b=this.getViewModel();if(b){var a=b.getStore('userStore');if(a){a.load();if(a.numRealUsers){b.set('selectedUser',a.getAt(1))}else {b.set('selectedUser',a.getAt(0))}console.log('store loaded')}}},newUser:function(){this.fireEvent('main_showLoginForNewUser',null)},environmentStoreChanged:function(){this.loadUsers()},init:function(){this.callParent();var a=this.getViewModel();if(a&&a.get('bootstrapped')){this.loadUsers()}}});Ext.define('ABP.view.launch.selectuser.SelectUserModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.selectusermodel',requires:['Ext.data.StoreManager'],data:{selectedUser:null},stores:{userStore:{fields:['env','user','envName'],autoLoad:!1,autoSync:!0,proxy:{type:'memory',reader:{type:'json'}},numRealUsers:0,load:function(){var a=ABP.util.LocalStorage.getUserData();if(!Ext.isArray(a)){a=[]}Ext.Array.sort(a,function(c,d){if(Ext.isObject(c)&&Ext.isObject(d)){var a=parseInt(c.data.LastLogin);var b=parseInt(d.data.LastLogin);if(a&&!b){return -1}else {if(!a&&b){return 1}else {if(!a&&!b){return 0}else {if(a<b){return 1}else {if(a>b){return -1}}}}}}return 0});var c=Ext.data.StoreManager.lookup('ABPEnvironmentStore');if(c){if(Ext.isArray(a)&&a.length>0){for(var b=0;b<a.length;b++){var d=c.getById(a[b].env);if(d){a[b].envName=d.data.name}else {Ext.Array.removeAt(a,b);b--}}}}this.numRealUsers=a.length;a.unshift({user:ABP.util.Common.geti18nString('login_selectUserAnotherUser'),username:ABP.util.Common.geti18nString('login_selectUserAnotherUser'),useAnotherUser:!0});this.loadData(a);return this}}}});Ext.define('ABP.view.launch.settings.ExtraStepController',{extend:'Ext.app.ViewController',alias:'controller.extrastepcontroller',backButtonClick:function(){this.fireEvent('launchCarousel_Login',this)},continueButtonClick:function(){var d=this;var c=d.getView();var a=c.down('#ABPExtraStepCustomContainer');var b;if(a){a=a.down();if(a&&a.getController()&&a.getController().getSaveData){b=a.getController().getSaveData();if(b){d.fireEvent('main_secondAuthStep',b,c.config.additionalInfo.path)}}}}});Ext.define('ABP.view.launch.maintenance.ForcePasswordController',{extend:'Ext.app.ViewController',alias:'controller.forcepassword',listen:{component:{'*':{forcepw_Signin:'signInButtonClick'}}},backButtonClick:function(){this.fireEvent('launchCarousel_Login',this)},signInButtonClick:function(){var b=this;var a=b.getViewModel();var f=a.get('newPassword');var e=a.get('confirmPassword');if(f.length<=0||e<=0){if(f.length<=0){b.getView().down('#newPassword').addCls('login-error')}else {b.getView().down('#newPassword').removeCls('login-error')}if(e<=0){b.getView().down('#confirmPassword').addCls('login-error')}else {b.getView().down('#confirmPassword').removeCls('login-error')}ABP.view.base.popUp.PopUp.showPopup(a.get('i18n.login_recover_enterNewPassword'),a.get('i18n.error_ok_btn'))}else {b.getView().down('#newPassword').removeCls('login-error');b.getView().down('#confirmPassword').removeCls('login-error');if(a.get('newPassword')!==a.get('confirmPassword')){ABP.view.base.popUp.PopUp.showPopup(a.get('i18n.login_recover_passwordsDoNotMatch'),a.get('i18n.error_ok_btn'))}else {var c=a.get('forcePasswordChange');var d={'environment':c.environment,'logonId':c.logonId,'password':c.password,'newPassword':a.get('newPassword')};b.fireEvent('main_showLoading','Sending Request','fullSize');var g='/abp/ChangePassword/';Ext.Ajax.request({url:b.getServerUrl()+g,disableCaching:!1,withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version>9,method:'POST',jsonData:d,success:function(f){var e=Ext.JSON.decode(f.responseText);if(e.resultCode===0){c.password=d.newPassword;b.fireEvent('main_Authenticate',c)}else {if(e.resultCode>=1&&e.resultCode<=6){var g=a.get('i18n.'+e.errorMessageKey);ABP.view.base.popUp.PopUp.showPopup(g||e.errorMessage,a.get('i18n.error_ok_btn'));b.fireEvent('main_hideLoading')}else {ABP.view.base.popUp.PopUp.showPopup(a.get('i18n.login_recover_passwordChangeFailed'),a.get('i18n.error_ok_btn'));b.fireEvent('main_hideLoading')}}},failure:function(){b.fireEvent('main_hideLoading');ABP.view.base.popUp.PopUp.showPopup(a.get('i18n.login_recover_passwordChangeFailed'),a.get('i18n.error_ok_btn'))}})}}},getServerUrl:function(){return ABP.util.LocalStorage.get('ServerUrl')}});Ext.define('ABP.view.launch.maintenance.ForcePasswordModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.forcepassword',data:{newPassword:'',confirmPassword:''}});Ext.define('ABP.view.launch.settings.OfflinePasswordController',{extend:'Ext.app.ViewController',alias:'controller.offlinepasswordcontroller',listen:{component:{'*':{savepassword:'saveButtonClick'}}},cancelButtonClick:function(){if(!ABP.util.Config.getLoggedIn()){ABP.util.LocalStorage.setForLoggedInUser('OfflinePasswordSkipped',!0);this.fireEvent('main_doConfiguration')}else {this.fireEvent('featureCanvas_hideSetting')}},saveButtonClick:function(){var b=this;var h=b.getView();var g=this.getViewModel();var d=b.lookupReference('offlinepassword');var c=b.lookupReference('confirmofflinepassword');var a=d.getValue();var e=c.getValue();if(!a){d.markInvalid('Enter a password');d.focus();return}if(!e){c.markInvalid('Enter password again');c.focus();return}if(a!==e){ABP.view.base.popUp.PopUp.showError('offline_passwords_dont_match');return}if(g.get('bootstrapConf.validateOfflinePassword')===!0){var f=ABP.util.LocalStorage.get('ServerUrl');jsonData={logonId:ABP.util.Config.getUsername(),environment:ABP.util.Config.getEnvironment(),offlinePassword:a};ABP.util.Ajax.request({url:f+'/abp/offlinePassword',withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version>9,method:'POST',jsonData:jsonData,success:function(d){var c=Ext.JSON.decode(d.responseText);if(c.resultCode===0){b.saveOfflinePassword(a)}else {ABP.view.base.popUp.PopUp.showPopup(c.errorMessage,'error_ok_btn');return}},failure:function(a){ABP.view.base.popUp.PopUp.showPopup('login_error_authFailure','error_ok_btn')}})}else {b.saveOfflinePassword(a)}},saveOfflinePassword:function(a){ABP.util.LocalStorage.removeForLoggedInUser('OfflinePasswordSkipped');var b=ABP.util.Sha256.generateSaltForUser(ABP.util.Config.getUsername(),ABP.util.Config.getEnvironment());ABP.util.LocalStorage.setForLoggedInUser('OfflinePassword',ABP.util.Sha256.sha256(a,b));if(!ABP.util.Config.getLoggedIn()){this.fireEvent('main_doConfiguration')}else {this.fireEvent('featureCanvas_hideSetting')}}});Ext.define('ABP.view.launch.maintenance.RecoverPasswordController',{extend:'Ext.app.ViewController',alias:'controller.recoverpassword',listen:{component:{'*':{recoverpw_Send:'sendButtonClick'}}},backButtonClick:function(){this.fireEvent('launchCarousel_Login',this)},sendButtonClick:function(){var a=this;var b=a.getViewModel();var d='';var c='';if(b.get('env_selection')){c=b.get('env_selection').id}if(b.get('recover_id')){d=b.get('recover_id')}if(c!==''&&d!==''){a.getView().down('#rec-environment-combo').removeCls('login-error');a.getView().down('#recUrl').removeCls('login-error');a.fireEvent('main_showLoading','Sending Request','fullSize');var e='/abp/RecoverPassword?loginId='+b.get('recover_id')+'&environment='+c;Ext.Ajax.request({url:a.getServerUrl()+e,disableCaching:!1,withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version>9,method:'GET',success:function(b){var c=Ext.JSON.decode(b.responseText);a.fireEvent('main_hideLoading');if(c.resultCode===0){ABP.view.base.popUp.PopUp.showPopup('login_recover_submit_success','error_ok_btn',function(){a.fireEvent('launchCarousel_Login',a)})}},failure:function(){a.fireEvent('main_hideLoading');ABP.view.base.popUp.PopUp.showPopup(b.get('login_recover_failed'),b.get('i18n.error_ok_btn'))}})}else {if(c===''){a.getView().down('#rec-environment-combo').addCls('login-error')}else {a.getView().down('#rec-environment-combo').removeCls('login-error')}if(d===''){a.getView().down('#recUrl').addCls('login-error')}else {a.getView().down('#recUrl').removeCls('login-error')}if(c===''||d===''){ABP.view.base.popUp.PopUp.showPopup('login_all_fields','error_ok_btn')}}},getServerUrl:function(){return ABP.util.LocalStorage.get('ServerUrl')}});Ext.define('ABP.view.launch.maintenance.RecoverPasswordModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.recoverpassword',data:{recover_id:''},formulas:{environment:{bind:{_def:'{bootstrapConf.defaultEnvironment}',_avail:'{bootstrapConf.availableEnvironments}',_selected:'{env_selection}'},get:function(a){if(a._selected&&a._selected.id){return a._selected.id}var b;if(a._def&&a._avail){for(b=0;b<a._avail.length;++b){if(a._avail[b].id===a._def||a._avail[b].name===a._def){return a._avail[b].id}}}else {if(a._avail.length>0){return a._avail[0].id}}return null}}}});Ext.define('ABP.view.launch.settings.SettingsController',{extend:'Ext.app.ViewController',alias:'controller.settingscontroller',listen:{component:{'*':{settings_save:'saveButtonClick',server_url_select:'serverUrlSelect',delete_server_url:'deleteServerUrl'}},controller:{'*':{settings_refresh_server_url:'refreshServerUrl'}}},init:function(){var a=ABP.util.LocalStorage.get('ServerUrl');this.saveServerUrl(a)},onMoreServerUrlsClick:function(){var d=this.getView();var a=d.down('#moreServerUrls');if(a&&!a.destroyed){var c=a.getCollapsed()===!1?!1:!0;a[Ext.toolkit==='modern'?'toggleCollapsed':'toggleCollapse'](!c,null);var b=d.down('#moreServerUrls-label');if(b){if(c){b.setIconCls('icon-navigate-open')}else {b.setIconCls('icon-navigate-close')}}}},serverUrlSelect:function(a){if(a){var c=this.getView();var b=c.down('#url');if(b){b.setValue(a.get('url'))}}},deleteServerUrl:function(b){if(b){var a=Ext.data.StoreManager.lookup('ABPServerUrlStore');if(a){if(a){a.remove(b)}}}},refreshServerUrl:function(){var b=this.getView();var a=b.down('#url');if(a){a.setValue(ABP.util.LocalStorage.get('ServerUrl'))}},backButtonClick:function(){this.fireEvent('launchCarousel_Login',this)},saveButtonClick:function(){var a=this;var e=a.getView();var b=e.down('#url').getValue();var d=!0;var c;if(b.length<=0){c=a.getViewModel();a.getView().down('#url').markInvalid(c.get('i18n.login_all_fields'));ABP.view.base.popUp.PopUp.showPopup(c.get('i18n.login_all_fields'),c.get('i18n.error_ok_btn'))}else {a.getView().down('#url').clearInvalid();b=b.trim();if(!a.isValidServerUrl(b)){ABP.view.base.popUp.PopUp.showPopup('login_settings_invalidurl');this.fireEvent('main_hideLoading');d=!1}if(d){if(!e.down('#settingsExtraFieldCont')||a.extraFieldsCheck()){ABP.util.LocalStorage.set('ServerUrl',b);a.saveServerUrl(b);this.fireEvent('main_relaunch',this)}}}},extraFieldsCheck:function(){var g=this;var j=g.getViewModel();var i=g.getView();var b=i.down('#settingsExtraFieldCont').items.items;var e=!0;var d=[];var a=0;if(!Ext.isEmpty(b)){for(a;a<b.length;++a){if(b[a].checkValue&&!b[a].checkValue()){e=!1;break}if(b[a].getValue()!==''){var h=b[a].getItemId().slice(19);var c=null;if(b[a].xtype==='combo'){c=b[a].getRawValue()}else {if(b[a].xtype==='button'&&Ext.isFunction(b[a].getFieldData)){buttonvals=b[a].getFieldData();if(buttonvals){for(var f in buttonvals){d.push({fieldId:f,val:buttonvals[f]})}continue}}else {c=b[a].getValue()}}d.push({fieldId:h,val:c})}else {e=!1;ABP.view.base.popUp.PopUp.showError('login_all_fields');break}}j.getParent().getParent().set('prebootstrapExtraSettingsFilled',d);ABP.util.LocalStorage.remove('settingsextrafields')}return e},isValidServerUrl:function(a){if(!a){return !1}return /^(?:(?:https?):\/\/)(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*|(?:(?:[a-z\u00a1-\uffff0-9]+_?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*)(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(a)},privates:{saveServerUrl:function(a){if(!Ext.isEmpty(a)){var b=Ext.data.StoreManager.lookup('ABPServerUrlStore');if(b){if(b.find('url',a)===-1){b.insert(0,{url:a})}}}}}});Ext.define('ABP.view.launch.settings.SettingsModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.settingsmodel',requires:['ABP.store.ABPServerUrlStore'],data:{url:{},language:{}},stores:{serverUrlStore:'ABPServerUrlStore'},formulas:{saveButtonWidth:{bind:{_bootstrapped:'{bootstrapped}'},get:function(a){if(a._bootstrapped){return '49%'}return '100%'}},extraSettingsFields:{bind:{__injectedFields:'{injectedSettingsFields}',__extraFields:'{bootstrapConf.settings.extraSettingsFields}',__filledFields:'{prebootstrapExtraSettingsFilled}'},get:function(a){var d=[];var f=ABP.util.Common.getClassic();var b=0;var c,e;if(a.__injectedFields){if(f){for(b=0;b<a.__injectedFields.length;b++){if(this.__checkForExistingFieldId(d,a.__injectedFields[b].fieldId)){if(!Ext.isEmpty(a.__filledFields)){c=this.__matchField(a.__injectedFields[b],a.__filledFields)}else {e=this.__checkForSavedValue(a.__injectedFields[b].fieldId);if(!Ext.isEmpty(e)){c=e}}if(a.__injectedFields[b].type){if(a.__injectedFields[b].type==='text'){d.push(this.__makeClassicTextField(a.__injectedFields[b],c))}else {if(a.__injectedFields[b].type==='list'&&a.__injectedFields[b].options&&a.__injectedFields[b].options.length>0){d.push(this.__makeClassicListField(a.__injectedFields[b],c))}else {if(a.__injectedFields[b].type==='toggle'){d.push(this.__makeClassicToggleField(a.__injectedFields[b],c))}else {if(a.__injectedFields[b].type==='number'){d.push(this.__makeClassicNumericField(a.__injectedFields[b],c))}else {if(a.__injectedFields[b].type==='button'){d.push(this.__makeClassicButton(a.__injectedFields[b],c))}}}}}}}}}else {for(b=0;b<a.__injectedFields.length;b++){if(this.__checkForExistingFieldId(d,a.__injectedFields[b].fieldId)){if(!Ext.isEmpty(a.__filledFields)){c=this.__matchField(a.__injectedFields[b],a.__filledFields)}else {e=this.__checkForSavedValue(a.__injectedFields[b].fieldId);if(!Ext.isEmpty(e)){c=e}}if(a.__injectedFields[b].type){if(a.__injectedFields[b].type==='text'){d.push(this.__makeModernTextField(a.__injectedFields[b],c))}else {if(a.__injectedFields[b].type==='list'&&a.__injectedFields[b].options&&a.__injectedFields[b].options.length>0){d.push(this.__makeModernListField(a.__injectedFields[b],c))}else {if(a.__injectedFields[b].type==='toggle'){d.push(this.__makeModernToggleField(a.__injectedFields[b],c))}else {if(a.__injectedFields[b].type==='number'){d.push(this.__makeModernNumericField(a.__injectedFields[b],c))}else {if(a.__injectedFields[b].type==='button'){d.push(this.__makeModernButton(a.__injectedFields[b],c))}}}}}}}}}}if(a.__extraFields){if(f){if(Ext.isArray(a.__extraFields)){for(b=0;b<a.__extraFields.length;b++){if(this.__checkForExistingFieldId(d,a.__extraFields[b].fieldId)){if(!Ext.isEmpty(a.__filledFields)){c=this.__matchField(a.__extraFields[b],a.__filledFields)}else {e=this.__checkForSavedValue(a.__extraFields[b].fieldId);if(!Ext.isEmpty(e)){c=e}}if(a.__extraFields[b].type){if(a.__extraFields[b].type==='text'){d.push(this.__makeClassicTextField(a.__extraFields[b],c))}else {if(a.__extraFields[b].type==='list'&&a.__extraFields[b].options&&a.__extraFields[b].options.length>0){d.push(this.__makeClassicListField(a.__extraFields[b],c))}else {if(a.__extraFields[b].type==='toggle'){d.push(this.__makeClassicToggleField(a.__extraFields[b],c))}else {if(a.__extraFields[b].type==='number'){d.push(this.__makeClassicNumericField(a.__extraFields[b],c))}else {if(a.__extraFields[b].type==='button'){d.push(this.__makeClassicButton(a.__extraFields[b],c))}}}}}}}}}else {if(this.__checkForExistingFieldId(d,a.__extraFields.fieldId)){if(!Ext.isEmpty(a.__filledFields)){c=this.__matchField(a.__extraFields,a.__filledFields)}else {savevdVal=this.__checkForSavedValue(a.__extraFields.fieldId);if(!Ext.isEmpty(e)){c=e}}if(a.__extraFields.type){if(a.__extraFields.type==='text'){d.push(this.__makeClassicTextField(a.__extraFields,c))}else {if(a.__extraFields.type==='list'&&a.__extraFields.options&&a.__extraFields.options.length>0){d.push(this.__makeClassicListField(a.__extraFields,c))}else {if(a.__extraFields.type==='toggle'){d.push(this.__makeClassicToggleField(a.__extraFields,c))}else {if(a.__extraFields.type==='button'){d.push(this.__makeClassicButton(a.__extraFields,c))}}}}}}}}else {if(Ext.isArray(a.__extraFields)){for(b=0;b<a.__extraFields.length;b++){if(this.__checkForExistingFieldId(d,a.__extraFields[b].fieldId)){if(!Ext.isEmpty(a.__filledFields)){c=this.__matchField(a.__extraFields[b],a.__filledFields)}else {e=this.__checkForSavedValue(a.__extraFields[b].fieldId);if(!Ext.isEmpty(e)){c=e}}if(a.__extraFields[b].type){if(a.__extraFields[b].type==='text'){d.push(this.__makeModernTextField(a.__extraFields[b],c))}else {if(a.__extraFields[b].type==='list'&&a.__extraFields[b].options&&a.__extraFields[b].options.length>0){d.push(this.__makeModernListField(a.__extraFields[b],c))}else {if(a.__extraFields[b].type==='toggle'){d.push(this.__makeModernToggleField(a.__extraFields[b],c))}else {if(a.__extraFields[b].type==='number'){d.push(this.__makeModernNumericField(a.__extraFields[b],c))}else {if(a.__extraFields[b].type==='button'){d.push(this.__makeModernButton(a.__extraFields[b],c))}}}}}}}}}else {if(this.__checkForExistingFieldId(d,a.__extraFields.fieldId)){if(!Ext.isEmpty(a.__filledFields)){c=this.__matchField(a.__extraFields,a.__filledFields)}else {e=this.__checkForSavedValue(a.__extraFields.fieldId);if(!Ext.isEmpty(e)){c=e}}if(a.__extraFields.type){if(a.__extraFields.type==='text'){d.push(this.__makeModernTextField(a.__extraFields,c))}else {if(a.__extraFields.type==='list'&&a.__extraFields.options&&a.__extraFields.options.length>0){d.push(this.__makeModernListField(a.__extraFields,c))}else {if(a.__extraFields.type==='toggle'){d.push(this.__makeModernToggleField(a.__extraFields,c))}else {if(a.__extraFields.type==='number'){d.push(this.__makeModernNumericField(a.__extraFields,c))}else {if(a.__extraFields.type==='button'){d.push(this.__makeModernButton(a.__extraFields,c))}}}}}}}}}}return d}}},__makeClassicTextField:function(a,b){return {xtype:'textfield',cls:'a-extrasettingsfield-text-'+a.fieldId,width:'100%',labelAlign:'top',fieldLabel:ABP.util.Common.geti18nString(a.label),itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,value:b||a.value,listeners:{specialkey:function(d,c){if(c.getKey()===c.ENTER){d.fireEvent('settings_save')}}}}},__makeClassicListField:function(a,b){return {xtype:'combo',cls:'launch-combo-box a-extrasettingsfield-list-'+a.fieldId,width:'100%',labelAlign:'top',fieldLabel:ABP.util.Common.geti18nString(a.label),itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,store:{data:a.options},displayField:'name',value:b!==null?b:a.options[0].key,valueField:'key',triggerAction:'all',allowBlank:!1,labelWidth:0,editable:!1,autoSelect:!0}},__makeClassicToggleField:function(a,c){var b=a.active==='true'||a.active===!0;if(!Ext.isEmpty(c)){b=c}return {xtype:'button',width:'100%',cls:'login-keepme a-extrasettingsfield-button-'+a.fieldId,itemId:'extraSettingsFields'+a.fieldId,text:ABP.util.Common.geti18nString(a.text),iconCls:b?'icon-checked-square':'icon-unchecked-square',active:b,value:b,handler:function(){this.active=!this.active;if(this.active){this.setIconCls('icon-checked-square')}else {this.setIconCls('icon-unchecked-square')}this.value=this.active}}},__makeClassicNumericField:function(a,c){var b=null;if(a.maxVal){b=a.maxVal.toString().length}return {xtype:'numberfield',cls:'a-extrasettingsfield-text-'+a.fieldId,width:'100%',labelAlign:'top',fieldLabel:ABP.util.Common.geti18nString(a.label),itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,value:c,maxValue:a.maxVal?parseFloat(a.maxVal):null,minValue:a.minVal?parseFloat(a.minVal):null,maxLength:b,enforceMaxLength:!0,checkValue:function(){var f=!0;var g=this.getValue();var d=this.maxValue;var e=this.minValue;var b;if(e&&g<e){b=ABP.util.Common.geti18nString('login_extraValue');f=!1;ABP.view.base.popUp.PopUp.showError(this.getEmptyText()+' '+b+' ('+e+'-'+d+')')}else {if(d&&g>d){b=ABP.util.Common.geti18nString('login_extraValue');f=!1;ABP.view.base.popUp.PopUp.showError(this.getEmptyText()+' '+b+' ('+e+'-'+d+')')}}return f}}},__makeClassicButton:function(a){var d=a.action;var b;var c;switch(d){case 'popup':b=function(){c=Ext.create('ABP.view.base.popUp.PopUpFrame',{config:{buttonInfo:a}});c.show()};break;case 'redirect':b=function(){window.location.href=a.url};break;case 'newTab':b=function(){window.open(a.url)};break;}return {xtype:'button',handler:b,cls:'btn-extra a-extrasettingsfield-button-'+a.fieldId,itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,bind:{text:a.labelKey?'{i18n.'+a.labelKey+'}':a.label},width:'100%',fieldData:null,setFieldData:function(b){this.fieldData=b},getFieldData:function(){return this.fieldData}}},__makeModernTextField:function(a,b){return {xtype:'textfield',cls:'x-unselectable login-form a-extraloginfield-text-'+a.fieldId,width:'100%',clearable:!1,allowBlank:'false',labelAlign:'top',label:ABP.util.Common.geti18nString(a.label),itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,value:b?b:''}},__makeModernListField:function(a,b){return {xtype:'selectfield',cls:'login-form a-extraloginfield-list-'+a.fieldId,width:'100%',labelAlign:'top',label:ABP.util.Common.geti18nString(a.label),itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,store:{data:a.options},displayField:'name',value:b!==null?b:a.options[0].key,valueField:'key',triggerAction:'all',allowBlank:!1,labelWidth:0,editable:!1,autoSelect:!0}},__makeModernToggleField:function(b,c){var a=b.active==='true'||b.active===!0;if(!Ext.isEmpty(c)){a=c}return {xtype:'button',cls:'login-keepme a-keepme-button',width:'100%',itemId:'extraSettingsFields'+b.fieldId,focusCls:'',text:ABP.util.Common.geti18nString(b.text),iconCls:a?'icon-checked-square':'icon-unchecked-square',active:a,value:a,handler:function(){this.active=!this.active;if(this.active){this.setIconCls('icon-checked-square')}else {this.setIconCls('icon-unchecked-square')}this.setValue(this.active)}}},__makeModernNumericField:function(a,b){var c=null;if(a.maxVal){c=a.maxVal.toString().length}return {xtype:'abpnumberfield',cls:'x-unselectable login-form a-extraloginfield-text-'+a.fieldId,width:'100%',clearable:!1,allowBlank:'false',labelAlign:'top',label:ABP.util.Common.geti18nString(a.label),itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,maxValue:a.maxVal?parseFloat(a.maxVal):null,minValue:a.minVal?parseFloat(a.minVal):null,value:b?b:'',maxLength:c}},__makeModernButton:function(a){var d=a.action;var b;var c;switch(d){case 'popup':b=function(){c=Ext.create({xtype:'popupframe',config:{buttonInfo:a}});c.show()};break;case 'redirect':b=function(){window.location.href=a.url};break;case 'newTab':b=function(){window.open(a.url)};break;}return {xtype:'button',handler:b,cls:['btn-login','login-form','a-extrasettingsfield-button-'+a.fieldId],itemId:'extraSettingsFields'+a.fieldId,fieldId:a.fieldId,margin:'6 0 4 0',bind:{text:a.labelKey?'{i18n.'+a.labelKey+'}':a.label},width:'100%',fieldData:null,setFieldData:function(b){this.fieldData=b},getFieldData:function(){return this.fieldData}}},__matchField:function(e,d){var b=null;var c;var a=0;for(a;a<d.length;a++){if(d[a].fieldId===e.fieldId){b=d[a].val;break}}if(b===null){c=this.__checkForSavedValue(e);if(c){b=c}}return b},__checkForExistingFieldId:function(b,d){var a=0;var c=!0;for(a=0;a<b.length;++a){if(b[a].fieldId===d){c=!1;break}}return c},__checkForSavedValue:function(e){var c=ABP.util.LocalStorage.get('settingsextrafields');var b;var d=null;var a=0;if(c){b=JSON.parse(c);for(a=0;a<b.length;++a){if(b[a].fieldId===e){d=b[a].val;break}}}return d}});Ext.define('ABP.view.launch.loading.LoadingScreen',{extend:'Ext.container.Container',alias:'widget.apteanloadingscreen',componentCls:'launch-canvas',layout:{type:'vbox',align:'center',pack:'center'},initComponent:function(){this.items=[{xtype:'container',height:140,layout:{type:'vbox',align:'center'},items:[{xtype:'component',html:'<div class="login-hdr"></div>',focusable:!1},{xtype:'component',componentCls:'bootstrap-loading',flex:1,html:'Connecting<div class="bootstrap-loading-dot1">.</div><div class="bootstrap-loading-dot2">.</div><div class="bootstrap-loading-dot3">.</div>'}]}];this.callParent()}});Ext.define('ABP.view.base.noSupport.NoSupport',{});Ext.define('ABP.view.session.offline.PasswordPromptModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.abp-passwordprompt',data:{passwordLabel:null,okBtnLabel:null,cancelBtnlabel:null}});Ext.define('ABP.view.session.offline.PasswordPromptController',{extend:'Ext.app.ViewController',requires:['ABP.view.session.offline.PasswordPromptModel'],alias:'controller.passwordprompt',onOkClicked:function(){var b=this,c=b.getView(),f=b.getViewModel(),d=c.down('#password'),e=d.getValue();var a={};a.environment=ABP.util.Config.getEnvironment();a.logonId=ABP.util.Config.getUsername();a.password=e;ABP.util.Common.setViewModelProperty('switchToOnline',!0);b.fireEvent('main_Authenticate',a);c.close()},onCancelClicked:function(){var b=this;var a=b.getView();a.close()}});Ext.define('ABP.view.session.offline.PasswordPrompt',{extend:'Ext.panel.Panel',requires:['ABP.view.session.offline.PasswordPromptController'],alias:'widget.passwordprompt',controller:'passwordprompt',layout:{type:'vbox',align:'center',pack:'center'},floating:!0,cls:'favoriteseditpanel',bodyCls:'x-unselectable',floating:!0,modal:!0,bind:{title:'{i18n.offline_promptpassword_title:htmlEncode}'},width:275,shadow:!1,items:[{xtype:'textfield',width:250,allowBlank:!1,itemId:'password',inputType:'password',labelAlign:'top',bind:{fieldLabel:'{i18n.offline_password_prompt:htmlEncode}'},keyMap:{'ENTER':{handler:'onOkClicked'}}}],bbar:{defaults:{border:!1},items:['->',{bind:{text:'{i18n.button_cancel:htmlEncode}'},automationCls:'offline-passwordPrompt-cancel',width:100,handler:'onCancelClicked'},{bind:{text:'{i18n.button_OK:htmlEncode}'},automationCls:'offline-passwordPrompt-ok',width:100,handler:'onOkClicked'}]}});Ext.define('ABP.view.session.SessionBannerController',{extend:'Ext.app.ViewController',alias:'controller.sessionbannercontroller',listen:{controller:{'*':{abp_headlines_show:'showHeadlines',abp_headlines_hide:'hideHeadline'}},component:{'headline':{headline_action:'actionHeadline',headline_read:'readHeadline'}}},init:function(){var b=this;b.callParent(arguments);var a=ABP.util.Config.getBootstrapConfig();if(a&&a.headlines){b.fireEvent('main_processHeadlines',a.headlines,!0)}},showHeadlines:function(d){var g=this,f=g.getView(),a,c=[],e=d.length;for(var b=0;b<e;b++){a=d[b];c.push({xtype:'headline',single:!!a.single,uniqueId:a.uniqueId,message:a.message,messageKey:a.messageKey,priority:a.priority,actionText:a.actionText,actionTextKey:a.actionTextKey})}if(e>0){f.insert(0,c)}},hideHeadline:function(c){var d=this;var a=d.getView();if(a.items&&a.items.length===1){var b=a.items.getAt(0);if(b.uniqueId===c){a.remove(b)}}},actionHeadline:function(a){var b=a.uniqueId;this.fireEvent('headline_action',b)},readHeadline:function(b){var a=b.uniqueId,c=b.single;if(!c){if(ABP.util.Config.getLoggedIn()){ABP.util.LocalStorage.setForLoggedInUser('hr-'+a,!0)}else {ABP.util.LocalStorage.set('hr-'+a,!0)}}this.fireEvent('headline_read',a)}});Ext.define('ABP.view.session.SessionBanner',{extend:'Ext.Container',requires:['ABP.view.session.SessionBannerController'],dock:'top',xtype:'sessionbanner',controller:'sessionbannercontroller',layout:'fit',cls:'session-banner',ariaRole:'banner'});Ext.define('ABP.view.launch.login.Login',{extend:'Ext.panel.Panel',requires:['ABP.view.launch.login.LoginController','ABP.view.launch.login.LoginModel'],alias:'widget.login',controller:'logincontroller',viewModel:{type:'loginmodel'},scrollable:{y:!0,x:!1},flex:1,listeners:{scope:'controller',boxready:'onBoxready',tabchanged:'onTabChanged'},cls:'main-content-wrapper',items:[{xtype:'container',cls:'main-content',width:'100%',layout:{type:'vbox',align:'middle',pack:'start'},defaults:{labelAlign:'top',msgTarget:'none'},defaultType:'abptext',items:[{width:'100%',itemId:'username',reference:'usernameField',allowBlank:!1,bind:{value:'{username}',disabled:'{preauthenticated}',fieldLabel:'{i18n.login_username:htmlEncode}',hidden:'{!showUsernameField}'},tabIndex:1,listeners:{specialkey:function(b,a){if(a.getKey()===a.ENTER){b.fireEvent('login_UserHit')}},scope:this},automationCls:'login-username',spellcheck:!1,inputAttrTpl:['autocapitalize="off" automationId="loginUsername"']},{width:'100%',itemId:'password',reference:'passwordField',inputType:'password',tabIndex:2,allowBlank:!1,bind:{value:'{password}',hidden:'{!showPasswordField}',fieldLabel:'{passwordText:htmlEncode}'},automationCls:'login-password',inputAttrTpl:['automationId="loginPassword"'],listeners:{specialkey:function(b,a){if(a.getKey()===a.ENTER){b.blur();b.fireEvent('login_PassHit')}},scope:this},focusable:!0},{xtype:'combo',width:'100%',itemId:'login-environment',listConfig:{cls:'abp-login-combo a-environment-options a-combo-'+Ext.os.deviceType},bind:{store:'{main_environmentStore}',value:'{environment}',selection:'{env_selection}',fieldLabel:'{i18n.login_environment:htmlEncode}',hidden:'{hideEnvironment}'},triggerAction:'all',cls:'launch-combo-box top-combo-box a-environment-combo',queryMode:'local',editable:!1,forceSelection:!0,displayField:'name',valueField:'id',tabIndex:3,autoSelect:!0,focusable:!0,listeners:{change:function(b,a){b.fireEvent('login_environmentChanged',a)},scope:this},shadow:'sides'},{xtype:'combo',width:'100%',itemId:'login-language',bind:{store:'{login_settingsStore}',selection:'{lan_selection}',fieldLabel:'{i18n.login_language:htmlEncode}',value:'{language}',hidden:'{hideLanguage}'},listConfig:{cls:'abp-login-combo a-language-options a-combo-'+Ext.os.deviceType},triggerAction:'all',cls:'launch-combo-box a-language-combo',queryMode:'local',editable:!1,forceSelection:!0,displayField:'name',valueField:'key',tabIndex:4,autoSelect:!0,visible:!1},{xtype:'container',width:'100%',layout:'vbox',itemId:'loginExtraFieldCont',items:[],bind:{items:'{extraLoginFields}'},setItems:function(a){Ext.suspendLayouts();this.removeAll();this.add(a);Ext.resumeLayouts(!0)}}]},{xtype:'container',cls:'main-content-footer',width:'100%',layout:{type:'vbox',align:'middle',pack:'start'},items:[{xtype:'button',itemId:'loginButton',width:'100%',bind:{text:'{loginBtnText:htmlEncode}'},cls:'btn-login a-login-button',flex:1,tabIndex:5,height:40,frame:!1,handler:'loginButtonClick',focusable:!0},{xtype:'button',cls:'login-keepme a-keepme-button',itemId:'loginKeepMe',bind:{text:'{i18n.login_keepMeSignedIn:htmlEncode}',iconCls:'{keepMeSignedInIcon}',hidden:'{!canKeepMeSignedIn}'},handler:'keepMeSignedInClicked',tabIndex:6},{xtype:'button',cls:'login-forgotpassword a-forgot-password',itemId:'forgotpassword-label',bind:{html:'{i18n.login_forgotpassword:htmlEncode}',visible:'{canRecoverPassword}',focusable:'{canRecoverPassword}'},tabIndex:7,frame:!1,textAlign:'center',listeners:{click:'onForgotPasswordClick'},setFocusable:function(a){this.focusable=a}},{xtype:'button',itemId:'settingsButton',cls:'login-settings a-login-settings',iconCls:'icon-gearwheel',tabIndex:8,frame:!1,ariaLabel:'settings',handler:'onSettingsClick',focusable:!0,bind:{visible:'{allowServiceChange}'}}]}]});Ext.define('ABP.view.base.popUp.PopUpFrame',{extend:'Ext.panel.Panel',alias:'widget.popupframe',requires:['ABP.view.base.popUp.PopUpHeader'],floating:!0,centered:!0,modal:!0,cls:'framePop',ui:'popup',width:'50%',minHeight:200,shadow:!1,header:{xtype:'popupheader'},dockedItems:[{xtype:'container',dock:'bottom',itemId:'errorPopButtonBar',cls:'errorpop-buttonbar',layout:{type:'hbox',pack:'end'},items:[{xtype:'button',frame:!1,width:100,bind:{text:'{i18n.login_save:htmlEncode}'},handler:function(){var a=this.up('popupframe');var b={};var c;if(a.config&&a.config.buttonInfo&&a.config.buttonInfo.contentXtype){b=a.down(a.config.buttonInfo.contentXtype);if(b&&b.getController()&&b.getController().getSaveData){c=b.getController().getSaveData();if(c){a.config.returnData=c}}else {a.closePopup()}}else {a.closePopup()}}},{xtype:'button',frame:!1,width:100,cls:'abp-popup-button',bind:{text:'{i18n.button_close:htmlEncode}'},handler:function(){this.up('popupframe').closePopup()}}]}],initComponent:function(){if(this.config&&this.config.buttonInfo){if(this.config.buttonInfo.contentXtype){this.items=[{xtype:this.config.buttonInfo.contentXtype,padding:10}]}if(this.config.buttonInfo.contentTitle){this.header.title=this.config.buttonInfo.contentTitle}}this.addBodyCls('framePop-body');this.callParent()},closePopup:function(){if(this.config&&this.config.returnData&&this.config.returnData){Ext.getApplication().getMainView().down('[fieldId='+this.config.buttonInfo.fieldId+']').setFieldData(this.config.returnData)}this.destroy()},getHeader:function(){return this.header.getInnerHeader()}});Ext.define('ABP.view.launch.settings.Settings',{extend:'Ext.panel.Panel',requires:['ABP.view.launch.settings.SettingsController','ABP.view.launch.settings.SettingsModel','ABP.view.base.popUp.PopUpFrame','Ext.panel.Panel','Ext.form.field.ComboBox'],alias:'widget.settings',controller:'settingscontroller',viewModel:{type:'settingsmodel'},defaultType:'textfield',stores:['SettingsLanguageStore'],models:['SettingsLanguageModel'],cls:'main-content-wrapper',items:[{xtype:'container',cls:'main-content',layout:{type:'vbox',align:'middle'},height:'100%',width:'100%',items:[{xtype:'abpheadercomponent',cls:'settings-title',width:'100%',componentCls:'x-unselectable',bind:{html:'{i18n.login_settingsTitle:htmlEncode}'}},{xtype:'component',itemId:'settingsGuide',width:'100%',ariaRole:'status',componentCls:'settings-text x-unselectable',bind:{html:'{i18n.login_settingsInstructions:htmlEncode}'}},{xtype:'label',align:'middle',width:'100%',itemId:'settingsErrorLabel',cls:'error-label error-label-hide',text:'INVALID URL'},{xtype:'combo',width:'100%',labelAlign:'top',itemId:'url',bind:{fieldLabel:'{i18n.login_url:htmlEncode}',store:'{serverUrlStore}'},displayField:'url',valueField:'url',queryMode:'local',listConfig:{itemTpl:['<div class="server-url a-server-url" data-qtip="{url}">{url}</div>','<div class="delete-item" role="button" aria-label="Remove URL" title="Remove URL">','<span class="delete-item-icon icon-garbage-can"></span></div>'],listeners:{itemclick:function(c,b,f,e,a,d){if(Ext.isObject(a)){if(a.getTarget('.delete-item')){c.fireEvent('delete_server_url',b);return !1}}return !0}}}},{xtype:'container',layout:'vbox',itemId:'settingsExtraFieldCont',items:[],width:'100%',bind:{items:'{extraSettingsFields}'},setItems:function(a){Ext.suspendLayouts();this.removeAll();this.add(a);Ext.resumeLayouts(!0)}}]},{xtype:'container',cls:'main-content-footer buttons',items:[{xtype:'button',reference:'backButton',componentCls:'btn-login a-settings-back',handler:'backButtonClick',width:'49%',bind:{visible:'{bootstrapped}',text:'{i18n.login_back:htmlEncode}'}},{xtype:'button',itemId:'saveButton',componentCls:'btn-login a-settings-save',handler:'saveButtonClick',bind:{width:'{saveButtonWidth}',text:'{i18n.login_save:htmlEncode}'}}]}],initComponent:function(){var a=this;a.callParent();a.down('#url').setValue(ABP.util.LocalStorage.get('ServerUrl'))},afterRender:function(){var a=this;var b=a.lookupReference('backButton');a.callParent();a.el.on({keydown:function(a){if(a.keyCode===a.ESC){if(b.isVisible()){b.click()}}}})}});Ext.define('ABP.view.launch.maintenance.RecoverPassword',{extend:'Ext.panel.Panel',requires:['Ext.form.field.ComboBox','ABP.view.launch.maintenance.RecoverPasswordController','ABP.view.launch.maintenance.RecoverPasswordModel'],alias:'widget.recoverpassword',controller:'recoverpassword',viewModel:{type:'recoverpassword'},cls:'main-content-wrapper',items:[{xtype:'container',cls:'main-content',defaults:{align:'middle',labelAlign:'top'},layout:{type:'vbox',pack:'start'},height:'100%',width:'100%',items:[{xtype:'abpheadercomponent',width:'100%',cls:'settings-title',bind:{html:'{i18n.login_recoverTitle:htmlEncode}'}},{xtype:'component',width:'100%',itemId:'settingsGuide',ariaRole:'status',componentCls:'settings-text x-unselectable',bind:{html:'{i18n.login_recoverInstructions:htmlEncode}'}},{xtype:'textfield',align:'middle',width:'100%',bind:{value:'{recover_id}',fieldLabel:'{i18n.login_recover_id:htmlEncode}'},itemId:'recUrl',reference:'recoverPasswordId',value:'',requiredCls:'login-required-field',msgTarget:'side',cls:'x-unselectable a-recoverpw-userid',listeners:{specialkey:function(b,a){if(a.getKey()===a.ENTER){b.blur();b.fireEvent('recoverpw_Send')}}}},{xtype:'combo',itemId:'rec-environment-combo',width:'100%',bind:{store:'{main_environmentStore}',value:'{environment}',selection:'{env_selection}',fieldLabel:'{i18n.login_environment:htmlEncode}'},triggerAction:'all',requiredCls:'login-required-field',cls:'launch-combo-box top-combo-box a-recoverpw-environment',listConfig:{cls:'abp-login-combo a-recoverpassword-options',shadow:!1},queryMode:'local',editable:!1,forceSelection:!0,displayField:'name',valueField:'id',autoSelect:!0,focusable:!0,listeners:{change:function(b,a){b.fireEvent('login_environmentChanged',a)},scope:this}}]},{xtype:'container',cls:'main-content-footer buttons',items:[{xtype:'button',reference:'recBackButton',componentCls:'btn-login a-recoverpw-back',handler:'backButtonClick',width:'49%',bind:{text:'{i18n.login_recover_back:htmlEncode}'}},{xtype:'button',itemId:'recSendButton',componentCls:'btn-login a-recoverpw-send',handler:'sendButtonClick',width:'49%',bind:{text:'{i18n.login_recover_send:htmlEncode}'}}]}],afterRender:function(){var a=this;var b=a.lookupReference('recBackButton');a.callParent();a.el.on({keydown:function(a){if(a.keyCode===a.ESC){if(b.isVisible()){b.click()}}}})}});Ext.define('ABP.view.launch.maintenance.ForcePassword',{extend:'Ext.panel.Panel',requires:['Ext.panel.Panel','Ext.form.field.ComboBox','ABP.view.launch.maintenance.ForcePasswordController','ABP.view.launch.maintenance.ForcePasswordModel'],alias:'widget.forcepassword',defaultType:'textfield',controller:'forcepassword',viewModel:{type:'forcepassword'},tabIndex:-1,cls:'main-content-wrapper',items:[{xtype:'container',cls:'main-content',layout:{type:'vbox',align:'middle',pack:'start'},defaults:{labelAlign:'top'},height:'100%',width:'100%',items:[{xtype:'component',cls:'settings-title',width:'100%',bind:{html:'{i18n.login_forcepw_title:htmlEncode}'},tabIndex:-1},{xtype:'component',itemId:'forcepwGuide',width:'100%',componentCls:'settings-text x-unselectable',bind:{html:'{i18n.login_forcepw_instructions:htmlEncode}'},tabIndex:-1},{xtype:'textfield',align:'middle',width:'100%',bind:{value:'{newPassword}',fieldLabel:'{i18n.login_forcepw_newPassword:htmlEncode}'},inputType:'password',itemId:'newPassword',labelWidth:0,value:'',cls:'x-unselectable login-required-field a-forcechange-newpassword',tabIndex:1},{xtype:'textfield',align:'middle',width:'100%',bind:{value:'{confirmPassword}',fieldLabel:'{i18n.login_forcepw_confirmPassword:htmlEncode}'},inputType:'password',itemId:'confirmPassword',labelWidth:0,value:'',cls:'x-unselectable login-required-field a-forcechange-confirmpassword',tabIndex:2,listeners:{specialkey:function(b,a){if(a.getKey()===a.ENTER){b.blur();b.fireEvent('forcepw_Signin')}}}}]},{xtype:'container',cls:'main-content-footer buttons',items:[{xtype:'button',itemId:'forceBackButton',componentCls:'btn-login a-forcechange-back',width:'49%',handler:'backButtonClick',bind:{text:'{i18n.login_forcepw_back:htmlEncode}'}},{xtype:'button',itemId:'forceSignInButton',componentCls:'btn-login a-forcechange-signin',handler:'signInButtonClick',width:'49%',bind:{text:'{i18n.login_forcepw_signIn:htmlEncode}'}}]}]});Ext.define('ABP.view.launch.maintenance.ExtraStep',{extend:'Ext.container.Container',requires:['ABP.view.launch.settings.ExtraStepController'],alias:'widget.maintenanceextrastep',controller:'extrastepcontroller',cls:'main-content-wrapper',initItems:function(){var a=this.items[0].items;if(a){if(Ext.isArray(a)&&a.length===1){a.pop()}a.push({xtype:this.additionalInfo.xtype,additionalInfo:this.additionalInfo});this.items[0].items=a}this.callParent()},items:[{xtype:'container',cls:'main-content',layout:{type:'vbox',align:'middle',pack:'start'},width:'100%',defaults:{width:'100%'},items:[],itemId:'ABPExtraStepCustomContainer'},{xtype:'container',cls:'main-content-footer buttons',items:[{xtype:'button',reference:'backButton',componentCls:'btn-login a-extrastep-back',width:'49%',handler:'backButtonClick',bind:{text:'{i18n.login_back:htmlEncode}'}},{xtype:'button',itemId:'saveButton',width:'49%',componentCls:'btn-login a-extrastep-save',handler:'continueButtonClick',bind:{text:'{i18n.button_continue:htmlEncode}'}}]}]});Ext.define('ABP.view.launch.maintenance.OfflinePassword',{extend:'Ext.panel.Panel',requires:['ABP.view.launch.settings.OfflinePasswordController'],alias:'widget.offlinepassword',controller:'offlinepasswordcontroller',cls:'main-content-wrapper',items:[{xtype:'container',cls:'main-content',layout:{type:'vbox',align:'middle',pack:'center'},height:'100%',width:'100%',items:[{xtype:'component',width:'100%',componentCls:'settings-text x-unselectable',bind:{html:'{i18n.offline_login_instructions:htmlEncode}'}},{xtype:'textfield',width:'100%',labelAlign:'top',reference:'offlinepassword',inputType:'password',allowBlank:!1,tabIndex:2,bind:{fieldLabel:'{i18n.offline_login_password:htmlEncode}'},automationCls:'offline-login-password',inputAttrTpl:['automationId="offlineLoginPassword"'],focusable:!0},{xtype:'textfield',width:'100%',labelAlign:'top',reference:'confirmofflinepassword',inputType:'password',allowBlank:!1,tabIndex:2,bind:{fieldLabel:'{i18n.offline_login_confirmpassword:htmlEncode}'},automationCls:'offline-login-confirmpassword',inputAttrTpl:['automationId="confirmofflineLoginPassword"'],listeners:{specialkey:function(b,a){if(a.getKey()===a.ENTER){b.fireEvent('savepassword')}},scope:this},focusable:!0}]},{xtype:'container',cls:'main-content-footer buttons',items:[{xtype:'button',reference:'backButton',componentCls:'btn-login a-extrastep-back',width:'49%',handler:'cancelButtonClick',bind:{text:'{i18n.button_cancel:htmlEncode}'}},{xtype:'button',reference:'saveButton',width:'49%',componentCls:'btn-login a-extrastep-save',handler:'saveButtonClick',bind:{text:'{i18n.button_save:htmlEncode}'}}]}]});Ext.define('ABP.view.launch.maintenance.Maintenance',{extend:'Ext.container.Container',requires:['ABP.view.launch.maintenance.RecoverPassword','ABP.view.launch.maintenance.ForcePassword','ABP.view.launch.maintenance.ExtraStep','ABP.view.launch.maintenance.OfflinePassword'],alias:'widget.maintenance',layout:{type:'fit'},items:[],showScreen:function(a,b){var c=this.down(a);if(c&&a==='maintenanceextrastep'){this.removeAll();this.add({xtype:a,additionalInfo:b})}if(!c){this.removeAll();this.add({xtype:a,additionalInfo:b})}}});Ext.define('ABP.view.launch.selectuser.SelectUser',{extend:'Ext.container.Container',requires:['ABP.view.launch.selectuser.SelectUserController','ABP.view.launch.selectuser.SelectUserModel','ABP.view.base.popUp.PopUpFrame','Ext.panel.Panel','Ext.form.field.ComboBox'],alias:'widget.selectuser',controller:'selectusercontroller',viewModel:{type:'selectusermodel'},height:'100%',layout:{type:'vbox',align:'middle'},defaultFocus:'userList',initFocus:function(){var c=this,d=c.getViewModel(),b=d.get('selectedUser');if(b){var a=c.down('#userList');a.focus();var f=d.storeInfo.userStore.indexOf(b);var e=a.getNavigationModel();e.setPosition(f)}},items:[{xtype:'abpheadercomponent',cls:'settings-title',reference:'login-selectuser-title',width:250,componentCls:'x-unselectable',bind:{html:'{i18n.login_selectUserTitle:htmlEncode}'},tabIndex:-1},{xtype:'component',itemId:'selectUserGuide',reference:'login-selectuser-desc',width:250,componentCls:'settings-text x-unselectable',bind:{html:'{i18n.login_selectUserInstructions:htmlEncode}'},tabIndex:-1},{layout:'fit',width:250,height:280,xtype:'dataview',itemId:'userList',reference:'userList',cls:'selectuser-userList a-selectuser-userList',overItemCls:Ext.baseCSSPrefix+'grid-item-over',selectedItemCls:Ext.baseCSSPrefix+'grid-item-selected',bind:{store:'{userStore}',selection:'{selectedUser}'},scrollable:!0,ariaLabelledBy:'login-selectuser-title',ariaDescribedBy:'login-selectuser-desc',itemSelector:'li.selectuser-item',tpl:['<ul class="selectuser-items" role="list">','<tpl for=".">','<li class="selectuser-item" role="listitem">','<div class="selectuser-image"><span class="selectuser-image-icon {useAnotherUser:this.getClass(values.data)}" style="{data:this.getPhoto()}"></span></div>','<div style="display: inline-block" class="user-info">','<tpl if="useAnotherUser">','<div class="user-info-name a-selectuser-newuser">{username:htmlEncode}</div>','<tpl else>','<div class="user-info-name a-selectuser-user">{username:htmlEncode}</div>','<div class="user-info-env a-selectuser-env">{envName:htmlEncode}</div>','</tpl>','</div>','<tpl if="useAnotherUser">','<tpl else>','<div class="delete-item"><span class="delete-item-icon icon-garbage-can a-delete-item-icon"></span></div>','</tpl>','</li>','</tpl>','</ul>',{getClass:function(a,b){if(a){return 'icon-businessperson2 a-selectuser-newicon'}if(b.Photo){return 'user-photo a-selectuser-icon'}return 'icon-user a-selectuser-icon'},getPhoto:function(a){if(!a||!a.Photo){return ''}return 'background-image:url('+a.Photo+')'}}],listeners:{itemadd:function(){console.log('item added')},itemClick:function(b,a,f,e,c,d){if(Ext.isObject(c)){if(c.getTarget('.delete-item-icon')){b.fireEvent('selectuser_delete',a)}else {if(a){if(a.get('useAnotherUser')){b.fireEvent('selectuser_new')}else {b.fireEvent('selectuser_select',a)}}}}return !0},itemkeydown:function(c,a,f,e,b,d){if(Ext.isObject(b)){if(b.getKeyName()=='ENTER'||b.getKeyName()=='SPACE'){if(a&&a.get('useAnotherUser')){c.fireEvent('selectuser_new')}else {c.fireEvent('selectuser_select',a)}}else {if(b.getKeyName()=='DELETE'){if(a&&!a.get('useAnotherUser')){c.fireEvent('selectuser_delete',a)}}else {if(b.getKeyName()=='ESC'){c.fireEvent('selectuser_new')}}}}}}}]});Ext.define('ABP.view.launch.LaunchCarousel',{extend:'Ext.tab.Panel',requires:['ABP.view.launch.LaunchCarouselController','ABP.view.launch.LaunchCarouselModel'],alias:'widget.launchcarousel',controller:'launchcarouselcontroller',viewModel:'launchcarouselmodel',tabBar:{hidden:!0},listeners:{'afterRender':function(a){var c=a;var d=c.getViewModel();var b=d.get('startingLaunchCarouselTab');a.setActiveTab(b)}}});Ext.define('ABP.view.launch.discovery.Discovery',{extend:'Ext.panel.Panel',requires:['ABP.view.launch.discovery.DiscoveryController','ABP.view.launch.discovery.DiscoveryModel'],alias:'widget.discovery',controller:'discoverycontroller',viewModel:{type:'discoverymodel'},scrollable:{y:!0,x:!1},flex:1,listeners:{scope:'controller',boxready:'onBoxready'},cls:'main-content-wrapper',items:[{xtype:'container',cls:'main-content',width:'100%',layout:{type:'vbox',align:'middle',pack:'start'},defaults:{labelAlign:'top',msgTarget:'none'},defaultType:'abptext',items:[{type:'component',margin:'0 0 20 0',bind:{html:'{i18n.login_SSOHelp:htmlEncode}'}},{width:'100%',itemId:'email',reference:'emailField',tabIndex:1,bind:{value:'{email}',fieldLabel:'{i18n.login_emailOrOrganisation:htmlEncode}'},listeners:{specialkey:'handleSpecialKeys'},automationCls:'login-email',allowBlank:!1,spellcheck:!1,focusable:!0,inputAttrTpl:['autocapitalize="off" automationId="loginEmail"']},{xtype:'label',itemId:'errorText',padding:4,bind:{html:'{errorText}'}}]},{xtype:'container',cls:'main-content-footer',width:'100%',layout:{type:'vbox',align:'middle',pack:'start'},items:[{xtype:'button',itemId:'loginButton',width:'100%',bind:{text:'{i18n.button_next:htmlEncode}'},cls:'btn-login a-login-button',flex:1,tabIndex:5,height:40,frame:!1,handler:'loginButtonClick',focusable:!0}]}]});Ext.define('ABP.view.launch.LaunchCanvas',{extend:'Ext.panel.Panel',alias:'widget.launchcanvas',requires:['ABP.view.session.SessionBanner','ABP.view.launch.login.Login','ABP.view.launch.settings.Settings','ABP.view.launch.maintenance.Maintenance','ABP.view.launch.selectuser.SelectUser','ABP.view.launch.LaunchCarousel','ABP.view.launch.discovery.Discovery'],itemId:'launch-canvas',componentCls:'launch-canvas',cls:'launch-canvas',tbar:{xtype:'sessionbanner',ariaAttributes:{'aria-label':'Headline Message'},dock:'top'},layout:{type:'vbox',align:'center',pack:'center'},initComponent:function(){this.items=[{xtype:'container',componentCls:'login-form',width:380,minHeight:600,maxHeight:600,layout:{type:'vbox',align:'stretch',pack:'start'},items:[{xtype:'abpheadercomponent',cls:'login-hdr-wrapper',itemId:'login-title',ariaAttributes:{'aria-level':'1'},bind:{html:'<div class="login-hdr">{i18n.login_login_header:htmlEncode}</div>'},width:380,tabIndex:-1,focusable:!1},{xtype:'launchcarousel',padding:'0 0 24 0',minHeight:350,flex:1,items:[{title:'settings',xtype:'settings',itemId:'settings-tab',defaults:{padding:'0 24 0 24'}},{title:'login',xtype:'login',itemId:'login-tab',defaults:{padding:'0 44 0 44'}},{title:'maintenance',xtype:'maintenance',itemId:'maintenance-tab',defaults:{padding:'0 24 0 24'}},{title:'selectuser',xtype:'selectuser',itemId:'selectuser-tab'},{title:'discovery',xtype:'discovery',itemId:'discovery-tab',defaults:{padding:'0 44 0 44'}}]}]}];this.callParent()}});Ext.define('ABP.view.main.ABPMainController',{extend:'Ext.app.ViewController',alias:'controller.abpmaincontroller',requires:['ABP.util.Ajax','ABP.util.Discovery','ABP.util.AuthenticationManager','ABP.view.launch.loading.LoadingScreen','ABP.view.base.noSupport.NoSupport','ABP.view.base.automation.AutomationHintOverlay','ABP.util.LocalStorage','ABP.util.SessionStorage','ABP.util.ServiceManager','ABP.view.session.offline.PasswordPrompt','Ext.Package','ABP.util.Sha256','ABP.view.launch.LaunchCanvas','ABP.util.keyboard.Shortcuts','ABP.ThemeManager'],listen:{global:{main_tokenAuthenticate:'tokenAuthenticate'},controller:{'*':{main_Authenticate:'authenticate',main_doBootstrap:'doBootstrap',main_doConfiguration:'doConfiguration',main_getSubscriptionServices:'getSubscriptionServices',main_ShowLogin:'showLogin',main_ShowNoSupportPage:'showNoSupportPage',main_AddSession:'addSession',main_DestroySession:'destroySession',main_relaunch:'relaunch',main_appUnloaded:'onAppUnloaded',main_appLoaded:'onAppLoaded',main_appShutdown:'onAppShutdown',main_fireAppEvent:'fireAppEvent',main_logoutComplete:'logoutComplete',main_showLoading:'showLoading',main_switchLanguage:'switchLanguage',main_hideLoading:'hideLoading',main_forceLogin:'forceLogin',main_addDefaultLanguageStrings:'addDefaultLanguageStrings',main_saveExtraFieldInfo:'saveExtras',main_routingWarningCallback:'routingWarningCallback',main_secondAuthStep:'secondAuthStep',main_loginAsUser:'loginAsUser',main_showLoginForNewUser:'showLoginForNewUser',main_processHeadlines:'processHeadlines',main_pendingChanges:'pendingChangesToggle',main_activeAppFocus:'activeAppFocus',main_updateUserProfile:'onUpdateUserProfile',main_updateLanguageStrings:'updateLanguageStrings',container_go_online:'promptOnlineMode',container_go_offline:'promptOfflineMode',abp_milestone_authentication_success:'afterLoginSuccess'}},component:{'*':{main_fireAppEvent:'fireAppEvent'}},theme:{changed:'switchTheme'}},keyboardNavigator:null,requestingLogin:!1,init:function(){var a=this;var g=a.getViewModel();var e=ABP.util.LocalStorage.get('LoginAsUser');ABP.util.LocalStorage.remove('LoginAsUser');if(e){var b=ABP.util.Common.jsonDecode(e);if(Ext.isObject(b)){if((Date.now()-b.created)/1000<=ABP.util.Constants.login.loginAsUserLifetime){this.setLoginUser(b)}}}var f=this.getViewModel().get('smallScreenThreshold');g.set('smallScreen',ABP.util.Common.getClassic()?!1:Ext.Viewport.getWindowWidth()<=f||Ext.Viewport.getWindowHeight()<=f);this.initKeyboardBindings();window.addEventListener('online',function(b){a.handleConnectionStateChange(b)});window.addEventListener('offline',function(b){a.handleConnectionStateChange(b)});window.addEventListener('beforeunload',function(b){a.onBeforeUnload(b)});a.loadApplicationServices();var d=ABP.util.Config.getHardcodedConfig();if(!d||d.enablePreBootstrapLoad===!0){var c=Ext.data.StoreManager.lookup('ABPPreBootstrapConfigStore');if(c){c.load({callback:function(i,h,g){try{if(g){var b=this.first(),f=b?b.get('usesRedirectForToken'):!1;var d=b.get('serverUrl');var e=b.get('overrideExistingServerUrl');var c=b.get('b2cShowLogin');if(Ext.isBoolean(c)){ABP.util.Msal.setStopAtLoginPage(c)}if(e||!Ext.isEmpty(d)&&Ext.isEmpty(ABP.util.LocalStorage.get('ServerUrl'))){ABP.util.LocalStorage.set('ServerUrl',d);a.fireEvent('settings_refresh_server_url')}if(ABP.util.Msal.enabled){a.tokenAuthenticate()}if(f){a.handleAuthRedirect();return}}}catch(j){}a.continueToBootstrap()}})}else {ABP.util.Logger.log('Cannot lookup ABPPreBootstrapConfigStore');this.continueToBootstrap()}}else {this.continueToBootstrap()}},tokenAuthenticate:function(){var b=this;if(Ext.isEmpty(ABP.util.LocalStorage.get('ServerUrl'))){return}var a=ABPAuthManager.getToken();if(a){b.loginWithB2cToken(a)}else {b.fireEvent('main_showLoading','load_authenticating','fullSize')}},handleAuthRedirect:function(){var c=this;function getParameterByName(b){var a=RegExp('[#&]'+b+'=([^&]*)').exec(window.location.hash);return a&&decodeURIComponent(a[1].replace(/\+/g,' '))}function getIdToken(){return getParameterByName('id_token')}var b=getIdToken();if(b){var g=function(d){var b=d.split('.')[1];var c=b.replace(/-/g,'+').replace(/_/g,'/');var a=decodeURIComponent(atob(c).split('').map(function(a){return '%'+('00'+a.charCodeAt(0).toString(16)).slice(-2)}).join(''));return JSON.parse(a)};var a=g(b);if(a){if(!ABP.util.Jwt.validateNonce(a.nonce)){ABP.util.Logger.logError('ERROR: Nonce is not OK! Token replay attack might be underway');return}var h=a.preferred_username||a.name;c.authenticateWithIDPToken(b,{logonId:h})}}else {var d=ABP.util.LocalStorage.get('TenantIdentifier');if(d){ABP.util.Discovery.discover(d,null,function(a){c.showLaunch('discovery-tab',a?{error:a}:null)})}else {var f=function(){return getParameterByName('error')};var e=f();c.showLaunch('discovery-tab',e?{error:e}:null)}}},loginWithB2cToken:function(f,b){var a=this;var h=ABP.util.Config.getBootstrapConfig();var g=a.getViewModel();var e;var d;var c=ABP.util.Jwt.getPayload(f);g.set('hidePreAuthMessage',!0);if(Ext.isEmpty(h)){return}var i=ABP.util.Msal.getStopAtLoginPage();if(i===!0&&Ext.isEmpty(b)){var j=!!ABP.util.LocalStorage.get('keepSignedIn')===!0;if(j){b=b||{};b.jsonData=a.reconstructUserSessionObject()}else {a.showLogin();return}}if(!Ext.isEmpty(g.get('loginTime'))||a.requestingLogin===!0){a.fireEvent('main_hideLoading');return}b=b||{};e=Ext.isEmpty(b.jsonData)?{logonId:''}:b.jsonData;d=Ext.isEmpty(b.jsonData)?!1:b.keepSignedIn;a.requestingLogin=!0;a.fireEvent('main_showLoading','load_authenticating','fullSize');ABP.util.Ajax.request({url:ABP.util.LocalStorage.get('ServerUrl')+'/abp/login/',method:'POST',headers:{'Authorization':'Bearer '+f},jsonData:e,keepSignedIn:d,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,success:function(j,h){a.requestingLogin=!1;var d=h.jsonData||{};var i=h.keepSignedIn;if(c){if(!Ext.isEmpty(c.emails)){d.logonId=c.emails[0]}else {if(c.family_name&&c.given_name){d.logonId=c.given_name+' '+c.family_name}else {var e=ABP.util.Msal.instance.getAccount();if(e&&e.name){d.logonId=e.name}}}}var g=Ext.JSON.decode(j.responseText);if(g.authorizationToken){ABPAuthManager.authenticationSuccess(g.authorizationToken)}a.authenticationLogic(g,!0,d,i)},failure:function(c){a.requestingLogin=!1;if(c){}else {}a.fireEvent('main_hideLoading')}})},authenticateWithIDPToken:function(c,a){var b=this;var d=b.getViewModel();d.set('hidePreAuthMessage',!0);b.fireEvent('main_showLoading','load_authenticating','fullSize');ABP.util.Ajax.request({url:ABP.util.LocalStorage.get('ServerUrl')+'/abp/login/',method:'POST',jsonData:a,headers:{'Authorization':'Bearer '+c},cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,success:function(e){if(a.customerName){ABP.util.LocalStorage.set('TenantIdentifier',a.customerName)}var d=Ext.JSON.decode(e.responseText);if(d.authorizationToken){ABPAuthManager.authenticationSuccess(d.authorizationToken)}b.authenticationLogic(d,!0,a)},failure:function(d){if(d){}else {}b.fireEvent('main_hideLoading')}})},continueToBootstrap:function(){var b=this.getViewModel();var a=ABP.util.Config.config.prebootSettingsExtraFields;if(!Ext.isEmpty(a)){b.set('injectedSettingsFields',a)}if(Ext.isEmpty(a)){this.doBootstrap()}else {if(this.checkPrebootVsLocalStorage(a)){this.doBootstrap()}else {this.showLaunch('settings-tab')}}},onBeforeUnload:function(b){var c=this,a=c.getViewModel();if(a.get('pendingChanges')&&!a.get('signout')){return (b||window.event).returnValue=ABP.util.Common.geti18nString('reload_warning')}},loginAsUser:function(a){this.setLoginUser(a);this.authCheck()},showLoginForNewUser:function(){this.setLoginUser(null);this.fireEvent('launchCarousel_Login',this)},setLoginUser:function(a){var b=this.getViewModel();b.set('loginAsUser',a);a=a||{};if(a.clearSession){ABP.util.SessionStorage.remove('sessionToken');ABP.util.SessionStorage.remove('SavedUsername');return}if(Ext.isEmpty(a.sessionToken)){ABP.util.SessionStorage.remove('sessionToken');ABP.util.SessionStorage.remove('SavedUsername');ABP.util.LocalStorage.remove('sessionToken')}else {if(Ext.isObject(a.sessionToken)){a.sessionToken=Ext.JSON.encode(a.sessionToken)}ABP.util.SessionStorage.set('sessionToken',a.sessionToken);if(b.get('bootstrapConf.settings.canKeepMultipleUsersSignedIn')){ABP.util.LocalStorage.remove('sessionToken')}}if(Ext.isEmpty(a.logonId)){ABP.util.LocalStorage.remove('SavedUsername');ABP.util.SessionStorage.remove('SavedUsername')}else {ABP.util.LocalStorage.set('SavedUsername',a.logonId);ABP.util.SessionStorage.set('SavedUsername',a.logonId)}if(Ext.isEmpty(a.password)){ABP.util.LocalStorage.remove('SavedPassword')}else {ABP.util.LocalStorage.set('SavedPassword',a.password)}if(Ext.isEmpty(a.environment)){ABP.util.LocalStorage.remove('SavedEnvironment')}else {ABP.util.LocalStorage.set('SavedEnvironment',a.environment)}if(Ext.isEmpty(a.locale)){ABP.util.LocalStorage.remove('SavedLanguage')}else {ABP.util.LocalStorage.set('SavedLanguage',a.locale)}b.set('allowAutoShowSelectUser',!1);this.fireEvent('login_updateViewModel')},authenticate:function(c,d){var a=this;var b=a.getViewModel();if(ABP.util.Msal.enabled){var e=ABPAuthManager.getToken();if(e){a.loginWithB2cToken(e,{jsonData:c,keepSignedIn:d});return}}a.fireEvent('main_showLoading','load_authenticating','fullSize');if(d===undefined){d=b.get('keepMeSignedIn')}if(d){b.set('keepMeSignedIn',!0)}b.set('selected.environment',c.environment);b.set('selected.language',c.locale);if((b.get('isOffline')||b.get('offlineMode'))&&!ABP.util.Config.getLoggedIn()){a.offlineAuthenticate(c,d);return}ABP.util.Ajax.request({url:ABP.util.LocalStorage.get('ServerUrl')+'/abp/login/',method:'POST',withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,jsonData:c,success:function(b){a.loginSuccess(b,c,!0)},failure:function(e){if(e){if((b.get('isOffline')||b.get('offlineMode'))&&ABP.util.Config.getLoggedIn()){a.fireEvent('main_hideLoading');ABP.view.base.popUp.PopUp.showPopup('offline_passwordPrompt_failure','error_ok_btn');return}if(e.timedout){ABP.view.base.popUp.PopUp.showPopup('error_timedout','error_ok_btn',function(){a.fireEvent('login_UserHit')})}else {if(e.responseText!==''){var f=Ext.JSON.decode(e.responseText);a.handleLoginFailureResponse(f,!1,null,function(){a.fireEvent('login_UserHit')})}}}else {ABP.view.base.popUp.PopUp.showPopup('login_error_authFailure','error_ok_btn',function(){a.fireEvent('login_UserHit')})}a.redirectTo('login',!0);a.fireEvent('main_hideLoading')}})},authenticationLogic:function(c,d,a,e){var b=this;var f=b.getViewModel();f.set('loginTime',Date.now());if(c&&c.logonId){a=a||{};a.logonId=c.logonId}if(a){if(d||a.logonId){ABP.util.Config.setUsername(a.logonId);ABP.util.SessionStorage.set('SavedUsername',a.logonId)}if(d||a.environment){ABP.util.Config.setEnvironment(a.environment)}if(d){ABP.util.LocalStorage.upgradeUserStorage()}if(d){ABP.util.LocalStorage.setForLoggedInUser(ABP.util.LocalStorage.usernameKey,ABP.util.Config.getUsername());ABP.util.LocalStorage.setForLoggedInUser('LastLogin',Date.now())}if(d||a.logonId){b.rememberValue({value:a.logonId,toLocalStorageKey:'SavedUsername',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberUsername',orIf:e})}if(d||a.password){b.rememberValue({value:a.password,toLocalStorageKey:'SavedPassword',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberPassword',andOnlyIf:e,toLoggedInUserLocalStorageKey:!0})}if(d||a.environment){b.rememberValue({value:a.environment,toLocalStorageKey:'SavedEnvironment',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberEnvironment'})}if(d||a.locale){b.rememberValue({value:a.locale,toLocalStorageKey:'SavedLanguage',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberLanguage',toLoggedInUserLocalStorageKey:!0})}if(d||a.logonId&&a.password){if(f.get('bootstrapConf.offlineAuthenticationType')===2){var j=ABP.util.Sha256.generateSaltForUser(a.logonId,a.environment);var i=ABP.util.Sha256.sha256(a.password,j);ABP.util.LocalStorage.setForLoggedInUser('SavedPasswordHash',i)}}}if(d){b.rememberValue({value:b.getExtraSettingsFieldsAsString(),toLocalStorageKey:'settingsextrafields',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberExtraSettingsFields'});b.rememberValue({value:b.getExtraLoginFieldsAsString(),toLocalStorageKey:'loginextrafields',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberExtraLoginFields'});if(e){ABP.util.LocalStorage.setForLoggedInUser('keepSignedIn',!0);ABP.util.LocalStorage.set('keepSignedIn',!0)}}if(c&&c.extraStep){b.showLaunch('extraloginstep-tab',c.extraStep);b.fireEvent('main_hideLoading')}else {if(Ext.isEmpty(ABP.util.Config.getAuthType())){if(!ABP.util.Config._bootstrapConfig||!ABP.util.Config._bootstrapConfig.authenticatedUserName){if(ABP.util.Common.isJsonString(c.sessionId)){var h=Ext.JSON.decode(c.sessionId);ABP.util.Config.setSessionId(h);ABP.util.Config.setAuthType('oauth');b.handleNewToken(h,e)}else {ABP.util.Config.setSessionId(c.sessionId);ABP.util.Config.setAuthType('integrated')}}}if(ABP.util.Config.getAuthType()==='oauth'){var g=Ext.JSON.decode(c.sessionId);ABP.util.Config.setSessionId(g);b.handleNewToken(g,e)}else {if(ABP.util.Config.getAuthType()==='integrated'){if(c.sessionId){ABP.util.Config.setSessionId(c.sessionId)}}else {if(ABP.util.Config.getAuthType()==='cookie'){}}}if(typeof appInsights=='object'){appInsights.setAuthenticatedUserContext(a.logonId)}b.fireEvent('container_authentication_success');b.fireEvent('main_doConfiguration',a&&a.locale?a.locale:f.get('selected.language'))}},secondAuthStep:function(d,c){var a=this;var b=a.getViewModel();if(c&&c[0]!=='/'){c='/'+c}a.fireEvent('main_showLoading',ABP.util.Common.geti18nString('load_extraAuthStep'));ABP.util.Ajax.request({url:ABP.util.LocalStorage.get('ServerUrl')+c,method:'POST',withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,jsonData:d,success:function(b){a.loginSuccess(b,d,!1)},failure:function(e){if(e){if(e.timedout){ABP.view.base.popUp.PopUp.showPopup(b.get('i18n.error_timedout'),b.get('i18n.error_ok_btn'),function(){a.fireEvent('login_UserHit')})}else {if(e.responseText!==''){try{var g=Ext.JSON.decode(e.responseText);var f=g.errorMessage}catch(h){}if(f){ABP.view.base.popUp.PopUp.showPopup(f,b.get('i18n.error_ok_btn'),function(){a.fireEvent('login_UserHit')})}else {ABP.view.base.popUp.PopUp.showPopup(b.get('i18n.login_error_authFailure'),b.get('i18n.error_ok_btn'),function(){a.fireEvent('login_UserHit')})}}}}else {ABP.view.base.popUp.PopUp.showPopup(b.get('i18n.login_error_authFailure'),b.get('i18n.error_ok_btn'),function(){a.fireEvent('login_UserHit')})}a.redirectTo('login',!0);a.fireEvent('main_hideLoading')}})},showLaunch:function(c,d){var a=this;var b=this.getView();if(!b.down('launchcanvas')){b.removeAll(!0,!0);a.getViewModel().set('startingLaunchCarouselTab',c);b.add({xtype:'launchcanvas'})}switch(c){case 'settings-tab':a.fireEvent('launchCarousel_Settings');break;case 'login-tab':a.fireEvent('launchCarousel_Login');break;case 'maintenance-tab':a.fireEvent('launchCarousel_Maintenance');break;case 'selectuser-tab':a.fireEvent('launchCarousel_SelectUser');break;case 'discovery-tab':a.fireEvent('launchCarousel_Discovery',d);break;case 'extraloginstep-tab':a.fireEvent('launchCarousel_Maintenance','maintenanceextrastep',d);}},showNoSupportPage:function(){var b=this;var a=b.getView();a.removeAll(!0,!0);a.add({xtype:'nosupportpage'})},showSettings:function(){this.showLaunch('settings-tab')},showLogin:function(){if(this.getViewModel().get('allowAutoShowSelectUser')==!0&&this.userSelectionPossible()){this.showLaunch('selectuser-tab')}else {this.showLaunch('login-tab')}},userSelectionPossible:function(){var b=this.getViewModel();if(b&&b.get('bootstrapped')&&ABP.util.Config.getBootstrapConfig().settings.canKeepMultipleUsersSignedIn){var a=ABP.util.LocalStorage.getUserData();if(a&&a.length>1){return !0}}return !1},doBootstrap:function(){var a=this;var f=a.getView().getViewModel();var d=ABP.util.Ajax.getBootstrapServerUrl();var c=a.getExtraSettingsFields();var e='';if(!d||Ext.browser.name==='IE'&&Ext.browser.version.major===9&&!ABP.util.Config.checkHostNameMatch(d)){a.showSettings();return}e=d+'/abp/bootstrap?deviceType='+Ext.os.deviceType+'&locale='+ABP.util.Common.getBrowserLanguage();if(!Ext.isEmpty(c)){var b=0;for(b;b<c.length;++b){e+='&'+c[b].fieldId+'='+c[b].val}}Ext.Ajax.useDefaultXhrHeader=!0;ABP.util.Ajax.request({url:e,withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,method:'GET',success:function(c){try{ABP.util.LocalStorage.set('ServerUrl',d);var b=Ext.JSON.decode(c.responseText);f.set('offlineMode',!1);if(b.resultCode===0){a.loadBootstrapConfig(b.configuration)}else {if(b.resultCode===11){a.showSettings()}else {if(b.errorMessage){ABP.view.base.popUp.PopUp.showError(b.errorMessage)}a.showSettings()}}}catch(g){a.doBootstrapErrorHander(g,a,f)}},failure:function(b){a.doBootstrapErrorHander(b,a,f)}})},doBootstrapErrorHander:function(b,h,d){if((b.status===404||b.status===0)&&(!navigator.onLine||navigator.connection&&(navigator.connection.type==='unknown'||navigator.connection.type==='none'))){if(ABP.util.LocalStorage.get('OfflineBootstrap')){d.set('offlineMode',!0);var a=Ext.JSON.decode(ABP.util.LocalStorage.get('OfflineBootstrap'));var j=a.offlineAuthenticationType;var i=a.hideOfflineModeToggle;a=a.bootstrap;a.offlineAuthenticationType=j;a.hideOfflineModeToggle=i;h.loadBootstrapConfig(a);return}}if(ABP.util.Ajax.getAttemptDiscoveryServerUrl()){h.doBootstrap();return}h.showSettings();var e=d.checkI18n('error_connection_failed');var f=d.checkI18n('error_connection_instructions');var g=d.checkI18n('error_ok_btn');if(b&&b.responseText!==''){var c='';try{var k=Ext.JSON.decode(b.responseText,!0);c=k.errorMessage}catch(l){c=(b.status||'')+' '+(b.statusText||'')}if(c){ABP.view.base.popUp.PopUp.showError(f,e+' '+c,g)}else {ABP.view.base.popUp.PopUp.showError(f,e,g)}}else {ABP.view.base.popUp.PopUp.showError(f,e,g)}},authCheck:function(){var a=this,e=a.getView().getViewModel(),k;var j=e.get('loginAsUser')||{};e.set('loginAsUser',null);if(ABP.util.Config.isPreAuthenticated()){ABP.util.Config.setUsername(ABP.util.Config.getBootstrapConfig().authenticatedUserName);if(!a.checkEnvLangAvailability()){if(a.extraFieldsProcessForLoginBypass()){a.doConfiguration();a.getViewModel().set('loginTime',Date.now())}else {a.redirectTo('login',!0)}}else {a.redirectTo('login',!0)}return}var b=j.sessionToken||ABP.util.SessionStorage.get('sessionToken');if(b){b=ABP.util.Common.jsonDecode(b);if(b&&b.refresh_token){var d=ABP.util.SessionStorage.get('SavedUsername');if(d){this.refreshTokenRelog(b.refresh_token,d);return}}}var c=ABP.util.LocalStorage.get('sessionToken');if(c){c=ABP.util.Common.jsonDecode(c);if(c&&c.refresh_token){var d=ABP.util.LocalStorage.get('SavedUsername');if(d){a.getViewModel().set('keepMeSignedIn',!0);a.refreshTokenRelog(c.refresh_token,d);return}}}if(ABP.util.Config.getAuthType()==='cookie'){var h=ABP.util.LocalStorage.get('SavedUsername');var f=ABP.util.LocalStorage.get('SavedEnvironment');var i=ABP.util.LocalStorage.getForUser(f,h,'keepSignedIn')==='true';if(i||!!ABP.util.SessionStorage.get('SavedUsername')){k={logonId:h,environment:f,locale:ABP.util.LocalStorage.get('SavedLanguage')};a.authenticate(k,i);return}}a.fireEvent('main_showLoading','load_authCheck');var g=a.getAutoLoginParams(j);if(g){e.set('keepMeSignedIn',!0);a.fireEvent('main_Authenticate',g,!0);a.fireEvent('main_showLoading','load_log');return}this.getViewModel().set('keepMeSignedIn',!1);a.redirectTo('login',!0);a.fireEvent('main_hideLoading')},getExtraSettingsFields:function(){var a;var b=ABP.util.LocalStorage.get('settingsextrafields');if(b){a=JSON.parse(b)}else {a=this.getViewModel().get('prebootstrapExtraSettingsFilled')}return a},getExtraSettingsFieldsAsString:function(){var c=this;var b;var a=c.getExtraSettingsFields();if(Ext.isString(a)){b=a}else {b=JSON.stringify(a)}return b},getExtraSettingsFieldsFromString:function(){var c=this;var b;var a=c.getExtraSettingsFields();if(Ext.isString(a)){b=JSON.parse(a)}else {b=a}return b},getExtraLoginFields:function(){var a;var b=ABP.util.LocalStorage.get('loginextrafields');if(b){a=b}else {a=this.getViewModel().get('loginExtraFieldsFilled')}return a},getExtraLoginFieldsAsString:function(){var c=this;var b;var a=c.getExtraLoginFields();if(Ext.isString(a)){b=a}else {b=JSON.stringify(a)}return b},getExtraLoginFieldsFromString:function(){var c=this;var b;var a=c.getExtraLoginFields();if(Ext.isString(a)){b=JSON.parse(a)}else {b=a}return b},isValidServerUrl:function(a){if(!a){return !1}return /^(?:(?:https?):\/\/)(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*|(?:(?:[a-z\u00a1-\uffff0-9]+_?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*)(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(a)},getAutoLoginParams:function(b){var m=this;var h=m.getViewModel();var i;var a;var k=ABP.util.LocalStorage.get('forceLogin');if(k==='true'){ABP.util.LocalStorage.set('forceLogin','');return !1}var f=h.get('bootstrapConf.availableEnvironments');var j=h.get('bootstrapConf.authenticatedUserName');var l=h.get('bootstrapConf.settings.authenticationType');if(l==='integrated'&&j&&f){var g=null;if(f.length===1){g=f[0].id}else {a=ABP.util.LocalStorage.get('SavedEnvironment');if(a!==''&&a!==undefined&&a!==null){for(i=0;i<f.length;++i){if(f[i].id===a){g=a;break}}}}if(g!==null){return {'environment':g,'logonId':j,'password':'','locale':''}}}var e;var d;var a;var c;if(b&&!Ext.Object.isEmpty(b)){e=b.logonId;d=b.password;a=b.environment;c=b.locale}else {if(!this.userSelectionPossible()&&h.get('bootstrapConf.settings.canKeepMeSignedIn')){e=ABP.util.LocalStorage.get('SavedUsername');d=ABP.util.LocalStorage.get('SavedPassword');a=ABP.util.LocalStorage.get('SavedEnvironment');c=ABP.util.LocalStorage.get('SavedLanguage')}}if(e!==''&&e!==undefined&&e!==null&&(d!==''&&d!==undefined&&d!==null)&&(a!==''&&a!==undefined&&a!==null)&&(c!==''&&c!==undefined&&c!==null)){return {'environment':a,'logonId':e,'password':d,'locale':c}}return !1},rememberValue:function(a){var d=this;var e=d.getViewModel();var c='';var b=a.orIf||(a.ifLocalStorageEnabledBy?e.get(a.ifLocalStorageEnabledBy):!1);if(b==='true'){b=!0}if(b===!0&&(a.andOnlyIf===undefined||a.andOnlyIf===!0)){c=a.value}ABP.util.LocalStorage.set(a.toLocalStorageKey,c);if(a.toLoggedInUserLocalStorageKey){ABP.util.LocalStorage.setForLoggedInUser(a.toLocalStorageKey,c)}},relaunch:function(){var b=this;var a=b.getView();a.getViewModel().set('bootstrapped',!1);a.removeAll(!0,!0);a.add({xtype:'loadingscreen',anchor:'100% 100%'});b.doBootstrap()},doConfiguration:function(d){var a=this;var b=a.getViewModel();var h=b.get('servicesAttempted');if(d){ABP.util.Config.setLanguage(d)}else {d=ABP.util.Config.getLanguage()}if(!h){a.fireEvent('main_getSubscriptionServices');return}var f=b.get('configurationExtraInfo');var e=a.getExtraSettingsFields();ABP.util.Config.setLanguage(d);a.fireEvent('main_showLoading','load_load_config','fullSize');if(ABP.util.LocalStorage.get('OfflineBootstrap')&&b.get('bootstrapConf.offlineAuthenticationType')===1){if(!ABP.util.LocalStorage.containsForLoggedInUser('OfflinePassword')&&!ABP.util.LocalStorage.getForLoggedInUser('OfflinePasswordSkipped')){a.fireEvent('launchCarousel_Maintenance','offlinepassword');a.fireEvent('main_hideLoading');return}}if(b.get('switchToOnline')===!0){a.fireEvent('container_online_mode');b.set('offlineMode',!1);b.set('switchToOnline',null)}if((b.get('isOffline')||b.get('offlineMode'))&&ABP.util.LocalStorage.getForLoggedInUser('OfflineConfiguration')){a.loadSessionConfig(Ext.JSON.decode(ABP.util.LocalStorage.getForLoggedInUser('OfflineConfiguration')));return}var g='';var c=0;if(d){g='/abp/configuration?locale='+d+'&deviceType='+Ext.os.deviceType}else {g='/abp/configuration?deviceType='+Ext.os.deviceType}if(f&&!Ext.isEmpty(f)){for(c=0;c<f.length;++c){g+='&'+f[c].fieldId+'='+f[c].val}}if(e&&!Ext.isEmpty(e)){for(c=0;c<e.length;++c){g+='&'+e[c].fieldId+'='+e[c].val}}var i=ABP.util.LocalStorage.get('ServerUrl')+g;ABP.util.Ajax.request({url:i,withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,method:'GET',success:function(c){a.fireEvent('main_showLoading','load_apply_config','fullSize');var b=Ext.JSON.decode(c.responseText);if(b.resultCode===0){a.loadSessionConfig(b.configuration)}else {a.handleLoginFailureResponse(b,!1,'login_error_configFailure');a.redirectTo('login',!0)}a.fireEvent('main_doPostConfiguration');a.fireEvent('main_hideLoading')},failure:function(c){a.redirectTo('login',!0);a.fireEvent('main_hideLoading');if(c){if(c.timedout){ABP.view.base.popUp.PopUp.showPopup(b.get('i18n.error_timedout'),b.get('i18n.error_ok_btn'),function(){a.fireEvent('login_UserHit')})}else {if(c.responseText!==''){var e=ABP.util.Common.jsonDecode(c.responseText);a.handleLoginFailureResponse(e,!1,'login_error_configFailure')}else {ABP.view.base.popUp.PopUp.showPopup(b.get('i18n.login_error_configFailure'),b.get('i18n.error_ok_btn'))}}}else {ABP.view.base.popUp.PopUp.showPopup(b.get('i18n.login_error_configFailure'),b.get('i18n.error_ok_btn'))}}})},setupConfiguration:function(a){var b=this;var c=!1;ABP.util.Config.setLoggedIn(!0);b.getView().getViewModel().set('conf',a);b.getViewModel().i18nSet(a.languageResources);b.fireEvent('main_AddSession');b.initializePlugins();b.fireEvent('searchDrop_storeLoad',a.settings);b.fireEvent('featureCanvas_hideLoading');if(ABP.util.Common.getClassic()&&ABP.util.Config.getSessionConfig().settings.enableSearch){if(a.settings.searchInfo&&a.settings.searchInfo.length>0){b.fireEvent('toolbar_addSearchButton')}}if(a.settings.appToolbarTitle){b.fireEvent('container_toolbar_setTitle',a.settings.appToolbarTitle)}if(a.settings.disableNavMenu){b.fireEvent('toolbar_removeMenuButton')}if(a.toolbarMenu){b.fireEvent('toolbar_setupConfig',a.toolbarMenu)}if(Ext.theme.subThemeList&&!Ext.isEmpty(Ext.theme.subThemeList)){var e=ABP.util.LocalStorage.getForLoggedInUser('ChosenTheme');var c=!1;if(a.settings.persistSelectedTheme&&e){c=b.processThemeConfig(e)}if(!c&&a.settings.defaultTheme){c=b.processThemeConfig(a.settings.defaultTheme)}if(!c){b.processThemeConfig(Ext.theme.subThemeList[0])}if(a.settings.mainMenuSingleExpand!==undefined){b.fireEvent('mainMenu_setSingleExpand',a.settings.mainMenuSingleExpand)}if(a.settings.mainMenuStartFavoritesOpen!==undefined){if(a.settings.mainMenuStartFavoritesOpen){b.fireEvent('mainmenu_openFavorites')}}}if(a.settings.enableMenuRecent){if(a.settings.recents&&Ext.isArray(a.settings.recents)&&!Ext.isEmpty(a.settings.recents)){b.fireEvent('mainMeun_setRecents',a.settings.recents)}else {var d=ABP.util.LocalStorage.getForLoggedInUser('ABPCore_recentPages');if(d){b.fireEvent('mainMeun_setRecents',Ext.JSON.decode(d))}}}if(a.shortcuts){b.processShortcuts(a.shortcuts)}if(a.headlines){b.processHeadlines(a.headlines)}b.processSenchaStrings();b.fireEvent('main_hideLoading')},processThemeConfig:function(a){var d=this;var e=d.getViewModel();var c=!1;var b=0;if(Ext.theme.subThemeList&&!Ext.isEmpty(Ext.theme.subThemeList)){if(a.indexOf('aptean-theme')===-1){a='aptean-theme-'+a}for(b=0;b<Ext.theme.subThemeList.length;++b){if(Ext.theme.subThemeList[b]===a){ABPTheme.setTheme(a);e.set('startingTheme',a);c=!0;break}}}return c},processHeadlines:function(a,c){a=a||[];c=c||!1;var i=this,b,f,d=[],g=ABP.util.Config.getLoggedIn(),h=a.length,e=0;if(g&&c){return}for(;e<h;e++){b=a[e];f=g?ABP.util.LocalStorage.getForLoggedInUser('hr-'+b.uniqueId):ABP.util.LocalStorage.get('hr-'+b.uniqueId);if(!f){d.push(b)}}if(d.length>0){i.fireEvent('container_headlines_show',d)}},initializePlugins:function(){var a;ABP.util.PluginManager.initializeAllPlugins();a=ABP.util.SessionStorage.get('AfterLoginRedirect');if(a){this.redirectTo(a,!0);ABP.util.SessionStorage.remove('AfterLoginRedirect')}else {this.redirectTo('home')}},getSubscriptionServices:function(){var a=this;var b=a.getViewModel();var d;var c=ABPServiceManager.getService('subscription');if(c){d=c.url}else {ABPLogger.logWarn('Subscription service was not defined in the application.settings.json - service discovery will be disabled');b.set('servicesAttempted',!0);a.fireEvent('main_doConfiguration');return}ABP.util.Ajax.request({url:d,withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,method:'GET',success:function(c){b.set('servicesAttempted',!0);var d=Ext.JSON.decode(c.responseText);ABP.Config.setSubscriptions(d);a.fireEvent('main_doConfiguration')},failure:function(c){b.set('servicesAttempted',!0);a.fireEvent('main_doConfiguration')}})},addSession:function(){var b=this;var a=b.getView();this.activeAppId=undefined;a.removeAll();a.add({xtype:'sessioncanvas'})},loginSuccess:function(h,c,g){var a=this;var e=a.getViewModel();var f=e.get('keepMeSignedIn');var b=Ext.JSON.decode(h.responseText);if(b.resultCode===0){a.authenticationLogic(b,g,c,f)}else {if(b.resultCode===1){var d=a.getViewModel().get('bootstrapConf.settings.canForcePasswordChange');if(d===!0||d==='true'){a.getViewModel().set('forcePasswordChange',c);a.fireEvent('launchCarousel_Maintenance','forcepassword')}else {a.handleLoginFailureResponse(r,!1,'login_error_passwordExpired');a.redirectTo('login',!0)}}else {if(b.resultCode===7){if(b.errorDetailed||b.errorMessage){e.set('forcedJson',c)}a.handleLoginFailureResponse(b,!0)}else {a.redirectTo('login',!0);a.handleLoginFailureResponse(b,!1)}}a.fireEvent('main_hideLoading')}},handleLoginFailureResponse:function(a,e,c,b){e=e||!1;c=c||'login_error_authFailure';b=b||null;var g=e?[{text:'login_forceLogin',event:'main_forceLogin'},{text:'error_cancel_btn'}]:'error_ok_btn',d=a.errorDetailed||a.errorMessageKey||a.errorMessage,f=d||c;if(!a.suppressErrorMessage){ABP.view.base.popUp.PopUp.showPopup(f,g,b)}if(d){ABP.util.Logger.logError('Error logging in: '+d)}},handleNewToken:function(a,c,d){var e=this,f=e.getView().getViewModel();var b=a.expires_in>600?(a.expires_in-300)*1000:(a.expires_in-a.expires_in*0.1)*1000;if(!this.refreshTask){this.refreshTask=new Ext.util.DelayedTask(this.refreshToken,this);this.refreshTask.delay(b)}else {this.refreshTask.delay(b,this.refreshToken,this)}ABP.util.SessionStorage.set('sessionToken',Ext.JSON.encode(a));if(c){if(ABP.util.Config.getBootstrapConfig().settings.canKeepMultipleUsersSignedIn){ABP.util.LocalStorage.setForLoggedInUser('sessionToken',Ext.JSON.encode(a))}else {ABP.util.LocalStorage.set('sessionToken',Ext.JSON.encode(a))}}else {if(d){if(f.get('bootstrapConf.settings.canKeepMultipleUsersSignedIn')){if(ABP.util.LocalStorage.getForLoggedInUser('sessionToken')){ABP.util.LocalStorage.setForLoggedInUser('sessionToken',Ext.JSON.encode(a))}}else {if(ABP.util.SessionStorage.get('sessionToken')){ABP.util.SessionStorage.set('sessionToken',Ext.JSON.encode(a))}}}else {ABP.util.LocalStorage.remove('sessionToken');ABP.util.LocalStorage.removeForLoggedInUser('sessionToken')}}},refreshTokenRelog:function(f,c){var a=this,b=a.getViewModel();var e=f;var d=b.get('keepMeSignedIn');if(b.get('isOffline')||b.get('offlineMode')){return}ABP.util.Ajax.request({url:ABP.util.Ajax.getServerUrl()+'/abp/refreshtoken',method:'POST',jsonData:{logonId:c,environment:ABP.util.LocalStorage.get('SavedEnvironment'),refreshToken:e},success:function(i,j){var h=Ext.JSON.decode(i.responseText);var g=Ext.JSON.decode(h.sessionId);if(h.resultCode===0){ABP.util.Config.setSessionId(g);a.handleNewToken(g,d,!0);ABP.util.Config.setEnvironment(ABP.util.LocalStorage.get('SavedEnvironment'));ABP.util.Config.setUsername(c);b.set('loginTime',Date.now());a.doConfiguration(ABP.util.LocalStorage.get('SavedLanguage'));a.fireEvent('container_authentication_success')}else {var e=a.getAutoLoginParams();if(e){a.getViewModel().set('keepMeSignedIn',!0);a.fireEvent('main_Authenticate',e,!0);a.fireEvent('main_showLoading','load_log')}else {a.redirectTo('login',!0)}}},failure:function(d,e){var b=a.getAutoLoginParams();if(b){a.getViewModel().set('keepMeSignedIn',!0);a.fireEvent('main_Authenticate',b,!0);a.fireEvent('main_showLoading','load_log')}else {a.redirectTo('login',!0)}}})},refreshToken:function(){var a=this;var c=ABP.util.Config.getOAuthInfo().refresh_token;var b=a.getViewModel().get('keepMeSignedIn');ABP.util.Ajax.request({url:ABP.util.LocalStorage.get('ServerUrl')+'/abp/refreshtoken',method:'POST',jsonData:{logonId:ABP.util.Config.getUsername(),environment:ABP.util.LocalStorage.get('SavedEnvironment'),refreshToken:c},success:function(e,f){var d=Ext.JSON.decode(e.responseText);var c=Ext.JSON.decode(d.sessionId);if(d.resultCode===0){ABP.util.Config.setSessionId(c);a.handleNewToken(c,b,!0)}else {}},failure:function(a,b){}})},activeAppId:undefined,activationRequest:undefined,shutdownInProgress:!1,deferredShutdownRequests:[],fireAppEvent:function(a,c,b,d){var e=this;if(a==='container'){e.fireEventArgs(a+'_'+c,b instanceof Array?b:[b]);return}else {if(a){this.fireEvent('featureCanvas_hideSetting');if(d===!1||d==='false'){this.fireEvent(a+'_'+c,b);return}if(this.activeAppId===undefined||this.activeAppId!==a){this.activationRequest={appId:a,eventName:c,eventArgs:b};if(this.activeAppId===undefined){this.activateApp()}else {this.fireEvent(this.activeAppId+'_unload')}}else {this.fireEvent(a+'_'+c,b)}}}},onAppUnloaded:function(a,b){if(this.activeAppId===a){if(b===!0){Ext.util.Logger.info('Shutdown asynchronously aborted by '+a);this.abortShutdown()}else {if(this.shutdownInProgress){this.processShutdownQueue()}else {if(this.activationRequest){this.fireEvent('thumbbar_hide');this.activateApp()}else {this.activeAppId=undefined}}}}},activateApp:function(){try{var a=ABP.util.PluginManager.getPluginInstance(this.activationRequest.appId);if(!a){ABP.util.Logger.logError('Unable to find plugin: '+this.activationRequest.appId);return}var b=a.getAppComponent();this.activeAppId=this.activationRequest.appId;this.fireEvent('featureCanvas_showFeature',b,'main_appLoaded',this.activationRequest.appId)}catch(c){ABP.util.Logger.logError('Error loading plugin: '+c.message)}},onAppLoaded:function(b){var a=this.activationRequest;if(a){if(a.appId===b){if(a.eventName){this.fireEvent(a.appId+'_'+a.eventName,a.eventArgs)}}}},showLoading:function(d,e){var c=this;var a=d?c.getViewModel().get('i18n.'+d)||d:'';a=Ext.String.htmlEncode(a);var b;if(ABP.util.Common.getModern()){b={xtype:'apteanloadingscreen',message:a,messageCls:'sm-loading'};c.getView().mask(b)}else {b=c.getLoadingHtml(a,e);c.getView().mask(b,'loading-msg')}},getLoadingHtml:function(b,c){var a;a='<div class="abp-loadmask loading-cont '+(c||'fullSize')+'"';a+=b!==undefined?'role="alert" aria-label="'+b+'">':'>';a+='<div class="bars"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div></div>';if(b!==undefined){a+='<div class="sm-loading" width="215" height="37">'+b+'</div>'}return a},hideLoading:function(){if(ABP.util.Common.getModern()){this.getView().setMasked(!1)}else {this.getView().unmask()}},abortShutdown:function(){this.shutdownInProgress=!1;this.deferredShutdownRequests=[];ABP.util.SessionStorage.remove('SignoutReason');this.hideLoading()},destroySession:function(a,d){var f,e,b,c;if(Ext.isArray(a)&&a.length>1){d=a[1];a=a[0]}else {if(Ext.isBoolean(a)){d=a;a=''}}if(d!==!0&&this.shutdownInProgress){ABP.util.Logger.logInfo('Shutdown already in progress');return}this.showLoading('signout_message');if(a){ABP.util.SessionStorage.set('SignoutReason',a);if(a==='user init'||a===ABP.util.Common.geti18nString('session_timeout')){this.getViewModel().set('signout',!0)}}if(d===!0){this.getViewModel().set('signout',!0);this.commitDestroySession();return}this.shutdownInProgress=!0;this.deferredShutdownRequests=[];var f=ABP.util.PluginManager.getActivePluginsImplementingFunction('requestShutdown');var g=Ext.toolkit==='classic'?Ext.util.Logger:Ext.Logger;for(e=0;e<f.length;e++){b=f[e];c='PROCEED';try{c=b.plugin.requestShutdown()}catch(h){g.warn('Exception while calling requestShutdown on pluginId "'+b.pluginId+'"');g.logException(h)}if(c==='ABORT'){g.info('Shutdown synchronously aborted by '+b.pluginId);this.abortShutdown();return}if(c==='DEFER'){this.deferredShutdownRequests.push({plugin:b.plugin,pluginId:b.pluginId,status:'queued'})}}if(this.activeAppId!==undefined){this.fireEvent(this.activeAppId+'_unload')}else {this.processShutdownQueue()}},onAppShutdown:function(b,c){var a;if(this.deferredShutdownRequests&&this.deferredShutdownRequests.length>0){a=this.deferredShutdownRequests.shift();if(a.pluginId===b){if(c===!0){this.abortShutdown()}else {if(a.status!=='pending'){ABP.util.Logger.logWarn('Unexpected state "'+a.status+'" while processing shutdown response from "'+b+'"')}this.processShutdownQueue()}}else {ABP.util.Logger.logWarn('Unexpected main_appShutdown recevied from "'+b+'": expected shutdown response from "'+a.pluginId+'"')}}else {ABP.util.Logger.logWarn('Unexpected main_appShutdown recevied from "'+b+'": no deferred shutdown requests.')}},processShutdownQueue:function(){if(!this.deferredShutdownRequests||this.deferredShutdownRequests.length<=0){this.commitDestroySession()}else {this.deferredShutdownRequests[0].status='pending';this.fireEvent(this.deferredShutdownRequests[0].pluginId+'_shutdown')}},commitDestroySession:function(){var a=this;a.rememberValue({value:'',toLocalStorageKey:'SavedPassword',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberPassword'});ABP.util.SessionStorage.remove('AfterLoginRedirect');ABP.util.SessionStorage.remove('sessionToken');ABP.util.SessionStorage.remove('SavedUsername');ABP.util.LocalStorage.removeForLoggedInUser(ABP.util.Config.getEnvironment(),ABP.util.Config.getUsername());ABP.util.LocalStorage.remove('SavedUsername');ABP.util.LocalStorage.remove('sessionToken');ABP.util.LocalStorage.remove('TenantIdentifier');ABP.util.LocalStorage.remove('keepSignedIn');ABP.util.LocalStorage.set('forceLogin','true');a.logout()},logout:function(){var a=this;var b=ABP.util.LocalStorage.get('ServerUrl')+'/abp/logout';ABP.util.Ajax.request({url:b,method:'POST',withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,timeout:4000,success:function(c){var b,d;ABP.util.Config.setLoggedIn(!1);if(c&&c.responseText){b=Ext.JSON.decode(c.responseText);if(b&&!Ext.isEmpty(b.redirectUrl)){d=b.redirectUrl}}a.logoutComplete(d)},failure:function(b){a.logoutComplete()}})},logoutComplete:function(c){var a;if(ABP.util.Msal.enabled){ABP.util.Msal.signOut();return}if(!Ext.isEmpty(c)){a=c}else {a=window.location.href;var b=a.lastIndexOf('#');if(b!==-1){a=a.substr(0,b)}}window.location=a},forceLogin:function(){var b=this;var c=b.getViewModel();var a=c.get('forcedJson');a.forceLogin=!0;b.authenticate(a)},addDefaultLanguageStrings:function(a){this.getViewModel().i18nSetDefaults(a);this.fireEvent('afteraddlanguagestrings')},updateLanguageStrings:function(a){this.getViewModel().i18nSet(a)},switchLanguage:function(b){var a=this;var c=a.getViewModel();if(b.languages){b=b.languages}var d='/abp/configuration?locale='+b+'&deviceType='+Ext.os.deviceType;ABP.util.Ajax.request({url:ABP.util.Ajax.getServerUrl()+d,withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,method:'GET',success:function(d){var c=Ext.JSON.decode(d.responseText);if(c.resultCode===0){a.getViewModel().set('conf.languageResources',c.configuration.languageResources);a.getViewModel().set('selected.language',b);ABP.util.Config.setLanguage(b);a.getViewModel().i18nSet(c.configuration.languageResources);if(c.configuration.formatting){a.processFormatting(c.configuration.formatting)}a.processSenchaStrings();a.rememberValue({value:b,toLocalStorageKey:'SavedLanguage',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberLanguage',toLoggedInUserLocalStorageKey:!0});a.fireEvent('afterSwitchLanguage')}},failure:function(a){if(a&&a.responseText!==''){var e=Ext.JSON.decode(a.responseText);var d=e.errorMessage;if(d){ABP.view.base.popUp.PopUp.showError(d,c.get('i18n.error_ok_btn'))}else {ABP.view.base.popUp.PopUp.showError(c.get('i18n.login_error_languageFailure'),c.get('i18n.error_ok_btn'))}}else {ABP.view.base.popUp.PopUp.showError(c.get('i18n.login_error_languageFailure'),c.get('i18n.error_ok_btn'))}}})},checkPrebootVsLocalStorage:function(e){var g=this;var d=g.getExtraSettingsFieldsFromString();var b=0;var a=0;var f=!0;var c=!1;for(b;b<e.length;++b){c=!1;for(a=0;a<d.length;++a){if(e[b].fieldId===d[a].fieldId){if(d[a].val!==''){c=!0;break}}}if(!c){f=!1;ABP.util.LocalStorage.remove('settingsextrafields');break}}return f},checkEnvLangAvailability:function(){var c=this;var a=ABP.util.Config.getBootstrapConfig().availableEnvironments;var b=!1;if(a){if(!Ext.isEmpty(a)){if(a.length>1){b=!0}else {if(!Ext.isEmpty(a[0].languages)){if(a[0].languages.length>1){b=!0}}c.getViewModel().set('selected.environment',a[0].id)}}}return b},extraFieldsProcessForLoginBypass:function(){var h=this;var i=h.getViewModel();var c=ABP.util.LocalStorage.get('loginextrafields');var b=ABP.util.Config.getBootstrapConfig().settings.extraLoginFields;var e=!0;var a=0;var d=0;var f=[];var g=!1;if(b&&b.length>0){if(c){c=JSON.parse(c);for(a=0;a<b.length;++a){g=!1;for(d=0;d<c.length;++d){if(b[a].fieldId===c[d].fieldId){f.push({fieldId:c[d].fieldId,val:c[d].val});g=!0;break}}if(!g){if(b[a].required){if(b[a].required===!0||b[a].required==='true'){e=!1;break}}}}if(!Ext.isEmpty(f)&&e){i.set('configurationExtraInfo',f)}}else {e=!1}}else {e=!0}return e},saveExtras:function(){this.rememberValue({value:this.getExtraLoginFieldsAsString(),toLocalStorageKey:'loginextrafields',ifLocalStorageEnabledBy:'bootstrapConf.settings.rememberExtraLoginFields'})},routingWarningCallback:function(a){if(a){this.getViewModel().set('signout',!0);this.destroySession()}else {window.history.forward()}},switchTheme:function(a){var c=Ext.getBody();var b=Ext.theme.subThemeList;var e=this.getViewModel();if(a.themes){a=a.themes}for(var d in b){c.removeCls(b[d])}e.set('currentTheme',a);c.addCls(a);if(ABP.util.Config._sessionConfig.settings.persistSelectedTheme){ABP.util.LocalStorage.setForLoggedInUser('ChosenTheme',a)}},privates:{initKeyboardBindings:function(){if(!ABP.util.Common.getClassic()){return}this.keyboardNavigator=new ABP.util.keyboard.Shortcuts({controller:this})},processShortcuts:function(a){if(this.keyboardNavigator){this.keyboardNavigator.addShortcuts(a)}},loadBootstrapConfig:function(a){var b=this;ABP.util.Config.processBootstrapConfig(a);var e=b.getView().getViewModel();e.set('bootstrapConf',a);if(a.languageResources&&a.languageResources.length>0){b.getViewModel().i18nSet(a.languageResources)}e.set('bootstrapped',!0);var d=e.getStore('main_environmentStore');var c=a.availableEnvironments;if(d){if(c instanceof Array){d.getSource().loadData(c)}else {d.getSource().loadData([c])}}if(a.settings.authenticationType==='integrated'||a.settings.authenticationType==='cookie'||a.settings.authenticationType==='oauth'){ABP.util.Config.setAuthType(a.settings.authenticationType)}else {ABP.util.Logger.logWarn('Unrecognized authenticationType: "'+a.authenticationType+'" defaulting to "cookie".')}if(a.headlines){b.processHeadlines(a.headlines,!0)}b.fireEvent('container_bootstrap_success');if(ABP.util.Msal&&ABP.util.Msal.enabled){console.log('TA/DEBUG - ABPMainController - loadBootstrapConfig - me.tokenAuthenticate');b.tokenAuthenticate();return}if(ABP.util.Common.getModern()){if(ABP.util.Config.isDesktop()&&a&&!a.supportsDesktop&&a.desktopUrl&&a.desktopUrl.trim()!==''){window.location=a.desktopUrl}else {if(ABP.util.Config.isDesktop()&&a&&!a.supportsDesktop){b.redirectTo('nosupport',!0)}else {b.authCheck()}}}else {b.authCheck()}},promptOfflineMode:function(c){var a=this;var b=a.getView().getViewModel();if(c){a.setOfflineMode(a,b);return}ABP.view.base.popUp.PopUp.showOkCancel('prompt_gooffline_text','prompt_gooffline_title',function(d){if(d){a.setOfflineMode(a,b)}})},promptOnlineMode:function(c){var a=this;var b=a.getView().getViewModel();ABP.util.Ajax.request({url:ABP.util.Ajax.getServerUrl()+'/abp/success',method:'GET',withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,timeout:4000,success:function(d){if(c){a.setOnlineMode(a,b);return}ABP.view.base.popUp.PopUp.showOkCancel('prompt_goonline_text','prompt_goonline_title',function(e){if(e){a.setOnlineMode(a,b)}else {if(a.offlineCheckTask){a.offlineCheckTask.stop()}}})},failure:function(a){ABP.view.base.popUp.PopUp.showPopup('offline_noconnection','error_ok_btn')}})},handleConnectionStateChange:function(d){var a=this;var b=a.getViewModel();var c=b.get('bootstrapConf.hideOfflineHeadline')||!1;if(d.type==='offline'){b.set('isOffline',!0);if(ABP.util.Config.getLoggedIn()===!1){b.set('offlineMode',!0)}a.fireEvent('connectionChange','offline');if(!c){a.fireEvent('container_headlines_show',[{messageKey:'offline_headline_message',uniqueId:'abp_offline_headline',priority:0,single:!0}])}}else {if(d.type==='online'){b.set('isOffline',!1);if(ABP.util.Config.getLoggedIn()===!1){b.set('offlineMode',!1)}a.fireEvent('connectionChange','online');if(!c){a.fireEvent('container_headlines_hide','abp_offline_headline')}}}},setOnlineMode:function(b,a){if(b.offlineCheckTask){b.offlineCheckTask.stop()}var c=Ext.create('ABP.view.session.offline.PasswordPrompt',{viewModel:{data:{passwordLabel:a.get('i18n.offline_password_prompt'),cancelBtnlabel:a.get('i18n.button_cancel'),okBtnLabel:a.get('i18n.button_OK')}}});c.show()},setOfflineMode:function(a,c){c.set('offlineMode',!0);a.fireEvent('container_offline_mode');var b=new Ext.util.TaskRunner();a.offlineCheckTask=b.newTask({run:a.offlineCheck,interval:60*1000,scope:a});a.offlineCheckTask.start();if(ABP.util.LocalStorage.getForLoggedInUser('OfflineConfiguration')){a.loadSessionConfig(Ext.JSON.decode(ABP.util.LocalStorage.getForLoggedInUser('OfflineConfiguration')));return}},offlineCheck:function(){var a=this;if(ABP.util.Config.getLoggedIn()){ABP.util.Ajax.request({url:ABP.util.Ajax.getServerUrl()+'/abp/success',method:'GET',withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version.major>9,timeout:4000,success:function(b){a.fireEvent('container_go_online')},failure:function(a){}})}},loadSessionConfig:function(e){var c=this;ABP.util.Config.processSessionConfig(e);var a=ABP.util.Config.getSessionConfig().packages;var f=[];c.fireEvent('container_config_processed');var i=c.getViewModel();c.verifyProfileImage(e.settings.userConfig.photo);if(a!==undefined&&a.length!==0){for(var d=0;d<a.length;d++){var g=a[d].url;var b=a[d].id;if(b==''||g==''){break}ABP.util.Config.setPackageURL(g);var h=Ext.util.JSON.decode('{"css":'+!0+', "namespace": "'+b+'" }');Ext.manifest.packages[b]=h;if(!Ext.Package.isLoaded(b)){f.push(Ext.Package.load(b))}}ABP.util.Config.setPackageURL(null)}Ext.Promise.all(f).then(function(){c.setupConfiguration(e)})},offlineAuthenticate:function(a,i){var b=this,e=b.getView().getViewModel(),h=e.get('bootstrapConf.offlineAuthenticationType');switch(h){case 0:if(Ext.isEmpty(ABP.util.LocalStorage.getForUser(a.environment,a.logonId,'OfflineConfiguration'))){ABP.view.base.popUp.PopUp.showPopup('login_error_authFailure','error_ok_btn');b.fireEvent('main_hideLoading');return};break;case 1:var f=ABP.util.LocalStorage.getForUser(a.environment,a.logonId,'OfflinePassword');if(Ext.isEmpty(f)){ABP.view.base.popUp.PopUp.showPopup('offline_login_error_noOfflinePassword','error_ok_btn');b.fireEvent('main_hideLoading');return};var d=ABP.util.Sha256.generateSaltForUser(a.logonId,a.environment);var c=ABP.util.Sha256.sha256(a.password,d);if(c!==f){ABP.view.base.popUp.PopUp.showPopup('login_error_authFailure','error_ok_btn');b.fireEvent('main_hideLoading');return};break;case 2:var g=ABP.util.LocalStorage.getForUser(a.environment,a.logonId,'SavedPasswordHash');var d=ABP.util.Sha256.generateSaltForUser(a.logonId,a.environment);var c=ABP.util.Sha256.sha256(a.password,d);if(c!==g){ABP.view.base.popUp.PopUp.showPopup('login_error_authFailure','error_ok_btn');b.fireEvent('main_hideLoading');return};break;}e.set('loginTime',Date.now());ABP.util.Config.setUsername(a.logonId);ABP.util.Config.setEnvironment(a.environment);b.fireEvent('main_doConfiguration',a&&a.locale?a.locale:e.get('selected.language'));b.fireEvent('main_hideLoading');return},pendingChangesToggle:function(a){var b=this,c=b.getViewModel();c.set('pendingChanges',a)},processFormatting:function(a){if(a.monthNames){Ext.Date.monthNames=a.monthNames}if(a.dayNames){Ext.Date.dayNames=a.dayNames}if(a.decimalSeparator){}if(a.thousandSeparator){}},processSenchaStrings:function(){var b=this;var c=b.getViewModel();var a=c.getData().i18n;Ext.Msg.buttonText={ok:a.s_window_messageBox_buttonText_ok,cancel:a.s_window_messageBox_buttonText_cancel,yes:a.s_window_messageBox_buttonText_yes,no:a.s_window_messageBox_buttonText_no};if(ABP.util.Common.getClassic()){Ext.form.field.VTypes.emailText=a.s_field_vTypes_emailText;Ext.form.field.VTypes.urlText=a.s_field_vTypes_urlText;Ext.form.field.VTypes.alphaText=a.s_field_vTypes_alphaText;Ext.form.field.VTypes.alphanumText=a.s_field_vTypes_alphanumText}},onUpdateUserProfile:function(a){this.verifyProfileImage(a.image)},verifyProfileImage:function(a){var c=this.getViewModel();if(!a){c.set('profilePhoto',null);return}var b=new Image();b.onerror=function(){c.set('profilePhoto',null)};b.onload=function(){c.set('profilePhoto',a);ABP.util.LocalStorage.setForLoggedInUser('Photo',a)};b.src=a}},activeAppFocus:function(){var a=this.activeAppId;if(a){this.fireAppEvent(a,'setFocus',null,!1)}},loadApplicationServices:function(){var b=this;var a=Ext.data.StoreManager.lookup('ABPApplicationServicesStore');if(a){a.load({scope:b,callback:function(a,c,b){if(!b){ABPLogger.logDebug('Failed to load application settings store.')}else {ABPLogger.logDebug('Loaded application settings store with '+a.length+' services.')}}})}},afterLoginSuccess:function(){var b=this;var a=Ext.data.StoreManager.lookup('ABPApplicationServicesStore');if(a.isLoading()){a.on('load',this.afterLoginSuccess,b)}else {a.un('load',this.afterLoginSuccess,b);if(a.getCount()>0){a.each(function(a){ABPServiceManager.registerService(a.getData())})}}},reconstructUserSessionObject:function(){return {logonId:ABP.util.LocalStorage.get('SavedUsername'),environment:ABP.util.LocalStorage.get('SavedEnvironment'),locale:ABP.util.LocalStorage.get('SavedLanguage'),forceLogin:!1}}});Ext.define('ABP.view.main.ABPMainModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.abpmainmodel',stores:{main_environmentStore:'ABPEnvironmentStore'},data:{bootstrapConf:{settings:{extraSettingsFields:null}},bootstrapped:!1,conf:{},forcePasswordChange:{},prebootstrapExtraSettingsField:{},prebootstrapExtraSettingsFilled:[],configurationExtraInfo:[],loginExtraFieldsFilled:[],startingLaunchCarouselTab:null,allowAutoShowSelectUser:!0,loginAsUser:null,ieTested:!1,startingTheme:'',offlineMode:!1,isOffline:!1,hidePreAuthMessage:!1,servicesAttempted:!1,b2cAuth:null,i18n:{about_applications:'Applications',about_info:'ABP featured applications to offer you appropriate and effective solutions',about_build:'Build: ',about_detail:'more...',about_thirdparty:'Third-Party Attributions',about_title:'About',about_version:'Version:',cardSearch_all:'All',cardSearch_next:'pull<br>to load<br>more<br>',cardSearch_noConfig:'Global Search not configured.  Please consult Admin.',cardSearch_noResults:'returned no results',cardSearch_previous:'pull<br>to load<br>previous<br>',cardSearch_title:'Global Search',error_cancel_btn:'Cancel',error_connection_failed:'Connection Failed',error_connection_instructions:'Please enter a valid url, then hit save.',error_no_btn:'No',error_ok_btn:'OK',error_timedout:'Your request has timed out.  Please try again.',error_yes_btn:'Yes',error_download_failed:'Download Failed',error_upload_failed:'Upload Failed',error_download_failed_fileNotFound:'Unable to download the request file as it can not be found on the server.',help_all_products:'All Products',help_allTypes:'All Help Links',help_allProducts:'All Products',help_blocked_Text:'The browser has blocked the following link from being opened. Please click on the link below to open it.',help_blocked_Title:'Show Link',help_text:'Our solutions, services, and support deliver the competitive edge your business needs to succeed today and tomorrow. With our wide array of comprehensive support services, we can quickly and accurately answer your technical questions and keep your business moving forward.',help_title:'Help',loading_mask_message:'',load_apply_config:'Applying Configuration',load_authenticating:'Authenticating',load_discovering:'Discovering',load_authCheck:'Checking Authorization',load_extraAuthStep:'',load_load_config:'Loading Configuration',load_log:'Logging In',logger_clear:'Clear Logs',logger_clear_confirmation:'Are you sure you want to clear all logs?',logger_level:'Level',logger_filter:'Filter',logger_nothingtodisplay:'No log items to display.',logger_title:'Logs',login_all_fields:'Please fill in all fields',login_back:'Back',login_dockNavigation:'Dock Navigation Menu',login_environment:'Environment',login_error_authFailure:'Authentication Failed',login_error_configFailure:'Configuration Failed',login_error_languageFailure:'Language Configuration Failed',login_error_passwordExpired:'Password has expired. Please contact your system administrator.',login_extraValue:'value not within acceptable range',login_forcepw_back:'Back',login_forcepw_confirmPassword:'Re-enter Password',login_forcepw_instructions:'Please enter your new password before signing in.',login_forcepw_newPassword:'New Password',login_forcepw_signIn:'Sign In',login_forcepw_title:'New Password',login_forceLogin:'Force Login',login_forgotpassword:'Forgot your password?',login_keepMeSignedIn:'Keep me signed in',login_language:'Language',login_password:'Password',login_recoverInstructions:'Please enter your email address and choose the environment to reset your password.',login_recoverTitle:'Recover Password',login_recover_back:'Back',login_recover_enterNewPassword:'Please enter a new password and confirm by re-entering it.',login_recover_failed:'Password recovery failed',login_recover_id:'Email Address',login_recover_passwordsDoNotMatch:'Passwords do not match. Try again.',login_recover_passwordChangeFailed:'Password change failed',login_recover_send:'Send',login_recover_invalid_email:'Email Address should be in the format "user@example.com"',login_recover_submit_success:'Please check your email for further instructions.',login_save:'Save',login_settingsInstructions:'Please enter your server address in the field below. If you do not have this information, please contact your IT administrator.',login_settings_invalidurl:'Please enter a valid server url',login_settingsTitle:'Settings',login_settingsUrlList:'Select a URL',login_login_header:'Login',login_signin_btn:'Sign In',login_url:'URL',login_previousUrls:'Other URLs',login_organization:'Organization',login_email:'Email',login_emailOrOrganisation:'Email / Organisation',login_SSOHelp:'Enter your Email or Organisation',login_username:'Username',login_selectUserTitle:'Select Account',login_selectUserInstructions:'Select an account or sign in with another one.',login_selectUserAnotherUser:'Use another account',navMenu_navigation:'Navigation',navMenu_searchbar_emptytext:'Search',navMenu_home:'Home',navMenu_favorites:'Favorites',navMenu_recent:'Recent',navMenu_suggested:'Suggested',navMenu_swapView:'Swap to ',reload_warning:'Reloading this page will cause you to sign out and lose any unsaved data.',search_searchText:'Search in',search_advanced:'Advanced',search_apply:'Apply',search_resultsPlaceholder:'Search for items, data, and other collateral here.',search_type:'Search Type',search_toggle:'Toggle Search',selectfield_mobile_done:'Done',sessionMenu_about:'About',sessionMenu_calendar:'Calendar',sessionMenu_chart:'Charts',sessionMenu_clipboard:'Clipboard',sessionMenu_environment:'Environment: ',sessionMenu_help:'Help',sessionMenu_languages:'Language',sessionMenu_logger:'Log',sessionMenu_search:'Search',sessionMenu_settings:'Settings',sessionMenu_url:'URLs',sessionMenu_signoff:'Sign Off',sessionMenu_theme:'Theme',sessionMenu_time:'Session Time: ',sessionMenu_user:'User: ',sessionMenu_editPreferences:'Edit Preferences',settingsCanvas_close:'Close',settings_internalLinks:'Internal Links',settings_languages:'Languages',settings_userInfo:'User Information',signout_message:'Signing out...',warn_ie9:'Url must have the same hostname as webpage when using Internet Explorer 9.',inactive_timeout:'You are about to be logged out due to inactivity: ',timeout_title:'Session Expiration Warning',session_timeout:'Session expired due to inactivity',session_signoff:'Sign Out',session_retain:'Keep me signed in',ac_widget_picker_default_group_title:'Widgets',ac_switch_dashboard:'Switch Dashboard',button_close:'Close',button_OK:'OK',button_save:'Save',button_cancel:'Cancel',button_yes:'Yes',button_no:'No',button_clear:'Clear',button_done:'Done',button_search:'Search',button_back:'Back',button_next:'Next',button_continue:'Continue',button_delete:'Delete',button_favorite:'Favorite',button_unfavorite:'Unfavorite',button_nextTheme:'Next Theme',button_prevTheme:'Previous Theme',sessionMenu_manageFavorites:'Manage Favorites',favorites_title:'Favorites',favorites_expandAll:'Expand All',favorites_collapseAll:'Collapse All',favorites_newGroup:'New Group',favorites_newGroup_emptyText:'Create New Group',favorites_toast_deleteEmptyGroups:'Removed empty favorite groups',favorites_confirmDeleteGroupMsg:'Are you sure you want to delete this group and all of its contents?',favorites_confirmDeleteGroupTitle:'Delete this favorite group?',favorites_editPanel_title:'Edit Favorite',favorites_editPanel_name:'Name',favorites_editPanel_source:'Source',favorites_editPanel_moveToGroup:'Move to group',favorites_editPanel_noGroup:'< No Group >',favorites_manager_emptyGroup:'This group is empty.',toolbar_toggleNavigation:'Toggle Navigation',toolbar_search_navigation:'Search Navigation',toolbar_jumpTo:'Jump to',toolbar_placeinapplication:'Place in application',abp_navigation_menu:'Navigation Menu',abp_main_content:'Main Content',sessionMenu_manageHeadlines:'Manage Headlines',headlines_title:'Headlines',headlines_new:'New Headline',headlines_column_message:'Message',headlines_label_message:'Message',headlines_column_message_key:'Message key',headlines_label_message_key:'Message key',headlines_column_action:'Action text',headlines_label_action:'Action text',headlines_column_action_key:'Action key',headlines_label_action_key:'Action key',headlines_column_starttime:'Start time',headlines_label_starttime:'Start time',headlines_column_endtime:'End time',headlines_label_endtime:'End time',headlines_column_priority:'Priority',headlines_label_priority:'Priority',headlines_priority_info:'Info',headlines_priority_warning:'Warning',headlines_priority_alert:'Alert',headlines_column_published:'Published',headlines_label_published:'Published',headlines_unsaved_changes:'There are headlines which have not been saved. Close anyway?',headlines_delete:'Do you wish to delete this headline?',field_validation_error_blanktext:'This field is required',field_validation_error_maxlengthtext:'The maximum length for this field is {0}',field_validation_error_minlengthtext:'The minimum length for this field is {0}',abp_notifications_button_tooltip:'Notifications',abp_notifications_rightpane_title:'Notifications',abp_notifications_label_no_notifications:'No notifications.',abp_notifications_label_no_new_notifications:'No new notifications.',abp_notifications_label_show_history:'Show History',abp_notifications_label_hide_history:'Hide History',abp_notifications_label_see_history:'See History',abp_notifications_label_read:'Read',abp_notifications_label_marked_as_read:'Marked as Read',abp_notifications_label_marked_as_unread:'Marked as Unread',abp_notifications_label_removed:'Notification Removed',abp_time_prefix_ago:'',abp_time_suffix_ago:'ago',abp_time_prefix_from_now:'',abp_time_suffix_from_now:'from now',abp_time_seconds:'less than a minute',abp_time_minute:'about a minute',abp_time_minutes:'about {0} minutes',abp_time_hour:'about an hour',abp_time_hours:'about {0} hours',abp_time_day:'about a day',abp_time_days:'about {0} days',abp_time_month:'about a month',abp_time_months:'about {0} months',abp_time_year:'about a year',abp_time_years:'about {0} years',abp_short_time_prefix_ago:'',abp_short_time_suffix_ago:'ago',abp_short_time_prefix_from_now:'',abp_short_time_suffix_from_now:'from now',abp_short_time_seconds:'few seconds',abp_short_time_minute:'1 min',abp_short_time_minutes:'{0} mins',abp_short_time_hour:'1 hour',abp_short_time_hours:'{0} hours',abp_short_time_day:'1 day',abp_short_time_days:'{0} days',abp_short_time_month:'1 month',abp_short_time_months:'{0} months',abp_short_time_year:'1 year',abp_short_time_years:'{0} years',login_offline_signin_btn:'Offline Sign In',offline_login_instructions:'Please enter an offline password. Use this password to log in while offline. This value is required for offline mode and should differ from your normal login password.',offline_login_password:'Offline Password',offline_login_confirmpassword:'Confirm Offline Password',offline_password_prompt:'Enter password',offline_passwords_dont_match:'Passwords do not match',offline_login_error_noOfflinePassword:'Authentication Failed. No offline password exists for this user and environment.',sessionMenu_setOfflinePassword:'Set Offline Password',button_switch_online_mode:'Go Online',button_switch_offline_mode:'Go Offline',prompt_gooffline_text:'Go Offline? Any unsaved data will be lost.',prompt_gooffline_title:'Switch to offline',prompt_goonline_text:'Go Online? Any unsaved data will be lost.',prompt_goonline_title:'Switch to online.',offline_passwordPrompt_failure:'Authentication failed, could not go online.',offline_promptpassword_title:'Enter password to go online',offline_noconnection:'Cannot go online, no connection to server.',offline_headline_message:'No connection to the Internet.',abp_filter_empty_text:'Filter...',s_dataValidator_bound_emptyMessage:'Must be present',s_dataValidator_bound_minOnlyMessage:'Value must be greater than {0}',s_dataValidator_bound_maxOnlyMessage:'Value must be less than {0}',s_dataValidator_bound_bothMessage:'Value must be between {0} and {1}',s_dataValidator_email_message:'Is not a valid email address',s_dataValidator_exclusion_message:'Is a value that has been excluded',s_dataValidator_ipaddress_message:'Is not a valid IP address',s_dataValidator_format_message:'Is in the wrong format',s_dataValidator_inclusion_message:'Is not in the list of acceptable values',s_dataValidator_length_minOnlyMessage:'Length must be at least {0}',s_dataValidator_length_maxOnlyMessage:'Length must be no more than {0}',s_dataValidator_length_bothMessage:'Length must be between {0} and {1}',s_dataValidator_number_message:'Is not a valid number',s_dataValidator_presence_message:'Must be present',s_dataValidator_range_minOnlyMessage:'Must be must be at least {0}',s_dataValidator_range_maxOnlyMessage:'Must be no more than than {0}',s_dataValidator_range_bothMessage:'Must be between {0} and {1}',s_dataValidator_range_nanMessage:'Must be numeric',s_grid_plugin_dragText:'{0} selected row{1}',s_abstractView_loading:'Loading...',s_tab_closeText:'Close',s_field_invalidText:'The value in this field is invalid',s_abstractView_loadingText:'Loading...',s_picker_date_todayText:'Today',s_picker_date_nowText:'Now',s_picker_date_minText:'This date is before the minimum date',s_picker_date_maxText:'This date is after the maximum date',s_picker_date_disabledDaysText:'Disabled',s_picker_date_disabledDatesText:'Disabled',s_picker_date_nextText:'Next Month (Control+Right)',s_picker_date_prevText:'Previous Month (Control+Left)',s_picker_date_monthYearText:'Choose a month (Control+Up/Down to move years)',s_picker_date_todayTip:'{0} (Spacebar)',s_picker_month_okText:'&#160;OK&#160;',s_picker_month_cancelText:'Cancel',s_toolbar_paging_beforePageText:'Page',s_toolbar_paging_afterPageText:'of {0}',s_toolbar_paging_firstText:'First Page',s_toolbar_paging_prevText:'Previous Page',s_toolbar_paging_nextText:'Next Page',s_toolbar_paging_lastText:'Last Page',s_toolbar_paging_refreshText:'Refresh',s_toolbar_paging_displayMsg:'Displaying {0} - {1} of {2}',s_toolbar_paging_emptyMsg:'No data to display',s_form_basic_waitTitle:'Please Wait...',s_form_field_base_invalidText:'The value in this field is invalid',s_field_text_minLengthText:'The minimum length for this field is {0}',s_field_text_maxLengthText:'The maximum length for this field is {0}',s_field_text_blankText:'This field is required',s_field_text_regexText:'',s_field_number_minText:'The minimum value for this field is {0}',s_field_number_maxText:'The maximum value for this field is {0}',s_field_number_nanText:'{0} is not a valid number',s_field_date_disabledDaysText:'Disabled',s_field_date_disabledDatesText:'Disabled',s_field_date_minText:'The date in this field must be after {0}',s_field_date_maxText:'The date in this field must be before {0}',s_field_date_invalidText:'{0} is not a valid date - it must be in the format {1}',s_field_combo_defaultListConfig_loadingText:'Loading...',s_field_vTypes_emailText:'This field should be an e-mail address in the format "user@example.com"',s_field_vTypes_urlText:'This field should be a URL in the format "http:/" + "/www.example.com"',s_field_vTypes_alphaText:'This field should only contain letters and _',s_field_vTypes_alphanumText:'This field should only contain letters, numbers and _',s_field_htmlEditor_createLinkText:'Please enter the URL for the link:',s_field_htmlEditor_buttonTips_bold_title:'Bold (Ctrl+B)',s_field_htmlEditor_buttonTips_bold_text:'Make the selected text bold.',s_field_htmlEditor_buttonTips_italic_title:'Italic (Ctrl+I)',s_field_htmlEditor_buttonTips_italic_text:'Make the selected text italic.',s_field_htmlEditor_buttonTips_underline_title:'Underline (Ctrl+U)',s_field_htmlEditor_buttonTips_underline_text:'Underline the selected text.',s_field_htmlEditor_buttonTips_increasefontsize_title:'Grow Text',s_field_htmlEditor_buttonTips_increasefontsize_text:'Increase the font size.',s_field_htmlEditor_buttonTips_decreasefontsize_title:'Shrink Text',s_field_htmlEditor_buttonTips_decreasefontsize_text:'Decrease the font size.',s_field_htmlEditor_buttonTips_backcolor_title:'Text Highlight Color',s_field_htmlEditor_buttonTips_backcolor_text:'Change the background color of the selected text.',s_field_htmlEditor_buttonTips_forecolor_title:'Font Color',s_field_htmlEditor_buttonTips_forecolor_text:'Change the color of the selected text.',s_field_htmlEditor_buttonTips_justifyleft_title:'Align Text Left',s_field_htmlEditor_buttonTips_justifyleft_text:'Align text to the left.',s_field_htmlEditor_buttonTips_justifycenter_title:'Center Text',s_field_htmlEditor_buttonTips_justifycenter_text:'Center text in the editor.',s_field_htmlEditor_buttonTips_justifyright_title:'Align Text Right',s_field_htmlEditor_buttonTips_justifyright_text:'Align text to the right.',s_field_htmlEditor_buttonTips_insertunorderedlist_title:'Bullet List',s_field_htmlEditor_buttonTips_insertunorderedlist_text:'Start a bulleted list.',s_field_htmlEditor_buttonTips_insertorderedlist_title:'Numbered List',s_field_htmlEditor_buttonTips_insertorderedlist_text:'Start a numbered list.',s_field_htmlEditor_buttonTips_createlink_title:'Hyperlink',s_field_htmlEditor_buttonTips_createlink_text:'Make the selected text a hyperlink.',s_field_htmlEditor_buttonTips_sourceedit_title:'Source Edit',s_field_htmlEditor_buttonTips_sourceedit_text:'Switch to source editing mode.',s_grid_header_sortAscText:'Sort Ascending',s_grid_header_sortDescText:'Sort Descending',s_grid_header_lockText:'Lock',s_grid_header_unlockText:'Unlock',s_grid_header_columnsText:'Columns',s_grid_groupingFeature_groupByText:'Group by this field',s_grid_groupingFeature_showGroupsText:'Show in Groups',s_grid_propertyColumnModel_nameText:'Name',s_grid_propertyColumnModel_valueText:'Value',s_grid_propertyColumnModel_trueText:'true',s_grid_propertyColumnModel_falseText:'false',s_grid_booleanColumn_trueText:'true',s_grid_booleanColumn_falseText:'false',s_grid_booleanColumn_undefinedText:'&#160;',s_field_time_minText:'The time in this field must be equal to or after {0}',s_field_time_maxText:'The time in this field must be equal to or before {0}',s_field_time_invalidText:'{0} is not a valid time',s_field_checkboxGroup_blankText:'You must select at least one item in this group',s_field_radioGroup_blankText:'You must select one item in this group',s_window_messageBox_buttonText_ok:'OK',s_window_messageBox_buttonText_cancel:'Cancel',s_window_messageBox_buttonText_yes:'Yes',s_window_messageBox_buttonText_no:'No',s_grid_filters_menuFilterText:'Filters',s_grid_filters_boolean_yesText:'Yes',s_grid_filters_boolean_noText:'No',s_grid_filters_date_fields_lt:'Before',s_grid_filters_date_fields_gt:'After',s_grid_filters_date_fields_eq:'On',s_grid_filters_list_loadingText:'Loading...',s_grid_filters_number_emptyText:'Enter Number...',s_grid_filters_string_emptyText:'Enter Filter Text...',s_multiSelectorSearch_searchText:'Search...',s_multiSelector_emptyText:'Nothing selected',s_multiSelector_removeRowTip:'Remove this item',s_multiSelector_addToolText:'Search for items to add',aria_tree_level:' level ',aria_badge_count:' count ',aria_badge_updated_count:' updated count '},formatting:{monthNames:['January','February','March','April','May','June','July','August','September','October','November','December'],dayNames:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],decimalSeparator:'.',thousandSeparator:',',currencySign:'$',dateFormat:'m-d-Y'},injectedSettingsFields:null,keepMeSignedIn:!1,loginTime:'',smallScreenThreshold:640,menuDocked:!1,name:'ABP',selected:{environment:'',language:''},signout:!1,signoutReason:'',smallScreen:!1,profilePhoto:''},checkI18n:function(a,d){var c=this;var b=a;if(c.config.data.i18n[a]!=undefined){b=c.config.data.i18n[a]}else {if(!d){ABP.util.Logger.logInfo("i18n: '"+a+"' was not found.")}}return b},i18nSet:function(a){var d=this;var b;if(!a){return}var c=d.get('i18n');if(a instanceof Array&&a.length>0){for(b=0;b<a.length;++b){if(a[b]&&a[b].key&&a[b].value){c[a[b].key]=a[b].value}}}d.set('i18n',c)},i18nSetDefaults:function(a){var d=this;var b;if(!a){return}var c=d.get('i18n');if(a instanceof Object){for(b in a){if(a.hasOwnProperty(b)){if(!c[b]){c[b]=a[b]}}}}d.set('i18n',c)}});Ext.define('ABP.view.session.mainMenu.MenuMask',{});Ext.define('ABP.view.session.SessionCanvasController',{extend:'Ext.app.ViewController',alias:'controller.sessioncanvascontroller',requires:['ABP.util.Logger','ABP.view.session.mainMenu.MenuMask'],listen:{controller:{'*':{session_configurationUpdated:'syncConfig',session_toggleMenu:'toggleMenu',session_closeMenu:'closeMenu',session_openMenu:'openMenu',session_toggleRightPane:'toggleRightPane',session_closeRightPane:'closeRightPane',searchDrop_storeLoad:'__loadStore'}},component:{'#searchbarTypeButton':{searchDrop_setSearch:'__setSearch'}}},init:function(){if(Ext.toolkit==='modern'){var a=this;var b=a.getView();b.el.dom.onclick=a.onClick.bind(this)}},onClick:function(b){var a=this;a.fireEvent('session_click',b)},syncConfig:function(){ABP.util.Logger.logInfo('Configuration updated! Syncing with model...')},toggleMenu:function(){var d=this;var e=d.getViewModel();var b=d.getView();var i=b.down('#rightPane');var c=b.down('#toolbar-button-menu');var a=e.get('menuOpen');var h=ABP.util.Common.getClassic();var g=ABP.util.Config.getSessionConfig().settings.rememberMenuState;var f=b.up().down('mainmenu').getViewModel().get('classicMenuExpand');if(h){d.fireEvent('mainMenu_classicToggle');if(c){if(f){c.removeCls('toolbar-toggled')}else {c.addCls('toolbar-toggled');d.focusSearch()}}c.setAriaExpanded(!f)}else {if(a){e.set('menuOpen',!a);if(g){ABP.util.LocalStorage.set('mmStateOpen',!a)}b.closeMenu()}else {e.set('menuOpen',!a);if(g){ABP.util.LocalStorage.set('mmStateOpen',!a)}b.openMenu();if(ABP.util.Common.getSmallScreen()===!0&&Ext.toolkit==='modern'){this.closeRightPane()}}}},focusSearch:function(){var a=ABP.util.Config.getSessionConfig().settings.enableSearch;if(a===!0){var e=this;var d=e.lookupReference('mainMenu');var b=d.lookupReference('abpNavSearchCont');var c=b.getComponent('navSearchField');c.focus()}},openMenu:function(){var b=this;var a=b.getView();var e=b.getViewModel();var d=a.down('#mainMenu');var c=a.down('#toolbar-button-menu');var f=ABP.util.Common.getClassic();if(f){b.fireEvent('mainMenu_classicOpen')}else {if(d&&e){d.show();e.set('menuOpen',!0);if(c){c.addCls('toolbar-toggled')}a.setMasked({xtype:'menumask'})}}},maskForMenu:function(){this.getView().setMasked({xtype:'menumask'})},closeMenu:function(){var b=this;var a=b.getView();var e=b.getViewModel();var d=a.down('#mainMenu');var c=a.down('#toolbar-button-menu');var f=ABP.util.Common.getClassic();var g=ABP.util.Config.getSessionConfig().settings.rememberMenuState;if(c){c.removeCls('toolbar-toggled')}if(f){b.fireEvent('mainMenu_classicClose')}else {if(d&&e){d.hide();e.set('menuOpen',!1);a.setMasked(!1)}}},toggleRightPane:function(){var a=this;var c=a.getViewModel();var b=c.get('rightPaneOpen');if(b){a.closeRightPane()}else {a.openRightPane()}},openRightPane:function(){if(ABP.util.Common.getSmallScreen()===!0&&Ext.toolkit==='modern'){this.closeMenu()}var c=this;var e=c.getView();var f=c.getViewModel();var a=e.down('#rightPane');var b=e.down('#rpButton');if(a&&f){a.show();f.set('rightPaneOpen',!0);if(b){b.addCls('toolbar-toggled');b.addCls('toolbar-button-pressed')}else {if(Ext.toolkit==='classic'){var d=a.getActiveTab();if(d){c.fireEvent('toolbar_addPressedCls',d.unqiueId)}}}if(ABP.util.Common.getKeyboardNavigation()){a.applyFocus()}}},closeRightPane:function(){var e=this;var b=e.getView();var f=e.getViewModel();var d=b.down('#rightPane');var c=b.down('#rpButton');var a=b.lookupReference('rightpaneButtons')||b.down('#rightpaneButtons');if(d&&f){d.hide();f.set('rightPaneOpen',!1);if(c){c.removeCls('toolbar-toggled');c.removeCls('toolbar-button-pressed')}if(a){a=a.items.items;a.forEach(function(a){if(a.pressed){a.setPressed(!1)}})}}},__loadStore:function(a){var b=this;var f=b.getView();var d;var c;var g;var e;if(a.enableSearch&&a.searchInfo){g=b.getViewModel();e=g.getStore('searchProviders');try{e.loadData(a.searchInfo);if(ABP.util.Common.getClassic()){b.__constructSearchOptionsMenu(a.searchInfo,a.defaultSearch)}else {b.fireEvent('searchPane_setupSearch',a)}}catch(h){ABP.util.Logger.logError('search info failed to load into searchProviders store',h)}}else {d=f.down('#searchbarContainer');if(d){c=f.down('#topContainer');if(c){c.remove(d)}}}},__constructSearchOptionsMenu:function(c,d){var e=this;var b=[];var a=0;var f='';var g=!1;for(a=0;a<c.length;++a){if(c[a].icon){f=e.__makeIconString(c[a].icon)}else {f=null}b.push({text:c[a].name,iconCls:f,cls:'a-searchtype-'+c[a].id,searchId:c[a].id,listeners:{click:'onProviderClick'}})}e.getViewModel().set('searchBar.menuOptions',b);if(d&&d!==''){for(a=0;a<b.length;a++){if(d===b[a].searchId||d===b[a].text){e.__setSearch(b[a]);g=!0;break}}}if(!g&&Ext.isArray(b)&&b.length>0){e.__setSearch(b[0])}},__constructSearchOptions:function(a,d){var c=this;var b=0;var e=!1;if(d&&d!==''){for(b=0;b<a.length;++b){if(d===a[b].id||d===a[b].name){c.__setSearch({searchId:a[b].id,iconCls:c.__makeIconString(a[b].icon)});e=!0;break}}if(!e){c.__setSearch({searchId:a[0].id,iconCls:c.__makeIconString(a[0].icon)})}}else {c.__setSearch({searchId:a[0].id,iconCls:c.__makeIconString(a[0].icon)})}},__makeIconString:function(a){var c=a;var b=a;b=b.split('-');c=b[0]==='fa'?'x-fa '+a:a;return c},__setSearch:function(a){var c=this;var b=c.getViewModel();b.set('searchBar.selectedSearch',a.searchId);b.set('searchBar.selectedSearchCls',a.iconCls)}});Ext.define('ABP.view.session.SessionCanvasModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.sessioncanvasmodel',requires:['ABP.store.ABPRecentSearchStore'],data:{menuOpen:!1,rightPaneOpen:!1,rightPaneTabs:[],searchBar:{Open:!1,menuOptions:[],selectedSearchCls:'icon-earth',selectedSearch:'global',val:''}},stores:{searchProviders:{storeId:'searchStore',model:'ABP.model.SearchModel'}}});Ext.define('ABP.view.session.about.AboutController',{extend:'Ext.app.ViewController',alias:'controller.about',init:function(){var b=this.getView();var c=ABP.util.PluginManager.getMergedPluginConfigs('aboutInfo');Ext.each(c,function(a){a.xtype='aboutitem';a.showIcon=!0});b.down('#aboutAppsList').add(c);var a=ABP.util.PluginManager.getMergedPluginConfigs('thirdPartyAttributions');a=this.checkForDuplicates(a);Ext.each(a,function(a){a.xtype='aboutitem'});if(a.length===0){b.down('#aboutThirdPartySection').hide()}else {b.down('#aboutThirdPartyList').add(a)}},checkForDuplicates:function(b){var e=[];var a=0;var c=0;var f=!1;var g=b.length;var d=[];var h=function(e){var c=!1;for(var a=0;a<d.length;++a){if(e===d[a]){c=!0;break}}if(!c){d.push(e)}};var e=[];if(g<2){e=b}else {for(a;a<g;++a){f=!1;for(c=0;c<b.length;++c){if(a!==c){if(b[a].name===b[c].name&&b[a].version===b[c].version){f=!0;if(a<c){h(c)}}}}}d.sort();for(a=d.length-1;a>-1;--a){b.splice(d[a],1)}e=b}return e},closeClicked:function(){this.fireEvent('featureCanvas_hideSetting')}});Ext.define('ABP.view.session.about.AboutViewModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.about',formulas:{viewPercent:{get:function(){var d=Ext.Viewport.getWindowWidth();var c=Ext.Viewport.getWindowHeight();var a=this.get('smallScreenThreshold');var b='60%';if(d<=a||c<=a){b='90%'}return b}}}});Ext.define('ABP.view.session.accessibility.JumpToBarViewModel',{extend:'Ext.app.ViewModel',requires:['ABP.model.WCAGRegion'],alias:'viewmodel.jumptobar',stores:{targets:{model:'ABP.model.WCAGRegion',data:[{domId:'NavMenu',text:'Main Menu'},{domId:'GlobalSearch',text:'Global Search'},{domId:'UserSettings',text:'User Settings'},{domId:'MainContent',text:'Main Content'}]}}});Ext.define('ABP.view.session.accessibility.JumpToBarController',{extend:'Ext.app.ViewController',alias:'controller.jumptobar',requires:['ABP.view.session.accessibility.JumpToBarViewModel','ABP.model.WCAGRegion'],listen:{controller:{'*':{abp_jumpto_show:'showJumpTo',rightpane_tabadded:'onRightPaneTabAdded',afteraddlanguagestrings:'onAfterAddLangaugeStrings'}},store:{'#searchStore':{datachanged:'onSearchStoreChanged'},'#navTree':{datachanged:'onNavMenuChanged'}}},initViewModel:function(d){var a=[{id:'MainContent',text:ABP.util.Common.geti18nString('abp_main_content')},{id:'NavMenu',text:ABP.util.Common.geti18nString('abp_navigation_menu')}];var b=ABP.util.Config.getSessionConfig();if(b.settings.enableMenuFavorites){a.push({id:'NavMenu-Favourites',text:ABP.util.Common.geti18nString('navMenu_favorites')})}if(b.settings.enableMenuRecent){a.push({id:'NavMenu-Recents',text:ABP.util.Common.geti18nString('navMenu_recent')})}a.push({id:'UserSettings',text:ABP.util.Common.geti18nString('sessionMenu_settings')});var c=ABP.util.Config.getRightPaneTabs();Ext.each(c,function(b){if(b.hidden){return}var c=b.tooltip;if(b.tooltipKey){c=ABP.util.Common.geti18nString(b.tooltipKey)}a.push({id:'RightPane'+b.uniqueId,context:b.uniqueId,text:c})});d.storeInfo.targets.loadData(a);Ext.data.StoreManager.on('add',function(b,c,a){console.log('Store Added: '+a)})},onRightPaneTabAdded:function(b,a){if(b==='rightPaneTab_abp-search'||b==='abp-settings'){return}if(a.hidden){return}var e=this,f=e.getViewModel();var c=a.tooltip;if(a.tooltipKey){c=ABP.util.Common.geti18nString(a.tooltipKey)}var d={id:'RightPane'+b,context:b,text:c,textKey:a.tooltipKey};f.storeInfo.targets.loadData([d],!0)},onAfterAddLangaugeStrings:function(){var a=this,b=a.getViewModel();b.storeInfo.targets.each(function(b){var a=b.get('textKey');if(a){b.set('text',ABP.util.Common.geti18nString(a))}})},onSelection:function(d,c){var b=this;var a=c.get('id');if(Ext.String.startsWith(a,'GlobalSearch')){b.fireEvent('abp_searchBar_toggleKey',c.get('context'))}else {if(a=='NavMenu'){b.fireEvent('container_showMenu',!0);if(ABP.util.Config.getSessionConfig().settings.enableNavSearch){ABP.util.Keyboard.focus('.nav-search-field')}else {ABP.util.Keyboard.focus('.main-menu .x-abptreelistitem')}}else {if(a==='NavMenu-Favourites'){b.fireEvent('mainmenu_focusFavorites')}else {if(a==='NavMenu-Recents'){b.fireEvent('mainmenu_focusRecents')}else {if(a==='MainContent'){ABP.util.Keyboard.focus('.feature-canvas [tabindex]')}else {if(Ext.String.startsWith(a,'RightPane')){this.fireEvent('container_rightPane_toggleTab',c.get('context'),!0,!0)}else {if(a==='UserSettings'){this.fireEvent('container_rightPane_toggleTab',{name:'abp-settings',uniqueId:'abp-settings',xtype:'settingscontainer',automationCls:'settings-tab'},!0);ABP.util.Keyboard.focus('.settings-container .x-panel-body [tabindex]')}}}}}}}d.setValue(null)},onFocusEnter:function(d,b){var a=this,c=a.getView();if(!b.backwards){c.show()}},onShow:function(){var a=this,b=a.getView();b.down('#JumpToCombo').focus()},onFocusLeave:function(){var a=this,b=a.getView();b.hide()},showJumpTo:function(){var b=this,a=b.getView();a.show()},privates:{onSearchStoreChanged:function(b){var c=this.getViewModel(),a=[];b.each(function(c){c.get('name');a.push({id:'GlobalSearch'+c.id,text:c.get('name'),context:c.id})});c.storeInfo.targets.loadData(a,!0)},onNavMenuChanged:function(d){var b=this;try{var c=Ext.getStore('navSearch');var a=c.getNodeById('container_nav-recent');if(a&&!a.get('hidden')){b.addTarget({id:'NavMenu-Recents',text:ABP.util.Common.geti18nString('navMenu_recent')},'NavMenu')}else {b.hideTarget('NavMenu-Recents')}var a=c.getNodeById('container_nav-favorites');if(a&&!a.get('hidden')){b.addTarget({id:'NavMenu-Favourites',text:ABP.util.Common.geti18nString('navMenu_favorites')},'NavMenu')}else {b.hideTarget('NavMenu-Favourites')}}catch(e){ABPLogger.logDebug(e)}},addTarget:function(b,d){var e=this,f=e.getViewModel(),a=f.storeInfo.targets;var b=a.getById(id);if(a){return}var c=a.indexOfId(d);if(c>-1){a.insert(c,b)}else {a.loadData(b,!0)}},hideTarget:function(c){var d=this,e=d.getViewModel(),a=e.storeInfo.targets;var b=a.getById(c);if(a){a.remove(b)}}}});Ext.define('ABP.view.session.favorites.FavoritesEditPanelModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.favoritesEditPanel',data:{depthLimit:null,allowItemRename:null,favorites_editPanel_title:'',favorites_editPanel_name:'',favorites_editPanel_source:'',favorites_editPanel_moveToGroup:'',button_cancel:'',button_delete:'',button_save:''}});Ext.define('ABP.view.session.favorites.FavoritesManagerControllerBase',{extend:'Ext.app.ViewController',init:function(){var b=this,a=b.getView();var c=b.getFavoritesStoreCopy();a.favTree=a.down('#favoritestree');a.favTree.setStore(c)},getFavoritesStoreCopy:function(){var c=this;var a=ABP.internal.util.MainMenu.copyFavorites();var b=Ext.create('Ext.data.TreeStore',{root:{expanded:!0,children:a}});return b},onSaveClick:function(){var a=this,e=!1,d=a.getView(),b=[];if(!d.favTree){return}var f=d.favTree.getStore();var c=f.getRootNode();if(c.hasChildNodes()){b=a.buildChildNode(c,e)}a.fireEvent('mainmenu_updateFavorites',b);a.fireEvent('featureCanvas_hideSetting')},onCancelClick:function(){this.fireEvent('featureCanvas_hideSetting')},privates:{buildChildNode:function(f,d){var e=[],a,c,g,b;for(c=0;c<f.childNodes.length;c++){a=f.childNodes[c];if(a.isLeaf()){e.push(a.data)}else {if(!a.hasChildNodes()){if(!d){g=ABP.util.Common.geti18nString('favorites_toast_deleteEmptyGroups');d=!0;ABP.view.base.toast.ABPToast.show(g)}continue}b=this.buildChildNode(a,d);if(b&&b.length>0){e.push({appId:'container',config:{icon:'icon-folder',text:a.data.text},text:a.data.text,uniqueId:a.id,enabled:!0,children:b})}}}return e}}});Ext.define('ABP.view.session.favorites.FavoritesManagerEditPanelController',{extend:'Ext.app.ViewController',alias:'controller.favoriteseditpanel',init:function(){var b=this,a=b.getView(),d=a.getFavorite(),g=a.down('#favoriteName'),f=a.down('#favoriteSource'),e=a.down('#favoriteGroups'),c=d.getData();g.setValue(c.text);f.setValue(b.__getSourceText(c));b.__buildGroups(d,e)},onCloseClick:function(){this.getView().close()},onDeleteClick:function(){var c=this,b=c.getView(),a=b.getFavorite();if(a.hasChildNodes()===!1){a.remove();b.close()}else {b.close();ABP.view.base.popUp.PopUp.showOkCancel(ABP.util.Common.geti18nString('favorites_confirmDeleteGroupMsg'),ABP.util.Common.geti18nString('favorites_confirmDeleteGroupTitle'),function(b){if(b){a.remove(!0)}})}},onSaveClick:function(){var g=this,b=g.getView(),d=b.getFavorite(),e=b.down('#favoriteName'),h=b.down('#favoriteGroups'),c=h.getValue(),f=d.getTreeStore();if(Ext.isEmpty(e.getValue())){return}d.set('text',e.getValue());if(c){var a=f.getNodeById(c);if(!a){a=g.__findTargetGroup(f.getRootNode(),c);if(Ext.isArray(a)&&a.length===1){a=a[0]}}if(a){a.insertChild(0,d)}else {ABP.util.Logger.logWarn('Could not find favorite group'+a)}}b.close()},__buildGroups:function(b,c){var d=ABP.util.Common.getViewModelProperty('conf.settings.favorites.depthLimit');var e=b.getTreeStore().getRootNode();var a=[{id:'root',text:ABP.util.Common.geti18nString('favorites_editPanel_noGroup')}];if(d===0||b.isLeaf()){a=a.concat(this.__getAllGroupsDeep(e))}c.setStore(Ext.create('Ext.data.Store',{fields:['id','text'],data:a}))},__getAllGroupsDeep:function(a){var c=this,e=c.getView(),d=e.getFavorite(),b=[];if(!a||a.isLeaf()||a.id===d.id){return []}else {if(a.id!=='root'){b.push({id:a.id,text:a.getData().text})}a.eachChild(function(d){b=b.concat(c.__getAllGroupsDeep(d))})}return b},__findTargetGroup:function(a,c){var d=this,b=[];if(!a||a.isLeaf()){return []}else {if(a.id===c){b.push(a)}a.eachChild(function(e){b=b.concat(d.__findTargetGroup(e,c))})}return b},__getSourceText:function(a){var b;if(a.labelKey){b=ABP.util.Common.geti18nString(a.labelKey);if(b){return b}}if(a.config){return a.config.text||a.text}return a.text}});Ext.define('ABP.view.session.favorites.FavoritesManagerModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.favoritesmanagermodel',data:{favoriteTitle:''},formulas:{hideEditIcon:{bind:{_depthLimit:'{conf.settings.favorites.depthLimit}',_allowItemRename:'{conf.settings.favorites.allowItemRename}'},get:function(a){if(a._depthLimit===1&&a._allowItemRename===!1){return !0}return !1}}}});Ext.define('ABP.view.session.feature.FeatureCanvasController',{extend:'Ext.app.ViewController',alias:'controller.featurecanvascontroller',listen:{controller:{'*':{featureCanvas_showFeature:'showFeature',featureCanvas_showSetting:'showSetting',featureCanvas_hideSetting:'hideSetting',featureCanvas_triggerDefaultMenuItem:'triggerDefaultMenuItem',featureCanvas_openSearchBar:'__openSearchBar'}},component:{'*':{abpHeaderPanel_closeView:'closeView'}}},showFeature:function(d,a,c){var f=this;var e=f.getView();var b=e.down('#applicationContainer');this.__clearAppContainer();b.add(d);if(a){this.fireEvent(a,c)}},showSetting:function(b){var d=this;var c=d.getView();var a=c.down('#settingsContainer');a.removeAll(!0,!0);this.__setSettingsShow(!0);a.add({xtype:b})},hideSetting:function(){var c=this;var b=c.getView();var a=b.down('#settingsContainer');this.__setSettingsShow(!1);a.removeAll()},closeView:function(a){var b=this.getView();var e=b.down('#applicationContainer').items;var c=b.down('#settingsContainer').items;var f=e.contains(a);var d=c.contains(a);if(f){this.__clearAppContainer()}if(d){this.hideSetting()}},triggerDefaultMenuItem:function(){var c=this;var d=c.getViewModel().data.conf.settings.loadPage;if(d){c.fireEvent('main_fireAppEvent',d.appId,d.event,d.eventArgs)}else {var b=c.getViewModel().data.conf.navMenu;for(var a=0;a<b.length;++a){if(b[a].event){c.fireEvent('main_fireAppEvent',b[a].appId,b[a].event,b[a].eventArgs);break}else {if(b[a].children&&b[a].children.length>0){if(c.lookThroughChildren(b[a].children)){break}}}}}},lookThroughChildren:function(b){var c=this;for(var a=0;a<b.length;++a){if(b[a].event){c.fireEvent('main_fireAppEvent',b[a].appId,b[a].event,b[a].eventArgs);return !0}else {if(b[a].children&&b[a].children.length>0){if(c.lookThroughChildren(b[a].children)){return !0}}}}return !1},__setSettingsShow:function(a){var b=this.getView();var c=b.down('#settingsContainer');var d=b.down('#applicationContainer');if(a===!0){d.hide();c.show()}else {if(a===!1){c.hide();d.show()}}b.settingShown=a},__clearAppContainer:function(){var b=this.getView();var a=b.down('#applicationContainer');if(ABP.util.Common.getModern()){a.removeAll(!0,!0)}else {a.removeAll()}},__openSearchBar:function(){this.getViewModel().set('searchBar.open',!0)},interpretSwipe:function(c,a,b){this.component.getController().fireEvent('thumbbar_handleSwipe',c,a,b)}});Ext.define('ABP.view.session.feature.FeatureCanvasModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.featurecanvasmodel'});Ext.define('ABP.view.session.headlines.HeadlinesManagerController',{extend:'Ext.app.ViewController',alias:'controller.headlinesManager',listen:{component:{'*':{headlinesManager_onCancelClick:'onCancelClick'}}},init:function(){var c=this,b=c.lookup('headlinesGrid'),a=Ext.getStore('ABPHeadlines');b.setStore(a)},newHeadline:function(){var f=this,c=f.lookup('headlinesGrid'),a=c.getStore(),b=a.getModel().create(),d=c.getPlugin('rowwidget');a.add(b);var e=a.indexOf(b);d.toggleRow(e,b)},onCancelClick:function(){var b=this,d=b.lookup('headlinesGrid'),a=d.getStore(),e=a.getNewRecords(),c=a.getModifiedRecords();if(e.length>0||c.length>0){ABP.view.base.popUp.PopUp.showOkCancel(ABP.util.Common.geti18nString('headlines_unsaved_changes'),ABP.util.Common.geti18nString('headlines_title'),function(c){if(c){a.rejectChanges();b.fireEvent('featureCanvas_hideSetting')}})}else {this.fireEvent('featureCanvas_hideSetting')}},removeItemClicked:function(f,d,c,g,e,a){var b=this;ABP.view.base.popUp.PopUp.showOkCancel(ABP.util.Common.geti18nString('headlines_delete'),ABP.util.Common.geti18nString('headlines_title'),function(j){if(j){var i=b.lookup('headlinesGrid'),h=i.getStore();b.fireEvent('headline_delete',a);h.remove(a);h.commitChanges()}})}});Ext.define('ABP.view.session.help.HelpController',{extend:'Ext.app.ViewController',alias:'controller.helpcontroller',listen:{component:{'*':{helpview_intialLoad:'intialLoadDisplay'}}},closeClicked:function(){this.fireEvent('featureCanvas_hideSetting')},intialLoadDisplay:function(){var j=this;var h=j.getViewModel().data;var g=h.helpTypeStore.data.items;var f=h.helpLinkStore.data.items;var d=[];var a,b;var e,c;var i;if(g){for(a=0;a<g.length;++a){e=g[a].data.type;c=[];for(b=0;b<f.length;++b){if(f[b].data.type===e){c.push(f[b].data)}}if(c.length>0){i={title:e,links:c};d.push(i)}}if(d.length>0){var k=j.lookupReference('abp-help-tile-container');for(a=0;a<d.length;++a){k.add(d[a])}}}},linkClick:function(f){var b=this.getViewModel();var a=f.url;var g=window.open(a);var d='';var c='';var e='';var h='_blank';f.el.blur();if(Ext.isEmpty(g)&&!ABP.util.Common.isIOSChrome()){d=b.get('i18n.help_blocked_Title');c=b.get('i18n.help_blocked_Text');cancelString=b.get('i18n.error_cancel_btn');canButton=Ext.MessageBox.CANCEL;canButton.text=cancelString;e=Ext.String.format("{0}<BR/><BR/><A HREF='{1}' TARGET='{2}'>{3}</A>",c,a,h,a);Ext.Msg.show({title:d,message:e,buttons:canButton})}}});Ext.define('ABP.view.session.help.HelpViewModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.helpviewviewmodel',requires:['ABP.model.HelpLinkModel','ABP.model.HelpLinkTypeModel'],data:{appTitle:''},stores:{helpLinkStore:{model:'ABP.model.HelpLinkModel',storeId:'ABPhelpLinkStore'},helpTypeStore:{model:'ABP.model.HelpLinkTypeModel',storeId:'ABPhelpLinkTypeStore'}},LoadStoreData:function(){var m=this;var i=ABP.util.PluginManager.config.registeredPlugins;var k=[];var e=[];var d={};var j,l,g,c,a,f,b;var h;for(j in i){if(i.hasOwnProperty(j)){l=i[j];g=l.split('.');c=window;d={};prodObj={};for(a=0;a<g.length;++a){c=c[g[a]]}if(c.prototype.config.helpLinks&&c.prototype.config.helpLinks.length>0){b=c.prototype.config.helpLinks}else {b=!1}if(b){for(a=0;a<b.length;++a){k.push(b[a]);d={};prodObj={};h=!1;for(f=0;f<e.length;++f){if(e[f].type===b[a].type){h=!0;break}}if(!h){d.text=d.type=b[a].type;e.push(d)}}}}}m.getStore('helpLinkStore').loadData(k);m.getStore('helpTypeStore').loadData(e)}});Ext.define('ABP.view.session.logger.LoggerController',{extend:'Ext.app.ViewController',alias:'controller.loggerpagecontroller',requires:['ABP.util.filters.Factory'],listen:{controller:{'*':{logger_clearClickAnswer:'__clearClickAnswer'}}},init:function(){},exportClicked:function(){},closeClicked:function(){this.fireEvent('featureCanvas_hideSetting')},clearClicked:function(){ABP.view.base.popUp.PopUp.showYesNo('logger_clear_confirmation','logger_clear','logger_clearClickAnswer')},phoneFilterClick:function(){var c=this;var a=c.lookupReference('filterMenu');var b=a.floatParentNode.getData();a.setUserCls(ABP.util.Common.getCurrentTheme());if(!b.modalMask){var d=Ext.Widget;var f=Ext.getFloatRoot();var e=a.getFloatWrap();b.modalMask=a.floatParentNode.createChild({cls:'x-mask abp-modal-mask-transparent'},e);b.modalMask.on({tap:d.onModalMaskTap,scope:d});if(Ext.isiOS&&a.floatParentNode===f){b.modalMask.on({touchmove:function(a){a.preventDefault()}})}}a.setWidth(c.getView().measure().width);a.showBy(c.getView().header,'b')},__clearClickAnswer:function(c){var d=this;var a;var b;if(c){a=Ext.data.StoreManager.lookup('ABPLoggingStore');b=d.getView().down('#loggerSeverity');a.clearFilter();a.removeAll();b.setValue('ALL')}},severityChanged:function(c,a){var c=this;var b=Ext.data.StoreManager.lookup('ABPLoggingStore');if(a.data){a=a.data.value}if(a!=='ALL'){b.filter('level',a)}else {b.clearFilter()}},onFilterChanged:function(d,a){var b=Ext.data.StoreManager.lookup('ABPLoggingStore');b.removeFilter('TextFilter');if(!a||a.length<2){return}var c=ABP.util.filters.Factory.createStringFilter(a,[{name:'message',useSoundEx:!0},{name:'detail',useSoundEx:!0}],!0);b.filter({id:'TextFilter',filterFn:c})},__clearLogFilters:function(){var a=Ext.data.StoreManager.lookup('ABPLoggingStore');a.clearFilter()},destroy:function(){this.__clearLogFilters();this.callParent()}});Ext.define('ABP.view.session.logger.LoggerViewModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.loggerviewmodel',stores:{severity:{fields:['display','value'],data:[{'display':'All Logs','value':'ALL'},{'display':'Info','value':'INFO'},{'display':'Warning','value':'WARN'},{'display':'Accessibility','value':'ARIA'},{'display':'Error','value':'ERROR'},{'display':'Fatal','value':'FATAL'},{'display':'Trace','value':'TRACE'},{'display':'Debug','value':'DEBUG'}]}}});Ext.define('ABP.view.session.mainMenu.ABPTreeListModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.abptreelistmodel',stores:{navItems:{type:'tree',root:{expanded:!0}}}});Ext.define('ABP.view.session.mainMenu.ABPTreeListController',{extend:'Ext.app.ViewController',alias:'controller.abptreelistcontroller',listen:{component:{treelistmenu:{itemclick:'onItemClick'}}},onItemClick:function(e,d){var c=this,b=d.node,a=b?b.getData():null;if(a){if(a.type==='event'&&a.event){c.fireEvent('main_fireAppEvent',a.appId,a.event,a.eventArgs,a.activateApp)}else {if(a.type==='route'&&a.hash){c.redirectTo(a.hash)}}if(!b.hasChildNodes()&&!b.getData().children){if(ABP.util.Common.getClassic()&&ABP.util.Config.getSessionConfig().settings.autoHideMenu||ABP.util.Common.getModern()){c.fireEvent('session_closeMenu')}}}c.fireEvent('main_activeAppFocus')},onManageToolClick:function(b,c){b.stopPropagation();var a=this.getView().getOverItem();if(a._node.get('manageEvent')){this.fireEvent(a._node.get('appId')+'_showSettings',a._node.get('manageEvent'))}},navigateDownPress:function(c,b){var a=this.findNextMenuOption();if(a){a.focus()}},navigateUpPress:function(c,b){var a=this.findPreviousMenuOption();if(a){a.focus()}},navigateLeftPress:function(b,c){var a=Ext.getCmp(b.target.id);if(a&&a.collapse){a.collapse()}},navigateRightPress:function(b,c){var a=Ext.getCmp(b.target.id);if(a&&a.expand){a.expand()}},navigateSelect:function(a,d){if(ABP.util.Common.getClassic()){var b=document.activeElement;b.click()}else {var c=Ext.getCmp(a.target.id);c.onClick(a)}},navigateSelectSpecial:function(d,c){var b=document.activeElement;var a=Ext.getCmp(b.id);if(a&&a.peelOffElement&&a.peelOffElement){if(a.peelOffElement.dom.href){a.peelOffElement.dom.click()}}},navigateSelectShiftTab:function(b){if(Ext.query('.nav-search-field').length>0&&ABP.util.Config.getSessionConfig().settings.enableNavSearch){ABP.util.Keyboard.focus('.nav-search-field')}else {var a=Ext.query('a[id^=abpbadgebutton]');if(a.length>0){a[a.length-1].focus()}else {ABP.util.Keyboard.focus('.tool-button-left')}}},findNextMenuOption:function(){var a=document.activeElement;var d=a.classList;var e=d.contains('x-treelist-item-collapsed');var b=ABP.util.Common.getClassic();if(a.lastChild.firstChild&&!e){return a.lastChild.firstChild}var c=b?this.findNextVisibleSibling(a):this.findNextVisibleSiblingModern(a);if(c){return c}else {b?this.focusNextParentSibling(a):this.focusNextParentSiblingModern(a)}},findPreviousMenuOption:function(){var b=document.activeElement;var e=ABP.util.Common.getClassic()?this.findPreviousVisibleSibling(b):this.findPreviousVisibleSiblingModern(b);if(e){return e}else {var f=b.classList;var g=f.contains('treeMenu-level-0');if(!g){b.parentNode.parentNode.focus()}else {var a=b.parentNode.lastChild;if(a!==b){if(a._extData.isVisible===undefined||a._extData.isVisible){var d=this.checkChildrenVisibility(a);if(d){return d}else {return a}}else {var c=ABP.util.Common.getClassic()?this.findPreviousVisibleSibling(a):this.findPreviousVisibleSiblingModern(a);if(c&&c!==b){return c}}}}}},findNextVisibleSibling:function(c){var b=null;var a=c;for(;;){if(a.nextSibling){a=a.nextSibling;if(a._extData.isVisible===undefined||a._extData.isVisible){b=a;break}}else {break}}return b},findNextVisibleSiblingModern:function(d){var c=null;var a=d;var b;for(;;){if(a.nextSibling){a=a.nextSibling;b=Ext.getCmp(a.id);if(!b.isHidden()){c=a;break}}else {break}}return c},findPreviousVisibleSiblingModern:function(f){var b=null;var a=f.previousSibling;var c;var e=!1;for(;;){if(a){c=Ext.getCmp(a.id);if(!c.isHidden()){b=a;e=!0;break}a=a.previousSibling}else {break}}if(e){var d=this.checkChildrenVisibility(b);if(d){b=d}}return b},findPreviousVisibleSibling:function(e){var b=null;var a=e.previousSibling;var d=!1;for(;;){if(a){if(a._extData.isVisible===undefined||a._extData.isVisible){b=a;d=!0;break}a=a.previousSibling}else {break}}if(d){var c=this.checkChildrenVisibility(b);if(c){b=c}}return b},checkChildrenVisibility:function(c){var f=c.classList;var g=f.contains('x-treelist-item-collapsed');var a;var e=!1;var b=null;if(c.lastChild.firstChild&&!g){a=c.lastChild.lastChild;for(;;){if(a){if(a._extData.isVisible===undefined||a._extData.isVisible){b=a;e=!0;break}a=a.previousSibling}else {break}}if(e){var d=this.checkChildrenVisibility(b);if(d){b=d}}}return b},focusNextParentSibling:function(c){var a=c.parentNode.parentNode;var b=!1;for(;;){if(a.nextSibling){a=a.nextSibling;if(a._extData.isVisible===undefined||a._extData.isVisible){a.focus();b=!0;break}}else {break}}if(!b){this.focusFirstMenuOption()}},focusNextParentSiblingModern:function(d){var a=d.parentNode.parentNode;var b;var c=!1;for(;;){if(a.nextSibling){a=a.nextSibling;b=Ext.getCmp(a.id);if(b&&!b.isHidden()){a.focus();c=!0;break}}else {break}}if(!c){this.focusFirstMenuOption()}},treeListFocus:function(){var a=this.findNextMenuOption();if(a){a.focus()}},focusFirstMenuOption:function(){var b=this.getView();var a=document.activeElement;a.blur();b.focus()}});Ext.define('ABP.view.session.mainMenu.ABPTreeListItem',{extend:'Ext.list.TreeItem',requires:['Ext.list.TreeItem','ABP.util.Common'],alias:'widget.abptreelistitem',config:{itemCount:undefined,itemPriority:undefined,showManageTool:!1,manageEvent:undefined},hideMode:'offsets',focusable:!0,tabIndex:-1,element:{reference:'element',tag:'li',cls:Ext.baseCSSPrefix+'treelist-item',children:[{reference:'rowElement',cls:Ext.baseCSSPrefix+'treelist-row',children:[{tag:'a',tabIndex:-1,role:'presentation',reference:'wrapElement',cls:Ext.baseCSSPrefix+'treelist-item-wrap','aria-live':'polite','aria-atomic':!0,'aria-relevant':'additions',children:[{reference:'iconElement',cls:Ext.baseCSSPrefix+'treelist-item-icon'},{reference:'textElement','aria-hidden':!0,cls:Ext.baseCSSPrefix+'treelist-item-text'},{reference:'shorthandElement',cls:Ext.baseCSSPrefix+'treelist-item-shorthand'},{tag:'a',tabIndex:-1,target:'_blank',reference:'peelOffElement',title:'Open in new Tab',cls:Ext.baseCSSPrefix+'treelist-item-tool treelist-tool-peel-off icon-windows'},{tag:'a',tabIndex:-1,target:'_blank',reference:'manageToolElement',cls:Ext.baseCSSPrefix+'treelist-item-tool treelist-tool-manage icon-gearwheel'},{reference:'expanderElement',cls:Ext.baseCSSPrefix+'treelist-item-expander'}]}]},{reference:'itemContainer',tag:'ul',cls:Ext.baseCSSPrefix+'treelist-container'},{reference:'toolElement',cls:Ext.baseCSSPrefix+'treelist-item-tool'}]},constructor:function(c){c=c||{};var b=this,a=c.node;if(a&&a.get('contextMenu')){c.contextMenu=!0;var e='abpcontextmenu';c.plugins=c.plugins||{};if(Ext.isObject(c.plugins)&&!c.plugins[e]){c.plugins[e]=e}else {if(Ext.isArray(c.plugins)&&!c.plugins.indexOf(e)>-1){c.plugins.push(e)}}}b.callParent([c]);b.initToolTip(c);a=b.getNode();var d=b.peelOffElement,h=b.wrapElement,f=a.get('itemHref'),l=ABP.util.Config.getSessionConfig().settings.enableMenuPeelOff,q=a.get('cls'),p=a.get('itemCount'),o=a.get('itemPriority'),k=a.get('hidden'),n=a.get('showManageTool'),i=a.get('shorthand'),g=ABP.util.Common.geti18nString('aria_tree_level'),j=ABP.util.Aria.encodeAttribute(Ext.String.htmlDecode(a.get('text'))),m=ABP.util.Config.getSessionConfig().settings.mainMenuSingleExpand;if(a&&a.parentNode&&a.parentNode.id==='container_nav-recent'&&!a.get('children')){b.isToggleEvent=function(){return !1}}b.element.set({'aria-label':j+g+a.get('depth')});if(a.childNodes&&a.childNodes.length>0){b.element.set({'aria-expanded':a.get('expanded')})}if(d){d.hide();if(!Ext.isEmpty(f)&&h){h.set({href:f});b.element.set({'aria-label':j+g+a.get('depth')+' alt + enter to open in new tab'});if(l){d.addCls('has-link');d.set({href:f});d.show();d.on({click:function(a){a.stopPropagation()}})}}}if(!n){b.manageToolElement.hide()}else {b.manageToolElement.show();b.manageToolElement.on({click:'onManageToolClick'})}if(i){b.shorthandElement.setHtml(i)}b.element.addCls(q);b.setItemCount(p);b.setItemPriority(o);if(k){b.setHidden(k)}if(m){a.on('collapse',b.onNodeCollapse)}return b},onNodeCollapse:function(a){var b=!Ext.isEmpty(a.childNodes);if(b){a.cascade({after:function(b){b.collapse()}})}},onNodeExpand:function(a){},updateText:function(a){this.renderNodeText(a,this.getItemCount(),this.getItemPriority())},updateItemCount:function(a){this.renderNodeText(this.getText(),a,this.getItemPriority())},updateItemPriority:function(a){this.renderNodeText(this.getText(),this.getItemCount(),a)},nodeUpdate:function(b,a){this.onNodeUpdate(b,a)},expand:function(){var a=this.getNode();if(a){a.expand();this.element.set({'aria-expanded':a.get('expanded')})}},collapse:function(){var a=this.getNode();if(a){a.collapse();this.element.set({'aria-expanded':a.get('expanded')})}},privates:{onNodeUpdate:function(a,c){var b=this;b.setItemCount(a.data['itemCount']);b.setItemPriority(a.data['itemPriority']);b.setHidden(a.data['hidden']);b.setText(a.data['text'])},renderNodeText:function(d,a,c){var b=null,f=this.getNode(),h=ABP.util.Common.geti18nString('aria_badge_count'),g=ABP.util.Common.geti18nString('aria_badge_updated_count'),i=ABP.util.Common.geti18nString('aria_tree_level'),e=ABP.util.Aria.encodeAttribute(Ext.String.htmlDecode(f.get('text')));if(c===ABP.util.Constants.badgePriority.Info){b='priority-normal'}else {if(c===ABP.util.Constants.badgePriority.Success){b='priority-low'}else {if(c===ABP.util.Constants.badgePriority.Warning){b='priority-medium'}else {if(c===ABP.util.Constants.badgePriority.Alert){b='priority-high'}}}}if(a){this.element.set({'aria-label':e+h+a+i+f.get('depth')});this.wrapElement.set({'aria-label':e+g+a});if(b){this.textElement.update(d+"<span class='nav-item-count "+b+"' aria-label='"+a+"'>"+a+'</span>')}else {this.textElement.update(d+"<span class='nav-item-count' style='background-color: "+c+"' aria-hidden=true>"+a+'</span>')}}else {this.textElement.update(d)}},initToolTip:function(b){var a=this;var d=a.getTooltipText(b);var f=a.getLabelText(b);var e=Ext.htmlEncode(!Ext.isEmpty(d)?d:f||'');if(b.shorthand){e+='<span class="shorthand">'+Ext.htmlEncode(b.shorthand)}var c={target:a.rowElement,html:e,anchor:'top',showDelay:1000,anchorToTarget:!1,listeners:!Ext.isEmpty(d)?undefined:{beforeshow:a.tooltipBeforeShow}};if(Ext.toolkit==='modern'){Ext.applyIf(c,{align:'b'})}else {Ext.applyIf(c,{cls:'main-menu'})}a.tooltip=Ext.create('Ext.tip.ToolTip',c)},getLabelText:function(g){var b='',c,e=g.node.data,f=e.text,d=e.label,a=e.labelKey;if(d&&d.length){b=d}else {if(f&&f.length){b=f}}if(a&&a.length){c=ABP.util.Common.geti18nString(a);if(c!==a){b=c}}return b},getTooltipText:function(f){var c='',b,e=f.node.data,d=e.tooltip,a=e.tooltipKey;if(d&&d.length){c=d}if(a&&a.length){b=ABP.util.Common.geti18nString(a);if(b!==a){c=b}}return c},tooltipBeforeShow:function(e,d){var c=this.target||this.targetElement,b=c.down('.x-treelist-item-text'),a=b?b.dom:null;if(a){return a.offsetWidth<a.scrollWidth}}}});Ext.define('ABP.view.session.mainMenu.ABPTreeList',{extend:'Ext.list.Tree',alias:'widget.treelistmenu',requires:['ABP.view.session.mainMenu.ABPTreeListModel','ABP.view.session.mainMenu.ABPTreeListController','ABP.view.session.mainMenu.ABPTreeListItem','Ext.list.Tree'],viewModel:{type:'abptreelistmodel'},controller:'abptreelistcontroller',itemId:'treelistmenu',cls:'mainnav-treelist',automationCls:'mainnav-treelist',ui:'dark',docked:'left',width:175,expanderFirst:!1,expanderOnly:!1,focusable:!0,tabIndex:0,bind:{singleExpand:'{mainMenuSingleExpand}'},defaults:{xtype:'abptreelistitem'},listeners:{focus:'treeListFocus'},keyMap:{DOWN:'navigateDownPress',UP:'navigateUpPress',LEFT:'navigateLeftPress',RIGHT:'navigateRightPress',ENTER:'navigateSelect',SPACE:'navigateSelect','ALT+ENTER':'navigateSelectSpecial','ALT+SPACE':'navigateSelectSpecial','SHIFT+TAB':'navigateSelectShiftTab'},indent:12,getIndent:function(){return 12}});Ext.define('ABP.view.session.mainMenu.MainMenuController',{extend:'Ext.app.ViewController',alias:'controller.mainmenucontroller',requires:['ABP.util.filters.misc.DuplicateFilter','ABP.events.ABPEvents'],useDefaultSelection:!0,__favoriteBroadcastChannel:'abp-core-favorite',listen:{controller:{'*':{mainMenu_Populate:'populateMainMenu',container_mobileSessionToggle:'mobileSessionToggle',mainMenu_classicToggle:'classicToggle',mainMenu_classicClose:'classicClose',mainMenu_classicOpen:'classicOpen',mainMenu_enableMenuOption:'enableMenuItem',mainMenu_addMenuOption:'addMenuItem',mainMenu_removeMenuOption:'removeMenuItem',mainMenu_updateMenuCount:'onUpdateMenuCount',mainMenu_toggleNav:'__toggleNavType',mainMenu_addRecent:'__addRecent',mainMenu_addFavorite:'__addFavorite',mainMenu_removeFavorite:'__removeFavorite',mainmenu_updateFavorites:'__updateFavorites',mainmenu_focusFavorites:'focusFavorites',mainmenu_focusRecents:'focusRecents',mainMenu_replaceSuggested:'__replaceSuggested',mainMenu_addTreeOption:'__addTreeOption',mainMenu_removeTreeOption:'__removeTreeOption',mainMenu_setSingleExpand:'__setSingleExpand',mainMeun_setRecents:'__setRecents',afterSwitchLanguage:'__updateTreeStrings',session_click:'__handleSessionClick',session_toggleMenuShortcuts:'__toggleMenuShortcuts'}},component:{'*':{miItemClick:'menuButtonClick',seperatorClick:'mobileSessionToggle'}}},init:function(){ABP.util.BroadcastChannel.create('abp-core-favorite',this.onFavoriteMessageRecieved,this)},destroy:function(){ABP.util.BroadcastChannel.remove('abp-core-favorite')},setMicro:function(){var c=this;var a=c.getViewModel();var b=a.get('micro');if(b){a.set('micro',!1);a.set('menuWidth',175);a.set('sessHeight',81);a.set('menuFooterCls','menu-footer')}else {a.set('micro',!0);a.set('menuWidth',40);a.set('sessHeight',52);a.set('menuFooterCls','main-footer-micro')}},populateMenuNav:function(i){var c=this;var n=c.getViewModel();var p=n.getStore('navSearch');var a=[];var l,f;var e=0;var b=ABP.util.Config.getSessionConfig();var g=b.navMenuOrder;var o=Object.keys(g).length;for(e=0;e<o;e++){f=null;for(var m in g){if(g[m]===e){f=m;break}}switch(f){case 'favorites':if(b.settings.enableMenuFavorites){a.push(c.buildFavoriteNode(b))};break;case 'recents':if(b.settings.enableMenuRecent){a.push(c.buildRecentsNode())};break;case 'suggested':if(b.settings.enableMenuSuggested){a.push(c.buildSuggestedNode())};break;case 'navigation':var k=i.length;for(var d=0;d<k;++d){var j=c.makeMenuTreeItem(i[d],0);if(b.firstMenuAtTop&&d===0){a.unshift(j)}else {if(i[d].isTop){a.unshift(j)}else {a.push(j)}}if(d===k-1){var h=a.length-1;n.set('mainMenu_lastAddedNavItemId',{uniqueId:a[h].uniqueId,appId:a[h].appId,index:h})}};break;}}l={expanded:!0,children:a};p.setRoot(l);c.setSearchStore()},buildFavoriteNode:function(c){var b=[];var d=!1;var a=c.settings.favorites.favoriteItems;if(Ext.isString(a)){a=Ext.JSON.decode(a)}if(Ext.isArray(a)&&a.length===1&&Ext.isString(a[0])){a=Ext.JSON.decode(a[0])}if(a&&!Ext.isEmpty(a)){b=a}if(c.settings.mainMenuStartFavoritesOpen){d=!0}return this.makeMenuTreeItem({activateApp:!1,enabled:!0,children:b,hidden:b.length===0,expanded:d,showManageTool:c.settings.enableMenuFavorite,itemId:'NavFavorites',appId:'container',uniqueId:'container_nav-favorites',label:'Favorites',labelKey:'navMenu_favorites',tooltip:'Favorites',tooltipKey:'navMenu_favorites',icon:'icon-favorite'},0,!1,'favorite')},buildRecentsNode:function(){var a=[];return this.makeMenuTreeItem({activateApp:!1,enabled:!0,children:a,hidden:a.length===0,itemId:'NavRecent',appId:'container',uniqueId:'container_nav-recent',label:'Recent',labelKey:'navMenu_recent',tooltip:'Recent',tooltipKey:'navMenu_recent',icon:'icon-clock'},0)},buildSuggestedNode:function(){var a=[];return this.makeMenuTreeItem({activateApp:!1,enabled:!0,children:a,hidden:a.length===0,itemId:'NavSuggested',appId:'container',uniqueId:'container_nav-suggested',label:'Suggested',labelKey:'navMenu_suggested',tooltip:'Suggested',tooltipKey:'navMenu_suggested',icon:'icon-lightbulb-off'},0)},populateMenuTree:function(b){var c=this;var g=c.getViewModel();var f=g.getStore('navTree');var d=[];var e;var a=0;if(b){for(a=0;a<b.length;++a){d.push(c.makeMenuTreeItem(b[a],0))}}e={expanded:!0,children:d};f.setRoot(e);c.setSearchStore()},makeMenuTreeItem:function(a,l,k,n){var h=this;var q=h.getViewModel();var d,c,m;var f=[];var b='';var e=a.icon;var i=0;var j='';var o='';var p='';var g='';if(a.data&&a.data.serialData){a=a.data.serialData;e=a.icon}if(a.uniqueId===null||a.uniqueId===undefined||a.uniqueId===''){c=(n==='favorite'?'fav_':'')+ABP.util.IdCreator.getId(a)}else {c=a.uniqueId}if(a.children&&a.children.length>0){for(i;i<a.children.length;i++){f.push(h.makeMenuTreeItem(a.children[i],l+1,k,n))}}else {f=undefined}if(a.config){b=a.config.icon;a.label=a.config.text}m=a.text?a.text:h.i18nLookup(a.label,a.labelKey);if(e){e=e.split('-');b=e[0]==='fa'?'x-fa '+a.icon:a.icon;b=h.__inspectIconString(b)}if(a.labelKey){j=p+'a-menu-'+a.labelKey.replace(/_/g,'-')}else {j=p+'a-menu-unsafe-'+a.label.replace(/[^A-Za-z]/g,'')}o+='treeMenu-level-'+l%5;indentCls='treeMenu-indent-'+l;g=[j,o,indentCls];if(!a.enabled){g.push('treeMenu-disabled')}if(n==='favorite'){if(q.get('conf.settings.favorites.hideIcons')===!0&&a.uniqueId!=='container_nav-favorites'){b=''}}if(b===''){g.push('abp-no-icon')}d={text:Ext.String.htmlEncode(m),config:{text:m,icon:b},itemId:a.itemId,iconCls:b,itemCount:a.itemCount,itemPriority:a.itemPriority,showManageTool:a.showManageTool,manageEvent:a.manageEvent,itemHref:a.itemHref,cls:g,activateApp:a.activateApp,appId:a.appId,expanded:a.expanded?a.expanded:!1,hash:a.hash,contextMenu:a.contextMenu||!1,hidden:a.hidden,enabled:a.enabled,event:a.event,eventArgs:a.eventArgs,labelKey:a.labelKey,tooltip:a.tooltip,tooltipKey:a.tooltipKey,shorthand:a.shorthand,type:a.type,id:c,uniqueId:c};if(k||k===undefined){a.uniqueId=c;d['serialData']=a}if(f){d['children']=f}else {d['leaf']=!0}return d},makeSessionMenuItem:function(a){var b=a.uniqueId===null||a.uniqueId===undefined||a.uniqueId===''?ABP.util.IdCreator.getId(a):a.appId+'_'+a.uniqueId;return {xtype:'menubutton',activateApp:a.activateApp,appId:a.appId,enabled:a.enabled,command:a.event,args:a.eventArgs,icon:a.icon,title:a.label,labelKey:a.labelKey,tooltip:a.tooltip,tooltipKey:a.tooltipKey,type:a.type,uniqueId:b,hidden:!a.enabled,bind:{width:'{menuWidth}'}}},__inspectIconString:function(c){var a=(((a||'')+'').toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join('');var d=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,b=/\x3c!--[\s\S]*?--\x3e|<\?(?:php)?[\s\S]*?\?>/gi;return c.replace(b,'').replace(d,function(b,d){return a.indexOf('<'+d.toLowerCase()+'>')>-1?b:''}).replace('/>','').trim()},i18nLookup:function(d,b){var e=this;var f=e.getViewModel();var c=d;var a='';if(b){a=f.get('i18n.'+b);if(a){c=a}}return c},onManageToolClick:function(b,c){b.stopPropagation();var a=this.getView().getOverItem();if(a._node.get('manageEvent')){this.fireEvent(a._node.get('appId')+'_showSettings',a._node.get('manageEvent'))}},populateMainMenu:function(b){var c=this;var k=c.getView();var l=c.getViewModel().data.menuDocked;var g=c.getViewModel().get('autoHide');var f=-1;var d=[];var a,h,j;var i,e;for(a=0;a<b.length;++a){h=b[a].enabled?!1:!0;j=b[a].uniqueId===null||b[a].uniqueId===undefined||b[a].uniqueId===''?ABP.util.IdCreator.getId(b[a]):b[a].uniqueId;if(b[a].enabled&&f===-1){f=a}i=!g&&b[a].enabled;e={xtype:'menubutton',uniqueId:j,icon:b[a].icon,title:b[a].label,labelKey:b[a].labelKey,bind:{labelVal:'{i18n.'+b[a].labelKey+'}'},command:b[a].event,args:b[a].eventArgs,enabled:b[a].enabled,tooltip:b[a].tooltip,tooltipKey:b[a].tooltipKey,shorthand:b[a].shorthand,type:b[a].type,children:b[a].children,appId:b[a].appId,hidden:b[a].hidden&&h,focusable:i,activateApp:b[a].activateApp,tabIndex:-1};if(b[a].children&&b[a].children.length>0){c.fireEvent('submenu_populate',b[a].children,e.uniqueId,e.title)}d.push(e)}d.push({flex:1});if(!g){d[f].tabIndex=2}k.focusItemsCt=c.getViewModel().navSet('navMenu',d)},populateSessionMenu:function(e){var c=this;var d=c.getView();var b=[];var a;if(ABP.util.Common.getModern()){a={xtype:'component',uniqueId:'apteanLogo',bind:{cls:'{menuFooterCls}'}}}else {a={xtype:'component',itemId:'apteanLogo',uniqueId:'apteanLogo',cls:'menu-footer',bind:{cls:'{menuFooterCls}',width:'{menuWidth}'},setCls:function(a){if(a==='menu-footer'){this.removeCls('main-footer-micro');this.addCls(a)}else {this.removeCls('menu-footer');this.addCls(a)}}}}b.push(a);d.focusItemsCt=c.getViewModel().navSet('sessionMenu',b)},languageSubMenu:function(b){var d=[];var c=this.getViewModel().get('selected.language');if(c===''){c='en';this.getViewModel().set('selected.language','en')}var a;for(a=0;a<b.length;++a){if(b[a].key!==c){d.push({label:b[a].name,labelKey:'languages_'+b[a].key,event:'switchLanguage',eventArgs:b[a].key,appId:'container',enabled:!0,tooltip:b[a].name,tooltipKey:'languages_'+b[a].key,children:undefined,type:'event'})}}return d},refreshMainMenu:function(){var b=this;var a=ABP.util.Config.getSessionConfig();b.populateMainMenu(a.navMenu);b.populateSessionMenu(a)},enableMenuItem:function(h,g,b){var c=this;var a=c.findMenuItem(h,g);if(a){if(a.isNode){var k=c.getView();var j=k.down('treelistmenu');var f=j.getItem(a);if(f){if(b){a.data.enabled=!0;f.removeCls('treeMenu-disabled')}else {a.data.enabled=!1;f.addCls('treeMenu-disabled')}}}else {a.data.enabled=b;if(!Ext.isArray(a.data.cls)){a.data.cls=[]}if(b&&Ext.Array.contains(a.data.cls,'treeMenu-disabled')){Ext.Array.remove(a.data.cls,'treeMenu-disabled')}else {if(!b&&!Ext.Array.contains(a.data.cls,'treeMenu-disabled')){Ext.Array.push(a.data.cls,'treeMenu-disabled')}}}}else {var e=c.findSessionMenuItem(h,g);if(e){var i=c.getViewModel();var d=i.get('sessionMenu');d[e].hidden=!b;d[e].enabled=b;i.navSet('sessionMenu',d)}}},findMenuItem:function(g,c,f){var d=this;var e=d.getViewModel();var a;var b;if(f){a=e.getStore('navTree')}else {a=e.getStore('navSearch')}b=a.getNodeById(c);if(b==null){if(a.lazyFill){b=d.findTreeStoreItem(a,'id',c)}}return b},findSessionMenuItem:function(e,d){var f=this;var g=f.getViewModel();var c=g.get('sessionMenu');var b=!1;for(var a=0;a<c.length;++a){if(e+'_'+d===c[a].uniqueId){b=a}}return b},addMenuItem:function(d,q,l,n,p){var c=this;var f=c.getViewModel();var e;var a;var h;var b=0;var o;var g;if(p){e=f.getStore('navTree')}else {e=f.getStore('navSearch')}if(q){if(n){var k=(l?l+'_':'')+n;a=this.findMenuItem(null,k,p);if(a){if(a.isNode){h=a;for(;;){if(h.parentNode.isRoot()){b+=1;break}else {h=h.parentNode;b+=1}}}else {b=a.level}}else {ABP.util.Logger.logWarn('Cannot add menu node. Could not find parent menu node id "'+k+'"')}}if(a){if(a.isNode){a.appendChild(c.makeMenuTreeItem(d,b))}else {if(!Ext.isArray(a.data.children)){a.data.children=[]}a.data.children.push(c.makeMenuTreeItem(d,b));a.data.leaf=!1}}else {var j=f.get('mainMenu_lastAddedNavItemId');if(j){var m=j.index+1;var i=c.makeMenuTreeItem(d,b);f.set('mainMenu_lastAddedNavItemId',{uniqueId:i.uniqueId,appId:i.appId,index:m});e.getRoot().insertChild(m,i)}else {if(e.getRoot()){e.getRoot().appendChild(c.makeMenuTreeItem(d,b))}else {e.setRoot({expanded:!0});e.getRoot().appendChild(c.makeMenuTreeItem(d,b))}}}}else {o=c.findSessionMenuItem(d.appId,d.uniqueId);if(!o){a=c.makeSessionMenuItem(d);g=f.get('sessionMenu');b=ABP.util.Config.getSessionConfig().settings.enableSignOff?2:1;g.splice(g.length-b,0,a);f.navSet('sessionMenu',g)}}c.setSearchStore()},removeMenuItem:function(f,e,h){var b=this;var a=b.findMenuItem(f,e,h);if(a){if(a.isNode){a.parentNode.removeChild(a)}else {a.remove()}}else {var d=b.findSessionMenuItem(f,e);if(d){var g=b.getViewModel();var c=g.get('sessionMenu');c.splice(d,1);g.navSet('sessionMenu',c)}}},onUpdateMenuCount:function(d,a,b){var c=this;var e=c.getViewModel();if(!c.__updateMenuCountForTree(d,a,!1,b)){c.__updateMenuCountForTree(d,a,!0,b)}c.__updateMenuCountForTree(d,'fav_'+a,!1,b);c.__updateMenuCountForTree(d,'rec_'+a,!1,b);c.__updateMenuCountForTree(d,'sug_'+a,!1,b);e.checkFirstRecentForUpdate(a,b)},__updateMenuCountForTree:function(d,c,f,e){var b=this;var a=b.findMenuItem(d,c,f);if(a){b.__updateMenuCount(a,e);return !0}return !1},__updateMenuCount:function(a,b){if(a.isNode){a.beginEdit()}a.set('itemPriority',b.priority);a.set('itemCount',b.count);if(a.isNode){a.endEdit()}},setSelected:function(c){var b=Ext.ComponentQuery.query('menubutton');var a;for(a=0;a<b.length;++a){if(b[a]!==c){b[a].setSelected(!1)}else {b[a].setSelected(!0)}}},moveLeft:function(){this.fireEvent('featureCanvas_closeAllMenus')},moveUp:function(){var b=this;var a=b.getView();if(a.currentFocus===-1){a.currentFocus=0;b.focusByPlace(a.currentFocus)}else {b.move(!0,a.currentFocus)}},moveDown:function(){var b=this;var a=b.getView();if(a.currentFocus===-1){a.currentFocus=0;b.focusByPlace(a.currentFocus)}else {b.move(!1,a.currentFocus)}},move:function(e,a){var c=this;var b=c.getView();var d;var f;if(e){if(a-1>=0){a--;d=c.findByPlace(a);if(!d.config.enabled){c.move(!0,a)}else {b.currentFocus=a;c.focusByPlace(b.currentFocus)}}else {b.currentFocus=b.focusItemsCt;c.focusByPlace(b.currentFocus)}}else {if(a+1>b.focusItemsCt){b.currentFocus=0;c.focusByPlace(b.currentFocus)}else {a++;d=c.findByPlace(a);if(!d.config.enabled){c.move(!1,a)}else {b.currentFocus=a;c.focusByPlace(b.currentFocus)}}}},tabHit:function(){var a=this;if(a.getViewModel().get('autohide')){a.getView().currentFocus=0}a.fireEvent('featureCanvas_focusToToolbar')},enterHit:function(){var b=this;var c=b.getView();var a=c.currentFocus;if(a!==-1){b.selectByPlace(a)}},focusByPlace:function(b){var c=this;var a=c.findByPlace(b);if(a!==null){a.focus()}},selectByPlace:function(b){var c=this;var a=c.findByPlace(b);if(a!==undefined){a.clickItem()}},findByPlace:function(f){var h=this;var g=h.getView();var d=g.down('#main_menu_nav');var b=g.down('#main_menu_session');var e=null;for(var a=0,c=d.items.items.length;a<c;++a){if(d.items.items[a].place===f){e=d.items.items[a];break}}for(var a=0,c=b.items.items.length;a<c;++a){if(b.items.items[a].place===f){e=b.items.items[a];break}}return e},UpdateTabIndex:function(a){this.getView().startIdx=a;this.getView().dirtyIdx=!0},preOpen:function(c){var a=this;var b=a.getView();b.lastInitMouseBool=c;if(a.getViewModel().get('autoHide')){b.addCls('main-menu-open')}else {b.addCls('main-menu-ah')}a.assignTabs(!0);if(!c){a.firstFocus()}},ahOpen:function(){var a=this;a.getView().addCls('main-menu-ahOpen')},ahClose:function(){var a=this;a.getView().removeCls('main-menu-ahOpen')},assignTabs:function(c){var g=this;var f=g.getView();var b=f.down('#main_menu_nav');var d=f.down('#main_menu_session');for(var a=0,e=b.items.items.length;a<e-1;++a){b.items.items[a].focusable=c;if(!c&&document.activeElement.id===b.items.items[a].id){document.activeElement.blur()}}if(g.getViewModel().data.dockedMenu){b.items.items[0].tabIndex=2}for(var a=0,e=d.items.items.length;a<e;++a){d.items.items[a].focusable=c;if(!c&&document.activeElement.id===d.items.items[a].id){document.activeElement.blur()}}},postClose:function(){var a=this;var b=a.getView();if(a.getViewModel().get('autoHide')){b.removeCls('main-menu-open')}else {b.removeCls('main-menu-ah')}a.assignTabs(!1);a.zeroFocus()},zeroFocus:function(){var a=this.getView();a.currentFocus=-1},firstFocus:function(){var a=this;var b=a.getView();b.currentFocus=0;a.focusByPlace(0)},reFocus:function(){var a=this;var b=a.getView();a.focusByPlace(b.currentFocus)},menuButtonClick:function(d){var b=this;var c;var e;var a=d;if(a.type===undefined){if(a.config.type){a=a.config}}switch(a.type){case 'event':b.setSelected(d);if(a.children&&a.children.length>0){if(ABP.util.Common.getModern()){b.makeSubMenu(d)}else {b.fireEvent('submenu_lineChange',a.uniqueId);b.fireEvent('featureCanvas_openSubMenu')}}else {if(ABP.util.Common.getClassic()){if(b.getViewModel().get('autoHide')&&d.xtype!=='menutoggle'){b.fireEvent('session_closeMenu')}}else {b.fireEvent('session_closeMenu')}};if(a.command!==undefined&&a.command!==''&&a.command!==null){if(a.appId instanceof Array){for(c=0;c<a.appId.length;++c){b.fireEvent('main_fireAppEvent',a.appId[c],a.command[c],a.args[c],a.activateApp)}}else {b.fireEvent('main_fireAppEvent',a.appId,a.command,a.args,a.activateApp)}};break;default:b.setSelected(a);b.fireEvent('submenu_lineChange',a);b.fireEvent('featureCanvas_openSubMenu');break;}},makeSubMenu:function(a){var b=Ext.widget('submenu',{menuButtons:a.getChildren()});b.showBy(a,'bl-br')},mobileSessionToggle:function(){var g=this;var f=g.getView();var e=f.down('#main_menu_session');var c;var b;if(e){c=e.innerItems;b=c[0];if(b.hasCls('fa-caret-up')){for(var a=1,d=c.length;a<d;++a){c[a].show()}b.removeCls('fa-caret-up');b.addCls('fa-caret-down')}else {for(var a=1,d=c.length;a<d;++a){c[a].hide()}b.removeCls('fa-caret-down');b.addCls('fa-caret-up')}}},__toggleNavType:function(){var a=this;var d=a.getView();var c=d.down('treelistmenu');var b=c.getBind().store.getValue().getStoreId();if(b==='navSearch'){a.setMenuNavTree()}else {a.setMenuNavSearch()}},setMenuNavTree:function(){var b=this;var c=b.getView();var d=b.getViewModel();var a=c.down('treelistmenu');a.setBind({store:null});a.setBind({store:'{navTree}'});d.switchNav('tree')},setMenuNavSearch:function(){var b=this;var c=b.getView();var d=b.getViewModel();var a=c.down('treelistmenu');a.setBind({store:null});a.setBind({store:'{navSearch}'});d.switchNav('search')},__sanitizeUniqueId:function(a){return a.replace('fav_','').replace('sug_','').replace('rec_','')},__prepareObjectForABPAreas:function(a,c){if(a.data&&a.data.serialData){var b=Ext.clone(a.data.serialData);b.uniqueId=c+this.__sanitizeUniqueId(b.uniqueId);return b}else {if(a.uniqueId){var b=Ext.clone(a);b.uniqueId=c+this.__sanitizeUniqueId(b.uniqueId);return b}else {a.uniqueId=c+ABP.util.IdCreator.getId(a);return a}}},__addRecent:function(d){var b=this;var f=b.getViewModel();var g=f.getStore('navSearch');var c=g.getNodeById('container_nav-recent');var e={};var a={};if(c){d=b.__prepareObjectForABPAreas(d,'rec_');e=b.makeMenuTreeItem(d,1,!0);a=f.addRecentPage(e);if(a){if(!Ext.isEmpty(a.added)){c.insertChild(0,a.added[0])}if(!Ext.isEmpty(a.removed)){c.removeChild(c.getChildAt(a.removed[0]))}b.__checkNodeForChildren(c)}b.fireEvent('abp_updatedRecents');b.__saveRecentsToLocalStorage()}},__saveRecentsToLocalStorage:function(){var e=this;var f=e.getViewModel();var a=f.get('recentPages');if(!Ext.isEmpty(a)){var c=[];for(var b=0;b<a.length;++b){if(a[b].serialData){c.push(a[b].serialData)}}if(!Ext.isEmpty(c)){var d=Ext.JSON.encode(a);ABP.util.LocalStorage.setForLoggedInUser('ABPCore_recentPages',d)}}},__setRecents:function(a){if(Ext.isArray(a)&&!Ext.isEmpty(a)){var e=this;var h=e.getViewModel();var f=[];for(var c=0;c<a.length;c++){f.push(e.makeMenuTreeItem(a[c],1,!0))}var b=h.setInitialRecents(f);if(Ext.isArray(b)&&!Ext.isEmpty(b)){var i=h.getStore('navSearch');var g=i.getNodeById('container_nav-recent');for(var d=0;d<b.length;d++){g.appendChild(b[d])}e.__checkNodeForChildren(g)}}},__addFavorite:function(b,f){var a=this;var j=a.getViewModel();var g=j.getStore('navSearch');var c=g.getNodeById('container_nav-favorites');if(c){var i=b.data.id;b=a.__prepareObjectForABPAreas(b,'fav_');c.appendChild(a.makeMenuTreeItem(b,1,!1,'favorite'));var e={isFavorite:!0,appId:b.appId,nodeId:i};if(f!==!1){a.saveFavorites();ABP.util.BroadcastChannel.send('abp-core-favorite',e)}Ext.ABPEvents.fireEvent(ABP.Events.favoritesUpdated,e);if(ABP.util.Common.getClassic()){var h=a.getView().down('treelistmenu');var d=h.getItem(c);if(d){d.addCls('animate-starburst');setTimeout(function(){d.removeCls('animate-starburst')},750)}}}a.__checkNodeForChildren(c)},__removeFavorite:function(i,e,h){var c=this,a;var k=c.getViewModel();var d=k.getStore('navSearch');var b=d.getNodeById('container_nav-favorites');if(d.lazyFill){a=c.findTreeStoreItemInChildren(b,'id','fav_'+e)}else {a=b.findChild('id','fav_'+e,!0)}if(a){this.__removeEmptyParent(a,d);a.remove();var g={isFavorite:!1,appId:i,nodeId:e};if(h!==!1){c.saveFavorites();ABP.util.BroadcastChannel.send('abp-core-favorite',g)}Ext.ABPEvents.fireEvent(ABP.Events.favoritesUpdated,g)}if(ABP.util.Common.getClassic()&&b&&b.childNodes.length){var j=c.getView().down('treelistmenu');var f=j.getItem(b);if(f){f.addCls('animate-starburst-min');setTimeout(function(){f.removeCls('animate-starburst-min')},750)}}},onFavoriteMessageRecieved:function(c){var a=c.data;if(a.isFavorite){var b=ABP.util.Common.getMenuItem(a.appId,a.nodeId,!1);this.__addFavorite(b,!1)}else {this.__removeFavorite(a.appId,a.nodeId,!1)}},__removeEmptyParent:function(b,e){var i=this;var h='container_nav-favorites';if(e.lazyFill){var j=b.isNode?b.parentNode?b.parentNode.id:null:b.parentId;if(j===h){return}var a=i.findTreeStoreItem(e,'id',j);if(a){var g=0;if(a.isNode){g+=a.childNodes?a.childNodes.length:0}else {d=a}var d=a.data?a.data:a;if(d&&Ext.isArray(d.children)){g+=d.children.length}if(g===1){i.__removeEmptyParent(a,e);if(a.parentNode&&a.parentNode.id===h){var k=a.parentNode;var c=k.data.children;var m=Ext.isArray(c)?c.length:0;for(var f=0;f<m;f++){var l=c[f];if(l.id===a.id){Ext.Array.removeAt(c,f)}}}a.remove()}}}else {if(!b.parentNode||b.parentNode.id===h){return}if(b.parentNode.childNodes&&b.parentNode.childNodes.length===1){i.__removeEmptyParent(b.parentNode,e);b.parentNode.remove()}}},__updateFavorites:function(a,f){var c=this;var j=c.getViewModel();var g=j.getStore('navSearch');var b=g.getNodeById('container_nav-favorites');var d=0;if(a){if(!Ext.isArray(a)){if(ABP.util.Common.isJsonString(a)){a=Ext.JSON.decode(a)}else {a=[a]}}if(b){b.removeAll();b.data.children=[]}for(d=0;d<a.length;++d){var h=c.__prepareObjectForABPAreas(a[d],'fav_');b.appendChild(c.makeMenuTreeItem(h,1,!1,'favorite'))}if(f!==!1){c.saveFavorites()}c.__checkNodeForChildren(b);if(ABP.util.Common.getClassic()&&b&&b.childNodes.length){var i=c.getView().down('treelistmenu');var e=i.getItem(b);if(e){e.addCls('animate-fav-update');setTimeout(function(){e.removeCls('animate-fav-update')},750)}}}},__replaceSuggested:function(c){var b=this;var g=b.getViewModel();var f=g.getStore('navSearch');var a=f.getNodeById('container_nav-suggested');var d=0;if(a){a.removeAll();a.data.children=[];if(Ext.isArray(c)){for(d;d<c.length;++d){var e=b.__prepareObjectForABPAreas(c[d],'sug_');a.appendChild(b.makeMenuTreeItem(e,1))}}else {var e=b.__prepareObjectForABPAreas(c,'sug_');a.appendChild(b.makeMenuTreeItem(e,1))}if(ABP.util.Config.getSessionConfig().settings.mainMenuSuggestedAutoExpand){if(!a.isExpanded()){a.expand()}}b.__checkNodeForChildren(a)}},__addTreeOption:function(a){var c=this;var b=0;if(!Ext.isArray(a)){c.addMenuItem(a,!0,a.parentAppId,a.parentId,!0)}else {for(b;b<a.length;++b){c.addMenuItem(a[b],!0,a[b].parentAppId,a[b].parentId,!0)}}c.setSearchStore()},__removeTreeOption:function(c,b){var a=this;a.removeMenuItem(c,b,!0);a.setSearchStore()},__checkNodeForChildren:function(a){if(a.childNodes&&a.childNodes.length>0){a.set('hidden',!1)}else {a.set('hidden',!0)}},onSearchKeyDown:function(a){var b=this;var c=a.getKey();if(c===a.DOWN){b.moveSelectedSearchResult(1);a.stopEvent()}else {if(c===a.UP){b.moveSelectedSearchResult(-1);a.stopEvent()}else {if(c===a.ENTER){if(!b.isSearchResultsVisible()){b.searchNav()}else {var e=b.getViewModel();var d=e.get('selectedSearchResult');b.fireSearchResultSelected(d)}}else {if(c===a.TAB){if(b.focusSearchResults()){a.stopEvent()}}else {if(c===a.ESC){b.resetSearchField()}else {if(c===191&&a.altKey){this.fireEvent('abp_jumpto_show');a.stopEvent()}else {if(c===a.ALT){b.__toggleMenuShortcuts();a.stopEvent()}}}}}}}},onSearchResultsKeyDown:function(a){var e=this;var c=a.getKey();if(c===a.TAB){var d=this.getView();var b=d.down('#navSearchField');if(b){b.focus()}a.stopEvent()}else {if(c===a.ESC){var d=this.getView();e.closeSearchResults();var b=d.down('#navSearchField');if(b){b.selectText();b.focus()}}else {if(a.altKey&&c===a.ENTER){if(a.record.data.href){a.item.firstElementChild.lastElementChild.click()}}}}},onSearchResultHighlighted:function(g,f){var a=this;var b=a.getViewModel(),h=a.getView();var e=b.getStore('searchTree');var c=f.dataset['recordindex'];var d=e.getAt(c);b.set('selectedSearchResult',d)},searchNav:function(){var a=this;var g=a.getView();var m=a.getViewModel();var b=g.down('#navSearchField');var h=b.getValue();var c=m.getStore('searchTree');var k=a.getSelectedSearchId();var i=!0;if(h.trim()!=''){a.removeSearchFilters(c,!1);var d=ABP.util.Config.getSessionConfig().settings;if(d.mainMenuNavSearchDisableSoundex!==undefined){i=!d.mainMenuNavSearchDisableSoundex}var f=[];var l=ABP.util.filters.Factory.createStringFilter(h.trim(),[{name:'shorthand',useSoundex:!1},{name:'text',useSoundEx:i}],!0);f.push({id:'TextFilter',filterFn:l});if(d.mainMenuNavSearchDuplicateFields){var j=ABP.util.filters.Factory.createDuplicationFilter(d.mainMenuNavSearchDuplicateFields);f.push({id:'DupFilter',filterFn:j})}ABP.util.Stopwatch.start();c.filter(f);ABP.util.Stopwatch.lap('Filter Applied');c.sort('text','ASC');if(!d.mainMenuNavSearchDisableRelevance){c.sort('_relevance','DESC')}ABP.util.Stopwatch.lap('Store Sorted');ABP.util.Stopwatch.stop();if(c.getCount()>0){a.setSelectedSearchId(k);var e=g.down('#searchResultsView');if(e){e.showBy(b,'bl')}else {a.addNavSearchResultsElement();e=g.down('#searchResultsView');e.showBy(b,'bl')}ABP.util.Aria.setExpanded(b,!0);b.focus()}else {a.removeSearchFilters(c,!0);ABP.util.Aria.setExpanded(b,!1)}}else {a.removeSearchFilters(c,!0);ABP.util.Aria.setExpanded(b,!1)}},removeSearchFilters:function(a,b){a.removeFilter('TextFilter');a.removeFilter('DupFilter');if(b){this.closeSearchResults()}},setSearchStore:function(){var c=this;var d=c.getViewModel();var b=d.getStore('searchTree');b.removeAll();var a=c.buildSearchItemsForStore(d.getStore('navTree'));if(!Ext.isEmpty(a)){b.add(a)}var a=c.buildSearchItemsForStore(d.getStore('navSearch'));if(!Ext.isEmpty(a)){b.add(a)}},buildSearchItemsForStore:function(b){var d=this,a=[];var c=b.getRoot();Ext.Array.push(a,d.buildSearchItems(c));return a},buildSearchItems:function(b,a){var i=this,f=[],a=a?a:'';var e=b.isNode?b.data:b;if(!b.isRoot||!b.isRoot()){i.buildSearchData(e,a,f);if(a){a+=' / '+e.text}else {a=e.text}}var g=b.childNodes;var h=Ext.isArray(g)?g.length:0;for(var c=0;c<h;c++){Ext.Array.push(f,i.buildSearchItems(g[c],a))}var d=e.children;var h=Ext.isArray(d)?d.length:0;for(var c=0;c<h;c++){if(!b.findChild||!b.findChild('id',d[c].id,!1)){Ext.Array.push(f,i.buildSearchItems(d[c],a))}}return f},buildSearchData:function(a,c,d){var e=this;if(!a){return}if(a.event||a.hash||a.itemHref){var b={appId:a.appId,itemId:a.itemId,text:a.text,hierarchy:c,activateApp:a.activateApp,iconCls:a.iconCls,shorthand:a.shorthand,href:a.itemHref};if(a.hash){b.hash=a.hash}if(a.event){b.event=a.event;b.eventArgs=a.eventArgs}d.push(b)}},findTreeStoreItem:function(g,a,h,d,f,b){var i=this;var j=!1;var c=g.getRoot();if(!c){return}b=b||0;a=a||'id';var e=i.findTreeStoreItemInChildren(c,a,h,d,f,b);return e},findTreeStoreItemInArray:function(c,m,n,f,k,j,g){var l=this;var h=!1;var b;if(Ext.isArray(c)){for(var d=0,o=c.length;d<o&&!b;d++){var a=c[d];var i=a.isNode?a.data:a;var e;if(f){if(!a.isNode){e=Ext.create('ABP.data.TreeData',{data:i,parentDataArray:c,index:d,level:j,parentId:g?g.id:null});h=f.call(k||l,e)}else {h=f.call(k||l,a)}}else {if(i[m]===n){h=!0}}if(h){if(a.isNode){b=a}else {if(e){b=e}else {b=Ext.create('ABP.data.TreeData',{data:i,parentDataArray:c,index:d,level:j,parentId:g?g.id:null})}}}else {b=l.findTreeStoreItemInChildren(a,m,n,f,k,j+1)}}}return b},findTreeStoreItemInChildren:function(a,e,h,d,g,f){var i=this;var b;if(Ext.isEmpty(a)){return}if(Ext.isArray(a.childNodes)&&a.childNodes.length>0){b=i.findTreeStoreItemInArray(a.childNodes,e,h,d,g,f+1,a)}if(!b){var c=a.data?a.data:a;if(Ext.isArray(c.children)&&c.children.length>0){b=i.findTreeStoreItemInArray(c.children,e,h,d,g,f+1,a)}}return b},setSearchStoreOrig:function(){var c=this;var d=c.getViewModel();var a=d.getStore('searchTree');var f=d.getStore('navTree');var b=f.getRoot();a.removeAll();if(b){b.cascade(function(b){var f=b;var c=[];var h='';var g='';var d=0;if(b.data.event||b.data.hash||b.data.itemHref){for(;;){if(!f.isRoot()){c.splice(0,0,f.data.text);f=f.parentNode}else {break}}if(!Ext.isEmpty(c)){for(d=0;d<c.length-1;++d){if(d!==0){g+=' / '}g+=c[d]}h=c[c.length-1]}var e={appId:b.data.appId,itemId:b.data.itemId,shorthand:b.data.shorthand,text:h,hierarchy:g,activateApp:b.data.activateApp,iconCls:b.data.iconCls};if(b.data.hash){e.hash=b.data.hash}else {e.event=b.data.event;e.eventArgs=b.data.eventArgs}a.add(e)}})}var e=c.getNavMenuSearchItems();if(!Ext.isEmpty(e)){a.add(e)}},getNavMenuSearchItems:function(){var d=this;var e=d.getViewModel();var b=e.getStore('navSearch');var c=b.getRoot();var a=[];c.cascade(function(b){var e=b;var c=[];var g='';var f='';var d=0;if(b.data.event){for(;;){if(!e.isRoot()){c.splice(0,0,e.data.text);e=e.parentNode}else {break}}if(!Ext.isEmpty(c)){for(d=0;d<c.length-1;++d){if(d!==0){f+=' / '}f+=c[d]}g=c[c.length-1]}a.push({appId:b.data.appId,itemId:b.data.itemId,event:b.data.event,eventArgs:b.data.eventArgs,text:g,hierarchy:f,activateApp:b.data.activateApp,iconCls:b.data.iconCls,shorthand:b.data.shorthand})}});return a},onSearchLostFocus:function(h,c,g){var d=this;var e=d.getView();var f=e.down('#searchResultsView');var a,b;if(c&&c.toComponent){a=c.toComponent;b=a.itemId?a.itemId:a.id;if(b&&(b==='navSearchField'||b==='searchResultsView')){return}}d.closeSearchResults()},onSearchResultReactWindowResize:function(c,b,a){this.onSearchResultResize(a)},onSearchResultResize:function(a,d,c){if(!a||a.isHidden()||c===1){return}var b=Ext.getViewportHeight()-a.getY();if(a.getMaxHeight()!==b){a.setMaxHeight(b)}},onSearchResultSelectionChanged:function(d,a){var c=this.getView();if(a.length>0){ABP.util.Aria.setActiveDecendant(c.down('#navSearchField'),a[0].id);if(a[0].data.href){var b=d.view.getNodeByRecord(a[0]);if(b){this.onIconHover(null,b)}}}else {ABP.util.Aria.setActiveDecendant(c.down('#navSearchField'),'')}},onSearchResultClick:function(a){var b=this;var c=a.target.className;if(c.indexOf('nav-search-results-new-tab')>=0){return}else {var d=b.getSearchResultRecord(a);b.fireSearchResultSelected(d)}},focusResultsFromSearch:function(){var c=this;var b=c.getView();var a=b.down('#searchResultsView');if(!a.isHidden()){a.focus()}},mainmenuTitleImageClick:function(c,a){var b=this;b.fireEvent('toolbartop_logoclick',a)},mainMenuTitleImageContainerBeforeRender:function(b){var c=this,d=c.getViewModel(),a=d.get('conf.toolbarTitleImageUrl');if(a){b.setHtml('<img class="mainmenu-title-image" src="'+Ext.String.htmlEncode(Ext.resolveResource(a))+'" alt="">')}},__updateTreeStrings:function(){var b=this;var g=b.getViewModel();var d=g.getStore('navSearch');var c=g.getStore('navTree');var f=d.getRoot();var e=c.getRoot();var a=function(a){if(a.data.labelKey){a.set('text',ABP.util.Common.geti18nString(a.data.labelKey))}};if(f){if(d.lazyFill){b.eachMenuItemFromStore(d,a,null)}else {f.cascade(a)}}if(e){if(c.lazyFill){b.eachMenuItemFromStore(c,a,null)}else {e.cascade(a)}}b.setSearchStore()},eachMenuItemFromStore:function(c,e,b,a){var f=this;var d=c.getRoot();f.eachMenuItem(d,e,b,a,0)},eachMenuItem:function(a,i,g,c,f){var j=this;if(!a.isRoot||!a.isRoot()){i.call(g||j,a)}var e=a.childNodes;var h=Ext.isArray(e)?e.length:0;for(var b=0;b<h;b++){j.eachMenuItem(e[b],i,g,c,f+1)}var d=a.data?a.data.children:null;var h=Ext.isArray(d)?d.length:0;for(var b=0;b<h;b++){if(c&&a.findChild&&!a.findChild('id',d[b].id,!1)||c&&!a.findChild||!c){var k=Ext.create('ABP.data.TreeData',{data:d[b],parentDataArray:d,index:b,level:f,parentId:a.id});j.eachMenuItem(k,i,g,c,f+1)}}},__setSingleExpand:function(a){this.getViewModel().set('mainMenuSingleExpand',a)},privates:{classicToggle:function(){var b=this;var c=b.getViewModel();var a=c.get('classicMenuExpand');this.setClassicMenuVisibility(!a)},classicClose:function(){this.setClassicMenuVisibility(!1)},classicOpen:function(){this.setClassicMenuVisibility(!0)},__handleSessionClick:function(a){var i=this;var d=i.getView();var o=d.getViewModel();var n=o.get('classicMenuExpand');var b=d.up().up();var h=d.el.dom;var m=a.target==h||h.contains(a.target);var g=b.down('#rightPane').el.dom;var l=a.target==g||g.contains(a.target);var f=b.down('#toolbar-button-menu');var c;if(f){c=f.el.dom}var k=a.target==c||c.contains(a.target);var e=b.down('#rpButton').el.dom;var j=a.target==e||e.contains(a.target);if(!l&&!m&&!k&&!j&&n){if(Ext.toolkit==='classic'){i.classicClose()}else {this.fireEvent('session_closeMenu')}}},focusFavorites:function(){var a=this;a.focusItemInGroup('container_nav-favorites')},focusRecents:function(){var a=this;a.focusItemInGroup('container_nav-recent')},focusItemInGroup:function(d){var c=this;c.setClassicMenuVisibility(!0);var a=c.getNavTree();if(a){var b=a.getStore().getNodeById(d);if(b){a.setSelection(b);if(!b.isExpanded()){b.expand()}c.focusSelected();a.controller.navigateDownPress()}}},focusSelected:function(){var d=this,c=d.getNavTree();var b=c.getSelection();if(!b){return}var a=Ext.query('.x-treelist-item[data-recordid="'+b.internalId+'"]');if(a&&a.length>0){a[0].focus()}},getNavTree:function(){return this.getView().down('#treelistmenu')},setClassicMenuVisibility:function(a){var b=this;var c=b.getViewModel();var f=c.get('classicMenuExpand');if(a===f){return}c.set('classicMenuExpand',a);var d=b.getView();if(a){d.show()}else {d.hide()}var e=ABP.util.Config.getSessionConfig().settings.rememberMenuState;if(e){ABP.util.LocalStorage.set('mmStateOpen',a)}},saveFavorites:function(){ABP.util.Ajax.request({url:ABP.util.LocalStorage.get('ServerUrl')+'/abp/favorites',method:'PUT',withCredentials:!0,cors:Ext.browser.name!=='IE'||Ext.browser.version>9,jsonData:ABP.util.Common.getFavorites(),success:function(a){if(a.responseText){var b=Ext.JSON.decode(a.responseText);if(!(b.resultCode===0)){ABP.util.Logger.logError('ERROR: Could not save favorites: '+b.errorDetail)}}},failure:function(){ABP.util.Logger.logError('ERROR: Could not save favorites')}})},resetSearchField:function(){var b=this;b.closeSearchResults();var c=b.getView();var a=c.down('#navSearchField');if(a){a.reset()}},getHightlightedItem:function(){var c=this;var b=c.getView();var a=b.down('#searchResultsView');if(a){return a.getSelection()}return null},closeSearchResults:function(){var a=this;var d=a.getView();var b=d.down('#searchResultsView');if(b){b.hide()}var c=a.getViewModel();c.set('selectedSearchResult',null);a.useDefaultSelection=!0},isSearchResultsVisible:function(){var c=this;var b=c.getView();var a=b.down('#searchResultsView');if(a){return a.isVisible()}else {return !1}},focusSearchResults:function(){var c=this;var b=c.getView();var a=b.down('#searchResultsView');if(a){if(a.isVisible()){return a.focus()}}return !1},fireSearchResultSelected:function(a){var b=this;if(a&&a.data){b.fireEvent('navigation_searchresultselected',a);if(a.data.event&&a.data.appId){b.fireEvent('main_fireAppEvent',a.data.appId,a.data.event,a.data.eventArgs,a.data.activateApp)}else {if(a.data.hash){b.redirectTo(a.data.hash)}}b.resetSearchField()}},moveSelectedSearchResult:function(g){var f=this;var l=f.getView();var j=f.getViewModel();var i=!1;var h=!1;var d=j.get('selectedSearchResult');if(!d){return}f.useDefaultSelection=!1;var e=d.store;var b=e.indexOf(d);b=b+g;if(b<0){b=e.getCount()-1;h=!0}else {if(b>=e.getCount()){b=0;i=!0}}var k=e.getAt(b);j.set('selectedSearchResult',k);var a=l.down('#searchResultsView');if(a){f.onIconKeyNav(a,d)}if(!a||!a.getMaxHeight()||a.getHeight()<a.getMaxHeight()){return}if(i){a.scrollTo(0,0);return}else {if(h){a.scrollTo(0,a.getScrollableClientRegion().bottom);return}}var c=a.getNodeByRecord(d);if(!c){return}if(g===1){if(c.getBoundingClientRect().bottom+c.scrollHeight>=a.getBox().bottom){a.scrollBy(0,c.scrollHeight)}}else {if(g===-1){if(a.getBox().top>=c.getBoundingClientRect().top-c.scrollHeight){a.scrollBy(0,-c.scrollHeight)}}}},getSelectedSearchId:function(){var b=this;var c=b.getViewModel();var a=c.get('selectedSearchResult');if(a){return a.id}return null},setSelectedSearchId:function(f){var b=this,g=b.getView(),c=b.getViewModel();var a=c.getStore('searchTree');if(a.count()===0){ABP.util.Aria.setActiveDecendant(g.down('#navSearchField'),'');return}var d=a.find('id',f);var e=a.getAt(0);if(d!==-1&&!b.useDefaultSelection){c.set('selectedSearchResult',a.getAt(d))}c.set('selectedSearchResult',e)},addNavSearchResultsElement:function(){var e=this;var b=e.lookupReference('abpNavSearchCont');var d=ABP.util.Config.getSessionConfig().settings.navSearchShowPath;var a=[];if(d){a=['<tpl for=".">','<tpl if="this.isUnder(xindex)">','<div id="{id}" class="nav-search-results-outer">','<tpl if="this.hasNewTab(href)">','<div class="icon-holder">','<div class="nav-search-results-icon {iconCls}"></div>','<a class = "nav-search-results-new-tab icon-windows" href="{href}" target="_blank" title="Open in a new tab"></a>','</div>','<tpl else>','<div class="nav-search-results-icon {iconCls}"></div>','</tpl>','<div class="nav-search-results-searched">{text}</div>','<div class="nav-search-results-hierarchy">{hierarchy}</div>','</div>','</tpl>','</tpl>',{isUnder:function(a){return a<=ABP.util.Config.getSessionConfig().settings.mainMenuNavSearchResultsMax},hasNewTab:function(a){return Ext.isString(a)}}]}else {a=['<tpl for=".">','<tpl if="this.isUnder(xindex)">','<div id="{id}" class="nav-search-results-outer">','<div class="nav-search-results-searched">{text}</div>','</div>','</tpl>','</tpl>',{isUnder:function(a){return a<=ABP.util.Config.getSessionConfig().settings.mainMenuNavSearchResultsMax}}]}var c={xtype:'dataview',floating:!0,scrollable:'y',id:'searchResultsView',hidden:!0,tabIndex:0,cls:'nav-search-results',overItemCls:'nav-search-highlight',bind:{store:'{searchTree}',selection:'{selectedSearchResult}',minWidth:'{menuWidth*.9}',maxWidth:'{menuWidth*.9*2}'},tpl:a,itemSelector:'div.nav-search-results-outer',listeners:{focusleave:'onSearchLostFocus',highlightitem:'onSearchResultHighlighted',el:{keydown:'onSearchResultsKeyDown'},resize:'onSearchResultResize',selectionchange:'onSearchResultSelectionChanged',click:{element:'el',fn:'onSearchResultClick'},mouseover:{element:'el',delegate:'div.nav-search-results-outer',fn:'onIconHover'},mouseout:{element:'el',delegate:'div.nav-search-results-outer',fn:'onIconHoverExit'}}};b.add(c)},__toggleMenuShortcuts:function(){var b=this;var c=b.getView();var a=c.down('#treelistmenu');if(a){a.toggleCls('show-shortcuts')}},onIconHover:function(f,a){var e=a.firstElementChild.className;if(e.indexOf('icon-holder')>=0){var b=a.firstElementChild;var d=b.firstElementChild;var c=b.lastElementChild;d.classList.add('spin-out');c.classList.add('spin-in');Ext.defer(function(){d.style.display='none';c.style.display='block'},75)}},onIconHoverExit:function(f,c){var e=c.firstElementChild.className;if(e.indexOf('icon-holder')>=0){var d=c.firstElementChild;var b=d.firstElementChild;var a=d.lastElementChild;a.classList.remove('spin-in');a.classList.add('spin-out');b.classList.remove('spin-out');b.classList.add('spin-in');Ext.defer(function(){a.style.display='none';b.style.display='block'},75);Ext.defer(function(){a.classList.remove('spin-out');b.classList.remove('spin-in')},250)}},onIconKeyNav:function(c,b){var d=this;var a=c.getNodeByRecord(b);if(a){if(a.firstElementChild.className.indexOf('icon-holder')>=0){d.onIconHoverExit(null,a)}}},getSearchResultRecord:function(a){var e=this;if(Ext.isEmpty(a)){return null}if(!Ext.isEmpty(a.record)){return a.record}else {if(a.parentEvent&&a.target){var c=a.target;var b=c.parentElement;if(!b){return}var f=e.getViewModel();var d=f.getStore('searchTree');return d.getById(b.id)}}}}});Ext.define('ABP.view.session.mainMenu.MainMenuModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.mainmenumodel',requires:['ABP.model.SearchTreeResultsModel'],data:{navMenu:{},sessionMenu:{},menuWidth:250,sessHeight:42,menuHeaderHeight:60,menuHeaderCls:'main-menu-top menu-top-title',menuFooterCls:'menu-footer',navAfterCls:'abp-nav-toggle-',treeIcon:'icon-tree',navIcon:'icon-signpost2',navToggleIcon:'abp-nav-toggle-icon-tree',classicMenuExpand:!0,hideTreeNav:!0,hideSearch:!0,recentPages:[],firstAddAfterSet:!1,selectedSearchResult:null,mainMenuSingleExpand:!1},stores:{navSearch:{type:'tree',storeId:'navSearch',root:{expanded:!0}},navTree:{type:'tree',storeId:'navTree',root:{expanded:!0}},searchTree:{model:'ABP.model.SearchTreeResultsModel',storeId:'searchTree',id:'searchTree'}},formulas:{micro:{get:function(){var d;var c;var a=!1;var b=Ext.os.deviceType==='Phone';if(b){d=ABP.util.Common.getWindowWidth();c=ABP.util.Common.getWindowHeight();if(b){a=!0}this.setMenu(a)}return a}},mainMenuTopLabel:{bind:{_bootstrapConf:'{bootstrapConf.branding.companyName}'},get:function(b){var a='';if(b._bootstrapConf){a=b._bootstrapConf}else {a='APTEAN'}return a}},mainMenuTitleImageUrl:{bind:{_mainMenuTitleImageUrl:'{conf.toolbarTitleImageUrl}'},get:function(a){return Ext.isEmpty(a._mainMenuTitleImageUrl)?null:a._mainMenuTitleImageUrl}}},constructor:function(){this.callParent(arguments);var a=ABP.util.Config.getSessionConfig().settings.mainMenuLazyFill;this.getStore('navSearch').lazyFill=a;this.getStore('navTree').lazyFill=a},setMenu:function(c){var a=this;var b=Ext.os.deviceType==='Tablet'||Ext.os.deviceType==='Desktop';if(!c){if(b){a.set('menuWidth',250);a.set('menuHeaderHeight',60);a.set('menuHeaderCls','main-menu-top menu-top-title')}else {a.set('menuWidth',300);a.set('menuHeaderHeight',40);a.set('menuHeaderCls','main-menu-top menu-top-title-micro')}}else {a.set('menuWidth','100%');a.set('menuHeaderHeight',40);a.set('menuHeaderCls','main-menu-top menu-top-title-micro')}},navSet:function(b,c){var a=this;a.set(b,null);a.set(b,c);return a.resetNav()},resetNav:function(){var c=this;var b=0;var a;for(a=0;a<c.data.sessionMenu.length;++a){if(c.data.sessionMenu[a].xtype==='menubutton'){c.data.sessionMenu[a].place=b;b++}}return b-1},switchNav:function(b){var a=this;if(b==='tree'){a.set('navToggleIcon',a.get('navAfterCls')+a.get('navIcon'))}else {a.set('navToggleIcon',a.get('navAfterCls')+a.get('treeIcon'))}},addRecentPage:function(h){var d=this;var a=d.get('recentPages');var b={added:[],removed:[]};var g=0;var j=0;var e=d.get('firstAddAfterSet');var c=d.__compareNodeToExistingRecentItems(h);var f=ABP.util.Config.getSessionConfig().settings.mainMenuRecentMaxShown+1;if(e){d.set('firstAddAfterSet',!1)}if(c===-1){a.splice(0,0,h);if(a.length>1){if(!e){b.added.push(a[1])}if(a.length>f){g=a.length-f;if(g>0){a.pop();b.removed.push(a.length-1)}d.set('recentPages',a);return b}else {return b}}else {return null}}else {if(c!==0){var i=a[c];a.splice(c,1);a.splice(0,0,i);b.removed.push(c);if(!e){b.added.push(a[1])}return b}else {if(!e){return null}else {b.removed.push(0);return b}}}},__compareNodeToExistingRecentItems:function(c){var d=-1;var e=this;var a=e.get('recentPages');if(a&&a.length>0){for(var b=0;b<a.length;++b){if(a[b].uniqueId===c.uniqueId){return b}}}return d},setInitialRecents:function(a){var c=this;var b=ABP.util.Config.getSessionConfig().settings.mainMenuRecentMaxShown;if(a.length>b){a.splice(b,a.length-b)}c.set('recentPages',a);c.set('firstAddAfterSet',!0);return a},checkFirstRecentForUpdate:function(b,c){var e=this;var a=e.get('recentPages');var d=Ext.String.startsWith(b,'rec_')?b:'rec_'+b;if(!Ext.isEmpty(a)&&a[0].uniqueId===d){a[0].itemPriority=c.priority;a[0].itemCount=c.count}}});Ext.define('ABP.view.session.mainMenu.MenuItemModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.menuitemmodel'});Ext.define('ABP.view.session.notifications.NotificationBaseController',{extend:'Ext.app.ViewController',onNotificationLinkClick:function(){var b=this,c=b.getView(),a=c.getNotificationRecord();if(a.event){b.fireEvent(a.event,a.eventArgs)}},onNotificationDownloadClick:function(){var b=this,c=b.getView(),a=c.getNotificationRecord();if(a.downloadEvent){b.fireEvent(a.downloadEvent,a.downloadEventArgs)}},onNotificationFlagClick:function(e,f){var a=this,b=a.getView(),d=b.getNotificationRecord(),c=a.__checkBtnPressed(e);if(c){e.setIconCls('icon-flag-filled');b.addCls('abp-notification-flagged')}else {e.setIconCls('icon-signal-flag');b.removeCls('abp-notification-flagged')}d.flagged=c;a.fireEvent('notification_flag_change',d);b.setNotificationRecord(d);if(c){a.fireViewEvent('notificationFlag')}else {a.fireViewEvent('notificationUnflag')}},__switchToContainer:function(b,a,e,f){var c=this,d=c.lookupReference('notificationDisplayContainer');b.removeCls('abp-notification-flagged');b.addCls(e);a.setHeight(d.el.getHeight());c.__setActiveCardItem(a,f)},onNotificationMarkReadClick:function(){var a=this,c=a.getView(),d=c.getNotificationRecord(),b=a.lookupReference('notificationMarkedAsReadContainer');a.__switchToContainer(c,b,'abp-notification-markasread',1);a.__animateFade(b,function(){a.fireEvent('notification_read',d);a.fireViewEvent('notificationRead')})},onNotificationMarkUnreadClick:function(){var a=this,c=a.getView(),d=c.getNotificationRecord(),b=a.lookupReference('notificationMarkedAsUnreadContainer');a.__switchToContainer(c,b,'abp-notification-markasunread',2);a.__animateFade(b,function(){a.fireEvent('notification_unread',d);a.fireViewEvent('notificationUnread')})},onNotificationRemoveClick:function(){var a=this,c=a.getView(),d=c.getNotificationRecord(),b=a.lookupReference('notificationRemovedContainer');a.__switchToContainer(c,b,'abp-notification-removed',3);a.__animateFade(b,function(){a.fireEvent('notification_removed',d);a.fireViewEvent('notificationRemove')})}});Ext.define('ABP.view.session.notifications.NotificationModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.abp-notification',data:{notificationTime:undefined,label:undefined,labelTemplate:undefined,labelArgs:undefined,detail:undefined,detailTemplate:undefined,detailArgs:undefined},formulas:{notificationLabel:function(b){var e=b('label'),a=b('labelTemplate'),d=b('labelArgs'),c=[];if(a&&a.trim().length>0){c.push(a);return Ext.String.format.apply(this,c.concat(d))}else {return e}},notificationDetail:function(b){var e=b('detail'),a=b('detailTemplate'),d=b('detailArgs'),c=[];if(a&&a.trim().length>0){c.push(a);return Ext.String.format.apply(this,c.concat(d))}else {return e}},notificationListOrder:function(a){var d=a('currentNavIndex')+1;var b=a('unreadNotificationCount');var c=a('historyNotificationCount');var e=a('displayHistory')?b+c:b;return d+' of '+e},notificationAdditionalAriaDetail:function(c){var b=this.getView().config.notificationRecord.flagged;var a=' updated '+c('notificationTime');if(b){a+=' notification flagged use F to unflag right and left arrows to navigate available tools '}else {a+=' use F to flag notification right and left arrows to navigate available tools '}return a}}});Ext.define('ABP.view.session.notifications.NotificationController',{extend:'ABP.view.session.notifications.NotificationBaseController',alias:'controller.abp-notification',handleNotificationKeyDown:function(a,f){if(a.keyCode===40||a.keyCode===38){a.stopEvent();this.fireEvent('notificationCategory_handleKeyDown',a,f,null,this.getView().category)}if(a.keyCode===39){var e=this,c=e.getViewModel();var d=this.getView().query('button');var b=c.get('currentBtnIdx');if(b+1<d.length){c.set('currentBtnIdx',b+1);d[b+1].focus()}a.stopEvent()}if(a.keyCode===37){var e=this,c=e.getViewModel();var d=this.getView().query('button');var b=c.get('currentBtnIdx');if(b-1>=0){c.set('currentBtnIdx',b-1);d[b-1].focus()}a.stopEvent()}if(a.keyCode===70){this.lookupReference('notificationFlagButton').click();a.stopEvent()}if(a.keyCode===32){console.log('space bar');this.lookupReference('notificationLinkButton').click();a.stopEvent()}},__checkBtnPressed:function(a){return a.pressed},__setActiveCardItem:function(d,a){var c=this,b=c.getView();b.getLayout().setActiveItem(a)},__animateFade:function(b,a){b.animate({duration:1000,to:{opacity:0.25},listeners:{afteranimate:a}})}});Ext.define('ABP.view.session.notifications.Notification',{extend:'Ext.container.Container',requires:['ABP.view.session.notifications.NotificationController','ABP.view.session.notifications.NotificationModel','ABP.util.RelativeTime'],alias:'widget.abp-notification',controller:'abp-notification',viewModel:{type:'abp-notification'},tabIndex:-1,config:{notificationRecord:null,justAdded:!1,filterFlagged:!1,category:''},updateFilterFlagged:function(b){var a=this;if(!a.notificationRecord){return}if(b){a.setHidden(!a.notificationRecord.flagged)}else {a.setHidden(!1)}},cls:'abp-notification',layout:'card',listeners:{keydown:{element:Ext.isModern?'element':'el',fn:'handleNotificationKeyDown'}},items:[{xtype:'container',reference:'notificationDisplayContainer',frame:!1,layout:{type:'vbox',align:'stretch'},items:[{xtype:'component',itemId:'notificationSpecificNavComponent',reference:'notificationSpecificNavComponent',bind:{ariaLabel:'{totalNotificationCount} {notificationLabel:ariaEncode} {notificationDetail} {notificationAdditionalAriaDetail}'},tabIndex:-1,focusable:!0},{xtype:'container',frame:!1,cls:'abp-notification-header',layout:{type:'hbox'},items:[{xtype:'button',reference:'notificationLinkButton',cls:'abp-notification-link a-abp-notification-link',uiCls:'abp-link',textAlign:'left',flex:1,tabIndex:0,bind:{text:'{notificationLabel:htmlEncode}',ariaLabel:'{notificationLabel:ariaEncode}'},handler:'onNotificationLinkClick'},{xtype:'button',reference:'notificationReadButton',cls:'abp-notification-read-button a-abp-notification-read-button',iconCls:'icon-navigate-cross',ariaLabel:'Mark Read',handler:'onNotificationMarkReadClick'}]},{xtype:'component',cls:'abp-notification-detail x-unselectable',bind:{html:'{notificationDetail:htmlEncode}'}},{xtype:'toolbar',cls:'abp-notification-toolbar',items:[{xtype:'component',reference:'notificationToolbarLabel',cls:'abp-notification-toolbar-label'},'->',{xtype:'container',cls:'abp-notification-toolbar-buttons-wrapper',items:[{xtype:'button',reference:'notificationDownloadButton',cls:'abp-notification-download-button a-abp-notification-download-button',iconCls:'icon-cloud-download',ariaLabel:'Download',handler:'onNotificationDownloadClick',hidden:!0},{xtype:'button',reference:'notificationFlagButton',cls:'abp-notification-flag-button a-abp-notification-flag-button',iconCls:'icon-signal-flag',ariaLabel:'Flag',enableToggle:!0,handler:'onNotificationFlagClick'},{xtype:'button',reference:'notificationUnreadButton',cls:'abp-notification-unread-button a-abp-notification-unread-button',iconCls:'icon-nav-undo',ariaLabel:'Mark Unread',handler:'onNotificationMarkUnreadClick'},{xtype:'button',reference:'notificationRemoveButton',cls:'abp-notification-remove-button a-abp-notification-remove-button',iconCls:'icon-garbage-can',ariaLabel:'Delete',handler:'onNotificationRemoveClick'}]}]}]},{xtype:'container',reference:'notificationMarkedAsReadContainer',layout:{type:'vbox',align:'center',pack:'center'},items:[{xtype:'component',cls:'abp-notification-action-label icon-fa-check-circle-o-01',bind:{html:'{i18n.abp_notifications_label_marked_as_read:htmlEncode}'}}]},{xtype:'container',reference:'notificationMarkedAsUnreadContainer',layout:{type:'vbox',align:'center',pack:'center'},items:[{xtype:'component',cls:'abp-notification-action-label icon-nav-undo',bind:{html:'{i18n.abp_notifications_label_marked_as_unread:htmlEncode}'}}]},{xtype:'container',reference:'notificationRemovedContainer',layout:{type:'vbox',align:'center',pack:'center'},items:[{xtype:'component',cls:'abp-notification-action-label icon-garbage-can',bind:{html:'{i18n.abp_notifications_label_removed:htmlEncode}'}}]}],initComponent:function(){var c=this,b=c.getViewModel(),a=c.getNotificationRecord(),d=null,e=null;c.callParent(arguments);b.set('label',a.label?a.label:'');b.set('uniqueId',a.uniqueId);b.set('currentBtnIdx',-1);if(a.labelKey){b.bind('{i18n.'+a.labelKey+'}',function(a){b.set('labelTemplate',a)})}else {b.set('labelTemplate','')}b.set('labelArgs',a.labelArgs?a.labelArgs:[]);b.set('detail',a.detail?a.detail:'');if(a.detailKey){b.bind('{i18n.'+a.detailKey+'}',function(a){b.set('detailTemplate',a)})}else {b.set('detailTemplate','')}b.set('detailArgs',a.detailArgs?a.detailArgs:[]);d=c.lookupReference('notificationToolbarLabel');if(a['new']){if(a.time){b.set('notificationTime',a.time)}d.setBind({html:'<div class="time abp-time-ago" data-time="{notificationTime:htmlEncode}">{notificationTime:formatRelativeTime}</div>'});c.lookupReference('notificationUnreadButton').setVisible(!1);c.lookupReference('notificationRemoveButton').setVisible(!1)}else {d.setBind({html:'{i18n.abp_notifications_label_read:htmlEncode} <span class="icon-check"></span>'});c.lookupReference('notificationReadButton').setVisible(!1);c.lookupReference('notificationDownloadButton').setVisible(!1)}if(a.flagged){c.addCls('abp-notification-flagged');b.set('flagged',!0);e=c.lookupReference('notificationFlagButton');e.setPressed(!0);e.setIconCls('icon-flag-filled')}if(a.event){c.lookupReference('notificationLinkButton').addCls('has-link')}else {c.lookupReference('notificationLinkButton').disable()}if(a.downloadEvent){c.lookupReference('notificationDownloadButton').setVisible(!0)}b.notify()},updateJustAdded:function(a){var b=this,c=b.getViewModel();c.notify();if(a){this.addCls('abp-notification-new')}else {this.removeCls('abp-notification-new')}}});Ext.define('ABP.view.session.notifications.NotificationsBaseController',{extend:'ABP.controllers.base.rightPane.RightPanePanelController',requires:['ABP.view.session.notifications.Notification'],listen:{controller:{'*':{abp_notifications_add:'__addNotifications',abp_notifications_remove:'__removeNotifications',abp_notifications_read:'__markNotificationsRead',abp_notifications_unread:'__markNotificationsUnread'}},component:{'abp-notification':{notificationRead:'__markNotificationRead',notificationUnread:'__markNotificationUnread',notificationFlag:'__flagNotification',notificationUnflag:'__unflagNotification',notificationRemove:'__removeNotification',notificationKeyNav:'handleNavKeyDown'}}},firstLoad:!0,init:function(){var c=this,a=c.getViewModel(),b=ABP.util.Config.getSessionConfig().settings.notifications;a.set('maxHistory',b.maxHistory);a.set('clearBadgeOnActivate',b.clearBadgeOnActivate);a.set('ariaNotificationsLabel','No new notifications');c.fireEvent('container_rightPane_updateBadge','abp-notifications',{value:0,priority:ABP.util.Constants.badgePriority.Info});ABP.util.RelativeTime.start()},__addNotifications:function(h,g,e){var a=this,c=a.getViewModel(),f=c.get('maxHistory'),b=c.get('notifications'),d=null;Ext.Array.each(e,function(c){if(b.length===f){d=b.pop();a.__removeNotificationFromDisplay(a.__getNotificationComponentForRecord(d))}c.source=h;c.sourceKey=g;b.unshift(c);a.__addNotificationToDisplay(c,!a.firstLoad)});a.firstLoad=!1;c.set('notifications',b);if(b.length>0){a.__setActiveCardItem(2)}},__addNotificationToDisplay:function(a,h){var b=this,f=b.lookupReference('notificationContainer'),c=f.down('panel[sourcePanelName="sourcepanel-'+a.source+'"]'),d,e=null,g;if(!c){if(ABP.util.Common.getModern()){g={collapsible:{collapseToolText:null,expandToolText:null,titleCollapse:!0,collapsed:!1,tool:{automationCls:'notifications-'+a.source+'-collapse-tool'}}}}else {g={collapsible:!0,collapsed:!1,collapseToolText:null,expandToolText:null,titleCollapse:!0}}c=f.add({xtype:'panel',sourcePanelName:'sourcepanel-'+a.source,id:'notificationSourcePanel',tabIndex:-1,header:{cls:'abp-notifications-source-panel-header',listeners:{click:b.handleHeaderClick,tap:{element:'element',scope:b,fn:b.handleHeaderClick}}},viewModel:{type:'abp-notifications-source-panel'},cls:'abp-notifications-source-panel a-abp-notifications-source-panel',bind:{title:'<span class="abp-notification-panel-title">'+(a.sourceKey?'{i18n.'+a.sourceKey+':htmlEncode}':Ext.String.htmlEncode(a.source))+'</span>{sourceNotificationCountDisplay}{sourceNotificationFlagDisplay}',hidden:'{hidePanel}'},items:[{xtype:'container',reference:'notificationNavComponent',items:[{xtype:'label',id:'notificationsNavLabel',bind:{ariaLabel:'{ariaMainNotificationLabel:ariaEncode}'}}],tabIndex:0,focusable:!0,listeners:{keydown:{element:Ext.isModern?'element':'el',scope:b,fn:b.handleNavKeyDown}}}]})}d=c.getViewModel();if(a['new']){d.incrementUnreadNotificationCount();b.fireEvent('container_rightPane_incrementBadge','abp-notifications')}else {d.incrementHistoryNotificationCount()}if(a.flagged){d.incrementFlaggedNotificationCount()}e=c.down('panel[categoryPanelName="categorypanel-'+a.category+'"]');if(!e){e=c.add({xtype:'abp-notifications-category-panel',categoryPanelName:'categorypanel-'+a.category,categoryName:a.category,categoryNameKey:a.categoryKey})}e.addNotification(a,h)},__removeNotifications:function(d){var b=this,c=b.getViewModel(),a=c.get('notifications');Ext.Array.each(d,function(c){Ext.Array.each(a,function(a){if(a.uniqueId===c.uniqueId){b.__removeNotificationFromDisplay(b.__getNotificationComponentForRecord({uniqueId:a.uniqueId}));return !1}});a=a.filter(function(a){return a.uniqueId!==c.uniqueId})});c.set('notifications',a);if(a.length===0){b.__setActiveCardItem(1)}},__removeNotificationFromDisplay:function(c){var e=this,g=e.getView(),a=c.getNotificationRecord(),d=g.down('panel[sourcePanelName="sourcepanel-'+a.source+'"]'),b=d.getViewModel(),f=d.down('panel[categoryPanelName="categorypanel-'+a.category+'"]');if(a['new']){b.decrementUnreadNotificationCount();e.fireEvent('container_rightPane_decrementBadge','abp-notifications')}else {b.decrementHistoryNotificationCount()}if(a.flagged){b.decrementFlaggedNotificationCount()}f.removeNotification(c)},__markNotificationRead:function(c){var b=this,g=b.getViewModel(),a=c.getNotificationRecord(),e=g.get('notifications'),h=b.lookupReference('notificationContainer'),f=h.down('panel[sourcePanelName="sourcepanel-'+a.source+'"]'),d=f.getViewModel(),i=f.down('panel[categoryPanelName="categorypanel-'+a.category+'"]');Ext.Array.each(e,function(e){if(e.uniqueId===a.uniqueId){if(e['new']){e['new']=!1;d.incrementHistoryNotificationCount();d.decrementUnreadNotificationCount();i.markNotificationRead(c);b.fireEvent('container_rightPane_decrementBadge','abp-notifications')}return !1}});g.set('notifications',e)},__markNotificationsRead:function(b){var a=this;Ext.Array.each(b,function(c){a.__markNotificationRead(a.__getNotificationComponentForRecord({uniqueId:c.uniqueId}))})},__markNotificationUnread:function(c){var b=this,g=b.getViewModel(),a=c.getNotificationRecord(),e=g.get('notifications'),h=b.lookupReference('notificationContainer'),f=h.down('panel[sourcePanelName="sourcepanel-'+a.source+'"]'),d=f.getViewModel(),i=f.down('panel[categoryPanelName="categorypanel-'+a.category+'"]');Ext.Array.each(e,function(e){if(e.uniqueId===a.uniqueId){if(!e['new']){e['new']=!0;d.incrementUnreadNotificationCount();d.decrementHistoryNotificationCount();i.markNotificationUnread(c);b.fireEvent('container_rightPane_incrementBadge','abp-notifications')}return !1}});g.set('notifications',e)},__markNotificationsUnread:function(b){var a=this;Ext.Array.each(b,function(c){a.__markNotificationUnread(a.__getNotificationComponentForRecord({uniqueId:c.uniqueId}))})},__getNotificationComponentForRecord:function(b){var c=this,a=c.lookupReference('notificationContainer');return a.down('abp-notification[notificationUniqueId="'+b.uniqueId+'"]')},__flagNotification:function(e){var c=this,d=c.getViewModel(),g=c.getView(),b=e.getNotificationRecord(),a=d.get('notifications'),f=g.down('panel[sourcePanelName="sourcepanel-'+b.source+'"]');Ext.Array.each(a,function(a){if(a.uniqueId===b.uniqueId){a.flagged=!0;return !1}});d.set('notifications',a);f.getViewModel().incrementFlaggedNotificationCount()},__unflagNotification:function(e){var c=this,d=c.getViewModel(),g=c.getView(),b=e.getNotificationRecord(),a=d.get('notifications'),f=g.down('panel[sourcePanelName="sourcepanel-'+b.source+'"]');Ext.Array.each(a,function(a){if(a.uniqueId===b.uniqueId){a.flagged=!1;return !1}});d.set('notifications',a);f.getViewModel().decrementFlaggedNotificationCount()},__removeNotification:function(a){var c=this,b=a.getNotificationRecord();c.__removeNotifications([b])},privates:{handleHeaderClick:function(c,b){if(b.target&&b.target.matches('.abp-notification-panel-flag')){var a=this.lookupViewModel();a.set('showFlaggedOnly',!a.data.showFlaggedOnly)}else {if(b.matches('.abp-notification-panel-flag')){var a=this.getViewModel();a.set('showFlaggedOnly',!a.data.showFlaggedOnly)}}},handleNavKeyDown:function(b,c){var d=this;b.stopEvent();var a=Ext.ComponentQuery.query('#notificationCategoryNavComponent');if(a&&a.length>0){a[0].focus()}}}});Ext.define('ABP.view.session.notifications.NotificationsCategoryController',{extend:'Ext.app.ViewController',alias:'controller.abp-notifications-category-panel',listen:{controller:{'*':{notificationCategory_handleKeyDown:'handleCategoryKeyDown'}}},addNotification:function(a,f){var c=this,d=c.getViewModel(),b,e;e={xtype:'abp-notification',justAdded:f,componentCls:'a-abp-notification-'+a.uniqueId,notificationUniqueId:a.uniqueId,notificationRecord:a,listeners:{notificationMarkReadClick:'onNotificationMarkReadClick'},bind:{filterFlagged:'{showFlaggedOnly}',category:'{categoryName}'}};if(a['new']){d.incrementUnreadNotificationCount();b=c.lookupReference('unreadNotificationContainer')}else {d.incrementHistoryNotificationCount();b=c.lookupReference('historyNotificationContainer')}d.notify();b.insert(0,e)},removeNotification:function(c){var b=this,d=b.getViewModel(),a;if(c.getNotificationRecord()['new']){d.decrementUnreadNotificationCount();a=b.lookupReference('unreadNotificationContainer')}else {d.decrementHistoryNotificationCount();a=b.lookupReference('historyNotificationContainer')}a.remove(c)},markNotificationRead:function(b){var c=this,a=b.getNotificationRecord();c.removeNotification(b);a['new']=!1;c.addNotification(a)},markNotificationUnread:function(b){var c=this,a=b.getNotificationRecord();c.removeNotification(b);a['new']=!0;c.addNotification(a)},onShowHistoryClick:function(){var a=this,b=a.getViewModel();b.set('displayHistory',!0)},onHideHistoryClick:function(){var a=this,b=a.getViewModel();b.set('displayHistory',!1)},handleCategoryKeyDown:function(a,o,n,i){if(i&&i!=this.getView().categoryName){a.stopEvent();return}var d=this,e=d.getViewModel(),b=e.get('currentNavIndex'),j=e.get('displayHistory'),k=e.get('unreadNotificationCount'),m=e.get('historyNotificationCount'),l=e.get('displayHistory')?k+m:k;if(a.keyCode===40||a.keyCode===38){a.stopEvent();if(a.keyCode===40){if(b+1<l){e.set('currentNavIndex',b+1);var c=d.lookupReference('unreadNotificationContainer').items.items;if(j){var g=d.lookupReference('historyNotificationContainer').items.items;if(b+1>c.length){g[b+1-c.length].lookupReference('notificationSpecificNavComponent').focus()}a.stopEvent();return}a.stopEvent();c[b+1].lookupReference('notificationSpecificNavComponent').focus()}else {if(!i&&l>0){var c=d.lookupReference('unreadNotificationContainer').items.items;if(j){var g=d.lookupReference('historyNotificationContainer').items.items;g[b-c.length].lookupReference('notificationSpecificNavComponent').focus();a.stopEvent();return}a.stopEvent();c[b].lookupReference('notificationSpecificNavComponent').focus()}else {var f=this.getView().up().query('abp-notifications-category-panel');var h=f.indexOf(this.getView());if(h+1<f.length){f[h+1].lookupReference('notificationCategoryNavComponent').focus()}a.stopEvent()}}}if(a.keyCode===38){if(b>0){e.set('currentNavIndex',b-1);var c=d.lookupReference('unreadNotificationContainer').items.items;if(j){var g=d.lookupReference('historyNotificationContainer').items;g[b-1-c.length].lookupReference('notificationSpecificNavComponent').focus();a.stopEvent();return}a.stopEvent();c[b-1].lookupReference('notificationSpecificNavComponent').focus()}else {var f=this.getView().up().query('abp-notifications-category-panel');var h=f.indexOf(this.getView());if(h-1>=0){f[h-1].lookupReference('notificationCategoryNavComponent').focus()}a.stopEvent()}}}},onCategoryNavFocus:function(){var a=this,b=a.getViewModel();b.set('currentNavIndex',-1)}});Ext.define('ABP.view.session.notifications.NotificationsCategoryPanelViewModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.abp-notifications-category-panel',data:{unreadNotificationCount:0,historyNotificationCount:0,displayHistory:!1,categoryName:'',currentNavIndex:0},formulas:{hidePanel:function(a){return a('unreadNotificationCount')+a('historyNotificationCount')===0},hideShowHistoryComponent:function(a){return a('historyNotificationCount')===0||a('displayHistory')},hideHideHistoryComponent:function(a){return a('historyNotificationCount')===0||!a('displayHistory')},categoryNotificationCountDisplay:function(b){var a=b('unreadNotificationCount');if(a>0){if(a>99){a='99+'}return '<span class="abp-notification-panel-badge">'+a+'</span>'}return ''},ariaCategoryNotificationLabel:function(b){var d=b('unreadNotificationCount');var c=b('historyNotificationCount');var a=b('categoryName');a+=' unread '+d;a+=c>0?' history '+c:'';return a},totalNotificationCount:function(a){var b=a('unreadNotificationCount');var c=a('historyNotificationCount');var d=a('displayHistory')?b+c:b;var e=a('currentNavIndex')+1;return ' list item '+e+' of '+d}},incrementUnreadNotificationCount:function(){var a=this;a.set('unreadNotificationCount',a.get('unreadNotificationCount')+1)},decrementUnreadNotificationCount:function(){var a=this;a.set('unreadNotificationCount',a.get('unreadNotificationCount')-1)},incrementHistoryNotificationCount:function(){var a=this;a.set('historyNotificationCount',a.get('historyNotificationCount')+1)},decrementHistoryNotificationCount:function(){var b=this,a=b.get('historyNotificationCount');a--;b.set('historyNotificationCount',a);if(a===0){b.set('displayHistory',!1)}}});Ext.define('ABP.view.session.notifications.NotificationsSourcePanelViewModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.abp-notifications-source-panel',data:{unreadNotificationCount:0,historyNotificationCount:0,flaggedNotificationCount:0,showFlaggedOnly:!1},formulas:{hidePanel:function(a){return a('unreadNotificationCount')+a('historyNotificationCount')===0},sourceNotificationCountDisplay:function(b){var a=b('unreadNotificationCount');if(a>0){if(a>99){a='99+'}return '<span class="abp-notification-panel-badge">'+a+'</span>'}return ''},sourceNotificationFlagDisplay:function(c){var b=c('flaggedNotificationCount');var d=c('showFlaggedOnly');if(b===0){this.set('showFlaggedOnly',!1);return ''}var a='<span class="abp-notification-panel-flag ';if(d){a+='abp-notification-flagged-only'}a+='">'+b+'</span>';return a},ariaMainNotificationLabel:function(a){return 'Notifications unread '+a('unreadNotificationCount')+' flagged '+a('flaggedNotificationCount')}},incrementUnreadNotificationCount:function(){var a=this;a.set('unreadNotificationCount',a.get('unreadNotificationCount')+1)},decrementUnreadNotificationCount:function(){var a=this;a.set('unreadNotificationCount',a.get('unreadNotificationCount')-1)},incrementHistoryNotificationCount:function(){var a=this;a.set('historyNotificationCount',a.get('historyNotificationCount')+1)},decrementHistoryNotificationCount:function(){var a=this;a.set('historyNotificationCount',a.get('historyNotificationCount')-1)},incrementFlaggedNotificationCount:function(){var a=this;a.set('flaggedNotificationCount',a.get('flaggedNotificationCount')+1)},decrementFlaggedNotificationCount:function(){var a=this;a.set('flaggedNotificationCount',a.get('flaggedNotificationCount')-1)}});Ext.define('ABP.view.session.notifications.NotificationsViewModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.abp-notifications',data:{notifications:[],maxHistory:null,clearBadgeOnActivate:null}});Ext.define('ABP.view.session.rightPane.RightPaneBaseController',{extend:'Ext.app.ViewController',listen:{controller:{'*':{rightPane_addElement:'addElement',rightPane_toggle:'togglePane',rightPane_toggleTab:'toggleTab',rightPane_initTab:'__initTab',rightPane_handleKeyPress:'handleKeyPress',session_click:'__handleSessionClick'}}},togglePane:function(){this.fireEvent('session_toggleRightPane')},addElement:function(a){var b=this;var e=b.getView();var d=b.getViewModel();if(d.get('rightPaneOpen')===!1){b.togglePane()}var c=e.getActiveTab();if(Ext.isString(a)){a={xtype:a}}if(a){c.add(a)}},__handleSessionClick:function(a){var h=this;var o=h.getView();var b=o.up();var m=b.getViewModel();var n=m.get('rightPaneOpen');var g=b.down('#mainMenu').el.dom;var l=a.target==g||g.contains(a.target);var f=b.down('#rightPane').el.dom;var k=a.target==f||f.contains(a.target);var d=b.down('#rpButton').el.dom;var i=a.target==d||d.contains(a.target);var e=b.down('#toolbar-button-menu');var c;if(e){c=e.el.dom}var j=a.target==c||c.contains(a.target);if(!l&&!k&&!i&&!j&&n){h.fireEvent('session_closeRightPane')}},__createTab:function(a,c){var d=null;var b={itemId:c,title:a.title,titleKey:a.titleKey,unqiueId:a.uniqueId,layout:'fit',scrollable:'vertical',items:[{xtype:a.xtype}]};if(a.tooltipKey){b.bind={'ariaLabel':'{i18n.'+a.tooltipKey+':htmlEncode}'}}else {if(a.tooltip){b.ariaLabel=a.tooltip}}return b},__getPanelConfig:function(d){var g=this;var f=g.getView();var e=f.getViewModel();var b=e.get('rightPaneTabs');var c={};var a;for(a=0;a<b.length;a++){if(b[a].uniqueId===d){c=b[a];break}}return c}});Ext.define('ABP.view.session.rightPane.RightPaneModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.rightpanemodel',data:{tabPrefix:'rightPaneTab_',menuWidth:330},formulas:{micro:{get:function(){var d;var c;var e;var a=!1;var b=Ext.os.deviceType==='Phone';if(b){d=ABP.util.Common.getWindowWidth();c=ABP.util.Common.getWindowHeight();if(b){a=!0}this.setMenu(a)}return a}},iconCls:{bind:'{profilePhoto}',get:function(a){if(a){return 'profile-picture'}return 'icon-user'}}},setMenu:function(c){var a=this;var b=Ext.os.deviceType==='Tablet'||Ext.os.deviceType==='Desktop';if(!c){if(b){a.set('menuWidth',250)}else {a.set('menuWidth',300)}}else {a.set('menuWidth','100%')}}});Ext.define('ABP.view.session.settings.SettingsContainerController',{extend:'ABP.controllers.base.rightPane.RightPanePanelController',alias:'controller.settingscontainer',listen:{controller:{'*':{closeActiveSettingsMenu:'toggleMenuButton',rightPane_toggleTab:'__toggleTab',session_toggleRightPane:'__toggleTab'}}},init:function(){this.constructSettingsMenu()},constructSettingsMenu:function(){var a=this;var b=ABP.util.Config.getSessionConfig().settings;if(!b){return}a.__initSessionTimer();a.__setVisibleSettings(b);a.__buildDefaultSettingsView();a.__createAppSettings(b.appSettings);a.__buildFavoritesManagerView(b);a.__buildHeadlinesManagerView(b);a.__buildThemeOptions(b);a.__buildLanguageOptions(b);a.__buildAboutView(b);a.__buildHelpView(b);a.__buildLogsView(b);a.__buildOfflineModeToggle();a.__buildSignOffButton(b)},closeRightPane:function(){this.fireEvent('rightPane_toggle')},__initSessionTimer:function(){var c=this;var b=c.getView();var e=c.getViewModel();var a=b.lookupReference('sessionTimeLabel');var d=new Ext.util.TaskRunner();var a=b.lookupReference('sessionTimeLabel');a.task=d.newTask({run:function(a){try{a.set('now',Date.now())}catch(f){}},interval:1000,fireOnStart:!0,args:[e]});a.task.start()},__setVisibleSettings:function(a){var b=this;var c=b.getViewModel();if(a.settingsPage&&Ext.isBoolean(b.__boolConverter(a.settingsPage.showEnvironment))){c.set('showEnvironment',a.settingsPage.showEnvironment)}if(a.settingsPage&&Ext.isBoolean(b.__boolConverter(a.settingsPage.showSessionTimer))){c.set('showSessionTimer',a.settingsPage.showSessionTimer)}if(a.settingsPage&&Ext.isBoolean(b.__boolConverter(a.settingsPage.enableUser))){c.set('showUserName',a.settingsPage.enableUser)}},__buildDefaultSettingsView:function(){var a=this,l=a.getView(),d=ABP.util.Config.getDisplayName(),g=d===ABP.util.Config.getUsername();var f=ABP.util.Config.getSessionConfig().settings.userConfig.enableEditProfile;var b=40,i='presentation',h=!1,e='x-unselectable settings-container-profile-container content-header',j='',k='';if(!g){e+=' large-profile-icon'}if(f){b=70;i='button';h=!0;e+=' editable';j='user-profile-over';k=ABP.util.Common.geti18nString('sessionMenu_editPreferences')}var c={xtype:'container',overCls:j,cls:e,height:b,focusable:h,ariaRole:i,tooltip:k,tabIndex:0,bind:{hidden:'{!showUserName}'},layout:{type:'hbox',align:'center',pack:'start'},items:[{xtype:'abpprofileimage',bind:{src:'{profilePhoto}'},margin:'0 0 0 7',width:b-10,height:b-10},{xtype:'container',layout:'vbox',flex:1,items:[{xtype:'label',margin:'0 0 0 5',flex:2,bind:{html:d?Ext.String.htmlEncode(d):Ext.String.htmlEncode(ABP.util.Config.getUsername())}},{xtype:'label',margin:'0 0 0 5',flex:1,cls:'user-name',bind:{html:Ext.String.htmlEncode(ABP.util.Config.getUsername()),hidden:g}}]}]};if(f){if(ABP.util.Common.getModern()){c.listeners={click:{element:'element',fn:function(){a.onUserProfileClick(this)}}}}else {c.listeners={element:'el',click:function(b){a.onUserProfileClick(this)},keydown:function(b){if(b.getKey()===b.ENTER){a.onUserProfileClick(this)}else {if(b.getKey()===b.ESC){a.onCloseUserSettings(this)}}}}}}l.add(c)},onCloseUserSettings:function(a){this.fireEvent('rightPane_toggle')},onUserProfileClick:function(a){this.fireEvent(ABP.Events.userProfileEdit,a.component)},__buildFavoritesManagerView:function(a){var c=this;var b=c.getView();if(a.enableMenuFavorites){b.add({bind:{text:'{i18n.sessionMenu_manageFavorites:htmlEncode}',ariaLabel:'{i18n.sessionMenu_manageFavorites:ariaEncode}'},automationCls:'toolusermenu-favorites',handler:'launchFavoritesManager'})}},__buildHeadlinesManagerView:function(b){var a=this;var c=a.getView();if(b.settingsPage&&a.__boolConverter(b.settingsPage.enableHeadlinesManager)){if(ABP.util.Common.getModern()){return}a.fireEvent('headline_manager_initialize',Ext.create('Ext.data.Store',{storeId:'ABPHeadlines',autoDestroy:!1,fields:['actionText','actionTextKey','message','messageKey',{name:'startTime',type:'date'},{name:'endTime',type:'date'},{name:'published',type:'boolean'},{name:'priority',type:'int'},'uniqueId']}));c.add({bind:{text:'{i18n.sessionMenu_manageHeadlines:htmlEncode}',ariaLabel:'{i18n.sessionMenu_manageHeadlines:ariaEncode}'},automationCls:'toolusermenu-headlines',handler:'launchHeadlinesManager'})}},__buildAboutView:function(a){var c=this;var b=c.getView();if(a.enableAbout||a.settingsPage.enableAbout){b.add({bind:{text:'{i18n.sessionMenu_about:htmlEncode}',ariaLabel:'{i18n.sessionMenu_about:ariaEncode}'},automationCls:'toolusermenu-about',handler:'launchAbout'})}},__buildHelpView:function(a){var c=this;var b=c.getView();if(a.settingsPage.enableHelp){b.add({bind:{text:'{i18n.sessionMenu_help:htmlEncode}',ariaLabel:'{i18n.sessionMenu_help:ariaEncode}'},automationCls:'toolusermenu-help',handler:'launchHelp'})}},__buildLogsView:function(a){var c=this;var b=c.getView();if(a.settingsPage.enableLoggerView){b.add({bind:{text:'{i18n.sessionMenu_logger:htmlEncode}',ariaLabel:'{i18n.sessionMenu_logger:ariaEncode}'},automationCls:'toolusermenu-logger',handler:'launchLogger'})}},__buildThemeOptions:function(g){var d=this;var h=d.getView();var i=d.getViewModel();var e=[];var a=0;if(g.settingsPage.enableThemeChange){if(Ext.theme&&Ext.theme.subThemeList){var b=Ext.theme.subThemeList;var f=ABP.util.LocalStorage.getForLoggedInUser('ChosenTheme');if(b){for(a=0;a<b.length;++a){var c=b[a].split('aptean-theme-')[1];c=ABP.util.String.makeHumanReadable(c,'-');e.push({title:c,name:'themes',automationCls:c+'-radio',value:b[a],checked:f&&f===b[a]})}h.add(d.__createRadialSetting({titleKey:'sessionMenu_theme',automationCls:'toolusermenu-themes',cls:'theme-option',ui:'radiobutton',appId:'container',event:'switchTheme',addToggle:!0,options:e,layout:Ext.toolkit==='classic'?'table':'hbox'}))}}}},__buildLanguageOptions:function(h){var d=this;var i=d.getView();var f=d.getViewModel();var e=[];var g=ABP.util.Config.getLanguage();var b=0;var a;var c;if(h.settingsPage.enableLanguages){a=f.get('selected.environment');if(a){a=f.get('main_environmentStore').getById(a);if(a&&a.data&&a.data.languages){c=a.data.languages;for(b=0;b<c.length;++b){e.push({title:Ext.String.htmlEncode(c[b].name),name:'languages',value:c[b].key,checked:c[b].key===g})}i.add(d.__createRadialSetting({titleKey:'sessionMenu_languages',automationCls:'toolusermenu-languages',cls:'language-option',appId:'container',event:'switchLanguage',options:e,layout:'vbox'}))}}}},__buildOfflineModeToggle:function(){var b=this;var a=b.getView();var c=b.getViewModel();if(ABP.util.LocalStorage.get('OfflineBootstrap')){if(c.get('bootstrapConf.hideOfflineModeToggle')===!0){return}if(c.get('bootstrapConf.offlineAuthenticationType')===1){a.add({bind:{text:'{i18n.sessionMenu_setOfflinePassword:htmlEncode}',hidden:'{offlineMode}',ariaLabel:'{i18n.sessionMenu_setOfflinePassword}'},cls:'settings-container-button',ui:'menuitem',uiCls:'light',textAlign:'left',automationCls:'toolusermenu-setofflinepassword',handler:'setOfflinePassword'})}a.add({bind:{text:'{goOnlineText:htmlEncode}',ariaLabel:'{goOnlineText:ariaEncode:ariaEncode}'},cls:'settings-container-button',ui:'menuitem',uiCls:'light',textAlign:'left',automationCls:'toolusermenu-swtichonlinestate',handler:'switchOnlineState'})}},__buildSignOffButton:function(a){var c=this;var b=c.getView();if(a.settingsPage.enableSignOff){b.add({bind:{text:'{i18n.sessionMenu_signoff:htmlEncode}',ariaLabel:'{i18n.sessionMenu_signoff:ariaEncode}'},automationCls:'toolusermenu-signoff',handler:'logout'})}},__toggleTab:function(c){var d=this;var a,b;var f=d.getView();var g=f.getViewModel();var e=g.get('rightPaneOpen');a=d.lookupReference('sessionTimeLabel');d.toggleMenuButton(c);if(Ext.toolkit==='modern'){b=e}else {if(c){b=c.uniqueId==='abp-settings'}if(e===!1){b=!1}}if(b===!0&&a.task.stopped===!0){a.task.start()}else {if(b===!1&&a.task.stopped===!1){a.task.stop()}}},launchFavoritesManager:function(){if(Ext.toolkit==='modern'){this.fireEvent('rightPane_toggle')}this.fireEvent('container_showSettings','favoritesManager')},launchHeadlinesManager:function(){if(Ext.toolkit==='modern'){this.fireEvent('rightPane_toggle')}this.fireEvent('container_showSettings','headlinesManager')},launchHelp:function(){if(Ext.toolkit==='modern'){this.fireEvent('rightPane_toggle')}this.fireEvent('container_showSettings','helpview')},launchAbout:function(){if(Ext.toolkit==='modern'){this.fireEvent('rightPane_toggle')}this.fireEvent('container_showSettings','about')},launchLogger:function(){if(Ext.toolkit==='modern'){this.fireEvent('rightPane_toggle')}this.fireEvent('container_showSettings','loggerpage')},logout:function(){this.fireEvent('main_fireAppEvent','container','signout',['user init',!1])},setOfflinePassword:function(){if(Ext.toolkit==='modern'){this.fireEvent('rightPane_toggle')}this.fireEvent('container_showSettings','offlinepassword')},switchOnlineState:function(){var a=this,b=a.getView(),c=b.getViewModel();if(c.get('offlineMode')){a.fireEvent('container_go_online')}else {a.fireEvent('container_go_offline')}},__createAppSettings:function(b){if(!b){return}var c=this;var a=0;for(a=0;a<b.length;++a){if(b[a].type==='check'){c.__createCheckSetting(b[a])}else {if(b[a].type==='radial'){c.__createRadialSetting(b[a])}else {if(b[a].type==='bool'){c.__createCheckSetting(b[a],!0)}else {if(b[a].type==='event'){c.__createButtonSetting(b[a])}else {if(b[a].type==='menu'){var d={xtype:'container',items:[]};var e={xtype:'container',margin:'0 0 0 7',items:[{xtype:b[a].xtype}]};d.items.push(e);c.addMenuButton(d.items,{title:b[a].title,cls:'settings-container-button'})}}}}}}},__createCheckSetting:function(a,e){var c=this;var h=c.getView();var d=[];var b=0;var g=e?1:a.options.length;var f=e===!0?'0 0 0 8':'0 0 0 0';for(b=0;b<g;++b){d.push({xtype:'checkbox',indent:!1,padding:f,name:a.options[b].value,boxLabel:a.options[b].title,boxLabelAlign:'after',bind:a.options[b].titleKey?{boxLabel:'{i18n.'+a.options[b].titleKey+':htmlEncode}'}:{},cls:'settings-container-checkfield',automationCls:'toolusermenu-check-'+a.options[b].value,event:a.appId+'_'+a.event,checked:c.__boolConverter(a.options[b].checked),listeners:{change:function(){var b={};if(Ext.toolkit==='modern'){this.up().items.each(function(c){b[c.name]=c.isChecked()})}else {this.up().items.each(function(c){b[c.name]=c.getValue()})}c.fireEvent(this.event,b)}}})}c.addMenuButton(d,{layout:a.layout,title:a.title,titleKey:a.titleKey,cls:'settings-container-button',automationCls:'toolusermenu-unsafe-'+a.titleKey||a.title})},__createRadialSetting:function(a){var c=this;var i=c.getView();var g='settings-container-button';var f=[];var h;var e;var b=0;if(!a.layout){a.layout='vbox'}e=a.layout==='vbox';for(b=0;b<a.options.length;++b){var d={xtype:'radiofield',name:a.options[b].name||'radField',indent:!1,boxLabelAlign:'after',boxLabel:e?a.options[b].title:null,cls:'settings-container-radio'+' '+a.cls,automationCls:'toolusermenu-radio-'+a.options[b].value+' '+a.cls,event:a.appId+'_'+a.event,checked:c.__boolConverter(a.options[b].checked),inputValue:a.options[b].value,ariaRole:'menuitemradio',listeners:{change:function(b,e){if(e===!1){return}var d={};d[b.name]=ABP.util.Common.getModern()?b.config.inputValue:b.inputValue;c.fireEvent(this.event,d)},specialkey:function(f,d){var b=f.ownerCt,c=d.event.key,e=b.ownerCt.items.keys.indexOf(b.id);if(c==='ArrowLeft'||c==='ArrowRight'){d.event.preventDefault();if(c==='ArrowLeft'){b.ownerCt.items.items[e-1].click()}}}}};if(a.options[b].titleKey){d.bind={ariaLabel:'{i18n.'+a.options[b].titleKey+':ariaEncode}'};if(e){d.bind.boxLabel='{i18n.'+a.options[b].titleKey+':htmlEncode}'}}else {if(a.options[b].title){d.ariaLabel=a.options[b].title}}f.push(d)}g+=a.automationCls?'':' a-toolusermenu-unsafe-'+a.titleKey||a.title;return c.addMenuButton(f,{layout:a.layout,title:a.title,titleKey:a.titleKey,cls:g,automationCls:a.automationCls||undefined,listeners:{click:function(b){setTimeout(function(){if(!b.nextSibling().hidden){var c=b.nextSibling().items.items.filter(function(c){return c.checked===!0});if(c.length>0){c[0].focus()}else {b.nextSibling().items.items[0].focus()}}},100)}},keyMap:{scope:'this',RIGHT:c.__onSpecialKeyPress,LEFT:c.__onSpecialKeyPress}})},__onSpecialKeyPress:function(a,b){if(a){a.preventDefault();a.stopPropagation();var d=a.event.key,c=b.nextSibling(),e=d==='ArrowRight'&&c.hidden||d==='ArrowLeft'&&!c.hidden;if(e){b.click()}}},__createButtonSetting:function(a){var b=this;var c=b.getView();c.add({text:a.title,bind:a.titleKey?{text:'{i18n.'+a.titleKey+':htmlEncode}'}:{},cls:'settings-container-button',ui:'menuitem',uiCls:'light',textAlign:'left',automationCls:'toolusermenu-unsafe-'+a.titleKey||a.title,event:a.event,eventArgs:a.eventArgs,iconCls:a.icon,appId:a.appId,activateApp:a.activateApp,listeners:{click:function(b){this.fireEvent('main_fireAppEvent',b.appId,b.event,b.eventArgs)},tap:function(b){this.fireEvent('main_fireAppEvent',b.appId,b.event,b.eventArgs)},scope:b}})},__boolConverter:function(a){if(typeof a==='string'||a instanceof String){switch(a.toLowerCase()){case 'false':case '0':return !1;case 'true':case '1':return !0;}}else {if(Ext.isBoolean(a)){return a}else {return !1}}}});Ext.define('ABP.view.session.settings.SettingsContainerModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.settingscontainer',data:{now:Date.now(),showEnv:!0,showEnvironment:!0,showSessionTimer:!0,showUserName:!0},formulas:{username:{get:function(){var d=ABP.util.Config.getUsername();var a=(((a||'')+'').toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join('');var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,b=/\x3c!--[\s\S]*?--\x3e|<\?(?:php)?[\s\S]*?\?>/gi;return d.replace(b,'').replace(c,function(b,c){return a.indexOf('<'+c.toLowerCase()+'>')>-1?b:''}).replace('/>','').trim()}},loggedInTime:{bind:{_loginTime:'{loginTime}',_now:'{now}'},get:function(d){var a=d._now-d._loginTime;a=Math.floor(a/1000);var e=Math.floor(a/3600);var b=Math.floor(a%3600/60);var c=a%60;b=b<10?'0'+b:b;c=c<10?'0'+c:c;return e+':'+b+':'+c}},environmentName:{bind:{_selected:'{selected.environment}',_envStore:'{main_environmentStore}'},get:function(a){if(!a._selected){a._selected=ABP.util.Config.getEnvironment()}var b=a._selected;var c;if(a._envStore&&a._selected){c=a._envStore.getById(a._selected);if(c&&c.data&&c.data.name){b=c.data.name}}else {this.set('showEnv',!1)}if(b&&b.length>25){b=b.slice(0,24)+'...'}return b}},goOnlineText:{bind:{_goOnline:'{i18n.button_switch_online_mode}',_goOffline:'{i18n.button_switch_offline_mode}',_offlineMode:'{offlineMode}'},get:function(a){return a._offlineMode?a._goOnline:a._goOffline}}}});Ext.define('ABP.view.session.settings.SettingsPageController',{extend:'Ext.app.ViewController',alias:'controller.settingspage',init:function(){this.fireEvent('container_toolbar_setTitle','sessionMenu_settings');this.__constructSettingsPage()},__constructSettingsPage:function(){var h=this;var k=h.getView();var i=h.getViewModel();var g=[];var a=ABP.util.Config.getSessionConfig().settings;var d=[];var b=[];var c;var j;var f;var e=0;d.push({xtype:'container',docked:'top',layout:{type:'hbox',pack:'end'},items:[{xtype:'button',bind:{text:'{i18n.settingsCanvas_close:htmlEncode}'},focusCls:'',overCls:'',handler:'closeClicked'}]});if(a.settingsPage.enableUser){g.push({xtype:'textfield',bind:{label:'{i18n.sessionMenu_user:htmlEncode}'},cls:'settingspage-field',labelCls:'settingspage-label',labelWidth:'35%',value:Ext.String.htmlEncode(ABP.util.Config.getUsername()),readOnly:!0})}if(a.settingsPage.showEnvironment){g.push({xtype:'textfield',bind:{label:'{i18n.sessionMenu_environment:htmlEncode}',value:'{selected.environment}'},cls:'settingspage-field',labelCls:'settingspage-label',labelWidth:'45%',readOnly:!0})}if(a.settingsPage.showSessionTimer){g.push({xtype:'textfield',bind:{label:'{i18n.sessionMenu_time:htmlEncode}',value:'{loggedInTime}'},labelWidth:'45%',cls:'settingspage-field',labelCls:'settingspage-label',readOnly:!0})}if(!Ext.isEmpty(g)){d.push({xtype:'panel',bind:{title:'{i18n.settings_userInfo}'},cls:'settings-info-panel',layout:{type:'vbox',align:'stretch'},items:[g]})}if(a.enableLanguages){c=i.get('selected.environment');if(c){j=i.get('selected.language');c=i.get('main_environmentStore').getById(c);if(c&&c.data&&c.data.languages){f=c.data.languages;b=[];for(e=0;e<f.length;++e){b.push({xtype:'radiofield',name:'languages',value:f[e].key,label:f[e].name,cls:'settingspage-field',labelCls:'settingspage-label',checked:j===f[e].key,listeners:{'check':function(){h.fireEvent('container_switchLanguage',this.getValue())}}})}if(!Ext.isEmpty(b)){d.push({xtype:'formpanel',bind:{title:'{i18n.settings_languages}'},cls:'settings-info-panel',automationCls:'languages-panel',layout:{type:'vbox',align:'stretch'},items:b})}}}}if(a.appSettings){d=d.concat(h.getAppSettings(a.appSettings))}if(a.enableHelp||a.enableAbout||a.enableLogger){b=[];if(a.enableHelp){b.push({xtype:'button',cls:'settingspage-link-button',bind:{text:'{i18n.sessionMenu_help:htmlEncode}'},handler:'launchHelp'})}if(a.enableAbout){b.push({xtype:'button',cls:'settingspage-link-button',bind:{text:'{i18n.sessionMenu_about:htmlEncode}'},handler:'launchAbout'})}if(a.enableLoggerView){b.push({xtype:'button',cls:'settingspage-link-button',bind:{text:'{i18n.sessionMenu_logger:htmlEncode}'},handler:'launchLogger'})}if(!Ext.isEmpty(b)){d.push({xtype:'panel',bind:{title:'{i18n.settings_internalLinks}'},cls:'settings-info-panel',layout:{type:'vbox',align:'stretch'},items:b})}}k.add(d)},getAppSettings:function(b){var d=this;var c=[];var a=0;for(a=0;a<b.length;++a){if(b[a].type){if(b[a].type==='check'){c.push(d.createCheckSetting(b[a]))}else {if(b[a].type==='radial'){c.push(d.createRadialSetting(b[a]))}else {if(b[a].type==='bool'){c.push(d.createBoolSetting(b[a]))}else {if(b[a].type==='info'){c.push(d.createInfoSetting(b[a]))}}}}}}return c},createCheckSetting:function(a){var e=this;var d;var c=[];var b=0;for(b=0;b<a.options.length;++b){c.push({xtype:'checkboxfield',value:!0,name:a.options[b].value,label:a.options[b].title,bind:a.options[b].titleKey?{label:'{i18n.'+a.options[b].titleKey+':htmlEncode}'}:{},cls:'settingspage-field',labelCls:'settingspage-label',event:a.appId+'_'+a.event,checked:a.options[b].checked==='true'||a.options[b].checked===!0,listeners:{'check':function(){var b=this.up('formpanel').getValues();for(var c in b){if(b.hasOwnProperty(c)){if(b[c]===null){b[c]=!1}}}e.fireEvent(this.event,b)},'uncheck':function(){var b=this.up('formpanel').getValues();for(var c in b){if(b.hasOwnProperty(c)){if(b[c]===null){b[c]=!1}}}e.fireEvent(this.event,b)}}})}if(!Ext.isEmpty(c)){d={xtype:'formpanel',title:a.title,bind:a.titleKey?{title:'{i18n.'+a.titleKey+'}'}:{},cls:'settings-info-panel',layout:{type:'vbox',align:'stretch'},items:c}}return d},createRadialSetting:function(a){var e=this;var d;var c=[];var b=0;for(b=0;b<a.options.length;++b){c.push({xtype:'radiofield',value:a.options[b].value,name:'radField',label:a.options[b].title,bind:a.options[b].titleKey?{label:'{i18n.'+a.options[b].titleKey+':htmlEncode}'}:{},cls:'settingspage-field',labelCls:'settingspage-label',event:a.appId+'_'+a.event,checked:a.options[b].checked,listeners:{'check':function(){e.fireEvent(this.event,this.up('formpanel').getValues())}}})}if(!Ext.isEmpty(c)){checkTitle=ABP.util.Common.geti18nString(a.title);d={xtype:'formpanel',title:a.title,bind:a.titleKey?{title:'{i18n.'+a.titleKey+'}'}:{},cls:'settings-info-panel',layout:{type:'vbox',align:'stretch'},items:c}}return d},createBoolSetting:function(a){var c=this;var b={xtype:'panel',title:a.title,bind:a.titleKey?{title:'{i18n.'+a.titleKey+'}'}:{},cls:'settings-info-panel',layout:{type:'vbox',align:'stretch'},items:[{xtype:'togglefield',name:a.options[0].value,value:a.options[0].checked,label:a.options[0].title,bind:a.options[0].titleKey?{label:'{i18n.'+a.options[0].titleKey+':htmlEncode}'}:{},cls:'settingspage-field',labelCls:'settingspage-label',event:a.appId+'_'+a.event,listeners:{'change':function(d,b){var e=d.getName();c.fireEvent(this.event,{name:b})}}}]};return b},createInfoSetting:function(a){var b={xtype:'panel',title:a.title,bind:a.titleKey?{title:'{i18n.'+a.titleKey+'}'}:{},cls:'settings-info-panel',layout:{type:'vbox',align:'stretch'},items:[{xtype:'textareafield',cls:'settingspage-field',readOnly:!0,maxRows:4,scrollable:'y',value:a.text,bind:a.textKey?{value:'{i18n.'+a.textKey+'}'}:{}}]};return b},launchHelp:function(){this.fireEvent('container_showSettings','helpview')},launchAbout:function(){this.fireEvent('container_showSettings','about')},launchLogger:function(){this.fireEvent('container_showSettings','loggerpage')},closeClicked:function(){this.fireEvent('featureCanvas_hideSetting')}});Ext.define('ABP.view.session.settings.SettingsPageModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.settingspage',formulas:{loggedInTime:{bind:{_loginTime:'{loginTime}'},get:function(d){var a=Date.now()-d._loginTime;a=Math.floor(a/1000);var e=Math.floor(a/3600);var b=Math.floor(a%3600/60);var c=a%60;b=b<10?'0'+b:b;c=c<10?'0'+c:c;return e+':'+b+':'+c}}}});Ext.define('ABP.view.session.subMenu.SubMenuController',{extend:'Ext.app.ViewController',alias:'controller.submenucontroller',subOptionClick:function(c){var a=this;var d=a.getView();var b=c.eventArgs;if(b){a.fireEvent('featureCanvas_showSetting',b);a.fireEvent('session_closeMenu');d.destroy()}}});Ext.define('ABP.view.base.popUp.ShowByPopUp',{});Ext.define('ABP.view.session.toolbarTop.ToolbarTopBaseController',{extend:'Ext.app.ViewController',requires:['ABP.view.base.popUp.ShowByPopUp'],listen:{controller:{'*':{toolbar_addbutton:'addButton',toolbar_addRPButton:'addRPButton',toolbar_addSearchButton:'addSearchButton',toolbar_openSearch:'openSearchBar',toolbar_removeButton:'removeButton',toolbar_removeMenuButton:'removeMenuButton',toolbar_setTitle:'setTitle',toolbar_showBranding:'showBranding',toolbar_setupConfig:'__processConfiguration',toolbar_setOverrideTitle:'setOverrideTitle',toolbar_updateButtonIcon:'updateButtonIcon',toolbar_setVisibilityRightPaneButton:'setVisibilityRightPaneButton',toolbar_removePressedCls:'__removePressedCls',toolbar_addPressedCls:'__addPressedCls',toolbar_updateBadge:'__updateBadge',toolbar_incrementBadge:'__incrementBadge',toolbar_decrementBadge:'__decrementBadge',toolbar_clearBadge:'__clearBadge',toolbar_findRightPaneButton:'__findRightPaneButton'}}},toggleMenu:function(){this.fireEvent('session_toggleMenu')},toggleRightPane:function(){this.fireEvent('session_toggleRightPane')},toggleRightPaneButton:function(a){this.fireEvent('rightPane_toggleTab',a.panelConfig,a.pressed)},handleRightPaneKeyPress:function(b,a){this.fireEvent('rightPane_handleKeyPress',b,a)},openSearchBar:function(){var a=this;var b=a.getViewModel();b.set('searchBar.open',!0);if(Ext.toolkit==='modern'){this.fireEvent('session_closeMenu')}},__processConfiguration:function(b){var d=this;var a=0;var c;for(a=0;a<b.length;++a){var c=function(){this.fireEvent(b[a].event,b[a].eventArgs)};if(b[a].side===''||b[a].side===undefined||b[a].side===null){b[a].side='right'}d.addButton(b[a])}},buttonId:0,addButton:function(a,f,e,c){var b=this;var d=null;if(a.uniqueId){d=b.getButton(a.uniqueId)}if(c){d=b.getButton(c)}if(!d){if(a.appId){b.addProperButton(a)}else {b.addLegacyButton(a,f,e,c)}}},addProperButton:function(a){var b=this;var g=b.getView();var e=b.makeIconString(a.icon);var f=a.uniqueId===null||a.uniqueId===undefined?ABP.util.IdCreator.getId(a):a.uniqueId;var c;var d;if(!a.side){a.side='right'}if(a.side==='left'){c=g.down('#tool-buttons-left');d={xtype:'button',cls:'tool-button-right toolbar-button a-toolbar-'+a.icon,bind:{height:'{toolbarHeight}'},command:a.event,uiCls:['dark'],eventArgs:a.eventArgs,uniqueId:f,iconCls:e,focusCls:'',overCls:'toolbar-button-over',handler:a.type==='event'?b.buttonEventHandler:b.makeHandler(a.eventArgs),pressedCls:'toolbar-button-pressed'};c.add(d)}else {if(a.side==='right'||a.side==='right-right'){c=g.down('#tool-buttons-right');d={xtype:'button',cls:'tool-button-right toolbar-button a-toolbar-'+a.icon,bind:{height:'{toolbarHeight}'},command:a.event,eventArgs:a.eventArgs,uiCls:['dark'],uniqueId:f,iconCls:e,focusCls:'',overCls:'toolbar-button-over',handler:a.type==='event'?b.buttonEventHandler:b.makeHandler(a.eventArgs),pressedCls:'toolbar-button-pressed'};if(a.side==='right'){c.addButton(d)}else {c.add(d)}}}},addLegacyButton:function(h,f,e,d){var j=this;var b;var a;var i=j.getView();var g=j.makeIconString(f);var k=d?d:this.buttonId++;var c;if(e==='toggleRightPane'){c=e}else {c=Ext.isFunction(e)?e:j.makeHandler(e)}if(h==='right'){b=i.down('#tool-buttons-right');a={xtype:'button',cls:'tool-button-right toolbar-button a-toolbar-'+f,bind:{height:'{toolbarHeight}'},uiCls:['dark'],uniqueId:d,iconCls:g,focusCls:'',overCls:'searchbar-button-over',handler:c,pressedCls:'toolbar-button-pressed'};if(k==='rpButton'){a.itemId=k}else {a.bind={hidden:'{nonControlButtonsHidden}'}}b.addButton(a)}else {if(h==='right-right'){b=i.down('#tool-buttons-right');a={xtype:'button',cls:'tool-button-right toolbar-button a-toolbar-'+f,bind:{height:'{toolbarHeight}'},uniqueId:d,iconCls:g,focusCls:'',overCls:'searchbar-button-over',handler:c,bind:{hidden:'{nonControlButtonsHidden}'},pressedCls:'toolbar-button-pressed'};b.add(a)}else {if(h==='left'){b=i.down('#tool-buttons-left');a={xtype:'button',cls:'tool-button-left toolbar-button a-toolbar-'+f,bind:{height:'{toolbarHeight}'},uniqueId:d,iconCls:g,handler:c,bind:{hidden:'{nonControlButtonsHidden}'},pressedCls:'toolbar-button-pressed'};b.add(a)}}}},addSearchButton:function(){var c=this;var b=c.getView();var a=b.down('#tool-buttons-right');if(ABP.util.Common.getModern()){a.add({xtype:'button',cls:'tool-button-right toolbar-button a-toolbar-searchButton',uniqueId:'tbSearchButton',iconCls:'icon-magnifying-glass toolbar-icon',enableToggle:!0,bind:{pressed:'{searchBar.open}'},pressedCls:'toolbar-button-pressed'})}else {a.addButton({xtype:'searchbar',flex:1})}},addRPButton:function(a){if(a&&a.icon){this.addButton('right',a.icon,'toggleRightPane','rpButton')}},getButton:function(c){var g=this;var d=g.getView();var e=d.down('#tool-buttons-left');var f=d.down('#tool-buttons-right');var b=null;var a=f.down('[uniqueId='+c+']');if(a){b=a}else {a=e.down('[uniqueId='+c+']');if(a){b=a}}return b},removeButton:function(d){var f=this;var e=f.getView();var b=e.down('#tool-buttons-left');var c=e.down('#tool-buttons-right');var a=c.down('[uniqueId='+d+']');if(a){c.remove(a)}else {a=b.down('[uniqueId='+d+']');if(a){b.remove(a)}}},removeMenuButton:function(){var d=this;var c=d.getView();var a=c.down('#tool-buttons-left');var b=c.down('#toolbar-button-menu');if(b&&a){a.remove(b)}},updateButtonIcon:function(c,h){var e=this;var d=e.getView();var b=e.makeIconString(h);var f=d.down('#tool-buttons-left');var g=d.down('#tool-buttons-right');var a=g.down('[uniqueId='+c+']');if(a){a.setIconCls(b)}else {a=f.down('[uniqueId='+c+']');if(a){a.setIconCls(b)}}},makeIconString:function(a){var c=a;var b=a;b=b.split('-');c=b[0]==='fa'?'x-fa '+a:a;return c+' toolbar-icon'},buttonEventHandler:function(){var a=this;a.up('toolbartop').getController().fireEvent(a.command,a.eventArgs)},makeHandler:function(a){var b=function(b){var c=Ext.Viewport.add({xtype:'abpshowbypopup',items:[{xtype:a}]});c.showBy(b)};return b},setTitle:function(a){var b=this;b.__setSpecificTitle(a,'toolbarTitle')},showBranding:function(a){var b=this,c=b.getViewModel();c.set('conf.settings.toolbarTitleShowBranding',a)},setOverrideTitle:function(a){var b=this;b.__setSpecificTitle(a,'overrideTitle')},__setSpecificTitle:function(b,d){var e=this,a=e.getViewModel(),c=a.getFormulas();b=b||'';if(a.get('i18n.'+b)){c[d]={bind:'{i18n.'+b+'}',get:function(a){return a}};a.setFormulas(c);a.notify()}else {c[d]={get:function(a){return b}};a.setFormulas(c);a.notify();a.set(d,b)}this.centerLabel(this.getView())},onResizeToolbar:function(b,a){var c=this;var d=c.getViewModel();this.centerLabel(b,a)},onAfterLayout:function(a,c,b){this.centerLabel(a)},toolbarTitleImageClick:function(c,a){var b=this;b.fireEvent('toolbartop_logoclick',a)},toolbarTitleImageContainerBeforeRender:function(b){var c=this,d=c.getViewModel(),a=d.get('conf.toolbarTitleImageUrl');if(a){b.setHtml('<img class="toolbar-title-image" src="'+Ext.String.htmlEncode(Ext.resolveResource(a))+'" alt="">')}},privates:{centerLabel:function(g){var i=this;var a=g.down('#toolbarTitle');if(!a||!a.text){return}var j=i.getViewModel(),f=a.getX(),h=j.get('conf.settings.toolbarTitleShowBranding'),d;if(!h){var e=g.down('#toolbarTitleContainer'),b;if(e){b=e.getX()}else {b=0}if(f!==b){a.setX(b)}}else {var c=a.getWidth();if(c===0){c=ABP.util.Common.measureTextSingleLine(a.text,ABP.util.Constants.BASE_FONT).width}d=(Ext.getViewportWidth()-c)/2;if(f!==d){a.setX(d)}}}}});Ext.define('ABP.view.session.toolbarTop.ToolbarTopModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.toolbartopmodel',data:{title:'',overrideTitle:undefined,toolbarHeight:44,toolCls:'',nonControlButtonsHidden:!1,userMenu:[],now:Date.now(),showEnv:!0,imageWidth:null},formulas:{micro:{get:function(){var d;var c;var a;var b=!1;if(ABP.util.Common.getModern()){d=ABP.util.Common.getWindowWidth();c=ABP.util.Common.getWindowHeight();a=this.get('smallScreenThreshold');if(d<=a||c<=a){b=!0}}this.setToolSize(b);return b}},toolbarBrandingCls:{bind:{_brand:'{mainMenuTopLabel}'},get:function(a){var b='toolbar-top-title';if(a._brand){if(a._brand.length<=7){b='toolbar-top-title'}else {if(a._brand.length>7&&a._brand.length<10){b='toolbar-top-title-med'}else {b='toolbar-top-title-sm'}}}return b}},toolbarTitle:{bind:{_title:'{title}',_override:'{overrideTitle}'},get:function(a){var b=a._title;if(a._override){b=a._override;this.set('nonControlButtonsHidden',!0)}else {this.set('nonControlButtonsHidden',!1)}return b}},toolbarTitleImageUrl:{bind:{_toolbarTitleImageUrl:'{conf.toolbarTitleImageUrl}'},get:function(a){return Ext.isEmpty(a._toolbarTitleImageUrl)?null:a._toolbarTitleImageUrl}},toolbarTitleBrandImageShow:{bind:{_toolbarTitleShowBranding:'{conf.settings.toolbarTitleShowBranding}'},get:function(a){return this.get('toolbarTitleImageUrl')&&a._toolbarTitleShowBranding!==!1}},toolbarTitleBrandNameShow:{bind:{_toolbarTitleShowBranding:'{conf.settings.toolbarTitleShowBranding}'},get:function(a){return !this.get('toolbarTitleImageUrl')&&a._toolbarTitleShowBranding!==!1}},mainMenuTopLabel:{bind:{_bootstrapConf:'{bootstrapConf.branding.companyName}'},get:function(b){var a='';if(b._bootstrapConf){a=b._bootstrapConf}else {a='APTEAN'}return a}},username:{get:function(){var d=ABP.util.Config.getUsername();var a=(((a||'')+'').toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join('');var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,b=/\x3c!--[\s\S]*?--\x3e|<\?(?:php)?[\s\S]*?\?>/gi;return d.replace(b,'').replace(c,function(b,c){return a.indexOf('<'+c.toLowerCase()+'>')>-1?b:''}).replace('/>','').trim()}},loggedInTime:{bind:{_loginTime:'{loginTime}',_now:'{now}'},get:function(d){var a=d._now-d._loginTime;a=Math.floor(a/1000);var e=Math.floor(a/3600);var b=Math.floor(a%3600/60);var c=a%60;b=b<10?'0'+b:b;c=c<10?'0'+c:c;return e+':'+b+':'+c}},environmentName:{bind:{_selected:'{selected.environment}',_envStore:'{main_environmentStore}'},get:function(b){var a=b._selected;var c;if(b._envStore&&b._selected){c=b._envStore.getById(b._selected);if(c&&c.data&&c.data.name){a=c.data.name}}else {this.set('showEnv',!1)}if(a&&a.length>25){a=a.slice(0,24)+'...'}return a}}},setToolSize:function(b){var a=this;if(b){a.set('toolbarHeight',40);a.set('toolCls','tool-top micro-tool-top')}else {a.set('toolbarHeight',44);a.set('toolCls','tool-top')}}});Ext.define('ABP.view.session.toolbarTop.search.SearchBarController',{extend:'Ext.app.ViewController',alias:'controller.searchbarcontroller',listen:{controller:{'*':{searchBar_close:'__closeToButton',searchBar_openIn:'__openInBar',abp_searchBar_toggleKey:'onToggleKeyPressed',abp_search_suggestions:'onUpdatedSuggestions'}}},pendingRequests:0,loadTask:null,initViewModel:function(a){this.callParent(a);this.initSuggestions();this.loadTask=new Ext.util.DelayedTask(this.fireLoadRequest,this)},toggleSearchButtonPressed:function(){var b=this;var e=b.getViewModel();var d=b.getView();var c=e.get('searchBar.open');var a=d.down('#searchbarSearchButton');if(c){a.removeCls('x-btn-pressed')}else {a.addCls('x-btn-pressed')}},onSearchClick:function(j){var a=this;var n=a.getView();var k=n.lookupReference('searchbarSearchField');var m=k.isVisible();var g=a.getViewModel();var b,h,e;var c=ABP.Config.canGlobalSearchToggle();var i=!Ext.isEmpty(j)?j.shortcut:!1;if(c===!1&&i){Ext.defer(function(a){a.focus()},1,a,[k])}else {if(c!==!1){a.toggleSearchButtonPressed()}}if(m){a.hideSuggestions();var d=g.get('selectedSuggestion');if(d){b=d.get('text');h=d.get('hierarchy');e=d.get('instanceId')}else {b=g.get('searchBar.val').trim()}if(b.length===0||i){return}var f=a.getSearchProvider();if(a.checkStringLength(b,f)){args=b;if(e){args=[b,e]}a.fireEvent('main_fireAppEvent',f.data.appId,f.data.event,args)}if(c===!0){a.__closeToButton()}var l=g.getStore('recentSearches');l.append(f,b,h,e)}else {if(c===!0){a.expandSearchBar()}}},onSearchFieldKeyDown:function(a){var c=this;var b=a.getKey();if(b===a.DOWN){c.moveSelectedSearchResult(1);a.stopEvent()}else {if(b===a.UP){c.moveSelectedSearchResult(-1);a.stopEvent()}}},__openInBar:function(){var b=this;var a=b.getView();var e=b.getViewModel();var d=a.down('#searchbarTypeButton');var c=a.down('#searchbarSearchField');b.fireEvent('toolbar_setOverrideTitle',' ');a.setWidth('475');a.addCls('searchbaropen')},__closeToButton:function(d){var a=this;var b=a.getView();var c=a.getViewModel();var e=c.get('searchBar.open');var f=b.down('#searchbarSearchField');if(e){a.fireEvent('toolbar_setOverrideTitle');b.setWidth(45);b.removeCls('searchbaropen');if(!d){f.setValue()}a.toggleSearchButtonPressed();c.set('searchBar.open',!1);a.hideSuggestions()}},onFocusLeave:function(){this.__closeToButton()},onSearchFieldFocus:function(){this.showSuggestions()},onEscKey:function(){this.__closeToButton()},onEnterKey:function(){var e=this;var h=Ext.get('GlobalSuggestionPopup').component;var c=h.getComponent('searchPopupDataview');var d=c.all.elements;var f=d.length;var a;for(var b=0;b<f;b++){var i=d[b];if(i.className.includes('x-item-selected')){a=c.store.getAt(b);break}else {a=null}}if(Ext.isEmpty(a)){e.onSearchClick()}else {var g;e.onSuggestionClick(g,a)}},onJumpToKey:function(){this.fireEvent('abp_jumpto_show')},onSwitchProviderDown:function(){this.switchProvider(1)},onSwitchProviderUp:function(){this.switchProvider(-1)},onProviderClick:function(a){this.focusSearchField();this.setSearch(a.searchId)},onSuggestionClick:function(f,c,i,h,j,g){var b=this;var d=b.getView();var e=b.getViewModel();var a=d.down('#searchbarSearchField');a.setValue(c.data.text);e.set('selectedSuggestion',c);a.suspendEvent('focus');b.onSearchClick();a.suspendEvent('focus')},onSearchFieldChange:function(h,d,g){var a=this;a.refreshSuggestions(d);var j=a.getViewModel();var i=a.getView();var f=!0;var b=a.getSearchProvider();if(!b||!b.data||!b.data.suggestionEvent){return}var c=d.trim();if(c.length>=b.data.suggestionThreshold){this.loadTask.delay(200,this.fireLoadRequest,this,[b,c])}else {this.loadTask.cancel();a.removeCustomSuggestions()}var e=a.pendingRequests>0;a.showSuggestions(e)},privates:{onUpdatedSuggestions:function(g,i,b,e){var a=this;a.pendingRequests=Math.max(a.pendingRequests-1,0);var h=a.getViewModel();var f=h.get('searchBar.selectedSearch');if(f!==g){return}if(!b||b.length===0){return}var c=a.getStore('suggestions');var d=[];Ext.Array.each(b,function(a){if(c.findExact('text',a.text)<0){d.push({text:a.text,hierarchy:a.hierarchy,instanceId:a.instanceId,timestamp:0,count:1,isRecent:!1})}});c.loadData(d,!0);a.refreshSuggestions(undefined,e)},refreshSuggestions:function(b,f){var e=this;var c=e.getViewModel();var a=c.getStore('suggestions');if(b===undefined){b=c.get('searchBar.val')}b=b.trim();a.clearFilter();if(f){try{ABP.util.Common.removeCaseInsensitiveDuplicates(a,'text')}catch(i){ABPLogger.logDebug(i)}}var d=[];if(b!=''){filterFunction=ABP.util.filters.Factory.createStringFilter(b,[{name:'text',useSoundEx:!1},{name:'hierarchy',useSoundEx:!1}],!0,1);a.filter({id:'TextFilter',filterFn:filterFunction});d.push({property:'_relevance',direction:'DESC'})}d.push({property:'timestamp',direction:'DESC'});a.sort(d);var g=ABP.util.filters.Factory.createTopNFilter(e.getRecentLength());a.filter({id:'TopNFilter',filterFn:g});if(a.count()===0){return}e.showSuggestions();var h=c.get('selectedSuggestion');if(a.indexOf(h)===-1){c.set('selectedSuggestion',null)}},removeCustomSuggestions:function(){var c=this;var d=c.getViewModel();var a=d.getStore('suggestions');var b=[];a.each(function(a){if(!a.data.isRecent){b.push(a)}});a.remove(b)},getRecentLength:function(){var a=this.getSearchProvider();if(a){return a.get('recents')}else {return 0}},getSearchProvider:function(){var c=this.getViewModel();var a=c.get('searchBar.selectedSearch');var b=Ext.StoreMgr.get('searchStore');return b.getById(a)},moveSelectedSearchResult:function(f){var g=this;var d=g.getViewModel(),h=g.getView();var e=d.get('selectedSuggestion');var c=d.getStore('suggestions');var a=-1;if(e){a=c.indexOf(e);a=a+f}else {a=0;if(f<0){a=c.getCount()-1}}var b=c.getAt(a);d.set('selectedSuggestion',b);if(b){ABP.util.Aria.setActiveDecendant(h.down('#searchbarSearchField'),b.id)}else {ABP.util.Aria.setActiveDecendant(h.down('#searchbarSearchField'),'')}},focusSearchField:function(){var b=this;var a=b.getView().down('#searchbarSearchField');if(!a.hidden){a.focus()}},switchProvider:function(e){var c=this;var f=c.getViewModel();var b=Ext.StoreMgr.get('searchStore');var d=f.get('searchBar.selectedSearch');var a=b.indexOfId(d);a=a+e;a=a<0?b.count()-1:a;a=a>=b.count()?0:a;c.setSearch(b.getAt(a))},initSuggestions:function(){var a=this;var f=a.getViewModel();var d=f.get('searchBar.selectedSearch');var e=a.getStore('recentSearches');var b=a.getStore('suggestions');b.clearFilter();var c=[];e.each(function(a){if(a.data.searchId==d){c.push({text:a.data.text,hierarchy:a.data.hierarchy,instanceId:a.data.instanceId,timestamp:a.data.timestamp,count:a.data.count,isRecent:!0})}});b.loadData(c);a.setSelectedSuggestionId('');a.refreshSuggestions('')},setSearch:function(a){if(typeof a==='string'){var d=Ext.StoreMgr.get('searchStore');a=d.getById(a)}if(!a){return}var b=this;var c=b.getViewModel();c.set('searchBar.selectedSearch',a.id);c.set('searchBar.selectedSearchCls',a.get('icon'));ABP.util.LocalStorage.setForLoggedInUser('DefaultSearch',a.id);b.initSuggestions()},showSuggestions:function(b){var e=this;var g=e.getViewModel();var d=this.getView();var a=d.down('#GlobalSuggestionPopup');a.alignTarget=c;if(b===undefined){b=e.pendingRequests>0}a.setMessage(null);a.setLoading(b);if(a.isVisible()){return}var f=g.getStore('recentSearches');if(f.count()===0&&!b){return}var c=d.down('#searchbarSearchField');Ext.Function.defer(function(a,c){if(!a.isVisible()){return}c.setWidth(a.getWidth());c.showBy(a,'bl');this.setSelectedSuggestionId('');ABP.util.Aria.setExpanded(a,!0);a.focus()},200,this,[c,a])},hideSuggestions:function(){var b=this.getView();var a=b.down('#GlobalSuggestionPopup');if(a){a.hide()}this.pendingRequests=0;if(this.loadTask){this.loadTask.cancel()}var c=b.down('#searchbarSearchField');ABP.util.Aria.setExpanded(c,!0)},ensureSuggestionsHidden:function(){var a=this;var b=a.getView();if(b.hidden===!1){a.hideSuggestions()}},setSelectedSuggestionId:function(d){var e=this;var b=e.getViewModel();var a=b.getStore('suggestions');if(a.count()===0){return}var c=a.find('id',d);if(c!==-1){b.set('selectedSuggestion',a.getAt(c))}else {b.set('selectedSuggestion',null)}},checkStringLength:function(d,a){var e=this;var c=d.trim();var b=!1;if(a&&a.data.minLength){if(c.length>=a.data.minLength){b=!0}else {if(a.data.minLengthError){ABP.view.base.popUp.PopUp.showError(a.data.minLengthError)}}}return b},expandSearchBar:function(){var a=this;var c=a.getViewModel();var b=c.getStore('recentSearches');if(!b.isLoaded()){b.load()}this.initSuggestions();a.__openInBar();c.set('searchBar.open',!0);a.focusSearchField()},onToggleKeyPressed:function(b){var a=this;if(b){a.setSearch(b)}var d=a.getViewModel();var c=d.get('searchBar.open');if(!c){a.onSearchClick({shortcut:!0})}},fireLoadRequest:function(a,c){var b=this;var a=b.getSearchProvider();if(b.fireEvent(a.data.appId+'_'+a.data.suggestionEvent,{searchId:a.id,text:c})){b.pendingRequests++;b.showSuggestions(!0)}},getSuggestions:function(){var b=this;var d=b.getView();var a=d.lookupReference('searchbarSearchField');var c=a.value;b.onSearchFieldChange(a,c)}}});Ext.define('ABP.view.session.toolbarTop.search.SearchBarViewModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.searchbarmodel',requires:['ABP.model.SearchModel','ABP.store.ABPRecentSearchStore'],data:{selectedSuggestion:null},stores:{recentSearches:{xclass:'ABP.store.ABPRecentSearchStore'},suggestions:{model:'ABP.model.Suggestion',sortOnLoad:!0,sorters:{property:'timestamp',direction:'DESC'}}},formulas:{emptyText:{bind:{_preSearch:'{i18n.search_searchText}',_selectedSearch:'{searchBar.selectedSearch}'},get:function(a){return a._preSearch+' '+a._selectedSearch}},modernWidth:{get:function(){var a=475;if(ABP.util.Common.getSmallScreen()){a='100%'}return a}},modernDock:{get:function(){var a=null;if(ABP.util.Common.getSmallScreen()){a='top'}return a}},selectedSearchTextLS:{bind:{__selectedSearch:'{searchBar.selectedSearch}'},get:function(d){var b;var c=ABP.util.Common.getModern();var a='';if(c){b=ABP.util.Common.getSmallScreen();if(!b){a=d.__selectedSearch}}return a}},showBarMenuButton:{bind:{__open:'{searchBar.open}',__menu:'{searchBar.menuOptions}'},get:function(a){return a.__open&&a.__menu.length>1}},showDropMenuButton:{bind:{__menu:'{searchProviders}'},get:function(a){var b=!1;if(a.__menu.getCount()<2){return !0}return b}}}});Ext.define('ABP.view.launch.loading.Loading',{extend:'Ext.container.Container',alias:'widget.loadingscreen',componentCls:'launch-canvas',layout:{type:'vbox',align:'center',pack:'center'},height:'100%',width:'100%',cls:'ABP-preauth-loading',items:[{xtype:'container',height:140,layout:{type:'vbox',align:'center'},items:[{xtype:'component',html:'<div class="login-hdr"></div>',focusable:!1},{xtype:'component',cls:'bootstrap-loading',flex:1,hidden:'{hidePreAuthMessage}',html:'Connecting<div class="bootstrap-loading-dot1">.</div><div class="bootstrap-loading-dot2">.</div><div class="bootstrap-loading-dot3">.</div>'}]}]});Ext.define('ABP.view.main.ABPMain',{extend:'Ext.container.Container',xtype:'app-main',requires:['ABP.view.main.ABPMainModel','ABP.view.main.ABPMainController','ABP.view.launch.loading.Loading'],controller:'abpmaincontroller',viewModel:'abpmainmodel',layout:{type:'fit'},items:[{xtype:'loadingscreen'}],listeners:{click:{element:'el',fn:function(){ABP.util.Common.setKeyboardNavigation(!1)}}}});Ext.define('ABP.view.main.ABPMain',{extend:'Ext.Container',controller:'abpmaincontroller',viewModel:{type:'abpmainmodel'},xtype:'app-main',items:[{xtype:'login'}]});Ext.define('ABP.view.base.components.ExpandPanel',{extend:'Ext.window.Window',requires:['ABP.view.base.components.ExpandPanelViewModel'],alias:'widget.abpexpandpanel',cls:'baseexpandpanel',bodyCls:'x-unselectable',floating:!0,modal:!0,config:{parentComponent:undefined,desiredWidth:500,desiredHeight:400,closeKeymap:undefined,fullscreenContainer:undefined,fullscreen:!1},bumper:20,animationDuration:250,origin:{x:0,y:0,height:100,width:100},tools:[],listeners:{beforeclose:function(){var a=this;if(a.waitForAnimation){var b=a.getParentComponent();if(!b){return}var d=b.getPosition();var c=b.getSize();a.animate({duration:a.animationDuration,to:{x:d[0],y:d[1],width:c.width,height:c.height},callback:function(){a.waitForAnimation=!1;a.close()}});return !1}},beforedestroy:function(){var a=this;a.syncResizeEvents()}},constructor:function(a){a=a||{};a.maxWidth=Ext.getBody().getViewSize().width-this.bumper;a.maxHeight=Ext.getBody().getViewSize().height-this.bumper;if(!a.parentComponent){ABP.util.Logger.logError("'parentComponent' not included in config.",'The parent component must be passed into the base expand panel.')}this.callParent([a])},initComponent:function(){var a=this;a.callParent();var b=a.getParentComponent();if(b){var d=b.getPosition();var c=b.getSize();a.setPosition(d[0],d[1]);a.setWidth(c.width);a.setHeight(c.height)}a.show();a.syncResizeEvents()},show:function(){var a=this;a.callParent();var b=a.getTargetTo();a.animate({duration:a.animationDuration,to:b})},privates:{waitForAnimation:!0,monitoringResize:!1,updateFullscreen:function(b,c){var a=this;if(b){a.setMaxWidth(null);a.setMaxHeight(null);if(a.resizer){a.resizer.disable()}}if(c!==undefined){a.syncResizeEvents();this.onViewportResize()}},syncResizeEvents:function(){var a=this;unbind=a.hidden||a.destroying||a.destroyed;if(a.monitoringResize){Ext.un('resize',a.onViewportResize,a);if(a.fullscreenContainer&&a.fullscreen){a.fullscreenContainer.un('resize',a.onViewportResize,a)}a.monitoringResize=!1;if(unbind){return}}if(a.fullscreenContainer&&a.fullscreen){a.fullscreenContainer.on('resize',a.onViewportResize,a,{buffer:1})}else {Ext.on('resize',a.onViewportResize,a,{buffer:1})}a.monitoringResize=!0},getTargetTo:function(){var a=this;var b={width:0,height:0};if(a.getFullscreenContainer()){b=a.getFullscreenContainer().getSize()}else {b=Ext.getBody().getViewSize();b.width-=a.bumper;b.height-=a.bumper}var e=Math.min(a.desiredWidth,b.width);var d=Math.min(a.desiredHeight,b.height);var c={x:Math.ceil((b.width-e)/2),y:Math.ceil((b.height-d)/2),width:e,height:d};if(a.fullscreen){var g=a.container.getSize();c.x=0;c.y=0;if(a.fullscreenContainer){var f=a.fullscreenContainer.getPosition();c.x=f[0];c.y=f[1]}c.width=b.width;c.height=b.height}else {c.x+=a.bumper/2;c.y+=a.bumper/2}return c},onViewportResize:function(){var a=this;var b=a.getTargetTo();a.animate({duration:a.animationDuration/2,to:b})}}});Ext.define('ABP.view.base.rightpane.RightPanePanel',{extend:'Ext.panel.Panel',alias:'widget.baserightpanepanel',cls:'abp-right-panel',header:{title:{ariaRole:'header',ariaAttributes:{'aria-level':'3'}}},scrollable:'vertical',focusableContainer:!0,activeMenuButton:null,initComponent:function(){var a=this;var b=ABP.util.Common.geti18nString('button_close');a.tools=(a.tools||[]).concat([{type:'close',automationCls:'rightpanel-btn-close',handler:'baseRightPanePanel_toggleRightPane',tooltip:b}]);this.callParent()},showScrollShadow:function(){this.addCls('abp-scrolled')},hideScrollShadow:function(){this.removeCls('abp-scrolled')}});Ext.define('ABP.view.buttons.BadgeButton',{extend:'Ext.button.Button',xtype:'abpbadgebutton',config:{badgeValue:null,badgePriority:ABP.util.Constants.badgePriority.Info},__delayedTaskUpdateBadge:null,childEls:['badgeEl'],getTemplateArgs:function(){var a=this.callParent(arguments);var c=this,b=c.getBadgeData();Ext.apply(a,b);return a},getBadgeData:function(){var a=this;return {badgeValue:a.getBadgeValue(),badgePriority:a.getBadgePriority()}},renderTpl:'<span id="{id}-btnWrap" data-ref="btnWrap" role="presentation" unselectable="on" style="{btnWrapStyle}" '+'class="{btnWrapCls} {btnWrapCls}-{ui} {splitCls}{childElCls}">'+'<span id="{id}-btnEl" data-ref="btnEl" role="presentation" unselectable="on" style="{btnElStyle}" '+'class="{btnCls} {btnCls}-{ui} {textCls} {noTextCls} {hasIconCls} '+'{iconAlignCls} {textAlignCls} {btnElAutoHeightCls}{childElCls}">'+'<span id="{id}-badgeEl" data-ref="badgeEl" class="abp-badge"'+'style="<tpl if="Ext.isEmpty(badgeValue)">display: none;</tpl><tpl if="badgePriority != undefined">background-color: {badgePriority};</tpl>">'+'{badgeValue}'+'</span>'+'<tpl if="iconBeforeText">{[values.$comp.renderIcon(values)]}</tpl>'+'<span id="{id}-btnInnerEl" data-ref="btnInnerEl" unselectable="on" '+'class="{innerCls} {innerCls}-{ui}{childElCls}">{text}</span>'+'<tpl if="!iconBeforeText">{[values.$comp.renderIcon(values)]}</tpl>'+'</span>'+'</span>'+'{[values.$comp.getAfterMarkup ? values.$comp.getAfterMarkup(values) : ""]}'+'<tpl if="closable">'+'<span id="{id}-closeEl" data-ref="closeEl" class="{baseCls}-close-btn">'+'<tpl if="closeText">'+' {closeText}'+'</tpl>'+'</span>'+'</tpl>'+'<tpl if="split">'+'<span id="{id}-arrowEl" class="{arrowElCls}" data-ref="arrowEl" '+'role="button" hidefocus="on" unselectable="on"'+'<tpl if="tabIndex != null"> tabindex="{tabIndex}"</tpl>'+'<tpl foreach="arrowElAttributes"> {$}="{.}"</tpl>'+' style="{arrowElStyle}"'+'>{arrowElText}</span>'+'</tpl>',updateBadgeValue:function(a,b){var c=!1;a>b;if(Ext.isNumber(a)){a=parseInt(a);if(a<0){return}this.badgeValue=a;c=a>b}else {this.badgeValue=null}this.updateBadge(c)},updateBadgePriority:function(c,a){var b=a&&c!=a;this.updateBadge(b)},updateBadge:function(b){var a=this;a.removeCls('animate-notify');a.removeCls('animate-spin');a.removeCls('animate-grow');if(Ext.isEmpty(a.__delayedTaskUpdateBadge)){a.__delayedTaskUpdateBadge=new Ext.util.DelayedTask(a.doUpdateBadge,a,[b])}a.__delayedTaskUpdateBadge.delay(100,null,null,[b])},incrementBadge:function(a){var b=this;var c=b.getBadgeValue();if(c==null&&!a){b.setBadgeValue(1)}if(Ext.isNumber(a)){a=parseInt(a);if(a<0){return}b.setBadgeValue(c+a)}else {b.setBadgeValue(++c)}},decrementBadge:function(a){var c=this;var b=c.getBadgeValue();if(b==null){return}if(Ext.isNumber(a)){a=parseInt(a);if(a<0){return}else {if(a>=b){c.setBadgeValue(null)}else {c.setBadgeValue(b-a)}}}else {if(b===1){c.setBadgeValue(null)}else {c.setBadgeValue(--b)}}},clearBadge:function(){var a=this;a.setBadgeValue(null)},doUpdateBadge:function(e){var d=this;var a=d.getBadgeData(),b=d.badgeEl,c=b?b.dom:null;if(!c||Ext.isEmpty(c)){return}if(e===!0){d.addCls('animate-notify')}else {if(e){d.addCls('animate-'+e)}}if(!Ext.isNumber(a.badgeValue)){a.badgeValue=parseInt(a.badgeValue);if(isNaN(a.badgeValue)===!0){b.hide();return}}if(a.badgeValue>99){c.innerHTML='99+'}else {c.innerHTML=a.badgeValue}if(!Ext.isEmpty(a.badgeValue)){if(!b.isVisible()){b.show()}}else {b.hide()}if(a.badgePriority!=undefined){if(a.badgePriority!==ABP.util.Constants.badgePriority.Alert&&a.badgePriority!==ABP.util.Constants.badgePriority.Warning&&a.badgePriority!==ABP.util.Constants.badgePriority.Success&&a.badgePriority!==ABP.util.Constants.badgePriority.Info){ABP.util.Logger.logWarn(a.badgePriority+' is an invalid badge priority, hiding badge. Please use one of the ABP.util.Constants.badgePriority values');b.hide()}b.setStyle({'background-color':a.badgePriority})}}});Ext.define('ABP.view.components.LoadingLine',{extend:'Ext.Component',alias:'widget.abploadingline',cls:'abp-loading-line',height:1,hideMode:'offsets',html:'<span class="bar1"></span><span class="bar2"></span><span class="bar3"></span><span class="bar4"></span><span class="bar5"></span><span class="bar6"></span><span class="bar7"></span><span class="bar8"></span><span class="bar9"></span><span class="bar10"></span>'});Ext.define('ABP.view.components.ProfileImage',{extend:'Ext.Container',alias:'widget.abpprofileimage',config:{displayName:null,src:null,icon:'icon-user'},baseCls:'abp-profile-picture',layout:'fit',referenceHolder:!0,defaults:{top:0,left:0,height:'100%'},items:[{xtype:'component',reference:'initials',cls:'abp-profile-picture-icon',html:''},{xtype:'image',reference:'image',cls:'abp-profile-picture-image',hidden:!0,listeners:{element:'el',error:function(){this.component.lookupReferenceHolder().showImage(!1)}}}],initComponent:function(){var a=this;a.callParent();a.lookup('initials').addCls(a.getIcon())},updateSrc:function(){this.renderVisuals()},updateDisplayName:function(){this.renderVisuals()},renderVisuals:function(){var a=this;var b=a.lookup('image');var c=a.lookup('initials');if(a.getSrc()){b.setSrc(a.getSrc());a.showImage(!0)}else {b.setSrc(null);a.showImage(!1)}},showImage:function(a){var b=this;b.lookup('image').setVisible(a);b.lookup('initials').setVisible(!a)}});Ext.define('ABP.view.components.aria.HeaderComponent',{extend:'Ext.Component',alias:'widget.abpheadercomponent',ariaRole:'header',ariaAttributes:{'aria-level':'2'}});Ext.define('ABP.view.components.panel.HeaderPanelBase',{extend:'Ext.Panel',alias:'widget.abpheaderpanel',closable:!1,scrollable:!0,header:{},items:[],config:{isFavorite:null},showBack:!1,backHandler:Ext.emptyFn,showFavorite:!1,showFilter:!1,filterDelay:undefined,filterThreshold:1,filterEmptyText:'{i18n.abp_filter_empty_text:htmlEncode}',listeners:{beforedestroy:function(){if(this.filterTask){this.filterTask.cancel();this.filterTask=null}}},constructor:function(a){a=a||{};a.header=a.header;if(a.header!==!1){var b=a.header||this.header;a.header=Ext.isObject(b)?Ext.clone(b):b}this.callParent([a])},initComponent:function(){var a=this;a.cls=(a.cls||'')+' abp-header-panel';if(a.items.length>0){a.initScrollListener()}a.initHeaderBar();a.callParent();if(this.filterDelay&&this.filterDelay>0){this.filterTask=new Ext.util.DelayedTask(this.fireFilterRequest,this)}},close:function(){var a=this;a.fireEvent('abpHeaderPanel_closeView',a);a.destroy()},showBackButton:function(){var b=this,a=b.down('#backButton');if(a){a.show()}},hideBackButton:function(){var b=this,a=b.down('#backButton');if(a){a.hide()}},showFavoriteButton:function(){var b=this;var a=b.down('#favoriteButton');if(a){a.show()}},hideFavoriteButton:function(){var b=this;var a=b.down('#favoriteButton');if(a){a.hide()}},privates:{favIconOn:'icon-favorite-full',favIconOff:'icon-favorite-empty',filterTask:null,updateIsFavorite:function(c){var b=this;if(!b.rendered){return}var a=b.lookupReference('favoriteButton');if(!a){return}if(c){a.setIconCls(b.favIconOn);a.setBind({tooltip:'{i18n.button_unfavorite:htmlEncode}'})}else {a.setIconCls(b.favIconOff);a.setBind({tooltip:'{i18n.button_favorite:htmlEncode}'})}},initScrollListener:function(){var c=this;var a=c.getScrollable();var b=c;if(a){a.on('scroll',function(c,d,a){if(a>6){b.addCls('abp-scrolled')}else {b.removeCls('abp-scrolled')}})}},filterField:function(){var a=this;if(ABP.util.Common.getClassic()||Ext.os.deviceType!=='Phone'){return {xtype:'textfield',itemId:'headerFilter',flex:3,maxWidth:300,minWidth:200,margin:'0px 5px 0px 0px',reference:'headerFilter',bind:{value:'{headerFilterValue}',emptyText:a.filterEmptyText},keyMap:{ESC:function(){this.setValue('')}},listeners:{change:a.onFilterChanged,scope:a}}}},initHeaderBar:function(){var a=this;if(a.showFilter){if(a.header&&a.header.items){a.header.items.unshift(a.filterField())}else {var b={userCls:'header-input-fields',items:[a.filterField()]};a.header=b}}return},onSwitchFavorite:function(){var c=this;var d=Ext.getApplication().getMainView().getController().activeAppId;var e=ABP.util.PluginManager.getPluginInstance(d);var a;if(e.getViewConfig){a=e.getViewConfig();if(a){var b=c.getController();if(!b){b=c.up('featurecanvas').getController()}if(c.isFavorite){if(typeof a==='string'||a instanceof String){b.fireEvent(ABP.Events.menuRemoveFavorite,d,a)}else {if(a.uniqueId){b.fireEvent(ABP.Events.menuRemoveFavorite,a.appId,a.uniqueId)}else {var g=ABP.util.IdCreator.getId(a);b.fireEvent(ABP.Events.menuRemoveFavorite,a.appId,g)}}c.setIsFavorite(!1)}else {if(typeof a==='string'||a instanceof String){var f=ABP.util.Common.getMenuItem(d,a,!1);if(f){b.fireEvent(ABP.Events.menuAddFavorite,f);c.setIsFavorite(!0)}}else {b.fireEvent(ABP.Events.menuAddFavorite,a);c.setIsFavorite(!0)}}}}},onFilterChanged:function(c,a,b){if(this.filterTask){if(a.length>=this.filterThreshold){this.filterTask.delay(this.filterDelay,this.fireFilterRequest,this,[c,a,b])}else {this.filterTask.cancel();this.fireFilterRequest(c,'',b)}}else {this.fireFilterRequest(c,a,b)}},fireFilterRequest:function(c,a,b){this.fireEvent('abp_header_filterChange',c,a,b)},beforeRender:function(){var a=this;a.callParent();if(a.showBack){a.getHeader().insert(0,{xtype:'tool',itemId:'backButton',iconCls:'icon-fa-arrow-left',callback:a.backHandler,bind:{tooltip:'{i18n.button_back:htmlEncode}'}})}if(a.showFavorite){if(!Ext.isBoolean(a.isFavorite)){var e=Ext.getApplication().getMainView().getController().activeAppId;var d=ABP.util.PluginManager.getPluginInstance(e);var b;if(d.getViewConfig){b=d.getViewConfig();if(b){var c;if(typeof b==='string'||b instanceof String){c=b}else {if(b.uniqueId){c=b.uniqueId}else {c=ABP.util.IdCreator.getId(b)}}if(c){var f=ABP.util.Common.isFavorite(e,c);a.isFavorite=f}}}}a.getHeader().add({xtype:'tool',itemId:'favoriteButton',reference:'favoriteButton',iconCls:a.isFavorite?a.favIconOn:a.favIconOff,callback:a.onSwitchFavorite,scope:a,bind:{tooltip:a.isFavorite?'{i18n.button_unfavorite:htmlEncode}':'{i18n.button_favorite:htmlEncode}'}})}}}});Ext.define('ABP.view.control.ABPLoggingPopupController',{extend:'Ext.app.ViewController',alias:'controller.loggingpopup',config:{clearLogsClickCount:0},constructor:function(){this.callParent()},onCloseClick:function(){var a=this;a.getView().closePanel()},onClickClearLogs:function(){var a=this;var b=a.getView();if(a.getClearLogsClickCount()>0){ABP.util.Logger.clearLogs();b.closePanel()}else {b.down('#clearLogsButtonContainer').add({xtype:'component',cls:'loggingpanel-button-text',html:'Clear Logs'});a.setClearLogsClickCount(1)}},onClickSave:function(){var a=this;a.getView().closePanel()}});Ext.define('ABP.view.control.ABPLoggingPopup',{extend:'Ext.panel.Panel',requires:['ABP.view.control.ABPLoggingPopupController','ABP.util.Logger'],alias:'widget.loggingpopup',controller:'loggingpopup',cls:'loggingpanel',bodyCls:'loggingpanel-body x-unselectable',floating:!0,modal:!0,maxHeight:Ext.getBody().getViewSize().height-10,maxWidth:Ext.getBody().getViewSize().width-10,title:'Log Viewer',config:{closeKeymap:undefined},tools:[{type:'mytool',cls:'loggingpanel-close-tool',renderTpl:function(){return '<i class="icon-delete"></i>'},handler:'onCloseClick'}],dockedItems:[{xtype:'toolbar',cls:'loggingpanel-toolbar',dock:'bottom',defaults:{cls:'loggingpanel-button'},items:['->',{xtype:'container',itemId:'clearLogsButtonContainer',layout:{type:'hbox',align:'stretch'},items:[{xtype:'component',cls:'loggingpanel-button-icon',html:'<i class="icon-garbage-can"></i>'}],listeners:{el:{click:'onClickClearLogs'}}},{xtype:'container',itemId:'saveWidgetButtonContainer',layout:{type:'hbox',align:'stretch'},items:[{xtype:'component',cls:'loggingpanel-button-icon',html:'<i class="icon-check"></i>'}],listeners:{el:{click:'onClickSave'}}}]}],initComponent:function(){var a=this;var b=Ext.getBody().getViewSize().width;b=b-20;a.items=[{xtype:'abptextarea',value:ABP.util.Logger.getLogs(),spellcheck:!1,inputAttrTpl:['autocomplete="off" wrap="off"'],height:Ext.getBody().getViewSize().height-110,width:b}];a.callParent();a.show();a.setCloseKeymap(Ext.getBody().addKeyListener(Ext.event.Event.ESC,a.onESC,a))},onESC:function(){var a=this;Ext.destroy(a.getCloseKeymap());a.closePanel()},closePanel:function(){var a=this;a.close()}});Ext.define('ABP.view.session.accessibility.JumpToBar',{extend:'Ext.Container',requires:['ABP.view.session.accessibility.JumpToBarController','ABP.view.session.accessibility.JumpToBarViewModel'],dock:'top',alias:'widget.jumptobar',xtype:'jumptobar',controller:'jumptobar',viewModel:'jumptobar',layout:{type:'hbox',align:'stretch',pack:'center'},cls:'jump-to-bar',padding:4,height:40,hideMode:'offsets',hidden:!0,tabIndex:0,listeners:{focusenter:'onFocusEnter',focusleave:'onFocusLeave',show:'onShow'},items:[{xtype:'combobox',itemId:'JumpToCombo',bind:{store:'{targets}',fieldLabel:'{i18n.toolbar_jumpTo:htmlEncode}',emptyText:'{i18n.toolbar_placeinapplication:htmlEncode}'},queryMode:'local',displayField:'text',labelWidth:245,labelAlign:'right',forceSelection:!0,flex:1,maxWidth:500,listeners:{select:'onSelection'}},{xtype:'component',cls:'jump-to-help',componentCls:'x-unselectable',html:'press <span>ALT</span>+<span>/</span> to show this menu',tabIndex:-1,flex:1}]});Ext.define('ABP.view.session.help.HelpTile',{extend:'Ext.container.Container',alias:'widget.helptile',layout:{type:'vbox',align:'center'},config:{title:'',links:[]},minHeight:220,cls:'abphelptile-tilebody',items:[{xtype:'component',itemId:'abp-helptile-title',cls:'abphelptile-title',width:'90%'},{xtype:'container',width:'100%',layout:{type:'vbox',align:'center'},cls:'abphelptile-links',itemId:'abp-helptile-body'}],constructor:function(a){var c=this;var e=c.items;c.setTitle(a.title);c.setLinks(a.links);var d=[];for(var b=0;b<a.links.length;++b){d.push({xtype:'button',uiCls:'abp-link',cls:'link_link'+' a-help-link-'+a.links[b].product.replace(' ','-')+'-'+a.links[b].type.replace(' ','-'),text:a.links[b].name,url:a.links[b].link,handler:'linkClick'})}e[1].items=d;e[0].html=Ext.htmlEncode(a.title);c.callParent(a)}});Ext.define('ABP.view.session.help.HelpView',{extend:'ABP.view.components.panel.HeaderPanelBase',alias:'widget.helpview',requires:['ABP.view.session.help.HelpController','ABP.view.session.help.HelpViewModel','ABP.view.session.help.HelpTile'],controller:'helpcontroller',viewModel:{type:'helpviewviewmodel'},bind:{title:'{i18n.help_title:htmlEncode}'},layout:{type:'vbox',pack:'start'},cls:'x-unselectable help-container',closable:!0,items:[{xtype:'container',minHeight:200,width:'100%',cls:'help_aptean_header',layout:{type:'vbox',align:'middle',pack:'center'},items:[{xtype:'component',width:250,height:40,itemId:'help-aptean-logo',cls:'help_aptean_logo'},{xtype:'label',width:'50%',cls:'help_aptean_text',bind:{text:'{i18n.help_text:htmlEncode}'},flex:1}]},{xtype:'container',reference:'abp-help-tile-container',cls:'abp-help-tile-container',width:'100%',defaultType:'helptile'}],initComponent:function(){var a=this;a.callParent();a.getViewModel().LoadStoreData();a.fireEvent('helpview_intialLoad')}});Ext.define('ABP.view.session.about.AboutViewModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.about',requires:[],data:{appTitle:''}});Ext.define('ABP.view.session.about.AboutItem',{extend:'Ext.container.Container',alias:'widget.aboutitem',layout:{type:'vbox',pack:'center',align:'center'},cls:'x-unselectable about-item-container',config:{showIcon:undefined,icon:undefined,name:undefined,version:undefined,build:undefined,detail:undefined,copyright:undefined},minHeight:120,initComponent:function(){var a=this;var b='';a.items=[];if(a.getShowIcon()){if(a.getIcon()){a.items.push({xtype:'component',cls:'about-item-icon icon-'+a.getIcon()})}else {a.items.push({xtype:'component',cls:'about-item-icon icon-gearwheel'})}}a.items.push({xtype:'component',cls:'about-item-title',html:a.getName()});if(a.getVersion()){a.items.push({xtype:'component',cls:'about-item-text',bind:{html:'{i18n.about_version:htmlEncode} '+a.getVersion()}})}if(a.getBuild()){a.items.push({xtype:'component',cls:'about-item-text',bind:{html:'{i18n.about_build:htmlEncode} '+a.getBuild()}})}if(a.getCopyright()){a.items.push({xtype:'component',cls:'about-item-text',html:a.getCopyright()})}if(a.getDetail()){b='a-about-'+a.getName().replace(' ','-');a.items.push({xtype:'component',cls:'about-item-detail'+' '+b,bind:{html:'{i18n.about_detail:htmlEncode}'},listeners:{el:{click:function(){ABP.view.base.popUp.PopUp.customPopup(a.getDetail(),a.getName())}}}})}a.callParent()}});Ext.define('ABP.view.session.about.About',{extend:'ABP.view.components.panel.HeaderPanelBase',alias:'widget.about',requires:['ABP.view.session.about.AboutViewModel','ABP.view.session.about.AboutController','ABP.view.session.about.AboutItem','ABP.view.control.ABPLoggingPopup'],controller:'about',viewModel:{type:'about'},bind:{title:'{i18n.about_title:htmlEncode}'},layout:{type:'vbox'},cls:'x-unselectable about-container',closable:!0,minWidth:300,items:[{xtype:'container',layout:{type:'hbox'},width:'100%',cls:'about-section-header-container',items:[{xtype:'component',flex:1,cls:'about-section-header-side'},{xtype:'component',bind:{html:'{i18n.about_applications:htmlEncode}'},cls:'about-section-header'},{xtype:'component',flex:1,cls:'about-section-header-side'}]},{xtype:'container',width:'100%',cls:'about-section about-section-top',layout:{type:'vbox',align:'center'},items:[{xtype:'component',bind:{html:'{i18n.about_info:htmlEncode}'},cls:'about-section-info',width:'100%'},{xtype:'container',cls:'about-tile-container',width:'100%',itemId:'aboutAppsList',items:[]}]},{xtype:'container',layout:{type:'hbox'},width:'100%',cls:'about-section-header-container',items:[{xtype:'component',flex:1,cls:'about-section-header-side'},{xtype:'component',bind:{html:'{i18n.about_thirdparty:htmlEncode}'},cls:'about-section-header'},{xtype:'component',flex:1,cls:'about-section-header-side'}]},{xtype:'container',width:'100%',cls:'about-section about-section-bottom',itemId:'aboutThirdPartySection',layout:{type:'vbox',align:'center'},items:[{xtype:'container',cls:'about-tile-container',width:'100%',itemId:'aboutThirdPartyList',items:[]}]}]});Ext.define('ABP.view.session.logger.LoggerPage',{extend:'ABP.view.components.panel.HeaderPanelBase',alias:'widget.loggerpage',requires:['ABP.util.Logger','ABP.view.session.logger.LoggerController','ABP.view.session.logger.LoggerViewModel'],controller:'loggerpagecontroller',viewModel:{type:'loggerviewmodel'},bind:{title:'{i18n.logger_title:htmlEncode}'},layout:{type:'vbox',align:'stretch',pack:'center'},closable:!0,showFilter:!0,listeners:{abp_header_filterChange:'onFilterChanged'},header:{items:[{xtype:'combo',bind:{store:'{severity}'},flex:2,minWidth:200,maxWidth:300,itemId:'loggerSeverity',hideLabel:!0,displayField:'display',valueField:'value',editable:!1,forceSelection:!0,autoSelect:!0,value:'ALL',listeners:{change:'severityChanged'}}]},cls:'about-container',height:'100%',width:'100%',tools:[{itemId:'clearLog',iconCls:'icon-garbage-can',callback:'clearClicked',bind:{tooltip:'{i18n.logger_clear:htmlEncode}'}}],items:[{xtype:'dataview',store:'ABPLoggingStore',autoScroll:!1,margin:'8 0 8 0',itemSelector:'.log-item',scrollable:'y',flex:1,bind:{emptyText:'<div class="no-log-items">{i18n.logger_nothingtodisplay}</div>'},itemTpl:['<div class="log-item {level:this.cls(values,parent[xindex-2],xindex-1,xcount)}">'+'{date:this.formatDate(values,parent[xindex-2],xindex-1,xcount)}'+'<div class="time-wrap">'+'<div class="log-item-abrev abp-logger-{level}" title="{level}">{level:this.firstChar}</div>'+'{time:this.formatTime(values,parent[xindex-2],xindex-1,xcount)}'+'</div>'+'<div class="line-wrap">'+'<div class="contents-wrap">'+'<label class="abp-logger-{level}">{level}</label>'+'<span class="message">{message}</span'+'<span class="detail">{detail}</span>'+'</div>'+'</div>'+'</div>',{cls:function(f,e,d,b,c){var a='';if(!b){a+=' timeline-item-first'}if(b>c-2){a+=' timeline-item-last'}return a},firstChar:function(a){return a.charAt(0).toUpperCase()},formatTime:function(f,c,b,e,d){var a=this.formatIfDifferent(c,b,'H:i:s');if(a){return '<div class="log-item-time">'+a+'</div>'}return ''},formatDate:function(f,c,b,e,d){var a=this.formatIfDifferent(c,b,'j F Y');if(a){return '<div class="timeline-epoch">'+a+'</div>'}return ''},formatIfDifferent:function(c,b,f){var a=b&&(b.isModel?b.data:b)['time'];var e=c&&(c.isModel?c.data:c)['time'];e=new Date(e);var d=Ext.Date.format(e,f);if(!a){return d}a=new Date(a);var g=Ext.Date.format(a,f);if(d===g){return ''}return d}}]}]});Ext.define('ABP.view.session.toolbarTop.ToolbarTopController',{extend:'ABP.view.session.toolbarTop.ToolbarTopBaseController',alias:'controller.toolbartopcontroller',init:function(){this.callParent();this.checkMenuButton();this.constructRightPane()},checkMenuButton:function(){var d=this,c=d.getView(),b=ABP.util.Config.getSessionConfig();if(!b.settings.startMenuHidden){var a=c.down('#toolbar-button-menu');if(a){a.addCls('toolbar-toggled')}}},constructRightPane:function(e){var l=this,q=l.getView(),p=q.up('sessioncanvas').getViewModel(),c,f,d=[],j=ABP.util.Config.getSessionConfig(),m=ABP.util.Config.getDisplayNameInitials(),n=ABP.util.Config.getProfilePicture(),r=j.settings.notifications.enabled,h=null,g=j.settings.rightPane,i=ABP.util.Config.config.rightPaneTabs,k='';for(c=0;c<g.length;c++){for(f=0;f<i.length;f++){var o=g[c];if(Ext.isObject(g[c])){o=g[c].name}if(o===i[f].name){d.push(i[f]);break}}}if(!e){e=q.down('#rightpaneButtons')}if(p){p.set('rightPaneTabs',d)}if(Ext.isArray(d)&&d.length>0){for(c=0;c<d.length;c++){var a=d[c];var b={xtype:'abpbadgebutton',itemId:a.uniqueId,ariaRole:'menu',ariaAttributes:{'aria-expanded':!1},iconCls:a.icon+' toolbar-icon',cls:k+' a-toolbar-rpsegment-'+a.uniqueId,uiCls:['dark'],scale:'large',hidden:a.invisible===!0?!0:a.hidden,invisible:a.invisible,panelConfig:a,handler:'toggleRightPaneButton',keyMapEnabled:!0,keyMap:{DOWN:'handleRightPaneKeyPress'}};if(a.tooltipKey){b.bind={tooltip:'{i18n.'+a.tooltipKey+':htmlEncode}',ariaLabel:'{i18n.'+a.tooltipKey+':ariaEncode}'}}else {if(a.tooltip){b.tooltip=a.tooltip;b.ariaLabel=a.tooltip}}e.add(b);l.fireEvent('rightpane_tabadded',a.uniqueId,a)}}if(r){h={name:'abp-notifications',uniqueId:'abp-notifications',xtype:'abp-notifications',clearBadgeOnActivate:j.settings.notifications.clearBadgeOnActivate};e.add({xtype:'abpbadgebutton',itemId:'abp-notifications',ariaRole:'menu',ariaAttributes:{'aria-expanded':!1},iconCls:'icon-bell toolbar-icon',cls:k+' a-toolbar-rpsegment-abp-notifications',uiCls:['dark'],scale:'large',panelConfig:h,handler:'toggleRightPaneButton',bind:{tooltip:'{i18n.abp_notifications_rightpane_title:htmlEncode}',ariaLabel:'{i18n.abp_notifications_rightpane_title:ariaEncode}'},keyMapEnabled:!0,keyMap:{DOWN:'handleRightPaneKeyPress'}});l.fireEvent('rightPane_initTab','abp-notifications',h)}var b={xtype:'abpbadgebutton',ariaRole:'menu',ariaAttributes:{'aria-expanded':!1},itemId:'abp-settings',ariaRole:'menu',iconCls:'',cls:k+' a-toolbar-rpsegment-abp-settings',uiCls:['dark'],scale:'large',tabIndex:0,panelConfig:{name:'abp-settings',uniqueId:'abp-settings',xtype:'settingscontainer'},handler:'toggleRightPaneButton',icon:n,bind:{icon:'{profilePhoto}',tooltip:'{i18n.sessionMenu_settings:htmlEncode}',ariaLabel:'{i18n.sessionMenu_settings:ariaEncode}'},keyMapEnabled:!0,keyMap:{DOWN:'handleRightPaneKeyPress'}};if(n){b.cls+=' toolbar-initials-button'}else {if(m){b.text=m;b.cls+=' toolbar-initials-button'}else {b.iconCls='icon-user toolbar-icon'}}e.add(b)},setVisibilityRightPaneButton:function(d,c){var f=this,e=f.getView(),b=e.down('#rightpaneButtons'),a;if(b){a=b.down('#'+d);if(a){if(c===!0){if(a.config&&!a.config.invisible){a.show()}}else {if(c===!1){a.hide()}}}}},__removePressedCls:function(){var c=this,b=c.getView(),a=b.down('#rightpaneButtons');if(a){a.cascade(function(a){if(a.xtype==='segmentedbutton'){return}a.setPressed(!1)})}},__addPressedCls:function(c){var b=this;b.__removePressedCls();var a=b.__findRightPaneButton(c);if(a){a.setPressed(!0)}},__findRightPaneButton:function(c){var e=this,d=e.getView(),b=d.down('#rightpaneButtons'),a;if(b){a=b.down('#'+c)}if(!a){ABP.util.Logger.logWarn('Could not find right pane button '+c)}return a},privates:{__updateBadge:function(c,a){var d=this;var b=d.__findRightPaneButton(c);if(Ext.isNumber(a)){a={value:a}}if(b){if(a.value){b.setBadgeValue(a.value)}if(a.priority){b.setBadgePriority(a.priority)}if(a.icon){b.setIconCls(a.icon+' toolbar-icon');if(a.animate){b.updateBadge(a.animate)}}}},__incrementBadge:function(b,c){var d=this;var a=d.__findRightPaneButton(b);if(a){a.incrementBadge(c)}},__decrementBadge:function(b,c){var d=this;var a=d.__findRightPaneButton(b);if(a){a.decrementBadge(c)}},__clearBadge:function(b){var c=this;var a=c.__findRightPaneButton(b);if(a){a.clearBadge()}}}});Ext.define('ABP.view.session.toolbarTop.ToolbarItem',{extend:'Ext.button.Button',alias:'widget.toolbarbutton',config:{ico:'',uniqueId:'',command:'',args:'',enabled:!0,tooltip:'',tooltipKey:'',type:'',appId:'',button:'default'},cls:'toolbar-menu-btn ',overCls:'toolbar-menu-btn-over',handler:function(b,a){if(a.type==='click'){this.clickItem()}else {this.enterItem()}},initComponent:function(){var a=this;var d=a.enabled?'':' toolbar-menu-disabled';var b=a.ico;b=b.split('-');var c=b[0]==='fa'?b[0]+' '+a.ico:'oCol'+' '+a.ico;a.cls=a.cls+c+d;a.tooltip=null;a.tooltipKey=null;a.callParent(arguments)},clickItem:function(){if(this.enabled){this.fireEvent('toolbar_click',this,!0)}},enterItem:function(){if(this.enabled){this.fireEvent('toolbar_click',this,!1)}},enableButton:function(){var a=this;a.enabled=!0;a.removeCls('toolbar-menu-disabled');var b=a.ico;b=b.split('-');var c=b[0]==='fa'?b[0]+' '+a.ico:'oCol'+' '+a.ico;a.setHtml('<i class="'+c+'"></i>');a.focusable=!0},disableButton:function(){var a=this;a.enabled=!1;a.addCls('toolbar-menu-disabled');a.focusable=!1}});Ext.define('ABP.view.session.toolbarTop.search.SearchPopup',{extend:'Ext.container.Container',alias:'widget.searchpopup',floating:!0,hidden:!0,tabIndex:0,cls:'abp-popup-list',items:[{xtype:'dataview',itemId:'searchPopupDataview',tabIndex:0,overItemCls:'abp-popup-item-highlight',bind:{store:'{suggestions}',selection:'{selectedSuggestion}'},tpl:['<tpl for=".">','<div class="abp-popup-list-outer">','<div class="abp-popup-list-searched">{text:htmlEncode}</div>','<div class="abp-popup-list-hierarchy">{hierarchy:htmlEncode}</div>','</div>','</tpl>'],itemSelector:'div.abp-popup-list-outer',listeners:{itemclick:'onSuggestionClick'}},{xtype:'component',itemId:'loading',html:'<div class="abp-loadmask loading-bars"><div class="bars slim"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div> </div></div>'},{xtype:'label',cls:'searchpopupmessage',itemId:'message',hidden:!0,html:null}],setLoading:function(a){if(a){this.down('#loading').show()}else {this.down('#loading').hide()}},setMessage:function(b){var a=this.down('#message');a.setHtml(b);if(Ext.isEmpty(b)){a.hide()}else {a.show()}}});Ext.define('ABP.view.session.toolbarTop.search.SearchBar',{extend:'Ext.container.Container',alias:'widget.searchbar',requires:['ABP.view.session.toolbarTop.search.SearchBarController','ABP.view.session.toolbarTop.search.SearchBarViewModel','ABP.view.session.toolbarTop.search.SearchPopup'],controller:'searchbarcontroller',viewModel:{type:'searchbarmodel'},width:45,bind:{height:'{toolbarHeight}'},listeners:{focusleave:'onFocusLeave'},cls:'searchbar',layout:{type:'hbox',align:'center',pack:'end'},items:[{xtype:'abpbutton',itemId:'searchbarTypeButton',scale:'large',uiCls:['dark'],hidden:!0,bind:{menu:'{searchBar.menuOptions}',iconCls:'{searchBar.selectedSearchCls}',hidden:'{!showBarMenuButton}',ariaLabel:'{i18n.button_search}'},height:44},{xtype:'textfield',itemId:'searchbarSearchField',reference:'searchbarSearchField',cls:'searchbar-searchfield a-searchbar-searchfield',inputAttrTpl:'spellcheck="false"',ariaRole:'combobox',hidden:!0,hideLabel:!0,bind:{emptyText:'{emptyText}',ariaLabel:'{emptyText}',hideLabel:!0,hidden:'{!searchBar.open}',value:'{searchBar.val}'},height:32,width:225,enableKeyEvents:!0,listeners:{change:'onSearchFieldChange',focus:'onSearchFieldFocus',show:function(){this.focus()},el:{keydown:'onSearchFieldKeyDown'},hide:'ensureSuggestionsHidden'},keyMap:{ESC:'onEscKey',ENTER:'onEnterKey','CTRL+DOWN':'onSwitchProviderDown','CTRL+UP':'onSwitchProviderUp','ALT+191':{alt:!0,fn:'onJumpToKey',defaultEventAction:'stopPropagation'}},ariaAttributes:{'aria-owns':'GlobalSuggestionPopup','aria-controls':'GlobalSuggestionPopup','aria-haspopup':'listbox','aria-expanded':'false','aria-autocomplete':'list','aria-activedescendant':''}},{xtype:'searchpopup',id:'GlobalSuggestionPopup'},{xtype:'abpbutton',itemId:'searchbarAdvancedButton',focusCls:'',overCls:'searchbar-button-over',cls:'searchbar-button a-searchbar-advancedbutton',height:44,bind:{text:'{i18n.search_advanced:htmlEncode}',ariaLabel:'{i18n.search_advanced}'},hidden:!0}],initComponent:function(){var b=this;var c=b.items;var f=ABP.Config.canGlobalSearchToggle();if(f===!1){var h=c.length-1;for(var d=0;d<h;d++){var a=c[d];if(a.hidden){a.hidden=!1}if(a.bind){var i=a.bind;if(i.hidden){delete a.bind.hidden}}if(a.itemId==='searchbarSearchField'){var g=a.listeners;g.focus='getSuggestions';a.triggers={search:{cls:'icon-magnifying-glass',automationCls:'global-search-trigger',handler:'onSearchClick'}}}}b.callParent();var e=b.getController();e.__openInBar()}else {c.push({xtype:'abpbutton',itemId:'searchbarSearchButton',uiCls:['dark'],iconCls:'icon-magnifying-glass',scale:'large',bind:{tooltip:'{i18n.sessionMenu_search:htmlEncode}',ariaLabel:'{i18n.search_toggle}',ariaExpanded:'{searchBar.open}'},height:44,width:45,handler:'onSearchClick'});b.callParent()}}});Ext.define('ABP.view.session.toolbarTop.ToolbarTop',{extend:'Ext.container.Container',alias:'widget.toolbartop',requires:['ABP.view.session.toolbarTop.ToolbarTopController','ABP.view.session.toolbarTop.ToolbarTopModel','ABP.view.session.toolbarTop.ToolbarItem','ABP.view.session.toolbarTop.search.SearchBar','ABP.view.buttons.BadgeButton'],controller:'toolbartopcontroller',viewModel:{type:'toolbartopmodel'},ariaRole:'menubar',currentFocus:-1,focusable:!0,dock:'top',bind:{height:'{toolbarHeight}'},ariaLabel:'Toolbar',ui:'abp-toolbar',layout:'hbox',autoEl:'header',items:[{xtype:'container',align:'left',layout:{type:'hbox'},itemId:'tool-buttons-left',docked:'left',cls:'left-cont',items:[{xtype:'abpbutton',automationCls:'toolbar-main-menu',uiCls:['dark'],cls:'tool-button-left abp-icon-button',ariaLabel:'{i18n.toolbar_toggleNavigation:ariaEncode}',scale:'large',ariaAttributes:{'aria-owns':'main-navigation-menu'},bind:{height:'{toolbarHeight}',ariaLabel:'{i18n.toolbar_toggleNavigation:ariaEncode}',ariaExpanded:'{menuOpen}',tooltip:'{i18n.toolbar_toggleNavigation:htmlEncode}'},iconCls:'icon-menu',itemId:'toolbar-button-menu',handler:'toggleMenu'},{xtype:'component',itemId:'toolbar-top-title',width:205,bind:{html:'{mainMenuTopLabel}',cls:'{toolbarBrandingCls}',height:'{toolbarHeight}',hidden:'{!toolbarTitleBrandNameShow || toolbarTitleBrandImageShow}'},cls:'toolbar-top-title',setCls:function(a){this.addCls(a)}},{xtype:'container',cls:'toolbar-title-image-container',overCls:'mouse-over',layout:'fit',width:205,bind:{height:'{toolbarHeight}',hidden:'{!toolbarTitleBrandImageShow}'},listeners:{beforerender:'toolbarTitleImageContainerBeforeRender',el:{click:'toolbarTitleImageClick'}}}]},{xtype:'container',itemId:'toolbarTitleContainer',flex:1,ariaRole:'banner',ariaAttributes:{'aria-labelledby':'toolbarTitle'},items:[{xtype:'component',autoEl:'h1',itemId:'toolbarTitle',id:'toolbarTitle',cls:'toolbar-title',bind:{html:'{toolbarTitle}',height:'{toolbarHeight}'}}]},{xtype:'container',align:'right',layout:{type:'hbox',align:'end',pack:'end'},itemId:'tool-buttons-right',docked:'right',cls:'right-cont',items:[],bind:{height:'{toolbarHeight}'},addButton:function(a){var b=this;b.insert(0,a)}},{xtype:'segmentedbutton',itemId:'rightpaneButtons',bind:{height:'{toolbarHeight}'},defaults:{userCls:'button-dark-contrast'},allowMultiple:!1,allowDepress:!0,items:[]}],listeners:{resize:'onResizeToolbar',afterlayout:'onAfterLayout'}});Ext.define('ABP.view.session.mainMenu.MenuItem',{extend:'Ext.container.Container',alias:'widget.menubutton',requires:['ABP.view.session.mainMenu.MenuItemModel'],viewModel:{type:'menuitemmodel'},config:{icon:'',uniqueId:'',title:'',labelKey:'',labelVal:'',tabId:'',command:'',args:'',enabled:!0,tooltip:'',tooltipKey:'',shorthand:'',type:'',children:'',place:'',appId:''},cls:'menu-item mi-Body',ui:'menuitem',uiCls:'dark',overCls:'x-hover',layout:{type:'hbox',align:'center'},height:41,bind:{width:'{menuWidth}'},afterRender:function(){var a=this;var b='';var c;a.callParent();a.getEl().dom.onclick=a.onMenuItemClick;if(a.tooltip&&a.tooltip!==''){b=a.tooltip}if(a.tooltipKey&&a.tooltipKey!==''){c=ABP.util.Common.geti18nString(a.tooltipKey);if(c!==a.tooltipKey){b=c}}if(b!==''){a.tooltip=Ext.create('Ext.tip.ToolTip',{target:a.getId(),text:b,cls:'tooltip-mm',listeners:{beforeshow:function(e,f){var a=e.currentTarget;var c=Array.from(a.dom.children);var d=c.reduce(function(a,b){return a+b.offsetWidth},0);var b=d>=a.getWidth();return b}}})}},initComponent:function(){var a=this;var c='';var d=a.icon.split('-');var b=[];if(a.icon&&a.icon[0]!=='{'&&(a.title&&a.title[0]!=='{')){c=d[0]==='fa'?'fa '+a.icon:a.icon;if(!a.labelKey){a.cls=a.cls+' a-menu-unsafe-'+a.title.replace(/[^A-Za-z]/g,'');a.labelVal=a.title}else {a.cls=a.cls+' a-menu-'+a.labelKey.replace(/_/g,'-')}b.push({xtype:'component',itemId:'miIcon',html:'<i class="'+c+'"></i>',cls:'mi-icon-micro',bind:{cls:'{classicMenuExpand}'},setCls:function(a){if(a){this.removeCls('icon-expanded')}else {this.addCls('icon-expanded')}}})}else {b.push({xtype:'component',itemId:'miIcon',cls:'mi-icon-micro',bind:{cls:'{classicMenuExpand}',html:'<i class="'+a.icon+'"></i>'},setCls:function(a){if(a){this.removeCls('icon-expanded')}else {this.addCls('icon-expanded')}}})}b.push({xtype:'component',itemId:'miTitle',bind:{hidden:'{!classicMenuExpand}',html:a.labelKey?'{i18n.'+a.labelKey+'}':a.title},cls:'mi-title-micro'});if(a.shorthand){b.push({xtype:'component',itemId:'miShorthand',html:a.shorthand,cls:'mi-shorthand',ariaAttributes:{'aria-hidden':'true'}})}a.items=b;a.ariaRole='menuitem';a.ariaLabel='Main Menu '+a.title;a.callParent(arguments)},listeners:{el:{keydown:function(a,b){if(this.component.config.labelKey!=='sessionMenu_signoff'){if(a.getKey()===a.ENTER||a.getKey()===a.RIGHT){this.component.onMenuItemSelect()}}else {if(a.getKey()===a.ENTER){this.component.onMenuItemSelect()}}c: this}}},onMenuItemClick:function(){var a=Ext.getCmp(this.id);a.fireEvent('miItemClick',a,!0)},onMenuItemSelect:function(){var a=this;a.fireEvent('miItemClick',a,!1)},setSelected:function(a){if(a){this.addCls('mi-body-selected')}else {this.removeCls('mi-body-selected')}},isSelected:function(){return this.hasCls('mi-body-selected')},setLabelVal:function(b){if(this.items&&b!==''){var a=this.checkLabel(b);this.labelVal=a;this.down('#miTitle').setHtml(Ext.String.htmlEncode(a))}else {if(this.items){this.down('#miTitle').setHtml(Ext.String.htmlEncode(this.title))}else {this.labelVal=this.title}}},checkLabel:function(f){var d=this;var h=70;var e=[];var b;var a;var c='';var g=f;if(h>140){b=f.split(' ');if(b.length>2){c=b[0];for(a=1;a<b.length;a++){if(ABP.util.Common.measureTextSingleLine(c+b[a]+' ').width*1.25<140){c=c+' '+b[a]}else {break}}e[0]=c;e[1]=b[a];for(a++;a<b.length;a++){e[1]=e[1]+' '+b[a]}if(ABP.util.Common.measureTextSingleLine(e[1],'Arial').width*1.25<140){g=e[0]+'<br>'+e[1];d.down('#miTitle').addCls('mi-double');d.addCls('mi-double')}else {c=e[1][0];for(a=1;a<e[1].length;++a){if(ABP.util.Common.measureTextSingleLine(c+e[1][a]+'...','Arial').width*1.25<140){c=c+e[1][a]}else {break}}g=e[0]+'<br>'+c+'...';d.down('#miTitle').addCls('mi-double');d.addCls('mi-double')}}else {if(b.length===2){if(ABP.util.Common.measureTextSingleLine(b[0],'Arial').width*1.25<140){g=b[0]+'<br>'+b[1];d.down('#miTitle').addCls('mi-double');d.addCls('mi-double')}else {d.down('#miTitle').removeCls('mi-double');d.removeCls('mi-double')}}else {for(a=0;a<f.length;a++){if(ABP.util.Common.measureTextSingleLine(c+f[a],'Arial').width*1.25<140){c=c+f[a]}else {break}}b[0]=f.slice(0,a-1);b[1]=f.slice(a-1);if(ABP.util.Common.measureTextSingleLine(b[1],'Arial').width*1.25<140){g=b[0]+'-<br>'+b[1];d.down('#miTitle').addCls('mi-double');d.addCls('mi-double')}else {c=b[1][0];for(a=1;a<b[1].length;++a){if(ABP.util.Common.measureTextSingleLine(c+b[1][a]+'...','Arial').width*1.25<140){c=c+b[1][a]}else {break}}g=b[0]+'-<br>'+c+'...';d.down('#miTitle').addCls('mi-double');d.addCls('mi-double')}}}}else {d.down('#miTitle').removeCls('mi-double');d.removeCls('mi-double')}return g}});Ext.define('ABP.view.session.mainMenu.MenuItemUserModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.menuitemusermodel',data:{userDisplay:''}});Ext.define('ABP.view.session.mainMenu.MenuItemUserController',{extend:'Ext.app.ViewController',alias:'controller.menuitemusercontroller',init:function(){this.startTime=Date.now()},onRenderUser:function(d){var c=this;var b=c.getViewModel();var f=Ext.create('Ext.tip.Tip',{html:'',cls:'user-tip',margin:'0 0 0 0',color:'#fff',shadow:!1});var e=ABP.util.Config.getEnvironment();Ext.each(b.get('bootstrapConf.availableEnvironments'),function(a){if(a&&a.id===e){e=a.name;return !1}});var h=function(){var a=b.get('i18n.sessionMenu_user')+' '+b.get('userDisplay')+'&nbsp;&nbsp;&nbsp;&nbsp;'+b.get('i18n.sessionMenu_environment')+' '+e+'&nbsp;&nbsp;&nbsp;&nbsp;'+b.get('i18n.sessionMenu_time')+c.getUseTime();f.update(a);f.showAt(c.getView().getX()+150,c.getView().getY())};var g=function(){f.hide()};d.getEl().on('mouseover',h);d.getEl().on('mouseout',g);d.getEl().on('touchstart',h);d.getEl().on('touchend',g);var a=b.get('conf.settings.userClick');if(a&&a.appId&&a.event){d.getEl().on('click',function(){c.fireEvent('main_fireAppEvent',a.appId,a.event,a.eventArgs)})}},getUseTime:function(){var a=Date.now()-this.startTime;a=Math.floor(a/1000);var d=Math.floor(a/3600);var b=Math.floor(a%3600/60);var c=a%60;b=b<10?'0'+b:b;c=c<10?'0'+c:c;return d+':'+b+':'+c},inspectUser:function(d){var a=(((a||'')+'').toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join('');var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,b=/\x3c!--[\s\S]*?--\x3e|<\?(?:php)?[\s\S]*?\?>/gi;return d.replace(b,'').replace(c,function(b,c){return a.indexOf('<'+c.toLowerCase()+'>')>-1?b:''}).replace('/>','').trim()}});Ext.define('ABP.view.session.mainMenu.MenuItemUser',{extend:'Ext.container.Container',alias:'widget.menuitemuser',requires:['ABP.view.session.mainMenu.MenuItemUserModel','ABP.view.session.mainMenu.MenuItemUserController'],controller:'menuitemusercontroller',viewModel:{type:'menuitemusermodel'},config:{icon:'',title:'',header:'',value:'&nbsp;',tabId:'',command:'',clickOnRender:!1},cls:'Menu_User',layout:{type:'hbox',align:'center',pack:'center'},height:25,width:'auto',initComponent:function(){var b=this;var d=b.getViewModel();var c='auto';var a=ABP.util.Config.getUsername();a=b.getController().inspectUser(a);d.set('userDisplay',a);a=a.split('\\').pop();if(a.length>14){c=100}b.items=[{xtype:'component',html:'<i class="'+b.icon+'"></i>',cls:'mi-icon-user'},{xtype:'component',html:a,width:c,cls:'mi-title-user'}];b.callParent(arguments)},listeners:{render:'onRenderUser'}});Ext.define('ABP.view.session.mainMenu.MenuScroll',{extend:'Ext.container.Container',alias:'widget.menuscroll',afterRender:function(){this.callParent();var a=this;if(this.getXType()==='menuscroll'){this._getIScrollElement=function(){return this.el.dom}}if(ABP.util.Config.isDesktop()){if(this._getIScrollElement){this._updateIScroll();this.on('afterlayout',this._updateIScroll,this)}}a.el.dom.onmouseleave=function(){var a=this;a=Ext.getCmp(a.id);a.addCls('noshowScroll')};a.el.dom.onmouseenter=function(){var a=this;a=Ext.getCmp(a.id);a.removeCls('noshowScroll')}},_ensureIScroll:function(){if(!this.iScroll){var a=this._getIScrollElement();if(a.children.length>0){this.iScroll=new IScroll(a,{mouseWheel:!0,click:!1,preventDefault:!1,scrollbars:!0,fadeScrollbars:!1});this.iScrollTask=new Ext.util.DelayedTask(this._refreshIScroll,this)}}},_updateIScroll:function(){this._ensureIScroll();if(this.iScroll){this.iScrollTask.delay(10)}},_refreshIScroll:function(){this.iScroll.refresh();this.el.child('div').dom.style.height=this.enabledItemCount*82+'px';this.iScrollTask.delay(1000)}});Ext.define('ABP.view.session.mainMenu.MenuToggle',{extend:'ABP.view.session.mainMenu.MenuItem',alias:'widget.menutoggle',initComponent:function(){var a=this;var c='';var b=a.icon;b=b.split('-');a.items=[{xtype:'component',itemId:'miIcon',cls:'mi-icon-micro',bind:{cls:'{classicMenuExpand}',html:'<i class="'+a.icon+'"></i>'},setCls:function(a){if(a){this.removeCls('icon-expanded')}else {this.addCls('icon-expanded')}}},{xtype:'component',itemId:'miTitle',bind:{hidden:'{!classicMenuExpand}',html:a.labelKey?'{i18n.'+a.labelKey+':htmlEncode}':Ext.String.htmlEncode(a.title)},cls:'mi-title-micro'},{xtype:'component',itemId:'miToggle',cls:'mi-icon-micro mi-icon-toggle',bind:{html:'<div class="icon-wrapper"><i class="'+'icon-elements-tree'+'"></i><i class="'+'{navIcon}'+'"></i></div>'}}];a.ariaRole='menuitem';a.ariaLabel='Main Menu '+a.title;a.superclass.superclass.initComponent.apply(a,arguments)},setCls:function(c){var a=this;var b=a.getViewModel();a.removeCls(b.get('navAfterCls')+b.get('navIcon'));a.removeCls(b.get('navAfterCls')+b.get('treeIcon'));a.addCls(c)}});Ext.define('ABP.view.session.mainMenu.MainMenu',{extend:'Ext.panel.Panel',alias:'widget.mainmenu',requires:['ABP.view.session.mainMenu.MainMenuController','ABP.view.session.mainMenu.MainMenuModel','ABP.view.session.mainMenu.MenuItem','ABP.view.session.mainMenu.MenuItemUser','ABP.view.session.mainMenu.MenuScroll','ABP.view.session.mainMenu.MenuToggle','ABP.view.session.mainMenu.ABPTreeList'],controller:'mainmenucontroller',viewModel:{type:'mainmenumodel'},ariaRole:'navigation',automationCls:'main-menu',autoEl:'nav',cls:'main-menu',id:'main-navigation-menu',ui:'nav-menu',itemId:'mainMenu',reference:'mainMenu',focusItemsCt:0,currentFocus:0,startIdx:-1,dirtyIdx:!0,lastInitMouseBool:!0,componentCls:'main-menu x-unselectable',layout:{type:'vbox',align:'begin',pack:'start'},bind:{width:'{menuWidth}',ariaLabel:'{i18n.abp_navigation_menu}'},items:[{xtype:'container',cls:'nav-search-cont',reference:'abpNavSearchCont',margin:'3px 0',height:34,layout:{type:'vbox',align:'middle',pack:'start'},bind:{width:'{menuWidth}',hidden:'{hideSearch}'},items:[{xtype:'abptext',cls:'nav-search-field',ariaRole:'combobox',inputAttrTpl:'spellcheck="false"',bind:{emptyText:'{i18n.navMenu_navigation}',fieldLabel:'{i18n.toolbar_search_navigation}',ariaLabel:'{i18n.toolbar_search_navigation}',hideLabel:!0},width:'90%',itemId:'navSearchField',automationCls:'navMenu-search-field',spellcheck:!1,triggers:{search:{cls:'nav-search-trigger',iconCls:'magnifying-glass',automationCls:'navMenu-search-trigger',handler:'searchNav'}},listeners:{change:'searchNav',focusleave:'onSearchLostFocus',el:{keydown:'onSearchKeyDown'}},ariaAttributes:{'aria-owns':'searchResultsView','aria-controls':'searchResultsView','aria-haspopup':'listbox','aria-expanded':'false','aria-autocomplete':'list','aria-activedescendant':''}}]},{xtype:'container',cls:'nav-toggle-cont',layout:{type:'vbox',align:'stretch'},bind:{width:'{menuWidth}'},items:[{xtype:'menutoggle',uniqueId:'navToggleTree',itemId:'navToggleTree',icon:'icon-refresh',title:'Schwap View',automationCls:'navMenu-swapView',labelKey:'navMenu_swapView',tooltipKey:'navMenu_swapView',command:'toggleNav',enabled:!0,type:'event',appId:'container',bind:{hidden:'{hideTreeNav}',cls:'{navToggleIcon}'}}]},{xtype:'container',cls:'main-menu-main-content',flex:1,scrollable:'y',bind:{width:'{menuWidth}'},items:[{xtype:'container',items:[{xtype:'treelistmenu',bind:{store:'{navSearch}',width:'{menuWidth}'}}]},{xtype:'container',cls:'menu-fade-bottom',itemId:'main_menu_session',flex:1,layout:{type:'vbox',align:'begin'},bind:{items:'{sessionMenu}',width:'{menuWidth}'},setItems:function(a){Ext.suspendLayouts();this.removeAll();this.add(a);Ext.resumeLayouts(!0)}}]}],initComponent:function(){var a=this;var c=a.getController();a.callParent();var j=ABP.util.Config.getSessionConfig().navMenu;var f=ABP.util.Config.getSessionConfig().treeMenu;var e=ABP.util.Config.getSessionConfig().settings.hideTreeNavigation;var g=ABP.util.Config.getSessionConfig().settings.startShowingTreeNavigation;var h=ABP.util.Config.getSessionConfig().settings.enableNavSearch;var b=ABP.util.Config.getSessionConfig().settings.enableWideMenu;if(b!==undefined){b=b===!0||b==='true'}else {b=!1}c.populateMenuNav(j);c.populateMenuTree(f);if(e!==undefined){a.getViewModel().set('hideTreeNav',e)}a.getViewModel().set('hideSearch',!h);var i=ABP.util.Config.getSessionConfig();a.getController().populateSessionMenu(i);if(b){a.getViewModel().set('menuWidth',350)}if(f&&g){a.getController().__toggleNavType()}var d=a.down('#searchResultsView');if(d){Ext.on('resize',c.onSearchResultReactWindowResize,c,d)}},toggleMicro:function(b){var c=this;var a=c.down('treelistmenu');a.setMicro(b);if(b){a.addCls('abp-tree-micro')}else {a.removeCls('abp-tree-micro')}}});Ext.define('ABP.view.session.subMenu.SubMenuModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.submenumodel',data:{allItems:[],shownItems:[],numShown:0,numCounted:0,numSubVis:0,numTriVis:0,longestTitle:0,longestLabel:0},shownSet:function(c,b){var a=this;a.set(c,b);return a.resetShown()},resetShown:function(){var b=this;var c=0;var a;for(a=0;a<b.data.shownItems.length;++a){if(b.data.shownItems[a].xtype==='submenubutton'){b.data.shownItems[a].place=c;c++}else {if(b.data.shownItems[a].xtype==='trimenubutton'&&b.data.shownItems[a].hidden===!1){b.data.shownItems[a].place=c;c++}else {b.data.shownItems[a].place=b.data.shownItems.length+1}}}return c-1}});Ext.define('ABP.view.session.subMenu.SubMenuItemModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.submenuitemmodel'});Ext.define('ABP.view.session.subMenu.SubMenuItem',{extend:'Ext.container.Container',alias:'widget.submenubutton',requires:['ABP.view.session.subMenu.SubMenuItemModel'],viewModel:{type:'submenuitemmodel'},config:{title:'',labelKey:'',labelVal:'',uniqueId:'',command:'',args:'',enabled:!0,tooltip:'',tooltipKey:'',type:'',children:'',appId:'',place:'',parentUID:'',parentTitle:'',clas:''},cls:'sub-menu-item smi-Body',itmeId:'smiBody',height:40,layout:{type:'hbox',align:'stretch'},tabIndex:-1,afterRender:function(){var a=this;var d;var b='';var c;a.callParent();if(a.tooltip&&a.tooltip!==''){b=a.tooltip}if(a.tooltipKey&&a.tooltipKey!==''){d=Ext.ComponentQuery.query('app-main')[0].getViewModel();c=d.checkI18n(a.tooltipKey);if(c!==a.tooltipKey){b=c}}if(b!==''){Ext.tip.QuickTipManager.register({target:a.getId(),text:b,cls:'tooltip-mm'})}},initComponent:function(){var a=this;var b=[];this.labelVal=this.title;if(!this.labelKey){a.cls=a.cls+' a-submenu-unsafe-'+a.title.replace(/[^A-Za-z]/g,'')}else {a.cls=a.cls+' a-submenu-'+a.labelKey.replace(/_/g,'-')}b.push({flex:1},{xtype:'component',itemId:'smiTitle',html:this.labelVal,cls:'smi-title'});var c=this.children===undefined||this.children.length===0?'smi-filler':'smi-chevron';b.push({xtype:'component',cls:c});this.items=b;this.ariaRole='menuitem';this.ariaLabel=this.parentTitle+' - '+this.title;this.callParent(arguments);this.cls=this.cls+' '+this.clas},listeners:{el:{keydown:function(a){if(a.getKey()===a.ENTER){var b=Ext.get(a.currentTarget.id);b.component.clickItem()}},click:function(a){var b=Ext.get(a.currentTarget.id);b.component.clickItem()},scope:this}},clickItem:function(){this.fireEvent('smiItemClick',this)},setSelected:function(a){if(a){this.addCls('smi-body-selected')}else {this.removeCls('smi-body-selected')}},isSelected:function(){var a=this.down('#smiBody');return a.hasCls('smi-body-selected')},setLabelVal:function(b){if(this.items&&b!==''){var c=ABP.util.Common.measureTextSingleLine(b,ABP.util.Constants.BASE_FONT).width+b.length+40;var a;if(c>300){var e=parseInt((c-275)/4,10);var d=b.length-e;a=b.slice(0,d)+'...'}if(a===undefined){a=b}this.labelVal=a;this.down('#smiTitle').setHtml(Ext.String.htmlEncode(a));this.fireEvent('subMenu_updatedLabel',a)}else {if(this.items){this.down('#smiTitle').setHtml(Ext.String.htmlEncode(this.title));this.fireEvent('subMenu_updatedLabel',this.title)}}}});Ext.define('ABP.view.session.subMenu.TriMenuItemModel',{extend:'Ext.app.ViewModel',alias:'viewmodel.trimenuitemmodel'});Ext.define('ABP.view.session.subMenu.TriMenuItem',{extend:'Ext.container.Container',alias:'widget.trimenubutton',requires:['ABP.view.session.subMenu.TriMenuItemModel'],viewModel:{type:'trimenuitemmodel'},config:{title:'',labelKey:'',labelVal:'',uniqueId:'',command:'',args:'',enabled:!0,tooltip:'',tooltipKey:'',type:'',children:'',appId:'',place:'',parentUID:'',parentTitle:'',clas:''},cls:'tri-menu-item tri-Body',layout:{type:'vbox',align:'stretch'},height:40,tabIndex:-1,afterRender:function(){var a=this;var d;var b='';var c;a.callParent();if(a.tooltip&&a.tooltip!==''){b=a.tooltip}if(a.tooltipKey&&a.tooltipKey!==''){d=Ext.ComponentQuery.query('app-main')[0].getViewModel();c=d.checkI18n(a.tooltipKey);if(c!==a.tooltipKey){b=c}}if(b!==''){Ext.tip.QuickTipManager.register({target:a.getId(),text:b,cls:'tooltip-mm'})}},initComponent:function(){var a=this;this.labelVal=this.title;if(!this.labelKey){a.cls=a.cls+' a-trimenu-unsafe-'+a.title.replace(/[^A-Za-z]/g,'')}else {a.cls=a.cls+' a-trimenu-'+a.labelKey.replace(/_/g,'-')}this.items=[{xtype:'component',itemId:'triTitle',html:this.labelVal,cls:'tri-title',listeners:{el:{click:function(){this.clickItem()},scope:this}}}];this.ariaRole='menuitem';this.ariaLabel=this.parentTitle+' - '+this.title;this.callParent(arguments);this.cls=this.cls+' '+this.clas},listeners:{el:{keydown:function(a){if(a.getKey()===a.ENTER||a.getKey()===a.RIGHT){var b=Ext.get(a.currentTarget.id);b.component.clickItem()}}}},clickItem:function(){this.fireEvent('triItemClick',this)},setSelected:function(a){if(a){this.addCls('tri-body-selected')}else {this.removeCls('tri-body-selected')}},isSelected:function(){return this.hasCls('tri-body-selected')},setLabelVal:function(b){if(this.items&&b!==''&&!this.hidden){var c=ABP.util.Common.measureTextSingleLine(b,ABP.util.Constants.BASE_FONT).width+b.length+40;var a;if(c>300){var e=parseInt((c-275)/4,10);var d=b.length-e;a=b.slice(0,d)+'...'}if(a===undefined){a=b}this.labelVal=a;this.down('#triTitle').setHtml(Ext.String.htmlEncode(a));this.fireEvent('subMenu_updatedLabel',a)}else {if(this.items&&!this.hidden){this.down('#triTitle').setHtml(Ext.String.htmlEncode(this.title));this.fireEvent('subMenu_updatedLabel',this.title)}}}});Ext.define('ABP.view.session.subMenu.SubScroll',{extend:'Ext.container.Container',alias:'widget.subscroll',afterRender:function(){this.callParent();var a=this;if(this.getXType()==='subscroll'){this._getIScrollElement=function(){return this.el.dom}}if(ABP.util.Config.isDesktop()){if(this._getIScrollElement){this._updateIScroll();this.on('afterlayout',this._updateIScroll,this)}}a.el.dom.onmouseleave=function(){var a=this;a=Ext.getCmp(a.id);a.addCls('noshowScroll')};a.el.dom.onmouseenter=function(){var a=this;a=Ext.getCmp(a.id);a.removeCls('noshowScroll')}},_ensureIScroll:function(){if(!this.iScroll){var a=this._getIScrollElement();if(a.children.length>0){this.iScroll=new IScroll(a,{mouseWheel:!0,click:!1,preventDefault:!1,scrollbars:!0,fadeScrollbars:!1});this.iScrollTask=new Ext.util.DelayedTask(this._refreshIScroll,this)}}},_updateIScroll:function(){this._ensureIScroll();if(this.iScroll){this.iScrollTask.delay(10)}},_refreshIScroll:function(){this.iScroll.refresh();var a=this.up().el.dom.clientHeight;this.el.dom.style.height=a+'px';this.el.child('div').dom.style.height=this.enabledItemCount*41+'px';this.iScrollTask.delay(1000)}});Ext.define('ABP.view.session.subMenu.SubMenu',{extend:'Ext.container.Container',alias:'widget.submenu',requires:['ABP.view.session.subMenu.SubMenuController','ABP.view.session.subMenu.SubMenuModel','ABP.view.session.subMenu.SubMenuItem','ABP.view.session.subMenu.TriMenuItem','ABP.view.session.subMenu.SubScroll'],controller:'submenucontroller',viewModel:{type:'submenumodel'},focusItemsCt:0,currentFocus:-1,startIdx:-1,dirtyIdx:!0,lastInitMouseBool:!0,componentCls:'sub-menu x-unselectable',layout:'vbox',width:300,height:'100%',items:[{xtype:'container',layout:{type:'vbox',align:'stretch'},cls:ABP.util.Config.isDesktop()?'noshowScroll':'',width:300,itemId:'sub_menu_cont',enabledItemCount:0,autoScroll:!ABP.util.Config.isDesktop(),bind:{items:'{shownItems}'},setItems:function(a){Ext.suspendLayouts();this.removeAll(!0);this.add(a);Ext.resumeLayouts(!0);this.recalcNavItems()},recalcNavItems:function(){var c=this;var b=c.items.items;var a=0;c.enabledItemCount=0;for(a;a<b.length;++a){if(b[a].config.enabled&&!b[a].config.hidden){c.enabledItemCount++}}}}],afterLayout:function(){if(!this.lastInitMouseBool){var a=this.getController();if(a&&a!==undefined){a.firstFocus()}}},listeners:{el:{keydown:function(a){switch(a.getKey()){case a.UP:this.component.getController().moveUp();break;case a.DOWN:this.component.getController().moveDown();break;case a.TAB:this.component.getController().tabHit();break;case a.LEFT:this.component.getController().moveLeft();break;}}}}});Ext.define('ABP.view.session.favorites.FavoritesManagerController',{extend:'ABP.view.session.favorites.FavoritesManagerControllerBase',alias:'controller.favoritesManager',onExpandAllClick:function(){var b=this,a=b.getView();if(a.favTree){a.favTree.getRootNode().expandChildren(!0)}},onCollapseAllClick:function(){var b=this,a=b.getView();if(a.favTree){a.favTree.getRootNode().collapseChildren(!0)}},addNewGroup:function(){var d=this.getViewModel();var c=this.getView();var a=d.get('favoriteTitle');var b=c.down('#newgrouptext');if(!a){b.markInvalid(ABP.util.Common.geti18nString('favorites_newGroup_emptyText'));b.focus();return}c.favTree.getRootNode().insertChild(0,{text:a,iconCls:'icon-folder',label:a,leaf:!1,expanded:!1});d.set('favoriteTitle','')},onChange:function(b){var a=this.getViewModel();a.set('favoriteTitle',b.value)},editItemClicked:function(e,g,f,i,h,c){var b=!0;if(c.isLeaf()){var a=ABP.util.Config.getSessionConfig().settings.favorites;if(a&&Ext.isBoolean(a.allowItemRename)){b=a.allowItemRename}}var d=Ext.create('ABP.view.session.favorites.FavoritesManagerEditPanel',{favorite:c,treeView:e,viewModel:{data:{allowItemRename:b}}});d.show()},removeItemClicked:function(e,d,c,g,f,a){var b=this;if(a.hasChildNodes()===!1){a.remove()}else {ABP.view.base.popUp.PopUp.showOkCancel(b.getViewModel().data.i18n.favorites_confirmDeleteGroupMsg,b.getViewModel().data.i18n.favorites_confirmDeleteGroupTitle,function(b){if(b){a.remove(!0)}})}}});Ext.define('ABP.view.session.favorites.FavoritesManager',{extend:'ABP.view.components.panel.HeaderPanelBase',alias:'widget.favoritesManager',requires:['Ext.tree.Panel','Ext.tree.Column','Ext.data.TreeStore','Ext.grid.plugin.CellEditing','Ext.tree.plugin.TreeViewDragDrop','ABP.view.session.favorites.FavoritesManagerController','ABP.view.session.favorites.FavoritesManagerModel'],viewModel:{type:'favoritesmanagermodel'},controller:'favoritesManager',scrollable:'vertical',layout:{type:'vbox',align:'stretch'},bind:{title:'{i18n.favorites_title:htmlEncode}'},header:{automationCls:'favorites-manager-header'},closable:!0,items:[{xtype:'treepanel',rootVisible:!1,itemId:'favoritestree',useArrows:!0,ui:'abpgridpanel',plugins:{cellediting:{clicksToEdit:2,listeners:{beforeedit:function(e,c,d){var a=!0;if(!c.record.isLeaf()){return a}var b=ABP.util.Config.getSessionConfig();if(b.settings.favorites&&b.settings.favorites.allowItemRename===!1){a=!1}return a}}}},viewConfig:{listeners:{nodedragover:function(a,e,d,g,f){var c=!Ext.isEmpty(d.records)?d.records[0]:undefined;var b=ABP.util.Common.getViewModelProperty('conf.settings.favorites.depthLimit');if(b===0){return !0}if(a.getDepth()>=b){if(a.getDepth()===b){if(a.isLeaf()&&c.isLeaf()){return !0}}else {return !1}}if(!c){return !1}if(!c.isLeaf()){if(!a.isLeaf()||!a.parentNode.isRoot()){return !1}}return !0}},plugins:{treeviewdragdrop:{containerScroll:!0}}},listeners:{edit:function(b,a){if(a.view){a.view.refresh()}}},columns:[{xtype:'treecolumn',text:null,flex:0.5,dataIndex:'text',editor:{xtype:'textfield',allowBlank:!1}},{xtype:'actioncolumn',flex:0.5,listeners:{afterrender:function(){if(ABP.util.Common.getViewModelProperty('conf.settings.favorites.depthLimit')===1&&ABP.util.Common.getViewModelProperty('conf.settings.favorites.allowItemRename')===!1){this.items[0].hidden=!0}}},items:[{width:30,iconCls:'icon-pencil',handler:'editItemClicked'},{xtype:'actioncolumn',width:30,iconCls:'icon-navigate-cross',handler:'removeItemClicked'}]}]}],tbar:{reference:'tbar',cls:'favorites-tbar',defaults:{border:!1},bind:{height:'{toolbarHeight}'},items:[{bind:{text:'{i18n.button_save:htmlEncode}'},cls:'a-favorites-toolbar-save',width:100,handler:'onSaveClick'},{bind:{text:'{i18n.favorites_expandAll:htmlEncode}',hidden:'{conf.settings.favorites.depthLimit === 1}'},cls:'a-favorites-toolbar-expandall',width:100,handler:'onExpandAllClick'},{bind:{text:'{i18n.favorites_collapseAll:htmlEncode}',hidden:'{conf.settings.favorites.depthLimit === 1}'},cls:'a-favorites-toolbar-collapseall',width:100,handler:'onCollapseAllClick'},{xtype:'textfield',height:32,bind:{emptyText:'{i18n.favorites_newGroup_emptyText}',value:'{favoriteTitle}',hidden:'{conf.settings.favorites.depthLimit === 1}'},cls:'a-favorites-toolbar-newgrouptext',itemId:'newgrouptext',keyMap:{'ENTER':{handler:'addNewGroup'}},listeners:{change:'onChange'},width:200},{bind:{disabled:'{favoriteTitle.length === 0}',hidden:'{conf.settings.favorites.depthLimit === 1}'},cls:'favorites-addgroup a-favorites-toolbar-newgroup',handler:'addNewGroup',border:!0,iconCls:'icon-plus'}]}});Ext.define('ABP.view.session.headlines.HeadlinesManager',{extend:'ABP.view.components.panel.HeaderPanelBase',alias:'widget.headlinesManager',requires:['ABP.view.components.panel.HeaderPanelBase','ABPControlSet.view.field.DateTime','ABP.view.session.headlines.HeadlinesManagerController','Ext.grid.plugin.RowWidget'],controller:'headlinesManager',cls:'headlines-manager-panel',scrollable:'vertical',layout:{type:'vbox',align:'stretch'},bind:{title:'{i18n.headlines_title:htmlEncode}'},closable:!0,closeEvent:'headlinesManager_onCancelClick',destroyOnClose:!1,header:{automationCls:'headlines-manager-header'},items:[{xtype:'grid',flex:1,rootVisible:!1,reference:'headlinesGrid',ui:'abpgridpanel',forceFit:!0,plugins:{rowwidget:{widget:{xtype:'abpform',layout:{type:'column'},bind:{data:'{record}'},defaults:{margin:4,labelAlign:'top',colspan:1},padding:4,items:[{xtype:'abptext',bind:{fieldLabel:'{i18n.headlines_label_message:htmlEncode}',value:'{record.message}'},name:'message'},{xtype:'abptext',bind:{fieldLabel:'{i18n.headlines_label_message_key:htmlEncode}',value:'{record.messageKey}'},name:'messageKey'},{xtype:'abptext',bind:{fieldLabel:'{i18n.headlines_label_action:htmlEncode}',value:'{record.actionText}'},name:'actionText'},{xtype:'abptext',bind:{fieldLabel:'{i18n.headlines_label_action_key:htmlEncode}',value:'{record.actionTextKey}'},name:'actionTextKey'},{xtype:'abpdatetime',bind:{fieldLabel:'{i18n.headlines_label_starttime:htmlEncode}',value:'{record.startTime}'},name:'startTime'},{xtype:'abpdatetime',bind:{fieldLabel:'{i18n.headlines_label_endtime:htmlEncode}',value:'{record.endTime}'},name:'endTime'},{xtype:'abpcheckbox',bind:{fieldLabel:'{i18n.headlines_label_published:htmlEncode}',value:'{record.published}'},name:'published'},{xtype:'abpradiogroup',bind:{fieldLabel:'{i18n.headlines_label_priority:htmlEncode}',value:'{record.priority}'},name:'priority',items:[{bind:{boxLabel:'{i18n.headlines_priority_info:htmlEncode}'},name:'priority',inputValue:0},{bind:{boxLabel:'{i18n.headlines_priority_warning:htmlEncode}'},name:'priority',inputValue:1},{bind:{boxLabel:'{i18n.headlines_priority_alert:htmlEncode}'},name:'priority',inputValue:2}]}],bbar:[{xtype:'abpbutton',handler:function(f){var b=f.up('abpform'),d=b.up('headlinesManager'),c=d.getController(),e=b._rowContext,a=e.record;c.fireEvent('headline_save',a);a.save()},bind:{text:'{i18n.button_save:htmlEncode}',disabled:'{!record.dirty}'}}]}}},columns:[{dataIndex:'message',bind:{text:'{i18n.headlines_column_message:htmlEncode}'},text:'Message',flex:3},{dataIndex:'messageKey',bind:{text:'{i18n.headlines_column_message_key:htmlEncode}'},text:'Message key',hidden:!0,flex:1},{dataIndex:'actionText',bind:{text:'{i18n.headlines_column_action:htmlEncode}'},flex:2},{dataIndex:'actionTextKey',bind:{text:'{i18n.headlines_column_action_key:htmlEncode}'},text:'Action key',hidden:!0,flex:1},{dataIndex:'startTime',bind:{text:'{i18n.headlines_column_starttime:htmlEncode}'},flex:2},{dataIndex:'endTime',bind:{text:'{i18n.headlines_column_endtime:htmlEncode}'},flex:2},{dataIndex:'published',bind:{text:'{i18n.headlines_column_published:htmlEncode}'},flex:1},{dataIndex:'priority',bind:{text:'{i18n.headlines_column_priority:htmlEncode}'},flex:1,renderer:function(a){switch(a){case 0:return ABP.util.Common.geti18nString('headlines_priority_info');case 1:return ABP.util.Common.geti18nString('headlines_priority_warning');case 2:return ABP.util.Common.geti18nString('headlines_priority_alert');default:}}},{xtype:'actioncolumn',hideable:!1,width:30,items:[{width:30,iconCls:'icon-navigate-cross',handler:'removeItemClicked'}]}]}],tbar:{reference:'tbar',cls:'headlines-tbar',defaults:{border:!1},bind:{height:'{toolbarHeight}'},items:[{bind:{text:'{i18n.button_cancel:htmlEncode}'},cls:'a-headlines-toolbar-cancel',width:100,handler:'onCancelClick'},{bind:{text:'{i18n.headlines_new:htmlEncode}'},cls:'a-headlines-toolbar-new',width:100,handler:'newHeadline'}]}});Ext.define('ABP.view.session.feature.FeatureCanvas',{extend:'Ext.panel.Panel',alias:'widget.featurecanvas',requires:['ABP.view.session.help.HelpView','ABP.view.session.about.About','ABP.view.session.logger.LoggerPage','ABP.view.session.toolbarTop.ToolbarTop','ABP.view.session.feature.FeatureCanvasController','ABP.view.session.feature.FeatureCanvasModel','ABP.view.session.mainMenu.MainMenu','ABP.view.session.subMenu.SubMenu','ABP.view.session.favorites.FavoritesManager','ABP.view.session.headlines.HeadlinesManager'],controller:'featurecanvascontroller',viewModel:{type:'featurecanvasmodel'},subMenuOpened:!1,menuOpened:!1,settingsShown:!1,layout:'absolute',cls:'feature-canvas',ariaRole:'main',autoEl:'main',flex:1,initComponent:function(){var a=this;var c=a.getViewModel();var b=a.getViewModel().get('conf').settings.autoHideMenu;c.set('autoHide',b);a.items=[{xtype:'container',anchor:'100% 100%',layout:'fit',itemId:'topContainer',items:[{xtype:'container',anchor:'100% 100%',layout:'fit',itemId:'settingsContainer',items:[],hidden:!0},{xtype:'container',anchor:'100% 100%',style:'z-index: 2;',layout:'fit',itemId:'applicationContainer',items:[]}]}];a.callParent()}});Ext.define('ABP.view.session.rightPane.RightPaneController',{extend:'ABP.view.session.rightPane.RightPaneBaseController',alias:'controller.rightpanecontroller',__initTab:function(a,b){var c=this,e=c.getView(),f=e.getViewModel(),d=f.get('tabPrefix');if(!b){b=c.__getPanelConfig(a)}if(a.indexOf(d)!==0){a=d+a}var g=c.__createTab(b,a);e.add(g)},handleKeyPress:function(j,g){var c=this,h=c.getView(),f=h.getViewModel(),a,k,b,i=g.panelConfig,e=f.get('tabPrefix'),d=f.get('rightPaneOpen');switch(j.keyCode){case 40:b=h.getActiveTab();a=i.uniqueId;if(a.indexOf(e)!==0){a=e+a};if(!d||d&&a!=b.itemId){c.toggleTab(g.panelConfig,!0)}else {c.applyFocus(b)};break;}},toggleTab:function(a,h,m){var c=this,f=c.getView(),l=f.getViewModel(),b,e,d,k=l.get('tabPrefix'),g=l.get('rightPaneOpen');if(!g&&h===!1){return}if(Ext.isString(a)){b=a;a=c.__getPanelConfig(a);if(!a.uniqueId){ABP.util.Logger.logWarn(Ext.String.format('No configuration exists for tab "{0}".',b));return}}b=a.uniqueId;if(b.indexOf(k)!==0){b=k+b}e=f.down('#'+b);if(!e){f.add(c.__createTab(a,b))}d=f.getActiveTab();if(d){var i=d.itemId.substring(d.itemId.indexOf('_')+1);var j=Ext.ComponentQuery.query('#'+i)[0];j.el.set({'aria-expanded':!1})}if(g===!1&&h!==!1){c.togglePane();c.fireEvent('toolbar_setVisibilityRightPaneButton',a.uniqueId,!0)}else {if(g===!0&&d.itemId===b&&h!==!0){c.togglePane();return}else {if(g===!0&&d.itemId!==b&&h===!1){return}}}var e=f.setActiveTab(b);if(m){var n=new Ext.util.DelayedTask(function(){ABP.util.Keyboard.focus('#'+e.id+' .x-panel-body .x-component [tabindex]')});n.delay(200)}var i=e.itemId.substring(e.itemId.indexOf('_')+1);var j=Ext.ComponentQuery.query('#'+i)[0];j.el.set({'aria-expanded':!0});if(a.clearBadgeOnActivate){c.fireEvent('toolbar_clearBadge',a.uniqueId)}c.fireEvent('toolbar_addPressedCls',a.uniqueId)},applyFocus:function(a){var b=a.down();if(b&&b.applyFocus){b.applyFocus()}else {if(a){var c=new Ext.util.DelayedTask(function(){ABP.util.Keyboard.focus('#'+a.id+' .x-panel-body .x-component [tabindex]')});c.delay(200)}}}});Ext.define('ABP.view.session.rightPane.RightPane',{extend:'Ext.tab.Panel',alias:'widget.rightpanecanvas',itemId:'rightPane',requires:['ABP.view.session.rightPane.RightPaneController','ABP.view.session.rightPane.RightPaneModel'],controller:'rightpanecontroller',viewModel:{type:'rightpanemodel'},width:250,height:'100%',scrollable:'vertical',cls:'rightpane',autoEl:'aside',closeAction:'hide',border:!0,focusable:!0,tabIndex:0,tools:[],items:[],listeners:{hide:function(a){if(a&&a.getActiveTab()){var c=a.getActiveTab().itemId.substring(a.getActiveTab().itemId.indexOf('_')+1);var b=a.up('sessioncanvas').down('#'+c);if(b){b.el.set({'aria-expanded':!1})}}this.removeFocus()}},keyMap:{scope:'this',ESC:function(){var a=this.getActiveTab().itemId.substring(this.getActiveTab().itemId.indexOf('_')+1);Ext.ComponentQuery.query('#'+a)[0].focus();this.getController().fireEvent('rightPane_toggle')}},initComponent:function(){var a=this;a.callParent();if(a.tabBar){a.tabBar.hide()}},applyFocus:function(c){var a;if(c){a=c.down()}else {var b=this.getActiveTab();if(b){a=b.down()}}if(a&&a.applyFocus){a.applyFocus()}},removeFocus:function(){var b=this.getActiveTab();if(b){var a=b.down('container');if(a&&a.removeFocus){a.removeFocus()}}}});Ext.define('ABP.view.session.settings.SettingsContainer',{requires:['ABP.view.session.settings.SettingsContainerModel','ABP.view.session.settings.SettingsContainerController','Ext.Img','Ext.layout.container.Table'],extend:'ABP.view.base.rightpane.RightPanePanel',alias:'widget.settingscontainer',controller:'settingscontainer',viewModel:{type:'settingscontainer'},cls:'settings-container',ui:'lightgrey',height:'100%',scrollable:'vertical',layout:{type:'vbox',pack:'start',align:'left'},bind:{title:'{i18n.sessionMenu_settings}'},defaults:{xtype:'button',width:'100%',cls:'settings-container-button',ui:'menuitem',uiCls:'light',textAlign:'left',toggleGroup:'settingsGroup',height:40},dockedItems:[{xtype:'toolbar',dock:'bottom',padding:'10 10 10 15',cls:'settings-container-session-labels',ui:'lightgrey',layout:{type:'vbox',align:'stretch'},items:[{xtype:'label',bind:{hidden:'{!showEnv || !showEnvironment}',text:'{i18n.sessionMenu_environment}'+' {environmentName}'}},{xtype:'label',reference:'sessionTimeLabel',bind:{hidden:'{!showSessionTimer}',text:'{i18n.sessionMenu_time}'+' {loggedInTime}'}}]}],applyFocus:function(){var b=this.items.items;var c=b.length;var a=0;for(a;a<c;++a){if(b[a]&&b[a].canFocus&&b[a].canFocus()){var d=new Ext.util.DelayedTask(function(){ABP.util.Keyboard.focus('#'+b[a].id)});d.delay(50);break}}},removeFocus:function(){var b=this.query('button');var c=b.length;var a=0;for(a;a<c;++a){if(b[a]&&b[a].setPressed){b[a].setPressed(!1)}}}});Ext.define('ABP.view.session.SessionCanvas',{extend:'Ext.panel.Panel',alias:'widget.sessioncanvas',requires:['ABP.view.session.SessionBanner','ABP.view.session.accessibility.JumpToBar','ABP.view.session.feature.FeatureCanvas','ABP.view.session.mainMenu.MainMenu','ABP.view.session.SessionCanvasController','ABP.view.session.rightPane.RightPane','ABP.view.session.settings.SettingsContainer','ABP.view.session.SessionCanvasModel'],controller:'sessioncanvascontroller',viewModel:{type:'sessioncanvasmodel'},menuOpened:!0,layout:'border',dockedItems:[{xtype:'jumptobar',dock:'top'},{xtype:'sessionbanner',dock:'top'},{xtype:'toolbartop',dock:'top'}],initComponent:function(){var c=this;var d=c.getViewModel();var e=d.get('conf').settings;var b=e.startMenuHidden;var g=e.autoHideMenu;var f=ABP.util.Config.getSessionConfig().settings.rememberMenuState;var a;if(f){a=ABP.util.LocalStorage.get('mmStateOpen');if(a!==null){if(a==='true'){a=!0}else {if(a==='false'){a=!1}}b=!a}}d.set('menuOpen',!b);d.set('rightPaneOpen',!1);d.set('autoHide',g);c.items=[{xtype:'mainmenu',region:'west',viewModel:{type:'mainmenumodel',data:{classicMenuExpand:!b}}},{xtype:'featurecanvas',region:'center'},{xtype:'rightpanecanvas',region:'east',hidden:!0,scrollable:!1}];c.callParent();if(b){c.closeMenu()}},closeMenu:function(){var a=this;var b=a.down('mainmenu');b.hide()},openMenu:function(c){var a=this;var b=a.down('mainmenu');b.show()}});Ext.define('ABP.view.session.favorites.FavoritesManagerEditPanel',{extend:'Ext.panel.Panel',requires:['ABP.view.session.favorites.FavoritesManagerEditPanelController','ABP.view.session.favorites.FavoritesEditPanelModel'],alias:'widget.favoriteseditpanel',controller:'favoriteseditpanel',viewModel:{type:'favoritesEditPanel'},cls:'favoriteseditpanel',bodyCls:'x-unselectable',floating:!0,modal:!0,bind:{title:'{i18n.favorites_editPanel_title:htmlEncode}'},border:!0,layout:'vbox',header:{automationCls:'edit-favorites-panel-header'},config:{favorite:undefined},width:500,height:300,tools:[{iconCls:'icon-navigate-cross',handler:'onCloseClick'}],defaults:{labelAlign:'top',width:'100%',margin:'0 10 0 10'},items:[{xtype:'textfield',allowBlank:!1,cls:'a-favorites-editpanel-name',itemId:'favoriteName',bind:{fieldLabel:'{i18n.favorites_editPanel_name:htmlEncode}',disabled:'{!allowItemRename}'}},{xtype:'textfield',cls:'a-favorites-editpanel-source',editable:!1,disabled:!0,itemId:'favoriteSource',bind:{fieldLabel:'{i18n.favorites_editPanel_source:htmlEncode}',hidden:'{!allowItemRename}'}},{xtype:'combobox',displayField:'text',valueField:'id',cls:'a-favorites-editpanel-groups',itemId:'favoriteGroups',bind:{fieldLabel:'{i18n.favorites_editPanel_moveToGroup:htmlEncode}',hidden:'{conf.settings.favorites.depthLimit === 1}'}}],bbar:{defaults:{border:!1},items:['->',{bind:{text:'{i18n.button_cancel:htmlEncode}'},cls:'a-favorites-editpanel-bbar-cancel',width:100,handler:'onCloseClick'},{bind:{text:'{i18n.button_delete:htmlEncode}'},cls:'a-favorites-editpanel-bbar-delete',width:100,handler:'onDeleteClick'},{bind:{text:'{i18n.button_save:htmlEncode}'},cls:'a-favorites-editpanel-bbar-save',width:100,handler:'onSaveClick'}]}});Ext.define('ABP.view.session.headlines.Headline',{extend:'Ext.toolbar.Toolbar',xtype:'headline',cls:'session-headline',ui:'headline',layout:{type:'hbox',pack:'right'},constructor:function(a){a=a||{};var j=this,d=a.actionTextKey?ABP.util.Common.geti18nString(a.actionTextKey):null,c=d||a.actionText,g=Ext.isEmpty(a.priority)?0:a.priority,f=Ext.isEmpty(c)?!1:!0,e=a.messageKey?ABP.util.Common.geti18nString(a.messageKey):null,h=e||a.message,i='session-headline',b;switch(g){case 0:b='headline-info';break;case 1:b='headline-warning';break;case 2:b='headline-alert';break;default:b='headline-info';}a.cls=i+' '+b;delete a.priority;delete a.actionText;delete a.message;a.items=[{xtype:'tbtext',itemId:'headlineMessage',cls:'scrollable-overflow',html:h,flex:1},{xtype:'abpbutton',cls:'headline-button',hidden:!f,text:c,handler:function(){var b=this.up('headline'),c=b.up('sessionbanner');b.fireEvent('headline_action',b);c.remove(b)}},{xtype:'tool',type:'close',role:'button',ariaLabel:'Close Headline',automationCls:'headline-read',handler:function(){var b=this.up('headline'),c=b.up('sessionbanner');b.fireEvent('headline_read',b);c.remove(b)}}];j.callParent([a])},initComponent:function(){this.on('afterlayout',this.onAfterLayout);this.callParent(arguments)},onAfterLayout:function(e){var a=e.down('#headlineMessage');var c=a&&a.el&&a.el?a.el.getHtml():null;if(!c){return}var b=a.getWidth();if(b===0){b=ABP.util.Common.measureTextSingleLine(c,ABP.util.Constants.BASE_FONT).width}var d=(Ext.getViewportWidth()-b)/2;var f=a.getX();if(f!==d){a.setX(d)}}});Ext.define('ABP.view.session.notifications.NotificationsController',{extend:'ABP.view.session.notifications.NotificationsBaseController',alias:'controller.abp-notifications',__setActiveCardItem:function(a){var c=this,b=c.getView();b.getLayout().setActiveItem(a)}});Ext.define('ABP.view.session.notifications.Notifications',{extend:'ABP.view.base.rightpane.RightPanePanel',requires:['ABP.view.session.notifications.NotificationsController','ABP.view.session.notifications.NotificationsViewModel'],alias:'widget.abp-notifications',controller:'abp-notifications',viewModel:{type:'abp-notifications'},ui:'lightgrey',bodyCls:'abp-notifications',layout:'card',ariaRole:'application',bind:{title:'{i18n.abp_notifications_rightpane_title}'},items:[{xtype:'label',cls:'notifications-no-notifications',bind:{text:'{i18n.abp_notifications_label_no_notifications:htmlEncode}'}},{xtype:'label',cls:'notifications-no-notifications',bind:{text:'{i18n.abp_notifications_label_no_new_notifications:htmlEncode}'}},{xtype:'container',reference:'notificationContainer',layout:{type:'vbox',align:'stretch'},scrollable:'y'}],applyFocus:function(){this.lookupReference('notificationNavComponent').focus()}});Ext.define('ABP.view.session.notifications.NotificationsCategoryPanel',{extend:'Ext.panel.Panel',alias:'widget.abp-notifications-category-panel',controller:'abp-notifications-category-panel',viewModel:{type:'abp-notifications-category-panel'},config:{categoryName:null,categoryNameKey:null},cls:'abp-notifications-category-panel a-abp-notifications-category-panel',collapsible:!0,collapsed:!1,collapseToolText:null,expandToolText:null,titleCollapse:!0,tabIndex:-1,bind:{hidden:'{hidePanel}'},header:{cls:'abp-notification-panel-header'},items:[{xtype:'container',layout:'hbox',frame:!1,items:[{xtype:'component',itemId:'notificationCategoryNavComponent',reference:'notificationCategoryNavComponent',bind:{ariaLabel:'{ariaCategoryNotificationLabel:ariaEncode}'},tabIndex:-1,focusable:!0,listeners:{keydown:{element:Ext.isModern?'element':'el',fn:'handleCategoryKeyDown'},focus:{element:Ext.isModern?'element':'el',fn:'onCategoryNavFocus'}}},{xtype:'component',reference:'categoryShowHistoryComponent',cls:'notifications-hideshow-history x-unselectable',ariaLabel:'Show History',bind:{html:'{i18n.abp_notifications_label_show_history:htmlEncode}',hidden:'{hideShowHistoryComponent}'},listeners:{el:{click:'onShowHistoryClick'}}},{xtype:'component',reference:'categoryHideHistoryComponent',cls:'notifications-hideshow-history x-unselectable',ariaLabel:'Hide History',bind:{html:'{i18n.abp_notifications_label_hide_history:htmlEncode}',hidden:'{hideHideHistoryComponent}'},listeners:{el:{click:'onHideHistoryClick'}}}]},{xtype:'container',reference:'unreadNotificationContainer',cls:'abp-notifications-unread-container'},{xtype:'container',reference:'historyNotificationContainer',cls:'abp-notifications-history-container',bind:{hidden:'{!displayHistory}'}}],initComponent:function(){var c=this,a=this.getCategoryNameKey(),b=this.getCategoryName(),d=c.getViewModel();d.set('categoryName',b);if(this.tools){this.tools.forEach(function(a){a.automationCls=this.automationCls+'-'+a.type})}this.setBind({hidden:'{hidePanel}',title:'<span class="abp-notification-panel-title" tabindex="0" aria-label="'+(a?'{i18n.'+a+':htmlEncode}':Ext.String.htmlEncode(b))+' {unreadNotificationCount}">'+(a?'{i18n.'+a+':htmlEncode}':Ext.String.htmlEncode(b))+'</span>{categoryNotificationCountDisplay}'});c.callParent()},addNotification:function(a,c){var d=this,b=d.getController();b.addNotification(a,c)},removeNotification:function(a){var c=this,b=c.getController();b.removeNotification(a)},markNotificationRead:function(a){var c=this,b=c.getController();b.markNotificationRead(a)},markNotificationUnread:function(a){var c=this,b=c.getController();b.markNotificationUnread(a)}});Ext.define('ABP.view.session.toolbarTop.ToolbarUser',{extend:'Ext.button.Button',alias:'widget.toolbaruser',cls:'toolbar-menu-user a-toolbar-menu-user',height:50,iconCls:'icon-user toolbar-menu-user-icon',bind:{text:'{username:htmlEncode}',menu:'{userMenu}',height:'{toolbarHeight}'},iconAlign:'left',overCls:'toolbar-menu-btn-over',focusCls:'',menuAlign:'tr-br',handler:function(){this.up('toolbartop').getViewModel().set('now',Date.now())}});